angular.module("app",["ui.router","ui.bootstrap","ngAnimate","angular-loading-bar","nouislider","localytics.directives","timer","LocalStorageModule","angular-sortable-view","angular.vertilize"]),function(){"use strict ";function e(e,t,n){e.defaults.headers.get||(e.defaults.headers.get={}),e.defaults.headers.get["If-Modified-Since"]="Fri, 01 Jan 2016 05:00:00 GMT",e.defaults.headers.get["Cache-Control"]="no-cache",e.defaults.headers.get.Pragma="no-cache",t.options({appendToBody:!0}),n.errorOnUnhandledRejections(!1)}e.$inject=["$httpProvider","$uibTooltipProvider","$qProvider"],angular.module("app").config(e)}(),function(){"use strict";function e(e,t){function n(e){t.set("sidebarLocked",e)}var r=this;r.$state=e,r.lockSidebar=t.get("sidebarLocked"),r.toggleSidebarLocked=n}e.$inject=["$state","localStorageService"],angular.module("app").controller("AppCtrl",e)}(),function(){"use strict";function e(e,i,a){var o={superAdmin:n,admin:t,user:r};a.html5Mode(!0),i.otherwise("/"),i.when("/pyramids/","/pyramids"),e.state("home",{url:"/",views:{content:{controller:"HomeCtrl",controllerAs:"vm",templateUrl:"common/views/home.html"}}}).state("pyramids",{url:"/pyramids",views:{content:{controller:"PyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramids.html"}}}).state("pyramids.myPyramids",{url:"/my-pyramids",views:{"content@":{controller:"MyPyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/my-pyramids.html"}},resolve:{auth:o.user}}).state("pyramids.view",{url:"/view/:competitionId",views:{"content@":{controller:"PyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramid.html"}}}).state("pyramids.stats",{url:"/stats/:competitionId",views:{"content@":{controller:"StatsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/stats.html"}}}).state("pyramids.admin",{url:"/admin/:competitionId",views:{"content@":{controller:"AdminCtrl",controllerAs:"vm",templateUrl:"pyramids/views/admin.html"}},resolve:{auth:o.user}}).state("pyramids.create",{url:"/create",views:{"content@":{controller:"CreatePyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/create-pyramid.html"}},resolve:{auth:o.user}}).state("user",{url:"/user",views:{content:{controller:"UserCtrl",controllerAs:"vm",templateUrl:"users/views/user.html"}},resolve:{auth:o.user}}).state("login",{url:"/login",views:{content:{controller:"LoginCtrl",controllerAs:"vm",templateUrl:"authentication/views/login.html"}}}).state("register",{url:"/register",views:{content:{controller:"RegisterCtrl",controllerAs:"vm",templateUrl:"authentication/views/register.html"}}}).state("verify",{url:"/verification",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}}).state("verification",{url:"/verification/:userId/:verificationToken",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}}).state("password-reset-request",{url:"/password-reset",views:{content:{controller:"PasswordResetCtrl",controllerAs:"vm",templateUrl:"authentication/views/password-reset.html"}}}).state("password-reset",{url:"/password-reset/:userId/:verificationToken",views:{content:{controller:"PasswordResetCtrl",controllerAs:"vm",templateUrl:"authentication/views/password-reset.html"}}})}function t(e){return e.authorizeCurrentUserForRoute("admin")}function n(e){return e.authorizeCurrentUserForRoute("super-admin")}function r(e){return e.authenticatedUserForRoute()}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app").config(e),t.$inject=["authService"],n.$inject=["authService"],r.$inject=["authService"]}(),function(){"use strict";function e(e,t,n){e.$on("$stateChangeError",function(e,n,r,i,a,o){"not authorized"===o&&(t.go("login"),t.previous=n,t.prevParams=r)}),e.$on("$stateChangeStart",function(){n.setSidebarStatus(!1)})}e.$inject=["$rootScope","$state","sidebarService"],angular.module("app").run(e)}(),function(){"use strict";function e(e,t,n,r,i,a){function o(e,r){var a=n.defer();return t.post("/login",{username:e,password:r}).then(function(e){e.data.success?(i.currentUser=e.data.user,a.resolve(!0)):"unverified"===e.data.message?a.resolve("unverified"):a.resolve(!1)}),a.promise}function l(e){var r=n.defer();return t.post("/api/users",{userData:e}).then(function(e){e.data?r.resolve(!0):r.resolve(!1)},function(e){"Error: Duplicate Username"===e.data.reason&&a.error("Sorry, an account already exists with that email address.")}),r.promise}function s(){var r=n.defer();return t.post("/logout",{logout:!0}).then(function(){i.currentUser=void 0,r.resolve(),e.go("home")}),r.promise}function c(e){return!!i.isAuthorized(e)||n.reject("not authorized")}function u(){return!!i.isAuthenticated()||n.reject("not authorized")}var d={authenticateUser:o,createUser:l,logout:s,authorizeCurrentUserForRoute:c,authenticatedUserForRoute:u};return d}e.$inject=["$state","$http","$q","userService","identityService","notifyService"],angular.module("app").factory("authService",e)}(),function(){"use strict";function e(e){function t(){return e.get("/api/users").then(function(e){return e})}function n(t,n){return e.get("/api/user/verification",{params:{userId:t,verificationToken:n}})}function r(t){return e.get("/api/user/password/link",{params:{username:t}})}function i(t,n,r){return e.put("/api/user/password/reset",{userId:t,verificationToken:n,password:r})}var a={getAllUsers:t,verifyUser:n,generatePasswordResetLink:r,resetPassword:i};return a}e.$inject=["$http"],angular.module("app").factory("userService",e)}(),function(){"use strict";function e(e,t,n){function r(){}function i(r,i){t.authenticateUser(r,i).then(function(t){t?"unverified"===t?n.error("You must verify your email before you can login"):e.previous?(e.go(e.previous,e.prevParams),e.previous=null,e.prevParams=null):e.go("pyramids.myPyramids"):n.error("Username / password combinaiton incorrect")})}var a=this;a.login=i,r()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("LoginCtrl",e)}(),function(){"use strict";function e(e,t,n,r,i,a){function o(){a.isAuthenticated()?e.go("home"):t.userId&&t.verificationToken&&n.verifyUser(t.userId,t.verificationToken).then(function(e){e.data&&(c.verified=!0)})}function l(t){n.generatePasswordResetLink(t).then(function(t){t.data?(r.success("Please check your email for a password reset link"),e.go("home")):r.error("Could not find that email address")})}function s(a){a.password!==a.confirmPassword?r.error("Passwords don't match!"):n.resetPassword(t.userId,t.verificationToken,a.password).then(function(t){t.data&&i.authenticateUser(t.data.username,a.password).then(function(t){e.go("home")})})}var c=this;c.username="",c.verified=!1,c.resetPasswordForm={},c.generatePasswordResetLink=l,c.resetPassword=s,o()}e.$inject=["$state","$stateParams","userService","notifyService","authService","identityService"],angular.module("app").controller("PasswordResetCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){}function i(r){r.password!==r.confirmPassword?n.error("Passwords don't match!"):t.createUser(r).then(function(){e.go("verify")})}var a=this;a.register=i,r()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("RegisterCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){t.userId&&t.verificationToken&&(i.verifying=!0,i.verified=null,n.verifyUser(t.userId,t.verificationToken).then(function(e){e.data?i.verified=!0:i.verified=!1}))}var i=this;i.verified=void 0,i.verifying=!1,r()}e.$inject=["$state","$stateParams","userService"],angular.module("app").controller("VerificationCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{pyramid:"="},templateUrl:"/challenges/components/active-challenges.html"};return e}function t(e,t){function n(){e.$watch("vm.pyramid",function(){i.pyramid&&r()})}function r(){i.challenges=[],t.getActiveChallengesByCompetition(i.pyramid._id).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){0!==e.timeLimit&&(e.expires=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1)}))})}var i=this;i.challenges=[],n()}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpActiveChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@",allowDelete:"=",challenges:"="},templateUrl:"/challenges/components/completed-challenges.html"};return e}function t(e,t,n){function r(){e.$watch("vm.challenges",function(){o.challenges&&o.challenges.length>0&&i()})}function i(){_.forEach(o.challenges,function(e){e.loser="challenger"===e.winner?"opponent":"challenger",e.whenCompleted=moment(e.completed).calendar(null,{sameDay:"[Today]",nextDay:"[Tomorrow]",nextWeek:"dddd",lastDay:"[Yesterday]",lastWeek:"[Last] dddd",sameElse:"DD/MM/YYYY"})})}function a(e,t){n.deleteChallenge(o.competitionId,e).then(function(){o.challenges.splice(t,1)})}var o=this;o.challenges=[],o.deleteChallenge=a,r()}t.$inject=["$scope","$state","challengesService"],angular.module("app").directive("kpCompletedChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{player:"="},templateUrl:"/challenges/components/player-overall-results.html"};return e}function t(e){function t(){e.$watch("vm.player.results",function(){a.player&&(n(a.player),r(a.player),i(a.player))})}function n(e){for(var t=[],n=0;n<a.maxLevels;n++)t.push(n*(n+1)/2+1);e.level=t.length;for(var r=0;r<t.length;r++)if(e.position<t[r+1]){e.level=t.indexOf(t[r])+1;break}}function r(e){var t,n=0,r=!0;_.forEach(e.results,function(i){r&&("challenger"===i.winner&&i.challenger._id===e._id||"opponent"===i.winner&&i.opponent._id===e._id?"losing"!==t?(n+=1,t="winning"):r=!1:("opponent"===i.winner&&i.challenger._id===e._id||"challenger"===i.winner&&i.opponent._id===e._id)&&("winning"!==t?(n+=1,t="losing"):r=!1)),a.streak={type:t,value:n}})}function i(e){a.wins.asOpponent=_.size(_.filter(e.results,function(t){return t.opponent._id===e._id&&"opponent"===t.winner})),a.wins.asChallenger=_.size(_.filter(e.results,function(t){return t.challenger._id===e._id&&"challenger"===t.winner})),a.wins.total=a.wins.asChallenger+a.wins.asOpponent,a.wins.byForfeit=_.size(_.filter(e.results,function(t){return t.forfeit&&(t.challenger._id===e._id&&"challenger"===t.winner||t.opponent._id===e._id&&"opponent"===t.winner)})),a.loses.asOpponent=_.size(_.filter(e.results,function(t){return t.opponent._id===e._id&&"challenger"===t.winner})),a.loses.asChallenger=_.size(_.filter(e.results,function(t){return t.challenger._id===e._id&&"opponent"===t.winner})),a.loses.total=a.loses.asChallenger+a.loses.asOpponent,a.loses.byForfeit=_.size(_.filter(e.results,function(t){return t.forfeit&&(t.challenger._id===e._id&&"opponent"===t.winner||t.opponent._id===e._id&&"challenger"===t.winner)}))}var a=this;a.maxLevels=10,a.wins={total:0,asChallenger:0,asOpponent:0,byForfeit:0},a.loses={total:0,asChallenger:0,asOpponent:0,byForfeit:0},a.streak={type:null,value:0},t()}t.$inject=["$scope"],angular.module("app").directive("kpPlayerOverallResults",e)}(),function(){"use strict";function e(e){function t(t){return e.post("/api/challenges/create",{challenge:t})}function n(t){return e.post("/api/challenges/complete",{challenge:t})}function r(t){return e.get("/api/challenges/competition",{params:{competitionId:t}})}function i(t){return e.get("/api/challenges/active/competition",{params:{competitionId:t}})}function a(t,n){return e.get("/api/challenges/active/competition/player",{params:{competitionId:t,playerId:n}})}function o(t,n){return e.get("/api/challenges/completed/competition",{params:{competitionId:t,limit:n}})}function l(t,n){return e.delete("/api/challenges/active/competition/player/delete",{params:{competitionId:t,playerId:n}})}function s(t,n){return e.delete("/api/challenges/delete",{params:{competitionId:t,challengeId:n}})}function c(t,n){return e.get("/api/challenges/results/competition/player",{params:{competitionId:t,playerId:n}})}var u={createChallenge:t,completeChallenge:n,getChallengesByCompetition:r,getActiveChallengesByCompetition:i,getActiveChallengeByCompetitionByPlayer:a,getCompletedChallengesByCompetition:o,deleteActiveChallengeByCompetitionByPlayer:l,deleteChallenge:s,getPlayerResultsByCompetition:c};return u}e.$inject=["$http"],angular.module("app").factory("challengesService",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",templateUrl:"/common/components/footer.html"};return e}function t(e,t){function n(){t.logout()}var r=this;r.indentity=e,r.logout=n}t.$inject=["identityService","authService"],angular.module("app").directive("kpFooter",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"headerCtrl",restrict:"A",templateUrl:"/common/components/header.html"};return e}function t(e,t,n,r,i){function a(){o(),e.$watch("headerCtrl.indentity.currentUser",function(){n.isAuthenticated()&&o()})}function o(){d.alerts=[],n.isAuthenticated()&&i.getActiveAlertsByPlayer(n.currentUser._id).then(function(e){d.alerts=e.data})}function l(e,t){i.clearAlert(e).then(function(){d.alerts.splice(t,1)})}function s(){i.clearAllAlertsByPlayer(n.currentUser._id).then(function(){d.alerts=[]})}function c(){t.setSidebarStatus(!d.sidebarStatus.left)}function u(){r.logout()}var d=this;d.indentity=n,d.logout=u,d.sidebarStatus=t.getSidebarStatus(),d.toggleSidebar=c,d.clearAlert=l,d.clearAllAlerts=s,d.alerts=[],a(),e.$on("ws:update_alerts",function(e,t){n.isAuthenticated()&&_.some(t,["userId",n.currentUser._id])&&o()})}t.$inject=["$scope","sidebarService","identityService","authService","alertsService"],angular.module("app").directive("kpHeader",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"sidebarCtrl",restrict:"A",templateUrl:"/common/components/sidebar.html"};return e}function t(e,t,n){function r(){t.logout()}var i=this;i.indentity=e,i.logout=r,i.sidebarStatus=n.getSidebarStatus()}t.$inject=["identityService","authService","sidebarService"],angular.module("app").directive("kpSidebar",e)}(),function(){"use strict";function e(){return function(e,t){if(!angular.isObject(e))return e;var n=[];for(var r in e)n.push(e[r]);return n.sort(function(e,n){return e=parseInt(e[t]),n=parseInt(n[t]),e-n}),n}}angular.module("app").filter("orderObjectBy",e)}(),function(){"use strict";function e(e){function t(t){return e.get("/api/alerts/",{params:{userId:t}})}function n(t){return e.put("/api/alert/clear",{alertId:t})}function r(t){return e.put("/api/alerts/clear",{userId:t})}var i={getActiveAlertsByPlayer:t,clearAlert:n,clearAllAlertsByPlayer:r};return i}e.$inject=["$http"],angular.module("app").factory("alertsService",e)}(),function(){"use strict";function e(e){function t(){return!!this.currentUser}function n(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}var r;null!==e.bootstrappedUserObject&&(r=e.bootstrappedUserObject);var i={currentUser:r,isAuthenticated:t,isAuthorized:n};return i}e.$inject=["$window"],angular.module("app").factory("identityService",e)}(),function(){"use strict";function e(){function e(e,t,n){$.notify({message:e,url:t,target:n},{type:"info"})}function t(e,t,n){$.notify({message:e,url:t,target:n},{type:"success"})}function n(e,t,n){$.notify({message:e,url:t,target:n},{type:"warning"})}function r(e,t,n){$.notify({message:e,url:t,target:n},{type:"danger"})}function i(e,t,n){$.notify({message:e,url:t,target:n},{type:"inverse"})}var a={info:e,success:t,warning:n,error:r,inverse:i};return $.notifyDefaults({newest_on_top:!0,offset:{x:20,y:85}}),a}angular.module("app").factory("notifyService",e)}(),function(){"use strict";function e(){function e(e,t,n,r){$(e).mCustomScrollbar({theme:t,scrollInertia:100,axis:n,mouseWheel:{enable:!0,axis:r,preventDefault:!0}})}var t={malihuScroll:e};return t}angular.module("app").factory("scrollbarService",e)}(),function(){"use strict";function e(){function e(){return n}function t(e){n.left=e}var n={left:!1,right:!1},r={getSidebarStatus:e,setSidebarStatus:t};return r}angular.module("app").factory("sidebarService",e)}(),angular.module("app").service("websocketService",["$rootScope","$window",function(e,t){function n(){return"https:"===t.location.protocol?"wss://"+t.location.host:"ws://"+t.location.host}var r;this.connect=function(){r=new WebSocket(n()),r.onmessage=function(t){var n=JSON.parse(t.data);e.$broadcast("ws:"+n.topic,n.data)}},this.send=function(e,t){var n=JSON.stringify({topic:e,data:t});r.send(n)}}]).run(["websocketService",function(e){e.connect()}]),function(){"use strict";function e(e){function t(){e.getPyramids().then(function(e){n.pyramids=e.data})}var n=this;n.pyramids=[],t()}e.$inject=["pyramidsService"],angular.module("app").controller("HomeCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{pyramid:"="},templateUrl:"/pyramids/components/pending-players.html"};return e}function t(e){function t(){}function n(t){t.position=i.pyramid.players.length+1,e.approvePendingPlayer(i.pyramid._id,t)}function r(t){e.denyPendingPlayer(i.pyramid._id,t)}var i=this;i.pendingPlayers=[],i.approvePendingPlayer=n,i.denyPendingPlayer=r,t()}t.$inject=["pyramidsService"],angular.module("app").directive("kpPendingPlayers",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{pyramid:"="},templateUrl:"/pyramids/components/pyramid-compact.html"};return e}function t(){function e(){}e()}angular.module("app").directive("kpPyramidCompact",e)}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"/pyramids/components/pyramid.html",replace:!0,scope:{pyramid:"="},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,n,r,i,a,o){function l(){for(var t=b;t>0;--t)$.maxPlayers+=t;e.$watch("vm.pyramid",function(){$.pyramid&&($.competitionId=$.pyramid._id,s(),c(),d(),p(),m())})}function s(){$.pyramid.players=r("orderBy")($.pyramid.players,"position")}function c(){$.currentUserIsOwner=!1,$.currentUserIsPending=!1,a.isAuthenticated()&&($.currentUserIsOwner=_.some($.pyramid.owners,["_id",a.currentUser._id]),$.currentUserIsPending=_.some($.pyramid.pendingPlayers,["_id",a.currentUser._id])),$.currentUserIsOnPyramid=!1,$.hasActiveChallenge=!1,_.forEach($.pyramid.players,function(e){a.isAuthenticated()&&e._id===a.currentUser._id&&($.currentUserIsOnPyramid=!0,e.class="current-user",$.currentUserPlayer=e,o.getActiveChallengeByCompetitionByPlayer($.competitionId,e._id).then(function(t){t.data&&($.hasActiveChallenge=!0,$.activeChallengeOpponent=t.data.challenger._id===e._id?t.data.opponent:t.data.challenger)}))}),o.getActiveChallengesByCompetition($.competitionId).then(function(e){_.forEach(e.data,function(e){var t=_.find($.pyramid.players,{_id:e.challenger._id});t.class="unavailable",t.challenge={position:"challenger"};var n=_.find($.pyramid.players,{_id:e.opponent._id});if(n.class="unavailable",n.challenge={position:"opponent"},0!==e.timeLimit){var r=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1;r>0?n.challenge.expires=r:r<=0&&h(null,!0,n)}}),f()})}function u(){$.breakPoints=[];for(var e=0;e<b;e++)$.breakPoints.push(e*(e+1)/2+1)}function d(){var e=0;$.levels=[],u();for(var t=0;t<$.pyramid.players.length;t++)$.breakPoints.indexOf(t+1)>-1&&(e+=1,$.levels.push(e)),$.pyramid.players[t].level=e}function p(){$.numberOfBlocks=0;for(var e=_.last($.levels);e>0;e--)$.numberOfBlocks+=e}function m(){$.numberOfRealPlayers=$.pyramid.players.length;for(var e=$.pyramid.players.length;e<$.numberOfBlocks;e++)$.pyramid.players.push({firstName:"Empty",lastName:"Spot",position:99,class:"empty"});d()}function f(){if($.currentUserIsOnPyramid&&!$.hasActiveChallenge){var e=$.currentUserPlayer.level>1?$.currentUserPlayer.level-1:null;_.forEach($.pyramid.players,function(t){t.level===e&&99!==t.position&&"unavailable"!==t.class&&($.availableChallenges=!0,t.available=!0,t.class="available")})}}function y(e){if(e.available){$.hasActiveChallenge=!0;var t={competitionName:$.pyramid.name,competitionId:$.competitionId,complete:!1,forfeit:!1,timeLimit:$.pyramid.forfeitDays,challenger:{_id:$.currentUserPlayer._id,email:$.currentUserPlayer.email,firstName:$.currentUserPlayer.firstName,lastName:$.currentUserPlayer.lastName,position:$.currentUserPlayer.position},opponent:{_id:e._id,email:e.email,firstName:e.firstName,lastName:e.lastName,position:e.position}};o.createChallenge(t).then(function(){$.pyramidMenuToggle=!1})}else i.error("Sorry, that is not a valid challenge.")}function h(e,t,r){var i=r||$.currentUserPlayer;o.getActiveChallengeByCompetitionByPlayer($.competitionId,i._id).then(function(i){$.hasActiveChallenge=!1;var a=!1;t?(i.data.forfeit=!0,"opponent"===r.challenge.position?(i.data.winner="challenger",a=!0):i.data.winner="opponent"):e?i.data.challenger._id===$.currentUserPlayer._id?(i.data.winner="challenger",a=!0):i.data.winner="opponent":i.data.challenger._id===$.currentUserPlayer._id?i.data.winner="opponent":(i.data.winner="challenger",a=!0),a?n.swapPositions($.competitionId,i.data.opponent,i.data.challenger).then(function(){o.completeChallenge(i.data).then(function(){U&&w()})}):o.completeChallenge(i.data).then(function(){U&&w()}),$.pyramidMenuToggle=!1})}function v(e){h(null,!0,e)}function g(){if(a.isAuthenticated())if($.numberOfRealPlayers<$.maxPlayers){var e={_id:a.currentUser._id,firstName:a.currentUser.firstName,lastName:a.currentUser.lastName,email:a.currentUser.username,position:$.numberOfRealPlayers+1};$.pyramid.open?swal({title:"Join Competition?",text:"You'll be added to the bottom",type:"warning",showCancelButton:!0,confirmButtonText:"Join",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToPyramid($.competitionId,e),swal("Welcome Aboard!","Now start fighting your way to the top","success")}):swal({title:"Send Join Request?",text:"This is a closed competition so the owner must approve your request",type:"warning",showCancelButton:!0,confirmButtonText:"Send Request",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToPyramidRequest($.pyramid,e).then(function(){$.currentUserIsPending=!0}),swal("Request Sent","You will receive an email once the owner processes the request.","success")})}else i.warning("Sorry, this pyramid is full");else i.warning("Please login to join a competition"),t.previous="pyramids.view",t.prevParams={competitionId:$.competitionId},t.go("login")}function P(){swal({title:"Leave Pyramid?",text:"You will lose your spot and forfeit any active challenges.",type:"error",showCancelButton:!0,confirmButtonText:"Yes, leave",confirmButtonClass:"btn-danger",cancelButtonText:"No, stay",closeOnConfirm:!1,closeOnCancel:!0},function(){w(),swal("OK, you'r out!","You've been removed from the pyramid.","success")})}function w(){a.isAuthenticated()&&$.currentUserIsOnPyramid&&(U=!0,$.hasActiveChallenge?h(null,!0,$.currentUserPlayer):($.currentUserIsOnPyramid=!1,$.hasActiveChallenge=!1,n.getPyramid($.competitionId).then(function(e){var t=e.data,r=$.currentUserPlayer.position;_.forEach(t.players,function(e){e.position>=r&&(e.position-=1)});for(var i=_.remove(t.players,function(e){return e._id===$.currentUserPlayer._id}),a=[],o=0;o<$.numberOfRealPlayers-1;++o){var l={_id:t.players[o]._id,firstName:t.players[o].firstName,lastName:t.players[o].lastName,position:t.players[o].position};a.push(l)}n.removedPlayerFromPyramid($.competitionId,i[0],a).then(function(){U=!1})})))}function C(e){99!==e.position||$.currentUserIsOnPyramid||g(),e.available===!0&&$.currentUserIsOnPyramid&&!$.hasActiveChallenge&&swal({title:"Challenge Request",text:"Challenge "+e.firstName+" "+e.lastName+"?",type:"warning",showCancelButton:!0,confirmButtonText:"Send Challenge",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){y(e),swal("Challenge Sent",e.firstName+" "+e.lastName+" has been notified of the challenge.","success")})}function S(){n.getPyramid($.competitionId).then(function(e){$.pyramid=e.data})}var b=10,$=this;$.competitionId=null,$.breakPoints=[],$.levels=[],$.numberOfBlocks=0,$.currentUserIsOnPyramid=!1,$.currentUserIsPending=!1,$.currentUserIsOwner=!1,$.hasActiveChallenge=!1,$.activeChallengeOpponent=null,$.availableChallenges=!1,$.createChallenge=y,$.completeChallenge=h,$.challengeExpired=v,$.currentUserPlayer={},$.pyramidMenuToggle=!1,$.addCurrentUserToPyramid=g,$.confirmRemoveCurrentUserFromPyramid=P,$.playerClick=C,$.numberOfRealPlayers=0,$.maxPlayers=0,l();var U=!1;e.$on("ws:pyramid_updated",function(e,t){$.competitionId===t.competitionId&&(i.info(t.description),S())})}t.$inject=["$scope","$state","pyramidsService","$filter","notifyService","identityService","challengesService"],angular.module("app").directive("kpPyramid",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{pyramid:"="},templateUrl:"/pyramids/components/update-players.html"};return e}function t(e,t,n,r,i){function a(){e.$watch("vm.pyramid",function(){m.pyramid&&o()})}function o(){i.getAllUsers().then(function(e){_.forEach(m.pyramid.players,function(t){_.remove(e.data,function(e){return t._id===e._id})}),m.availablePlayers=e.data})}function l(){_.forEach(p,function(e){r.deleteActiveChallengeByCompetitionByPlayer(m.pyramid._id,e._id)}),n.updatePyramid(m.pyramid).then(function(){m.disableSubmit=!0})}function s(){n.getPyramid(m.pyramid._id).then(function(e){e.data.players=t("orderBy")(e.data.players,"position"),m.pyramid=e.data,m.disableSubmit=!0}),o()}function c(){var e=1;_.forEach(m.pyramid.players,function(t){t.position=e,++e}),m.disableSubmit=!1}function u(e){p.push(e),m.availablePlayers.push(_.remove(m.pyramid.players,{_id:e._id})[0]),c()}function d(e){e.position=m.pyramid.players.length+1,m.pyramid.players.push(_.remove(m.availablePlayers,{_id:e._id})[0]),m.disableSubmit=!1}var p=[],m=this;m.availablePlayers=[],m.updatePyramid=l,m.cancelUpdate=s,m.reorderPlayers=c,m.removePlayer=u,m.addPlayer=d,m.disableSubmit=!0,a()}t.$inject=["$scope","$filter","pyramidsService","challengesService","userService"],angular.module("app").directive("kpUpdatePlayers",e)}(),function(){"use strict";function e(e){function t(t){return e.get("/api/pyramid",{params:{competitionId:t}})}function n(t){return e.get("/api/pyramids/user",{params:{userId:t}})}function r(){return e.get("/api/pyramids")}function i(t){return e.post("/api/pyramids/create",{pyramid:t})}function a(t){return e.post("/api/pyramids/update",{pyramid:t})}function o(t){return e.delete("/api/pyramids/delete",{params:{competitionId:t}})}function l(t,n,r){return e.post("/api/pyramids/swapPositions",{competitionId:t,challenger:n,opponent:r})}function s(t,n){return e.post("/api/pyramids/addPlayer",{competitionId:t,player:n})}function c(t,n){return e.post("/api/pyramids/addPlayerRequest",{competition:t,player:n})}function u(t,n,r){return e.post("/api/pyramids/removePlayer",{competitionId:t,removedPlayer:n,players:r})}function d(t,n){return e.post("/api/pyramids/approvePlayer",{competitionId:t,player:n})}function p(t,n){return e.post("/api/pyramids/denyPlayer",{competitionId:t,player:n})}var m={getPyramid:t,getPyramidsForUser:n,getPyramids:r,createPyramid:i,updatePyramid:a,deletePyramid:o,swapPositions:l,addPlayerToPyramid:s,addPlayerToPyramidRequest:c,removedPlayerFromPyramid:u,approvePendingPlayer:d,denyPendingPlayer:p};return m}e.$inject=["$http"],angular.module("app").factory("pyramidsService",e)}(),function(){"use strict";function e(e,t,n,r,i,a,o,l){function s(){n.competitionId?(p.competitionId=n.competitionId,c()):t.go("pyramids.myPyramids")}function c(){i.getPyramid(p.competitionId).then(function(e){e.data&&_.some(e.data.owners,["_id",a.currentUser._id])?(p.isOwner=!0,e.data.players=r("orderBy")(e.data.players,"position"),p.pyramid=e.data):t.go("pyramids.myPyramids")}),l.getCompletedChallengesByCompetition(p.competitionId).then(function(e){p.challenges=e.data})}function u(){i.getPyramid(p.competitionId).then(function(e){var t=e.data;t.open=p.pyramid.open,i.updatePyramid(t)})}function d(){swal({title:"Delete Competition?",text:"This can not be undone",type:"error",showCancelButton:!0,confirmButtonText:"Delete",cancelButtonText:"Nevermind",closeOnConfirm:!0,closeOnCancel:!0},function(){i.deletePyramid(p.competitionId).then(function(){t.go("pyramids.myPyramids")})})}var p=this;p.competitionId=null,p.updatePyramidOpenStatus=u,p.deletePyramid=d,s(),e.$on("ws:pyramid_updated",function(e,t){p.competitionId===t.competitionId&&(o.info(t.description),c())}),e.$on("ws:pyramid_deleted",function(e,n){p.competitionId===n.competitionId&&(o.info(n.description),t.go("pyramids.myPyramids"))})}e.$inject=["$scope","$state","$stateParams","$filter","pyramidsService","identityService","notifyService","challengesService"],angular.module("app").controller("AdminCtrl",e)}(),function(){"use strict";function e(e,t,n,r){function i(){t.getAllUsers().then(function(e){d.availablePlayers=e.data});for(var e=0;e<u;e++)c.push(e*(e+1)/2+1)}function a(e){e.position=d.addedPlayers.length+1,d.addedPlayers.push(_.remove(d.availablePlayers,{_id:e._id})[0])}function o(e){d.availablePlayers.push(_.remove(d.addedPlayers,{_id:e._id})[0]),l()}function l(){var e=1;_.forEach(d.addedPlayers,function(t){t.position=e,++e})}function s(t){angular.forEach(d.addedPlayers,function(e){p+=1;var n={position:p,_id:e._id,email:e.username,firstName:e.firstName,lastName:e.lastName};t.players.push(n)}),t.owners=[{_id:r.currentUser._id,email:r.currentUser.username,firstName:r.currentUser.firstName,lastName:r.currentUser.lastName}];for(var i=0;i<c.length;i++)if(t.players.length<c[i]){t.levels=i;break}n.createPyramid(t).then(function(t){e.go("pyramids.view",{competitionId:t.data._id})})}var c=[],u=10,d=this;d.newPyramid={players:[],open:!1},d.availablePlayers=[],d.addedPlayers=[],d.createPyramid=s,d.addPlayer=a,d.removePlayer=o,d.reorderPlayers=l,d.newPyramid.forfeitDays=1,i();var p=0}e.$inject=["$state","userService","pyramidsService","identityService"],angular.module("app").controller("CreatePyramidCtrl",e)}(),function(){"use strict";function e(e,t,n,r,i){function a(){o()}function o(){l=[],s.activeChallenge=null,r.isAuthenticated()&&t.getPyramidsForUser(r.currentUser._id).then(function(e){s.pyramids=e.data,_.forEach(s.pyramids,function(e){l.push(e._id),n.getActiveChallengeByCompetitionByPlayer(e._id,r.currentUser._id).then(function(t){t.data&&(e.activeChallenge=t.data,0!==e.activeChallenge.timeLimit&&(e.activeChallenge.expires=moment().diff(moment(e.activeChallenge.created).add(e.activeChallenge.timeLimit,"d"),"s")*-1))})})})}var l=[],s=this;s.activeChallenge=null,a(),e.$on("ws:pyramid_updated",function(e,t){l.indexOf(t.competitionId)>=0&&(i.info(t.description),o())})}e.$inject=["$scope","pyramidsService","challengesService","identityService","notifyService"],angular.module("app").controller("MyPyramidsCtrl",e)}(),function(){"use strict";function e(e,t,n,r,i){function a(){n.competitionId&&(o.competitionId=n.competitionId,r.getPyramid(o.competitionId).then(function(e){e.data?o.pyramid=e.data:t.go("pyramids.myPyramids")}))}var o=this;o.competitionId=null,o.pyramid=null,a(),e.$on("ws:pyramid_deleted",function(e,n){o.competitionId===n.competitionId&&(i.info(n.description),t.go("pyramids.myPyramids"))})}e.$inject=["$scope","$state","$stateParams","pyramidsService","notifyService"],angular.module("app").controller("PyramidCtrl",e)}(),function(){"use strict";function e(e){function t(){e.getPyramids().then(function(e){n.pyramids=e.data})}var n=this;n.pyramids=[],t()}e.$inject=["pyramidsService"],angular.module("app").controller("PyramidsCtrl",e)}(),function(){"use strict";function e(e,t,n,r,i,a){function o(){t.competitionId&&(s.competitionId=t.competitionId,l())}function l(){r.getPyramid(s.competitionId).then(function(e){
e.data?(s.pyramid=e.data,_.forEach(s.pyramid.players,function(e){a.getPlayerResultsByCompetition(s.competitionId,e._id).then(function(t){e.results=t.data})})):n.go("pyramids.myPyramids")}),a.getCompletedChallengesByCompetition(s.competitionId).then(function(e){s.challenges=e.data})}var s=this;s.competitionId=null,s.pyramid={},s.playersResults=[],s.challenges=[],o(),e.$on("ws:pyramid_updated",function(e,t){s.competitionId===t.competitionId&&(i.info(t.description),l())}),e.$on("ws:pyramid_deleted",function(e,t){s.competitionId===t.competitionId&&(i.info(t.description),n.go("pyramids.myPyramids"))})}e.$inject=["$scope","$stateParams","$state","pyramidsService","notifyService","challengesService"],angular.module("app").controller("StatsCtrl",e)}(),function(){"use strict";function e(e){function t(){}var n=this;n.indentity=e,t()}e.$inject=["identityService"],angular.module("app").controller("UserCtrl",e)}(),function(){"use strict";function e(e){function t(t,n,r){var i=r.scrollaxis||"y",a=r.theme||"minimal-dark",o=r.mousewheelaxis||"y";$("html").hasClass("ismobile")||e.malihuScroll(n,a,i,o)}var n={restrict:"C",link:t};return n}e.$inject=["scrollbarService"],angular.module("app").directive("cOverflow",e)}(),function(){"use strict";function e(){function e(e,t){t.click(function(){t.next().slideToggle(200),t.parent().toggleClass("toggled")})}var t={restrict:"A",link:e};return t}angular.module("app").directive("toggleSubmenu",e)}(),function(){"use strict";function e(){function e(e,t){t.hasClass("btn-icon")||t.hasClass("btn-float")?Waves.attach(t,["waves-circle"]):t.hasClass("btn-light")?Waves.attach(t,["waves-light"]):Waves.attach(t),Waves.init()}var t={restrict:"C",link:e};return t}angular.module("app").directive("wavesEffect",e)}(),function(){"use strict";function e(){function e(e,t){var n=t.children().first(),r=t.parent().hasClass("fg-float");n.focus(function(){t.addClass("fg-toggled")}),n.blur(function(){(!r||r&&0===n.val().length)&&t.removeClass("fg-toggled")})}var t={restrict:"C",link:e};return t}angular.module("app").directive("fgLine",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiYXBwLmNvbnRyb2xsZXIuanMiLCJhcHAucm91dGVzLmpzIiwiYXBwLnJ1bi5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL2F1dGguc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL3VzZXIuc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3ZpZXdzL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJhdXRoZW50aWNhdGlvbi92aWV3cy9wYXNzd29yZC1yZXNldC5jb250cm9sbGVyLmpzIiwiYXV0aGVudGljYXRpb24vdmlld3MvcmVnaXN0ZXIuY29udHJvbGxlci5qcyIsImF1dGhlbnRpY2F0aW9uL3ZpZXdzL3ZlcmlmaWNhdGlvbi5jb250cm9sbGVyLmpzIiwiY2hhbGxlbmdlcy9jb21wb25lbnRzL2FjdGl2ZS1jaGFsbGVuZ2VzLmRpcmVjdGl2ZS5qcyIsImNoYWxsZW5nZXMvY29tcG9uZW50cy9jb21wbGV0ZWQtY2hhbGxlbmdlcy5kaXJlY3RpdmUuanMiLCJjaGFsbGVuZ2VzL2NvbXBvbmVudHMvcGxheWVyLW92ZXJhbGwtcmVzdWx0cy5kaXJlY3RpdmUuanMiLCJjaGFsbGVuZ2VzL3NlcnZpY2VzL2NoYWxsZW5nZXMuc2VydmljZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL2Zvb3Rlci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy9oZWFkZXIuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvc2lkZWJhci5kaXJlY3RpdmUuanMiLCJjb21tb24vZmlsdGVycy9vcmRlci1vYmplY3QtYnkuZmlsdGVyLmpzIiwiY29tbW9uL3NlcnZpY2VzL2FsZXJ0cy5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL2luZGVudGl0eS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL25vdGlmeS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3Njcm9sbGJhci5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3NpZGViYXIuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy93ZWJzb2NrZXQuc2VydmljZS5qcyIsImNvbW1vbi92aWV3cy9ob21lLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3BlbmRpbmctcGxheWVycy5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQtY29tcGFjdC5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQuZGlyZWN0aXZlLmpzIiwicHlyYW1pZHMvY29tcG9uZW50cy91cGRhdGUtcGxheWVycy5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9zZXJ2aWNlcy9weXJhbWlkcy5zZXJ2aWNlLmpzIiwicHlyYW1pZHMvdmlld3MvYWRtaW4uY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL2NyZWF0ZS1weXJhbWlkLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy92aWV3cy9teS1weXJhbWlkcy5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvcHlyYW1pZC5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvcHlyYW1pZHMuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL3N0YXRzLmNvbnRyb2xsZXIuanMiLCJ1c2Vycy92aWV3cy91c2VyLmNvbnRyb2xsZXIuanMiLCJjb21tb24vY29tcG9uZW50cy91aS9zY3JvbGxiYXIuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvdWkvdG9nZ2xlLXN1Ym1lbnUuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvdWkvd2F2ZXMuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvdWkvZm9ybXMvZmctbGluZS5kaXJlY3RpdmUuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZ3VyYXRpb24iLCIkaHR0cFByb3ZpZGVyIiwiJHVpYlRvb2x0aXBQcm92aWRlciIsIiRxUHJvdmlkZXIiLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJnZXQiLCJvcHRpb25zIiwiYXBwZW5kVG9Cb2R5IiwiZXJyb3JPblVuaGFuZGxlZFJlamVjdGlvbnMiLCJjb25maWciLCJBcHBDdHJsIiwiJHN0YXRlIiwibG9jYWxTdG9yYWdlU2VydmljZSIsInRvZ2dsZVNpZGViYXJMb2NrZWQiLCJsb2NrZWQiLCJzZXQiLCJhcHBDdHJsIiwidGhpcyIsImxvY2tTaWRlYmFyIiwiY29udHJvbGxlciIsImNvbmZpZ3VyZVJvdXRlcyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJyb3V0ZVJvbGVDaGVja3MiLCJzdXBlckFkbWluIiwicmVxdWlyZVN1cGVyQWRtaW4iLCJhZG1pbiIsInJlcXVpcmVBZG1pbiIsInVzZXIiLCJyZXF1aXJlQXV0aCIsImh0bWw1TW9kZSIsIm90aGVyd2lzZSIsIndoZW4iLCJzdGF0ZSIsInVybCIsInZpZXdzIiwiY29udGVudCIsImNvbnRyb2xsZXJBcyIsInRlbXBsYXRlVXJsIiwiY29udGVudEAiLCJyZXNvbHZlIiwiYXV0aCIsImF1dGhTZXJ2aWNlIiwiYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSIsImF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUiLCIkaW5qZWN0IiwiYXBwUnVuIiwiJHJvb3RTY29wZSIsInNpZGViYXJTZXJ2aWNlIiwiJG9uIiwiZXZlbnQiLCJ0b1N0YXRlIiwidG9QYXJhbXMiLCJmcm9tU3RhdGUiLCJmcm9tUGFyYW1zIiwiZXJyb3IiLCJnbyIsInByZXZpb3VzIiwicHJldlBhcmFtcyIsInNldFNpZGViYXJTdGF0dXMiLCJydW4iLCIkaHR0cCIsIiRxIiwidXNlclNlcnZpY2UiLCJpZGVudGl0eVNlcnZpY2UiLCJub3RpZnlTZXJ2aWNlIiwiYXV0aGVudGljYXRlVXNlciIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJkZmQiLCJkZWZlciIsInBvc3QiLCJ0aGVuIiwicmVzcG9uc2UiLCJkYXRhIiwic3VjY2VzcyIsImN1cnJlbnRVc2VyIiwibWVzc2FnZSIsInByb21pc2UiLCJjcmVhdGVVc2VyIiwidXNlckRhdGEiLCJyZWFzb24iLCJsb2dvdXQiLCJ1bmRlZmluZWQiLCJyb2xlIiwiaXNBdXRob3JpemVkIiwicmVqZWN0IiwiaXNBdXRoZW50aWNhdGVkIiwic2VydmljZSIsImZhY3RvcnkiLCJnZXRBbGxVc2VycyIsInVzZXJzIiwidmVyaWZ5VXNlciIsInVzZXJJZCIsInZlcmlmaWNhdGlvblRva2VuIiwicGFyYW1zIiwiZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayIsInJlc2V0UGFzc3dvcmQiLCJwdXQiLCJMb2dpbkN0cmwiLCJhY3RpdmF0ZSIsImxvZ2luIiwidm0iLCJQYXNzd29yZFJlc2V0Q3RybCIsIiRzdGF0ZVBhcmFtcyIsInZlcmlmaWVkIiwicmVzZXRQYXNzd29yZEZvcm0iLCJjb25maXJtUGFzc3dvcmQiLCJSZWdpc3RlckN0cmwiLCJyZWdpc3RlciIsIm5ld1VzZXIiLCJWZXJpZmljYXRpb25DdHJsIiwidmVyaWZ5aW5nIiwia3BBY3RpdmVDaGFsbGVuZWdlcyIsImRpcmVjdGl2ZSIsImJpbmRUb0NvbnRyb2xsZXIiLCJjdHJsRnVuYyIsInJlc3RyaWN0Iiwic2NvcGUiLCJweXJhbWlkIiwiJHNjb3BlIiwiY2hhbGxlbmdlc1NlcnZpY2UiLCIkd2F0Y2giLCJnZXRBY3RpdmVDaGFsbGVuZ2VzIiwiY2hhbGxlbmdlcyIsImdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uIiwiX2lkIiwibGVuZ3RoIiwiXyIsImZvckVhY2giLCJjaGFsbGVuZ2UiLCJ0aW1lTGltaXQiLCJleHBpcmVzIiwibW9tZW50IiwiZGlmZiIsImNyZWF0ZWQiLCJhZGQiLCJrcENvbXBsZXRlZENoYWxsZW5lZ2VzIiwiY29tcGV0aXRpb25JZCIsImFsbG93RGVsZXRlIiwiZGlzcGxheUNvbXBsZXRlZENoYWxsZW5nZXMiLCJsb3NlciIsIndpbm5lciIsIndoZW5Db21wbGV0ZWQiLCJjb21wbGV0ZWQiLCJjYWxlbmRhciIsInNhbWVEYXkiLCJuZXh0RGF5IiwibmV4dFdlZWsiLCJsYXN0RGF5IiwibGFzdFdlZWsiLCJzYW1lRWxzZSIsImRlbGV0ZUNoYWxsZW5nZSIsImNoYWxsZW5nZUlkIiwiJGluZGV4Iiwic3BsaWNlIiwia3BQbGF5ZXJPdmVyYWxsUmVzdWx0cyIsInBsYXllciIsImFzc2lnbnBsYXllcnNUb0xldmVscyIsImNhbGN1bGF0ZVN0cmVhayIsImNhbGN1YXRlV2luQW5kTG9zZXMiLCJicmVha1BvaW50cyIsImkiLCJtYXhMZXZlbHMiLCJwdXNoIiwibGV2ZWwiLCJqIiwicG9zaXRpb24iLCJpbmRleE9mIiwic3RyZWFrVHlwZSIsInN0cmVhayIsImNvbnRpbnVlU3RyZWFrIiwicmVzdWx0cyIsImNoYWxsZW5nZXIiLCJvcHBvbmVudCIsInR5cGUiLCJ2YWx1ZSIsIndpbnMiLCJhc09wcG9uZW50Iiwic2l6ZSIsImZpbHRlciIsImFzQ2hhbGxlbmdlciIsInRvdGFsIiwiYnlGb3JmZWl0IiwiZm9yZmVpdCIsImxvc2VzIiwiY3JlYXRlQ2hhbGxlbmdlIiwiY29tcGxldGVDaGFsbGVuZ2UiLCJnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbiIsImdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllciIsInBsYXllcklkIiwiZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24iLCJsaW1pdCIsImRlbGV0ZUFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllciIsImRlbGV0ZSIsImdldFBsYXllclJlc3VsdHNCeUNvbXBldGl0aW9uIiwia3BGb290ZXIiLCJpbmRlbnRpdHkiLCJrcEhlYWRlciIsImFsZXJ0c1NlcnZpY2UiLCJnZXRBY3RpdmVBbGVydHMiLCJoZWFkZXJDdHJsIiwiYWxlcnRzIiwiZ2V0QWN0aXZlQWxlcnRzQnlQbGF5ZXIiLCJjbGVhckFsZXJ0IiwiaW5kZXgiLCJjbGVhckFsbEFsZXJ0cyIsImNsZWFyQWxsQWxlcnRzQnlQbGF5ZXIiLCJ0b2dnbGVTaWRlYmFyIiwic2lkZWJhclN0YXR1cyIsImxlZnQiLCJnZXRTaWRlYmFyU3RhdHVzIiwiZSIsInNvbWUiLCJrcFNpZGViYXIiLCJvcmRlck9iamVjdEJ5IiwiaW5wdXQiLCJhdHRyaWJ1dGUiLCJpc09iamVjdCIsImFycmF5Iiwib2JqZWN0S2V5Iiwic29ydCIsImEiLCJiIiwicGFyc2VJbnQiLCJhbGVydElkIiwiJHdpbmRvdyIsInJvbGVzIiwiYm9vdHN0cmFwcGVkVXNlck9iamVjdCIsImluZm8iLCJ0YXJnZXQiLCIkIiwibm90aWZ5Iiwid2FybmluZyIsImludmVyc2UiLCJub3RpZnlEZWZhdWx0cyIsIm5ld2VzdF9vbl90b3AiLCJvZmZzZXQiLCJ4IiwieSIsInNjcm9sbGJhclNlcnZpY2UiLCJtYWxpaHVTY3JvbGwiLCJzZWxlY3RvciIsInRoZW1lIiwic2Nyb2xsYXhpcyIsIm1vdXNld2hlZWxheGlzIiwibUN1c3RvbVNjcm9sbGJhciIsInNjcm9sbEluZXJ0aWEiLCJheGlzIiwibW91c2VXaGVlbCIsImVuYWJsZSIsInByZXZlbnREZWZhdWx0Iiwic3RhdHVzIiwicmlnaHQiLCJ3ZWJzb2NrZXRIb3N0IiwibG9jYXRpb24iLCJwcm90b2NvbCIsImhvc3QiLCJjb25uZWN0aW9uIiwiY29ubmVjdCIsIldlYlNvY2tldCIsIm9ubWVzc2FnZSIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCIkYnJvYWRjYXN0IiwidG9waWMiLCJzZW5kIiwianNvbiIsInN0cmluZ2lmeSIsIndlYnNvY2tldFNlcnZpY2UiLCJIb21lQ3RybCIsInB5cmFtaWRzU2VydmljZSIsImdldFB5cmFtaWRzIiwicHlyYW1pZHMiLCJrcFBlbmRpbmdQbGF5ZXJzIiwiYXBwcm92ZVBlbmRpbmdQbGF5ZXIiLCJwbGF5ZXJzIiwiZGVueVBlbmRpbmdQbGF5ZXIiLCJwZW5kaW5nUGxheWVycyIsImtwUHlyYW1pZENvbXBhY3QiLCJrcFB5cmFtaWQiLCJyZXBsYWNlIiwiJGZpbHRlciIsIm1heFBsYXllcnMiLCJvcmRlclBsYXllcnMiLCJnZXRQbGF5ZXJzU3RhdHVzIiwiYXNzaWduTGV2ZWxzVG9QbGF5ZXJzIiwiY2FsY3VsYXRlUHlyYW1pZEJsb2NrcyIsImZpbGxJbkVtcHR5QmxvY2tzIiwiY3VycmVudFVzZXJJc093bmVyIiwiY3VycmVudFVzZXJJc1BlbmRpbmciLCJvd25lcnMiLCJjdXJyZW50VXNlcklzT25QeXJhbWlkIiwiaGFzQWN0aXZlQ2hhbGxlbmdlIiwiY2xhc3MiLCJjdXJyZW50VXNlclBsYXllciIsImFjdGl2ZUNoYWxsZW5nZU9wcG9uZW50IiwiZmluZCIsInRpbWVUb0V4cGlyZSIsImZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzIiwiY3JlYXRlQnJlYWtQb2ludHMiLCJsZXZlbHMiLCJudW1iZXJPZkJsb2NrcyIsImxhc3QiLCJudW1iZXJPZlJlYWxQbGF5ZXJzIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJsZXZlbEFib3ZlIiwiYXZhaWxhYmxlQ2hhbGxlbmdlcyIsImF2YWlsYWJsZSIsImNvbXBldGl0aW9uTmFtZSIsIm5hbWUiLCJjb21wbGV0ZSIsImZvcmZlaXREYXlzIiwiZW1haWwiLCJweXJhbWlkTWVudVRvZ2dsZSIsIndpbm5lcklzQ3VycmVudFVzZXIiLCJmb3JmZWl0TG9zZXIiLCJzd2FwUG9zaXRpb25zIiwicmVtb3ZpbmdDdXJyZW50VXNlciIsInJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQiLCJjaGFsbGVuZ2VFeHBpcmVkIiwiYWRkQ3VycmVudFVzZXJUb1B5cmFtaWQiLCJvcGVuIiwic3dhbCIsInRpdGxlIiwidGV4dCIsInNob3dDYW5jZWxCdXR0b24iLCJjb25maXJtQnV0dG9uVGV4dCIsImNhbmNlbEJ1dHRvblRleHQiLCJjbG9zZU9uQ29uZmlybSIsImNsb3NlT25DYW5jZWwiLCJhZGRQbGF5ZXJUb1B5cmFtaWQiLCJhZGRQbGF5ZXJUb1B5cmFtaWRSZXF1ZXN0IiwiY29uZmlybVJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQiLCJjb25maXJtQnV0dG9uQ2xhc3MiLCJnZXRQeXJhbWlkIiwicCIsIm9wZW5Qb3NpdGlvbiIsInJlbW92ZWRQbGF5ZXIiLCJyZW1vdmUiLCJ1cGRhdGVkUGxheWVycyIsInVwZGF0ZWRQbGF5ZXIiLCJyZW1vdmVkUGxheWVyRnJvbVB5cmFtaWQiLCJwbGF5ZXJDbGljayIsInJlZnJlc2hQeXJhbWlkIiwiY2hhbGxlbmdlRGV0YWlscyIsImRlc2NyaXB0aW9uIiwia3BVcGRhdGVQbGF5ZXJzIiwiZ2V0QXZhaWxhYmxlUGxheWVycyIsInB5cmFtaWRQbGF5ZXIiLCJhdmFpbGFibGVQbGF5ZXIiLCJhdmFpbGFibGVQbGF5ZXJzIiwidXBkYXRlUHlyYW1pZCIsInJlbW92ZWRQbGF5ZXJzIiwiZGlzYWJsZVN1Ym1pdCIsImNhbmNlbFVwZGF0ZSIsInJlb3JkZXJQbGF5ZXJzIiwicmVtb3ZlUGxheWVyIiwiYWRkUGxheWVyIiwiZ2V0UHlyYW1pZHNGb3JVc2VyIiwiY3JlYXRlUHlyYW1pZCIsImRlbGV0ZVB5cmFtaWQiLCJjb21wZXRpdGlvbiIsIkFkbWluQ3RybCIsImlzT3duZXIiLCJ1cGRhdGVQeXJhbWlkT3BlblN0YXR1cyIsInVwZGF0ZWRQeXJhbWlkIiwiQ3JlYXRlUHlyYW1pZEN0cmwiLCJhZGRlZFBsYXllcnMiLCJuZXdQeXJhbWlkIiwiTXlQeXJhbWlkc0N0cmwiLCJteVB5cmFtaWRzIiwiYWN0aXZlQ2hhbGxlbmdlIiwiUHlyYW1pZEN0cmwiLCJQeXJhbWlkc0N0cmwiLCJTdGF0c0N0cmwiLCJwbGF5ZXJzUmVzdWx0cyIsIlVzZXJDdHJsIiwiY092ZXJmbG93IiwibGlua0Z1bmMiLCJlbGVtZW50IiwiYXR0cnMiLCJoYXNDbGFzcyIsImxpbmsiLCJ0b2dnbGVTdWJtZW51IiwiZWwiLCJjbGljayIsIm5leHQiLCJzbGlkZVRvZ2dsZSIsInBhcmVudCIsInRvZ2dsZUNsYXNzIiwid2F2ZXNFZmZlY3QiLCJXYXZlcyIsImF0dGFjaCIsImluaXQiLCJmZ0xpbmUiLCJjaGlsZHJlbiIsImZpcnN0IiwiaXNGbG9h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ZHVsZSgnYXBwJywgW1xuICAndWkucm91dGVyJyxcbiAgJ3VpLmJvb3RzdHJhcCcsXG4gICduZ0FuaW1hdGUnLFxuICAnYW5ndWxhci1sb2FkaW5nLWJhcicsXG4gICdub3Vpc2xpZGVyJyxcbiAgJ2xvY2FseXRpY3MuZGlyZWN0aXZlcycsXG4gICd0aW1lcicsXG4gICdMb2NhbFN0b3JhZ2VNb2R1bGUnLFxuICAnYW5ndWxhci1zb3J0YWJsZS12aWV3JyxcbiAgJ2FuZ3VsYXIudmVydGlsaXplJ1xuXSk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QgJztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbmZpZyhjb25maWd1cmF0aW9uKTtcblxuICBmdW5jdGlvbiBjb25maWd1cmF0aW9uKCRodHRwUHJvdmlkZXIsICR1aWJUb29sdGlwUHJvdmlkZXIsICRxUHJvdmlkZXIpIHtcbiAgICAvL2luaXRpYWxpemUgZ2V0IGlmIG5vdCB0aGVyZVxuICAgIGlmICghJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldCkge1xuICAgICAgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldCA9IHt9OyAgICBcbiAgICB9ICAgIFxuICAgIC8vZGlzYWJsZSBJRSBhamF4IHJlcXVlc3QgY2FjaGluZ1xuICAgICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXRbJ0lmLU1vZGlmaWVkLVNpbmNlJ10gPSAnRnJpLCAwMSBKYW4gMjAxNiAwNTowMDowMCBHTVQnO1xuICAgIC8vIGV4dHJhXG4gICAgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldFsnQ2FjaGUtQ29udHJvbCddID0gJ25vLWNhY2hlJztcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0WydQcmFnbWEnXSA9ICduby1jYWNoZSc7XG5cbiAgICAkdWliVG9vbHRpcFByb3ZpZGVyLm9wdGlvbnMoeyBhcHBlbmRUb0JvZHk6IHRydWUgfSk7XG4gICAgJHFQcm92aWRlci5lcnJvck9uVW5oYW5kbGVkUmVqZWN0aW9ucyhmYWxzZSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQXBwQ3RybCcsIEFwcEN0cmwpO1xuXG4gIGZ1bmN0aW9uIEFwcEN0cmwoJHN0YXRlLCBsb2NhbFN0b3JhZ2VTZXJ2aWNlKSB7XG4gICAgdmFyIGFwcEN0cmwgPSB0aGlzO1xuICAgIC8vIFVzZSB0aGlzIGZvciBTaWRlYmFyIG1lbnVcbiAgICBhcHBDdHJsLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgICAvLyBMb2NrIHRoZSBzaWRlYmFyIGluIHZpZXdcbiAgICBhcHBDdHJsLmxvY2tTaWRlYmFyID0gbG9jYWxTdG9yYWdlU2VydmljZS5nZXQoJ3NpZGViYXJMb2NrZWQnKTtcbiAgICBhcHBDdHJsLnRvZ2dsZVNpZGViYXJMb2NrZWQgPSB0b2dnbGVTaWRlYmFyTG9ja2VkO1xuXG4gICAgZnVuY3Rpb24gdG9nZ2xlU2lkZWJhckxvY2tlZChsb2NrZWQpIHtcbiAgICAgIGxvY2FsU3RvcmFnZVNlcnZpY2Uuc2V0KCdzaWRlYmFyTG9ja2VkJywgbG9ja2VkKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29uZmlnKGNvbmZpZ3VyZVJvdXRlcyk7XG5cbiAgZnVuY3Rpb24gY29uZmlndXJlUm91dGVzKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgdmFyIHJvdXRlUm9sZUNoZWNrcyA9IHtcbiAgICAgIHN1cGVyQWRtaW46IHJlcXVpcmVTdXBlckFkbWluLFxuICAgICAgYWRtaW46IHJlcXVpcmVBZG1pbixcbiAgICAgIHVzZXI6IHJlcXVpcmVBdXRoXG4gICAgfTtcblxuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcblxuICAgIC8vIGZvciBhbnkgdW5tYXRjaGVkIHVybFxuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcblxuICAgICR1cmxSb3V0ZXJQcm92aWRlci53aGVuKCcvcHlyYW1pZHMvJywgJy9weXJhbWlkcycpO1xuXG4gICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgIC5zdGF0ZSgnaG9tZScsIHtcbiAgICAgICAgdXJsOiAnLycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21tb24vdmlld3MvaG9tZS5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzJywge1xuICAgICAgICB1cmw6ICcvcHlyYW1pZHMnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1B5cmFtaWRzQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL3B5cmFtaWRzLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMubXlQeXJhbWlkcycsIHtcbiAgICAgICAgdXJsOiAnL215LXB5cmFtaWRzJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTXlQeXJhbWlkc0N0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9teS1weXJhbWlkcy5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIGF1dGg6IHJvdXRlUm9sZUNoZWNrcy51c2VyXG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy52aWV3Jywge1xuICAgICAgICB1cmw6ICcvdmlldy86Y29tcGV0aXRpb25JZCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1B5cmFtaWRDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvcHlyYW1pZC5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLnN0YXRzJywge1xuICAgICAgICB1cmw6ICcvc3RhdHMvOmNvbXBldGl0aW9uSWQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdGF0c0N0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9zdGF0cy5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLmFkbWluJywge1xuICAgICAgICB1cmw6ICcvYWRtaW4vOmNvbXBldGl0aW9uSWQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBZG1pbkN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9hZG1pbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIGF1dGg6IHJvdXRlUm9sZUNoZWNrcy51c2VyXG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy5jcmVhdGUnLCB7XG4gICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDcmVhdGVQeXJhbWlkQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL2NyZWF0ZS1weXJhbWlkLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3VzZXInLCB7XG4gICAgICAgIHVybDogJy91c2VyJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdVc2VyQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3VzZXJzL3ZpZXdzL3VzZXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICBhdXRoOiByb3V0ZVJvbGVDaGVja3MudXNlclxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvbG9naW4uaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdyZWdpc3RlcicsIHtcbiAgICAgICAgdXJsOiAnL3JlZ2lzdGVyJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy9yZWdpc3Rlci5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3ZlcmlmeScsIHtcbiAgICAgICAgdXJsOiAnL3ZlcmlmaWNhdGlvbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVmVyaWZpY2F0aW9uQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3ZlcmlmaWNhdGlvbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3ZlcmlmaWNhdGlvbicsIHtcbiAgICAgICAgdXJsOiAnL3ZlcmlmaWNhdGlvbi86dXNlcklkLzp2ZXJpZmljYXRpb25Ub2tlbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVmVyaWZpY2F0aW9uQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3ZlcmlmaWNhdGlvbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3Bhc3N3b3JkLXJlc2V0LXJlcXVlc3QnLCB7XG4gICAgICAgIHVybDogJy9wYXNzd29yZC1yZXNldCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUGFzc3dvcmRSZXNldEN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy9wYXNzd29yZC1yZXNldC5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3Bhc3N3b3JkLXJlc2V0Jywge1xuICAgICAgICB1cmw6ICcvcGFzc3dvcmQtcmVzZXQvOnVzZXJJZC86dmVyaWZpY2F0aW9uVG9rZW4nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bhc3N3b3JkUmVzZXRDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvcGFzc3dvcmQtcmVzZXQuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgcmVxdWlyZUFkbWluLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZUFkbWluKGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUoJ2FkbWluJyk7XG4gIH1cblxuICByZXF1aXJlU3VwZXJBZG1pbi4kaW5qZWN0ID0gWydhdXRoU2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIHJlcXVpcmVTdXBlckFkbWluKGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUoJ3N1cGVyLWFkbWluJyk7XG4gIH1cblxuICByZXF1aXJlQXV0aC4kaW5qZWN0ID0gWydhdXRoU2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIHJlcXVpcmVBdXRoKGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUoKTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5ydW4oYXBwUnVuKTtcblxuICBmdW5jdGlvbiBhcHBSdW4oJHJvb3RTY29wZSwgJHN0YXRlLCBzaWRlYmFyU2VydmljZSkge1xuICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VFcnJvcicsIGZ1bmN0aW9uIChldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcywgZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvciA9PT0gJ25vdCBhdXRob3JpemVkJykge1xuICAgICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XG4gICAgICAgICRzdGF0ZS5wcmV2aW91cyA9IHRvU3RhdGU7XG4gICAgICAgICRzdGF0ZS5wcmV2UGFyYW1zID0gdG9QYXJhbXM7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBzaWRlYmFyU2VydmljZS5zZXRTaWRlYmFyU3RhdHVzKGZhbHNlKTtcbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdhdXRoU2VydmljZScsIGF1dGhTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBhdXRoU2VydmljZSgkc3RhdGUsICRodHRwLCAkcSwgdXNlclNlcnZpY2UsIGlkZW50aXR5U2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgYXV0aGVudGljYXRlVXNlcjogYXV0aGVudGljYXRlVXNlcixcbiAgICAgIGNyZWF0ZVVzZXI6IGNyZWF0ZVVzZXIsXG4gICAgICBsb2dvdXQ6IGxvZ291dCxcbiAgICAgIGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGU6IGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUsXG4gICAgICBhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlOiBhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9sb2dpbicsIHtcbiAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSByZXNwb25zZS5kYXRhLnVzZXI7XG4gICAgICAgICAgZGZkLnJlc29sdmUodHJ1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlID09PSAndW52ZXJpZmllZCcpIHtcbiAgICAgICAgICBkZmQucmVzb2x2ZSgndW52ZXJpZmllZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRmZC5yZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlVXNlcih1c2VyRGF0YSkge1xuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywge1xuICAgICAgICB1c2VyRGF0YTogdXNlckRhdGFcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUodHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEucmVhc29uID09PSAnRXJyb3I6IER1cGxpY2F0ZSBVc2VybmFtZScpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdTb3JyeSwgYW4gYWNjb3VudCBhbHJlYWR5IGV4aXN0cyB3aXRoIHRoYXQgZW1haWwgYWRkcmVzcy4nKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5wb3N0KCcvbG9nb3V0Jywge1xuICAgICAgICBsb2dvdXQ6IHRydWVcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIGRmZC5yZXNvbHZlKCk7XG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZShyb2xlKSB7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aG9yaXplZChyb2xlKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoJ25vdCBhdXRob3JpemVkJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpIHtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJHEucmVqZWN0KCdub3QgYXV0aG9yaXplZCcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCd1c2VyU2VydmljZScsIHVzZXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiB1c2VyU2VydmljZSgkaHR0cCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0QWxsVXNlcnM6IGdldEFsbFVzZXJzLFxuICAgICAgdmVyaWZ5VXNlcjogdmVyaWZ5VXNlcixcbiAgICAgIGdlbmVyYXRlUGFzc3dvcmRSZXNldExpbms6IGdlbmVyYXRlUGFzc3dvcmRSZXNldExpbmssXG4gICAgICByZXNldFBhc3N3b3JkOiByZXNldFBhc3N3b3JkXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGdldEFsbFVzZXJzKCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIHJldHVybiB1c2VycztcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZlcmlmeVVzZXIodXNlcklkLCB2ZXJpZmljYXRpb25Ub2tlbikge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VyL3ZlcmlmaWNhdGlvbicsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgdXNlcklkOiB1c2VySWQsXG4gICAgICAgICAgdmVyaWZpY2F0aW9uVG9rZW46IHZlcmlmaWNhdGlvblRva2VuXG4gICAgICAgIH1cbiAgICAgIH0pOyAgXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayh1c2VybmFtZSkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VyL3Bhc3N3b3JkL2xpbmsnLCB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZVxuICAgICAgICB9XG4gICAgICB9KTsgIFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQodXNlcklkLCB2ZXJpZmljYXRpb25Ub2tlbiwgcGFzc3dvcmQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wdXQoJy9hcGkvdXNlci9wYXNzd29yZC9yZXNldCcsIHtcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXG4gICAgICAgIHZlcmlmaWNhdGlvblRva2VuOiB2ZXJpZmljYXRpb25Ub2tlbixcbiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICB9KTsgIFxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBMb2dpbkN0cmwpO1xuXG4gIGZ1bmN0aW9uIExvZ2luQ3RybCgkc3RhdGUsIGF1dGhTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5sb2dpbiA9IGxvZ2luO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgYXV0aFNlcnZpY2UuYXV0aGVudGljYXRlVXNlcih1c2VybmFtZSwgcGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdVc2VybmFtZSAvIHBhc3N3b3JkIGNvbWJpbmFpdG9uIGluY29ycmVjdCcpO1xuICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlID09PSAndW52ZXJpZmllZCcpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdZb3UgbXVzdCB2ZXJpZnkgeW91ciBlbWFpbCBiZWZvcmUgeW91IGNhbiBsb2dpbicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICgkc3RhdGUucHJldmlvdXMpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygkc3RhdGUucHJldmlvdXMsICRzdGF0ZS5wcmV2UGFyYW1zKTtcbiAgICAgICAgICAgICRzdGF0ZS5wcmV2aW91cyA9IG51bGw7XG4gICAgICAgICAgICAkc3RhdGUucHJldlBhcmFtcyA9IG51bGw7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMubXlQeXJhbWlkcycpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1Bhc3N3b3JkUmVzZXRDdHJsJywgUGFzc3dvcmRSZXNldEN0cmwpO1xuXG4gIGZ1bmN0aW9uIFBhc3N3b3JkUmVzZXRDdHJsKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCB1c2VyU2VydmljZSwgbm90aWZ5U2VydmljZSwgYXV0aFNlcnZpY2UsIGlkZW50aXR5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0udXNlcm5hbWUgPSAnJztcbiAgICB2bS52ZXJpZmllZCA9IGZhbHNlO1xuICAgIHZtLnJlc2V0UGFzc3dvcmRGb3JtID0ge307XG4gICAgdm0uZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayA9IGdlbmVyYXRlUGFzc3dvcmRSZXNldExpbms7XG4gICAgdm0ucmVzZXRQYXNzd29yZCA9IHJlc2V0UGFzc3dvcmQ7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgfSBlbHNlIGlmICgkc3RhdGVQYXJhbXMudXNlcklkICYmICRzdGF0ZVBhcmFtcy52ZXJpZmljYXRpb25Ub2tlbikge1xuICAgICAgICB1c2VyU2VydmljZS52ZXJpZnlVc2VyKCRzdGF0ZVBhcmFtcy51c2VySWQsICRzdGF0ZVBhcmFtcy52ZXJpZmljYXRpb25Ub2tlbikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAgICAgdm0udmVyaWZpZWQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayh1c2VybmFtZSkge1xuICAgICAgdXNlclNlcnZpY2UuZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayh1c2VybmFtZSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignQ291bGQgbm90IGZpbmQgdGhhdCBlbWFpbCBhZGRyZXNzJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS5zdWNjZXNzKCdQbGVhc2UgY2hlY2sgeW91ciBlbWFpbCBmb3IgYSBwYXNzd29yZCByZXNldCBsaW5rJyk7XG4gICAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQocmVzZXRQYXNzd29yZEZvcm0pIHtcbiAgICAgIGlmIChyZXNldFBhc3N3b3JkRm9ybS5wYXNzd29yZCAhPT0gcmVzZXRQYXNzd29yZEZvcm0uY29uZmlybVBhc3N3b3JkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1Bhc3N3b3JkcyBkb25cXCd0IG1hdGNoIScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXNlclNlcnZpY2UucmVzZXRQYXNzd29yZCgkc3RhdGVQYXJhbXMudXNlcklkLCAkc3RhdGVQYXJhbXMudmVyaWZpY2F0aW9uVG9rZW4sIHJlc2V0UGFzc3dvcmRGb3JtLnBhc3N3b3JkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgICBhdXRoU2VydmljZS5hdXRoZW50aWNhdGVVc2VyKHJlc3BvbnNlLmRhdGEudXNlcm5hbWUsIHJlc2V0UGFzc3dvcmRGb3JtLnBhc3N3b3JkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIFJlZ2lzdGVyQ3RybCk7XG5cbiAgZnVuY3Rpb24gUmVnaXN0ZXJDdHJsKCRzdGF0ZSwgYXV0aFNlcnZpY2UsIG5vdGlmeVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnJlZ2lzdGVyID0gcmVnaXN0ZXI7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXIobmV3VXNlcikge1xuICAgICAgaWYgKG5ld1VzZXIucGFzc3dvcmQgIT09IG5ld1VzZXIuY29uZmlybVBhc3N3b3JkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1Bhc3N3b3JkcyBkb25cXCd0IG1hdGNoIScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXV0aFNlcnZpY2UuY3JlYXRlVXNlcihuZXdVc2VyKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkc3RhdGUuZ28oJ3ZlcmlmeScpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignVmVyaWZpY2F0aW9uQ3RybCcsIFZlcmlmaWNhdGlvbkN0cmwpO1xuXG4gIGZ1bmN0aW9uIFZlcmlmaWNhdGlvbkN0cmwoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIHVzZXJTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS52ZXJpZmllZCA9IHVuZGVmaW5lZDtcbiAgICB2bS52ZXJpZnlpbmcgPSBmYWxzZTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICgkc3RhdGVQYXJhbXMudXNlcklkICYmICRzdGF0ZVBhcmFtcy52ZXJpZmljYXRpb25Ub2tlbikge1xuICAgICAgICB2bS52ZXJpZnlpbmcgPSB0cnVlO1xuICAgICAgICB2bS52ZXJpZmllZCA9IG51bGw7XG4gICAgICAgIHVzZXJTZXJ2aWNlLnZlcmlmeVVzZXIoJHN0YXRlUGFyYW1zLnVzZXJJZCwgJHN0YXRlUGFyYW1zLnZlcmlmaWNhdGlvblRva2VuKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgICB2bS52ZXJpZmllZCA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZtLnZlcmlmaWVkID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twQWN0aXZlQ2hhbGxlbmVnZXMnLCBrcEFjdGl2ZUNoYWxsZW5lZ2VzKTtcblxuICBmdW5jdGlvbiBrcEFjdGl2ZUNoYWxsZW5lZ2VzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcHlyYW1pZDogJz0nXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY2hhbGxlbmdlcy9jb21wb25lbnRzL2FjdGl2ZS1jaGFsbGVuZ2VzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKCRzY29wZSwgY2hhbGxlbmdlc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNoYWxsZW5nZXMgPSBbXTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICRzY29wZS4kd2F0Y2goJ3ZtLnB5cmFtaWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh2bS5weXJhbWlkKSB7XG4gICAgICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlcygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRBY3RpdmVDaGFsbGVuZ2VzKCkge1xuICAgICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24odm0ucHlyYW1pZC5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZXMpIHtcbiAgICAgICAgaWYgKGNoYWxsZW5nZXMuZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdm0uY2hhbGxlbmdlcyA9IGNoYWxsZW5nZXMuZGF0YTtcbiAgICAgICAgICBfLmZvckVhY2godm0uY2hhbGxlbmdlcywgZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgaWYgKGNoYWxsZW5nZS50aW1lTGltaXQgIT09IDApIHtcbiAgICAgICAgICAgICAgY2hhbGxlbmdlLmV4cGlyZXMgPSAobW9tZW50KCkuZGlmZihtb21lbnQoY2hhbGxlbmdlLmNyZWF0ZWQpLmFkZChjaGFsbGVuZ2UudGltZUxpbWl0LCAnZCcpLCdzJykpICogLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BDb21wbGV0ZWRDaGFsbGVuZWdlcycsIGtwQ29tcGxldGVkQ2hhbGxlbmVnZXMpO1xuXG4gIGZ1bmN0aW9uIGtwQ29tcGxldGVkQ2hhbGxlbmVnZXMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCcsXG4gICAgICAgIGFsbG93RGVsZXRlOiAnPScsXG4gICAgICAgIGNoYWxsZW5nZXM6ICc9J1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NoYWxsZW5nZXMvY29tcG9uZW50cy9jb21wbGV0ZWQtY2hhbGxlbmdlcy5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUsICRzdGF0ZSwgY2hhbGxlbmdlc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNoYWxsZW5nZXMgPSBbXTtcbiAgICB2bS5kZWxldGVDaGFsbGVuZ2UgPSBkZWxldGVDaGFsbGVuZ2U7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAkc2NvcGUuJHdhdGNoKCd2bS5jaGFsbGVuZ2VzJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh2bS5jaGFsbGVuZ2VzICYmIHZtLmNoYWxsZW5nZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGRpc3BsYXlDb21wbGV0ZWRDaGFsbGVuZ2VzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc3BsYXlDb21wbGV0ZWRDaGFsbGVuZ2VzKCkge1xuICAgICAgXy5mb3JFYWNoKHZtLmNoYWxsZW5nZXMsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgY2hhbGxlbmdlLmxvc2VyID0gY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInID8gJ29wcG9uZW50JyA6ICdjaGFsbGVuZ2VyJztcbiAgICAgICAgY2hhbGxlbmdlLndoZW5Db21wbGV0ZWQgPSBtb21lbnQoY2hhbGxlbmdlLmNvbXBsZXRlZCkuY2FsZW5kYXIobnVsbCwge1xuICAgICAgICAgIHNhbWVEYXk6ICdbVG9kYXldJyxcbiAgICAgICAgICBuZXh0RGF5OiAnW1RvbW9ycm93XScsXG4gICAgICAgICAgbmV4dFdlZWs6ICdkZGRkJyxcbiAgICAgICAgICBsYXN0RGF5OiAnW1llc3RlcmRheV0nLFxuICAgICAgICAgIGxhc3RXZWVrOiAnW0xhc3RdIGRkZGQnLFxuICAgICAgICAgIHNhbWVFbHNlOiAnREQvTU0vWVlZWSdcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlSWQsICRpbmRleCkge1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZGVsZXRlQ2hhbGxlbmdlKHZtLmNvbXBldGl0aW9uSWQsIGNoYWxsZW5nZUlkKS50aGVuIChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZtLmNoYWxsZW5nZXMuc3BsaWNlKCRpbmRleCwgMSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twUGxheWVyT3ZlcmFsbFJlc3VsdHMnLCBrcFBsYXllck92ZXJhbGxSZXN1bHRzKTtcblxuICBmdW5jdGlvbiBrcFBsYXllck92ZXJhbGxSZXN1bHRzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcGxheWVyOiAnPSdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jaGFsbGVuZ2VzL2NvbXBvbmVudHMvcGxheWVyLW92ZXJhbGwtcmVzdWx0cy5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLm1heExldmVscyA9IDEwO1xuICAgIHZtLndpbnMgPSB7XG4gICAgICB0b3RhbDogMCxcbiAgICAgIGFzQ2hhbGxlbmdlcjogMCxcbiAgICAgIGFzT3Bwb25lbnQ6IDAsXG4gICAgICBieUZvcmZlaXQ6IDBcbiAgICB9O1xuICAgIHZtLmxvc2VzID0ge1xuICAgICAgdG90YWw6IDAsXG4gICAgICBhc0NoYWxsZW5nZXI6IDAsXG4gICAgICBhc09wcG9uZW50OiAwLFxuICAgICAgYnlGb3JmZWl0OiAwXG4gICAgfTtcbiAgICB2bS5zdHJlYWsgPSB7XG4gICAgICB0eXBlOiBudWxsLFxuICAgICAgdmFsdWU6IDBcbiAgICB9O1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgJHNjb3BlLiR3YXRjaCgndm0ucGxheWVyLnJlc3VsdHMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh2bS5wbGF5ZXIpIHtcbiAgICAgICAgICBhc3NpZ25wbGF5ZXJzVG9MZXZlbHModm0ucGxheWVyKTtcbiAgICAgICAgICBjYWxjdWxhdGVTdHJlYWsodm0ucGxheWVyKTtcbiAgICAgICAgICBjYWxjdWF0ZVdpbkFuZExvc2VzKHZtLnBsYXllcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFzc2lnbnBsYXllcnNUb0xldmVscyhwbGF5ZXIpIHtcbiAgICAgIC8vIERldGVybWluZSBhbGwgdGhlIGJyZWFrIHBvaW50cyB0byBmaWd1cmUgb3V0IGxldmVsc1xuICAgICAgdmFyIGJyZWFrUG9pbnRzID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLm1heExldmVsczsgaSsrKSB7XG4gICAgICAgIGJyZWFrUG9pbnRzLnB1c2goKCgoaSAqIChpICsgMSkpIC8gMikpICsgMSk7XG4gICAgICB9XG5cbiAgICAgIC8vIERlZmF1bHQgYWxsIHBsYXllcnMgdG8gdGhlIGxvd2VzdCBsZXZlbFxuICAgICAgcGxheWVyLmxldmVsID0gYnJlYWtQb2ludHMubGVuZ3RoO1xuICAgICAgLy8gTm93IGNoZWNrIHRvIHNlZSBpZiB0aGUgcGxheWVyIGlzIGF0IGEgaGlnaGVyIGxldmVsXG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGJyZWFrUG9pbnRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgIGlmIChwbGF5ZXIucG9zaXRpb24gPCBicmVha1BvaW50c1tqICsgMV0pIHtcbiAgICAgICAgICBwbGF5ZXIubGV2ZWwgPSBicmVha1BvaW50cy5pbmRleE9mKGJyZWFrUG9pbnRzW2pdKSArIDE7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYWxjdWxhdGVTdHJlYWsocGxheWVyKSB7XG4gICAgICAvLyBGaWd1cmUgb3V0IHRoZSBwbGF5ZXIncyBjdXJyZW50IHN0cmVha1xuICAgICAgdmFyIHN0cmVhayA9IDA7XG4gICAgICB2YXIgY29udGludWVTdHJlYWsgPSB0cnVlO1xuICAgICAgdmFyIHN0cmVha1R5cGU7XG4gICAgICBfLmZvckVhY2gocGxheWVyLnJlc3VsdHMsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgaWYgKGNvbnRpbnVlU3RyZWFrKSB7XG4gICAgICAgICAgLy8gV2lubmluZyBTdHJlYWtcbiAgICAgICAgICBpZiAoKGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJyAmJiBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllci5faWQpIHx8XG4gICAgICAgICAgICAoY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50JyAmJiBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkID09PSBwbGF5ZXIuX2lkKSkge1xuICAgICAgICAgICAgLy8gSWYgdGhleSBhcmUgbm90IGFscmVhZHkgb24gYSBsb3Npbmcgc3RyZWFrIGFuZCAxIHRvIHRoZWlyIHdpbm5pbmcgc3RyZWFrXG4gICAgICAgICAgICBpZiAoc3RyZWFrVHlwZSAhPT0gJ2xvc2luZycpIHtcbiAgICAgICAgICAgICAgc3RyZWFrICs9IDE7XG4gICAgICAgICAgICAgIHN0cmVha1R5cGUgPSAnd2lubmluZyc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb250aW51ZVN0cmVhayA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIC8vIExvc2luZyBTdHJlYWtcbiAgICAgICAgICB9IGVsc2UgaWYgKChjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnICYmIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVyLl9pZCkgfHxcbiAgICAgICAgICAgIChjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcicgJiYgY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVyLl9pZCkpIHtcbiAgICAgICAgICAgIC8vIElmIHRoZXkgYXJlIG5vdCBhbHJlYWR5IG9uIGEgd2lubmluZyBzdHJlYWsgYW5kIDEgdG8gdGhlaXIgbG9zaW5nIHN0cmVha1xuICAgICAgICAgICAgaWYgKHN0cmVha1R5cGUgIT09ICd3aW5uaW5nJykge1xuICAgICAgICAgICAgICBzdHJlYWsgKz0gMTtcbiAgICAgICAgICAgICAgc3RyZWFrVHlwZSA9ICdsb3NpbmcnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29udGludWVTdHJlYWsgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdm0uc3RyZWFrID0ge1xuICAgICAgICAgIHR5cGU6IHN0cmVha1R5cGUsXG4gICAgICAgICAgdmFsdWU6IHN0cmVha1xuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2FsY3VhdGVXaW5BbmRMb3NlcyhwbGF5ZXIpIHtcbiAgICAgIC8vIEZpZ3VyZSBvdXQgd2lucyBhbmQgbG9zZXNcbiAgICAgIHZtLndpbnMuYXNPcHBvbmVudCA9IF8uc2l6ZShfLmZpbHRlcihwbGF5ZXIucmVzdWx0cywgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllci5faWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50J1xuICAgICAgICApO1xuICAgICAgfSkpO1xuXG4gICAgICB2bS53aW5zLmFzQ2hhbGxlbmdlciA9IF8uc2l6ZShfLmZpbHRlcihwbGF5ZXIucmVzdWx0cywgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVyLl9pZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcidcbiAgICAgICAgKTtcbiAgICAgIH0pKTtcblxuICAgICAgdm0ud2lucy50b3RhbCA9IHZtLndpbnMuYXNDaGFsbGVuZ2VyICsgdm0ud2lucy5hc09wcG9uZW50O1xuXG4gICAgICB2bS53aW5zLmJ5Rm9yZmVpdCA9IF8uc2l6ZShfLmZpbHRlcihwbGF5ZXIucmVzdWx0cywgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIGNoYWxsZW5nZS5mb3JmZWl0ICYmICgoY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkID09PSBwbGF5ZXIuX2lkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJykgfHxcbiAgICAgICAgICAoY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVyLl9pZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnKSlcbiAgICAgICAgKTtcbiAgICAgIH0pKTtcblxuICAgICAgdm0ubG9zZXMuYXNPcHBvbmVudCA9IF8uc2l6ZShfLmZpbHRlcihwbGF5ZXIucmVzdWx0cywgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllci5faWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInXG4gICAgICAgICk7XG4gICAgICB9KSk7XG5cbiAgICAgIHZtLmxvc2VzLmFzQ2hhbGxlbmdlciA9IF8uc2l6ZShfLmZpbHRlcihwbGF5ZXIucmVzdWx0cywgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVyLl9pZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnXG4gICAgICAgICk7XG4gICAgICB9KSk7XG5cbiAgICAgIHZtLmxvc2VzLnRvdGFsID0gdm0ubG9zZXMuYXNDaGFsbGVuZ2VyICsgdm0ubG9zZXMuYXNPcHBvbmVudDtcblxuICAgICAgdm0ubG9zZXMuYnlGb3JmZWl0ID0gXy5zaXplKF8uZmlsdGVyKHBsYXllci5yZXN1bHRzLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgY2hhbGxlbmdlLmZvcmZlaXQgJiYgKChjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllci5faWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50JykgfHxcbiAgICAgICAgICAoY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVyLl9pZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcicpKVxuICAgICAgICApO1xuICAgICAgfSkpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdjaGFsbGVuZ2VzU2VydmljZScsIGNoYWxsZW5nZXNTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBjaGFsbGVuZ2VzU2VydmljZSgkaHR0cCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgY3JlYXRlQ2hhbGxlbmdlOiBjcmVhdGVDaGFsbGVuZ2UsXG4gICAgICBjb21wbGV0ZUNoYWxsZW5nZTogY29tcGxldGVDaGFsbGVuZ2UsXG4gICAgICBnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbjogZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb24sXG4gICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbjogZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24sXG4gICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXI6IGdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcixcbiAgICAgIGdldENvbXBsZXRlZENoYWxsZW5nZXNCeUNvbXBldGl0aW9uOiBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbixcbiAgICAgIGRlbGV0ZUFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcjogZGVsZXRlQWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyLFxuICAgICAgZGVsZXRlQ2hhbGxlbmdlOiBkZWxldGVDaGFsbGVuZ2UsXG4gICAgICBnZXRQbGF5ZXJSZXN1bHRzQnlDb21wZXRpdGlvbjogZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb25cbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jaGFsbGVuZ2VzL2NyZWF0ZScsIHtcbiAgICAgICAgY2hhbGxlbmdlOiBjaGFsbGVuZ2VcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvbXBsZXRlQ2hhbGxlbmdlKGNoYWxsZW5nZSkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvY2hhbGxlbmdlcy9jb21wbGV0ZScsICB7XG4gICAgICAgIGNoYWxsZW5nZTogY2hhbGxlbmdlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvY29tcGV0aXRpb24nLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9hY3RpdmUvY29tcGV0aXRpb24nLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcihjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2FjdGl2ZS9jb21wZXRpdGlvbi9wbGF5ZXInLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICAgIHBsYXllcklkOiBwbGF5ZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkLCBsaW1pdCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2NvbXBsZXRlZC9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgbGltaXQ6IGxpbWl0XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbGV0ZUFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcihjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS9jaGFsbGVuZ2VzL2FjdGl2ZS9jb21wZXRpdGlvbi9wbGF5ZXIvZGVsZXRlJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBwbGF5ZXJJZDogcGxheWVySWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsZXRlQ2hhbGxlbmdlKGNvbXBldGl0aW9uSWQsIGNoYWxsZW5nZUlkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZGVsZXRlKCcvYXBpL2NoYWxsZW5nZXMvZGVsZXRlJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBjaGFsbGVuZ2VJZDogY2hhbGxlbmdlSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCwgcGxheWVySWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9yZXN1bHRzL2NvbXBldGl0aW9uL3BsYXllcicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgcGxheWVySWQ6IHBsYXllcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BGb290ZXInLCBrcEZvb3Rlcik7XG5cbiAgZnVuY3Rpb24ga3BGb290ZXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9mb290ZXIuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoaWRlbnRpdHlTZXJ2aWNlLCBhdXRoU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgIHZtLmxvZ291dCA9IGxvZ291dDtcblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BIZWFkZXInLCBrcEhlYWRlcik7XG5cbiAgZnVuY3Rpb24ga3BIZWFkZXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ2hlYWRlckN0cmwnLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbW1vbi9jb21wb25lbnRzL2hlYWRlci5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUsIHNpZGViYXJTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UsIGF1dGhTZXJ2aWNlLCBhbGVydHNTZXJ2aWNlKSB7XG4gICAgdmFyIGhlYWRlckN0cmwgPSB0aGlzO1xuICAgIGhlYWRlckN0cmwuaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgIGhlYWRlckN0cmwubG9nb3V0ID0gbG9nb3V0O1xuICAgIGhlYWRlckN0cmwuc2lkZWJhclN0YXR1cyA9IHNpZGViYXJTZXJ2aWNlLmdldFNpZGViYXJTdGF0dXMoKTtcbiAgICBoZWFkZXJDdHJsLnRvZ2dsZVNpZGViYXIgPSB0b2dnbGVTaWRlYmFyO1xuICAgIGhlYWRlckN0cmwuY2xlYXJBbGVydCA9IGNsZWFyQWxlcnQ7XG4gICAgaGVhZGVyQ3RybC5jbGVhckFsbEFsZXJ0cyA9IGNsZWFyQWxsQWxlcnRzO1xuICAgIGhlYWRlckN0cmwuYWxlcnRzID0gW107XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBnZXRBY3RpdmVBbGVydHMoKTtcbiAgICAgICRzY29wZS4kd2F0Y2goJ2hlYWRlckN0cmwuaW5kZW50aXR5LmN1cnJlbnRVc2VyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgICAgZ2V0QWN0aXZlQWxlcnRzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUFsZXJ0cygpIHtcbiAgICAgIGhlYWRlckN0cmwuYWxlcnRzID0gW107XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgIGFsZXJ0c1NlcnZpY2UuZ2V0QWN0aXZlQWxlcnRzQnlQbGF5ZXIoaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCkudGhlbihmdW5jdGlvbiAoYWxlcnRzKSB7XG4gICAgICAgICAgaGVhZGVyQ3RybC5hbGVydHMgPSBhbGVydHMuZGF0YTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xlYXJBbGVydChjbGVhckFsZXJ0LCBpbmRleCkge1xuICAgICAgYWxlcnRzU2VydmljZS5jbGVhckFsZXJ0KGNsZWFyQWxlcnQpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBoZWFkZXJDdHJsLmFsZXJ0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xlYXJBbGxBbGVydHMoKSB7XG4gICAgICBhbGVydHNTZXJ2aWNlLmNsZWFyQWxsQWxlcnRzQnlQbGF5ZXIoaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGhlYWRlckN0cmwuYWxlcnRzID0gW107XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0b2dnbGVTaWRlYmFyKCkge1xuICAgICAgc2lkZWJhclNlcnZpY2Uuc2V0U2lkZWJhclN0YXR1cyghaGVhZGVyQ3RybC5zaWRlYmFyU3RhdHVzLmxlZnQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czp1cGRhdGVfYWxlcnRzJywgZnVuY3Rpb24gKGUsIGFsZXJ0cykge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSAmJiBfLnNvbWUoYWxlcnRzLCBbJ3VzZXJJZCcsIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWRdKSkge1xuICAgICAgICBnZXRBY3RpdmVBbGVydHMoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BTaWRlYmFyJywga3BTaWRlYmFyKTtcblxuICBmdW5jdGlvbiBrcFNpZGViYXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3NpZGViYXJDdHJsJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9zaWRlYmFyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UsIHNpZGViYXJTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pbmRlbnRpdHkgPSBpZGVudGl0eVNlcnZpY2U7XG4gICAgdm0ubG9nb3V0ID0gbG9nb3V0O1xuICAgIHZtLnNpZGViYXJTdGF0dXMgPSBzaWRlYmFyU2VydmljZS5nZXRTaWRlYmFyU3RhdHVzKCk7XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmlsdGVyKCdvcmRlck9iamVjdEJ5Jywgb3JkZXJPYmplY3RCeSk7XG5cbiAgZnVuY3Rpb24gb3JkZXJPYmplY3RCeSgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGlucHV0LCBhdHRyaWJ1dGUpIHtcbiAgICAgIGlmICghYW5ndWxhci5pc09iamVjdChpbnB1dCkpIHJldHVybiBpbnB1dDtcblxuICAgICAgdmFyIGFycmF5ID0gW107XG4gICAgICBmb3IgKHZhciBvYmplY3RLZXkgaW4gaW5wdXQpIHtcbiAgICAgICAgYXJyYXkucHVzaChpbnB1dFtvYmplY3RLZXldKTtcbiAgICAgIH1cblxuICAgICAgYXJyYXkuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICBhID0gcGFyc2VJbnQoYVthdHRyaWJ1dGVdKTtcbiAgICAgICAgYiA9IHBhcnNlSW50KGJbYXR0cmlidXRlXSk7XG4gICAgICAgIHJldHVybiBhIC0gYjtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH07XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnYWxlcnRzU2VydmljZScsIGFsZXJ0c1NlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIGFsZXJ0c1NlcnZpY2UoJGh0dHApIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGdldEFjdGl2ZUFsZXJ0c0J5UGxheWVyOiBnZXRBY3RpdmVBbGVydHNCeVBsYXllcixcbiAgICAgIGNsZWFyQWxlcnQ6IGNsZWFyQWxlcnQsXG4gICAgICBjbGVhckFsbEFsZXJ0c0J5UGxheWVyOiBjbGVhckFsbEFsZXJ0c0J5UGxheWVyXG4gICAgfTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgLyoqXG4gICAgICogR2V0cyB1bmNsZWFyZWQgYWxlcnRzIGZvciBhIHVzZXIgZnJvbSB0aGUgZGF0YWJhc2VcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB1c2VySWQgaWQgZm9yIHRoZSB1c2VyXG4gICAgICogQHJldHVybiB7QXJyYXl9IGFsZXJ0c1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUFsZXJ0c0J5UGxheWVyKHVzZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9hbGVydHMvJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICB1c2VySWQ6IHVzZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNYXJrcyBhIGFsZXJ0cyBhcyBjbGVhcmVkXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gYWxlcnRJZCBpZCBmb3IgdGhlIGFsZXJ0XG4gICAgICogQHJldHVybiB7U3RyaW5nfSBTdGF0dXNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbGVhckFsZXJ0KGFsZXJ0SWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wdXQoJy9hcGkvYWxlcnQvY2xlYXInLCB7XG4gICAgICAgIGFsZXJ0SWQ6IGFsZXJ0SWRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1hcmtzIGFsbCB1bnZpZXdlZCBhbGVydHMgYXMgdmlld2VkIGZvciBhIHVzZXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB1c2VySWQgaWQgZm9yIHRoZSB1c2VyXG4gICAgICogQHJldHVybiB7U3RyaW5nfSBTdGF0dXNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbGVhckFsbEFsZXJ0c0J5UGxheWVyKHVzZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS9hbGVydHMvY2xlYXInLCB7XG4gICAgICAgIHVzZXJJZDogdXNlcklkXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnaWRlbnRpdHlTZXJ2aWNlJywgaWRlbnRpdHlTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBpZGVudGl0eVNlcnZpY2UoJHdpbmRvdykge1xuICAgIHZhciBjdXJyZW50VXNlcjtcbiAgICBpZiAoJHdpbmRvdy5ib290c3RyYXBwZWRVc2VyT2JqZWN0ICE9PSBudWxsKSB7XG4gICAgICBjdXJyZW50VXNlciA9ICR3aW5kb3cuYm9vdHN0cmFwcGVkVXNlck9iamVjdDtcbiAgICB9XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBjdXJyZW50VXNlcjogY3VycmVudFVzZXIsXG4gICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGlzQXV0aGVudGljYXRlZCxcbiAgICAgIGlzQXV0aG9yaXplZDogaXNBdXRob3JpemVkXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZCgpIHtcbiAgICAgIHJldHVybiAhIXRoaXMuY3VycmVudFVzZXI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNBdXRob3JpemVkKHJvbGUpIHtcbiAgICAgIHJldHVybiAhIXRoaXMuY3VycmVudFVzZXIgJiYgdGhpcy5jdXJyZW50VXNlci5yb2xlcy5pbmRleE9mKHJvbGUpID4gLTE7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmZhY3RvcnkoJ25vdGlmeVNlcnZpY2UnLCBub3RpZnlTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBub3RpZnlTZXJ2aWNlKCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgaW5mbzogaW5mbyxcbiAgICAgIHN1Y2Nlc3M6IHN1Y2Nlc3MsXG4gICAgICB3YXJuaW5nOiB3YXJuaW5nLFxuICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgaW52ZXJzZTogaW52ZXJzZVxuICAgIH07XG5cbiAgICAkLm5vdGlmeURlZmF1bHRzKHtcbiAgICAgIG5ld2VzdF9vbl90b3A6IHRydWUsXG4gICAgICBvZmZzZXQ6IHtcbiAgICAgICAgeDogMjAsXG4gICAgICAgIHk6IDg1XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGluZm8obWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ2luZm8nXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdzdWNjZXNzJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd2FybmluZyhtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnd2FybmluZydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdkYW5nZXInXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnZlcnNlKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdpbnZlcnNlJ1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmZhY3RvcnkoJ3Njcm9sbGJhclNlcnZpY2UnLCBzY3JvbGxiYXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBzY3JvbGxiYXJTZXJ2aWNlKCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgbWFsaWh1U2Nyb2xsOiBtYWxpaHVTY3JvbGxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBtYWxpaHVTY3JvbGwoc2VsZWN0b3IsIHRoZW1lLCBzY3JvbGxheGlzLCBtb3VzZXdoZWVsYXhpcykge1xuICAgICAgJChzZWxlY3RvcikubUN1c3RvbVNjcm9sbGJhcih7XG4gICAgICAgIHRoZW1lOiB0aGVtZSxcbiAgICAgICAgc2Nyb2xsSW5lcnRpYTogMTAwLFxuICAgICAgICBheGlzOiBzY3JvbGxheGlzLFxuICAgICAgICBtb3VzZVdoZWVsOiB7XG4gICAgICAgICAgZW5hYmxlOiB0cnVlLFxuICAgICAgICAgIGF4aXM6IG1vdXNld2hlZWxheGlzLFxuICAgICAgICAgIHByZXZlbnREZWZhdWx0OiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdzaWRlYmFyU2VydmljZScsIHNpZGViYXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBzaWRlYmFyU2VydmljZSgpIHtcbiAgICB2YXIgc2lkZWJhclN0YXR1cyA9IHtcbiAgICAgIGxlZnQ6IGZhbHNlLFxuICAgICAgcmlnaHQ6IGZhbHNlXG4gICAgfTtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGdldFNpZGViYXJTdGF0dXM6IGdldFNpZGViYXJTdGF0dXMsXG4gICAgICBzZXRTaWRlYmFyU3RhdHVzOiBzZXRTaWRlYmFyU3RhdHVzXG4gICAgfTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gZ2V0U2lkZWJhclN0YXR1cygpIHtcbiAgICAgIHJldHVybiBzaWRlYmFyU3RhdHVzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFNpZGViYXJTdGF0dXMoc3RhdHVzKSB7XG4gICAgICBzaWRlYmFyU3RhdHVzLmxlZnQgPSBzdGF0dXM7XG4gICAgfVxuICB9XG59KSgpOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAuc2VydmljZSgnd2Vic29ja2V0U2VydmljZScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkd2luZG93KSB7XG4gICAgZnVuY3Rpb24gd2Vic29ja2V0SG9zdCgpIHtcbiAgICAgIGlmICgkd2luZG93LmxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cHM6Jykge1xuICAgICAgICByZXR1cm4gJ3dzczovLycgKyAkd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJ3dzOi8vJyArICR3aW5kb3cubG9jYXRpb24uaG9zdDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgY29ubmVjdGlvbjtcbiAgICB0aGlzLmNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh3ZWJzb2NrZXRIb3N0KCkpO1xuXG4gICAgICBjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpO1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3dzOicgKyBwYXlsb2FkLnRvcGljLCBwYXlsb2FkLmRhdGEpO1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgdGhpcy5zZW5kID0gZnVuY3Rpb24gKHRvcGljLCBkYXRhKSB7XG4gICAgICB2YXIganNvbiA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgdG9waWM6IHRvcGljLFxuICAgICAgICBkYXRhOiBkYXRhXG4gICAgICB9KTtcbiAgICAgIGNvbm5lY3Rpb24uc2VuZChqc29uKTtcbiAgICB9O1xuICB9KS5ydW4oZnVuY3Rpb24gKHdlYnNvY2tldFNlcnZpY2UpIHtcbiAgICB3ZWJzb2NrZXRTZXJ2aWNlLmNvbm5lY3QoKTtcbiAgfSk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignSG9tZUN0cmwnLCBIb21lQ3RybCk7XG5cbiAgZnVuY3Rpb24gSG9tZUN0cmwocHlyYW1pZHNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5weXJhbWlkcyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWRzKCkudGhlbihmdW5jdGlvbiAocHlyYW1pZHMpIHtcbiAgICAgICAgdm0ucHlyYW1pZHMgPSBweXJhbWlkcy5kYXRhO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFBlbmRpbmdQbGF5ZXJzJywga3BQZW5kaW5nUGxheWVycyk7XG5cbiAgZnVuY3Rpb24ga3BQZW5kaW5nUGxheWVycygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHB5cmFtaWQ6ICc9J1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3B5cmFtaWRzL2NvbXBvbmVudHMvcGVuZGluZy1wbGF5ZXJzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKHB5cmFtaWRzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucGVuZGluZ1BsYXllcnMgPSBbXTtcbiAgICB2bS5hcHByb3ZlUGVuZGluZ1BsYXllciA9IGFwcHJvdmVQZW5kaW5nUGxheWVyO1xuICAgIHZtLmRlbnlQZW5kaW5nUGxheWVyID0gZGVueVBlbmRpbmdQbGF5ZXI7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuXG4gICAgZnVuY3Rpb24gYXBwcm92ZVBlbmRpbmdQbGF5ZXIocGxheWVyKSB7XG4gICAgICBwbGF5ZXIucG9zaXRpb24gPSB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoICsgMTtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5hcHByb3ZlUGVuZGluZ1BsYXllcih2bS5weXJhbWlkLl9pZCwgcGxheWVyKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZW55UGVuZGluZ1BsYXllcihwbGF5ZXIpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5kZW55UGVuZGluZ1BsYXllcih2bS5weXJhbWlkLl9pZCwgcGxheWVyKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twUHlyYW1pZENvbXBhY3QnLCBrcFB5cmFtaWRDb21wYWN0KTtcblxuICBmdW5jdGlvbiBrcFB5cmFtaWRDb21wYWN0KCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcHlyYW1pZDogJz0nLFxuXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvcHlyYW1pZHMvY29tcG9uZW50cy9weXJhbWlkLWNvbXBhY3QuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoKSB7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BQeXJhbWlkJywga3BQeXJhbWlkKTtcblxuICBmdW5jdGlvbiBrcFB5cmFtaWQoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9weXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQuaHRtbCcsXG4gICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcHlyYW1pZDogJz0nXG4gICAgICB9LFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCAkc3RhdGUsIHB5cmFtaWRzU2VydmljZSwgJGZpbHRlciwgbm90aWZ5U2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciBtYXhMZXZlbHMgPSAxMDtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNvbXBldGl0aW9uSWQgPSBudWxsO1xuICAgIHZtLmJyZWFrUG9pbnRzID0gW107XG4gICAgdm0ubGV2ZWxzID0gW107XG4gICAgdm0ubnVtYmVyT2ZCbG9ja3MgPSAwO1xuICAgIHZtLmN1cnJlbnRVc2VySXNPblB5cmFtaWQgPSBmYWxzZTtcbiAgICB2bS5jdXJyZW50VXNlcklzUGVuZGluZyA9IGZhbHNlO1xuICAgIHZtLmN1cnJlbnRVc2VySXNPd25lciA9IGZhbHNlO1xuICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IGZhbHNlO1xuICAgIHZtLmFjdGl2ZUNoYWxsZW5nZU9wcG9uZW50ID0gbnVsbDtcbiAgICB2bS5hdmFpbGFibGVDaGFsbGVuZ2VzID0gZmFsc2U7XG4gICAgdm0uY3JlYXRlQ2hhbGxlbmdlID0gY3JlYXRlQ2hhbGxlbmdlO1xuICAgIHZtLmNvbXBsZXRlQ2hhbGxlbmdlID0gY29tcGxldGVDaGFsbGVuZ2U7XG4gICAgdm0uY2hhbGxlbmdlRXhwaXJlZCA9IGNoYWxsZW5nZUV4cGlyZWQ7XG4gICAgdm0uY3VycmVudFVzZXJQbGF5ZXIgPSB7fTtcbiAgICB2bS5weXJhbWlkTWVudVRvZ2dsZSA9IGZhbHNlO1xuICAgIHZtLmFkZEN1cnJlbnRVc2VyVG9QeXJhbWlkID0gYWRkQ3VycmVudFVzZXJUb1B5cmFtaWQ7XG4gICAgdm0uY29uZmlybVJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQgPSBjb25maXJtUmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZDtcbiAgICB2bS5wbGF5ZXJDbGljayA9IHBsYXllckNsaWNrO1xuICAgIHZtLm51bWJlck9mUmVhbFBsYXllcnMgPSAwO1xuICAgIHZtLm1heFBsYXllcnMgPSAwO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBtYXhpbXVtIG51bWJlciBvZiBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBtYXhpbXVtIG51bWJlciBvZiBsZXZlbHNcbiAgICAgIGZvciAodmFyIGkgPSBtYXhMZXZlbHM7IGkgPiAwOyAtLWkpIHtcbiAgICAgICAgdm0ubWF4UGxheWVycyArPSBpO1xuICAgICAgfVxuXG4gICAgICAkc2NvcGUuJHdhdGNoKCd2bS5weXJhbWlkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodm0ucHlyYW1pZCkge1xuICAgICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSB2bS5weXJhbWlkLl9pZDtcbiAgICAgICAgICBvcmRlclBsYXllcnMoKTtcbiAgICAgICAgICBnZXRQbGF5ZXJzU3RhdHVzKCk7XG4gICAgICAgICAgYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCk7XG4gICAgICAgICAgY2FsY3VsYXRlUHlyYW1pZEJsb2NrcygpO1xuICAgICAgICAgIGZpbGxJbkVtcHR5QmxvY2tzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE9yZGVyIHRoZSBwbGF5ZXJzIGJ5IHRoZSBwb3NpdGlvbiBwcm9wZXJ0eSBvZiB0aGUgcGxheWVycyBhcnJheSBpbiB0aGUgcHlyYW1pZCBvYmplY3RcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBvcmRlclBsYXllcnMoKSB7XG4gICAgICB2bS5weXJhbWlkLnBsYXllcnMgPSAkZmlsdGVyKCdvcmRlckJ5Jykodm0ucHlyYW1pZC5wbGF5ZXJzLCAncG9zaXRpb24nKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaWd1cmUgb3V0IGlmIGVhY2ggcGxheWVyIGlzIGFscmVhZHkgY2hhbGxlbmdlZCBhbmQgc2V0IHNvbWUgc3R1ZmZcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJzU3RhdHVzKCkge1xuICAgICAgXG4gICAgICB2bS5jdXJyZW50VXNlcklzT3duZXIgPSBmYWxzZTtcbiAgICAgIHZtLmN1cnJlbnRVc2VySXNQZW5kaW5nID0gZmFsc2U7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGUgY3VycmVudCB1c2VyIGlzIGFuIG93bmVyIG9mIHRoaXMgcHlyYW1pZFxuICAgICAgICB2bS5jdXJyZW50VXNlcklzT3duZXIgPSBfLnNvbWUodm0ucHlyYW1pZC5vd25lcnMsIFsnX2lkJywgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZF0pO1xuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIGN1cnJlbnQgdXNlciBoYXMgYSBwZW5kaW5nIHJlcXVlc3QgdG8gam9pblxuICAgICAgICB2bS5jdXJyZW50VXNlcklzUGVuZGluZyA9IF8uc29tZSh2bS5weXJhbWlkLnBlbmRpbmdQbGF5ZXJzLCBbJ19pZCcsIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWRdKTtcbiAgICAgIH1cblxuICAgICAgdm0uY3VycmVudFVzZXJJc09uUHlyYW1pZCA9IGZhbHNlO1xuICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gZmFsc2U7XG4gICAgICBfLmZvckVhY2godm0ucHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIC8vIEZpbmQgdGhlIGN1cnJlbnQgdXNlciBpZiB0aGV5IGFyZSBvbiB0aGlzIHB5cmFtaWQgYW5kIHNldCBzb21lIHByb3BlcnRpZXNcbiAgICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSAmJiBwbGF5ZXIuX2lkID09PSBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkKSB7XG4gICAgICAgICAgdm0uY3VycmVudFVzZXJJc09uUHlyYW1pZCA9IHRydWU7XG4gICAgICAgICAgcGxheWVyLmNsYXNzID0gJ2N1cnJlbnQtdXNlcic7XG4gICAgICAgICAgdm0uY3VycmVudFVzZXJQbGF5ZXIgPSBwbGF5ZXI7XG5cbiAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBhbiBhY3RpdmUgY2hhbGxlbmdlXG4gICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllci5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgaWYgKGNoYWxsZW5nZS5kYXRhKSB7XG4gICAgICAgICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IHRydWU7XG4gICAgICAgICAgICAgIHZtLmFjdGl2ZUNoYWxsZW5nZU9wcG9uZW50ID0gY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci5faWQgPT09IHBsYXllci5faWQgPyBjaGFsbGVuZ2UuZGF0YS5vcHBvbmVudCA6IGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIF8uZm9yRWFjaChjaGFsbGVuZ2VzLmRhdGEsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcblxuICAgICAgICAgIHZhciBjaGFsbGVuZ2VyID0gXy5maW5kKHZtLnB5cmFtaWQucGxheWVycywgeyAnX2lkJzogY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkIH0pO1xuICAgICAgICAgIGNoYWxsZW5nZXIuY2xhc3MgPSAndW5hdmFpbGFibGUnO1xuICAgICAgICAgIGNoYWxsZW5nZXIuY2hhbGxlbmdlID0ge1xuICAgICAgICAgICAgcG9zaXRpb246ICdjaGFsbGVuZ2VyJ1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICB2YXIgb3Bwb25lbnQgPSBfLmZpbmQodm0ucHlyYW1pZC5wbGF5ZXJzLCB7ICdfaWQnOiBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkIH0pO1xuICAgICAgICAgIG9wcG9uZW50LmNsYXNzID0gJ3VuYXZhaWxhYmxlJztcbiAgICAgICAgICBvcHBvbmVudC5jaGFsbGVuZ2UgPSB7XG4gICAgICAgICAgICBwb3NpdGlvbjogJ29wcG9uZW50J1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICAvLyBUcmFjayB3aGVuIHRoZSBjaGFsbGVuZ2Ugd2lsbCBleHBpcmVcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLnRpbWVMaW1pdCAhPT0gMCkge1xuICAgICAgICAgICAgdmFyIHRpbWVUb0V4cGlyZSA9IG1vbWVudCgpLmRpZmYobW9tZW50KGNoYWxsZW5nZS5jcmVhdGVkKS5hZGQoY2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2QnKSwgJ3MnKSAqIC0xO1xuICAgICAgICAgICAgLy8gSWYgdGhlIGNoYWxsZW5nZSBoYXMgbm90IHlldCBleHBpcmVkIGRpc3BsYXkgYSBjb3VudGRvd24gb24gdGhlIG9wcG9uZW50XG4gICAgICAgICAgICBpZiAodGltZVRvRXhwaXJlID4gMCkge1xuICAgICAgICAgICAgICBvcHBvbmVudC5jaGFsbGVuZ2UuZXhwaXJlcyA9IHRpbWVUb0V4cGlyZTtcbiAgICAgICAgICAgICAgLy8gSWYgdGhlIGNoYWxsZW5nZSBleHBpcmVkIHdoaWxlIG5vIG9uZSB3YXMgdmlld2luZyB0aGlzIHB5cmFtaWQgY29tcGxldGUgdGhlIGNoYWxsZW5nZSBieSBmb3JmZWl0XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRpbWVUb0V4cGlyZSA8PSAwKSB7XG4gICAgICAgICAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlKG51bGwsIHRydWUsIG9wcG9uZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBOb3cgdGhhdCB3ZSBrbm93IHdoaWNoIHBsYXllcnMgYXJlIGluIGNoYWxsZW5nZXMgYW5kIHdoaWNoIGFyZW4ndFxuICAgICAgICAvLyBmaW5kIHRoZSBhdmFpbGFibGUgY2hhbGxlbmdlcyBmb3IgdGhpcyB1c2VyXG4gICAgICAgIGZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaWd1cmUgb3V0IHdoZXJlIHRvIHN0YXJ0IGVhY2ggbmV3IHJvdyBvbiB0aGUgcHlyYW1pZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZUJyZWFrUG9pbnRzKCkge1xuICAgICAgdm0uYnJlYWtQb2ludHMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4TGV2ZWxzOyBpKyspIHtcbiAgICAgICAgdm0uYnJlYWtQb2ludHMucHVzaCgoKChpICogKGkgKyAxKSkgLyAyKSkgKyAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHaXZlIGVhY2ggcGxheWVyIGEgbGV2ZWwgcHJvcGVydHkgYmFzZWQgb24gdGhlIGJyZWFrIHBvaW50c1xuICAgIC8vIFRoaXMgd2lsbCBiZSB1c2VkIHRvIGRldGVybWluZSB3aG8gb3RoZXIgcGxheWVycyBjYW4gY2hhbGxlbmdlXG4gICAgZnVuY3Rpb24gYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCkge1xuICAgICAgdmFyIGxldmVsID0gMDtcbiAgICAgIHZtLmxldmVscyA9IFtdO1xuICAgICAgY3JlYXRlQnJlYWtQb2ludHMoKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh2bS5icmVha1BvaW50cy5pbmRleE9mKGkgKyAxKSA+IC0xKSB7XG4gICAgICAgICAgbGV2ZWwgKz0gMTtcbiAgICAgICAgICAvLyBTZXQgdGhlIG51bWJlciBvZiB0b3RhbCBsZXZlbHNcbiAgICAgICAgICB2bS5sZXZlbHMucHVzaChsZXZlbCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gR2l2ZSBlYWNoIHBsYXllciBhIGxldmVsXG4gICAgICAgIHZtLnB5cmFtaWQucGxheWVyc1tpXS5sZXZlbCA9IGxldmVsO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhvdyBtYW55IHRvdGFsIGJsb2NrcyBpbiB0aGlzIHB5cmFtaWRcbiAgICBmdW5jdGlvbiBjYWxjdWxhdGVQeXJhbWlkQmxvY2tzKCkge1xuICAgICAgdm0ubnVtYmVyT2ZCbG9ja3MgPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IF8ubGFzdCh2bS5sZXZlbHMpOyBpID4gMDsgaS0tKSB7XG4gICAgICAgIHZtLm51bWJlck9mQmxvY2tzICs9IGk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmlsbCBvdXQgdGhlIHJlbWFpbmluZyBibG9ja3Mgb2YgdGhlIHB5cmFtaWQgd2l0aCBlbXB0eSBibG9ja3NcbiAgICBmdW5jdGlvbiBmaWxsSW5FbXB0eUJsb2NrcygpIHtcbiAgICAgIHZtLm51bWJlck9mUmVhbFBsYXllcnMgPSB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoO1xuICAgICAgZm9yICh2YXIgaSA9IHZtLnB5cmFtaWQucGxheWVycy5sZW5ndGg7IGkgPCB2bS5udW1iZXJPZkJsb2NrczsgaSsrKSB7XG4gICAgICAgIHZtLnB5cmFtaWQucGxheWVycy5wdXNoKHtcbiAgICAgICAgICBmaXJzdE5hbWU6ICdFbXB0eScsXG4gICAgICAgICAgbGFzdE5hbWU6ICdTcG90JyxcbiAgICAgICAgICBwb3NpdGlvbjogOTksXG4gICAgICAgICAgY2xhc3M6ICdlbXB0eSdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICAvLyBXZSBoYXZlIHRvIGdpdmUgbGV2ZWxzIHRvIHRoZSBuZXcgZW1wdHkgc3BvdHNcbiAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgIH1cblxuICAgIC8vIEZpbmQgYWxsIHRoZSBwbGF5ZXJzIHRoYXQgYXJlIGF2YWlsYWJsZSB0byBiZSBjaGFsbGVuZ2VkIGJ5IHRoaXMgdXNlclxuICAgIGZ1bmN0aW9uIGZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzKCkge1xuICAgICAgaWYgKHZtLmN1cnJlbnRVc2VySXNPblB5cmFtaWQgJiYgIXZtLmhhc0FjdGl2ZUNoYWxsZW5nZSkge1xuICAgICAgICB2YXIgbGV2ZWxBYm92ZSA9IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxldmVsID4gMSA/IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxldmVsIC0gMSA6IG51bGw7XG4gICAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgICBpZiAocGxheWVyLmxldmVsID09PSBsZXZlbEFib3ZlICYmIHBsYXllci5wb3NpdGlvbiAhPT0gOTkgJiYgcGxheWVyLmNsYXNzICE9PSAndW5hdmFpbGFibGUnKSB7XG4gICAgICAgICAgICB2bS5hdmFpbGFibGVDaGFsbGVuZ2VzID0gdHJ1ZTtcbiAgICAgICAgICAgIHBsYXllci5hdmFpbGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgcGxheWVyLmNsYXNzID0gJ2F2YWlsYWJsZSc7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFsbGVuZ2UocGxheWVyKSB7XG4gICAgICBpZiAoIXBsYXllci5hdmFpbGFibGUpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignU29ycnksIHRoYXQgaXMgbm90IGEgdmFsaWQgY2hhbGxlbmdlLicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gdHJ1ZTtcbiAgICAgICAgdmFyIGNoYWxsZW5nZSA9IHtcbiAgICAgICAgICBjb21wZXRpdGlvbk5hbWU6IHZtLnB5cmFtaWQubmFtZSxcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiB2bS5jb21wZXRpdGlvbklkLFxuICAgICAgICAgIGNvbXBsZXRlOiBmYWxzZSxcbiAgICAgICAgICBmb3JmZWl0OiBmYWxzZSxcbiAgICAgICAgICB0aW1lTGltaXQ6IHZtLnB5cmFtaWQuZm9yZmVpdERheXMsXG4gICAgICAgICAgY2hhbGxlbmdlcjoge1xuICAgICAgICAgICAgX2lkOiB2bS5jdXJyZW50VXNlclBsYXllci5faWQsXG4gICAgICAgICAgICBlbWFpbDogdm0uY3VycmVudFVzZXJQbGF5ZXIuZW1haWwsXG4gICAgICAgICAgICBmaXJzdE5hbWU6IHZtLmN1cnJlbnRVc2VyUGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiB2bS5jdXJyZW50VXNlclBsYXllci5sYXN0TmFtZSxcbiAgICAgICAgICAgIHBvc2l0aW9uOiB2bS5jdXJyZW50VXNlclBsYXllci5wb3NpdGlvblxuICAgICAgICAgIH0sXG4gICAgICAgICAgb3Bwb25lbnQ6IHtcbiAgICAgICAgICAgIF9pZDogcGxheWVyLl9pZCxcbiAgICAgICAgICAgIGVtYWlsOiBwbGF5ZXIuZW1haWwsXG4gICAgICAgICAgICBmaXJzdE5hbWU6IHBsYXllci5maXJzdE5hbWUsXG4gICAgICAgICAgICBsYXN0TmFtZTogcGxheWVyLmxhc3ROYW1lLFxuICAgICAgICAgICAgcG9zaXRpb246IHBsYXllci5wb3NpdGlvblxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBjaGFsbGVuZ2VcbiAgICAgICAgLy8gV2Vic29ja2V0IGV2ZW50IHdpbGwgcmVmcmVzaCB0aGUgcHlyYW1pZFxuICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jcmVhdGVDaGFsbGVuZ2UoY2hhbGxlbmdlKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2bS5weXJhbWlkTWVudVRvZ2dsZSA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tcGxldGUgYSBjaGFsbGVuZ2UgYnkgYSB1c2VyIGludGVyYWN0aW9uIG9yIGEgZm9yZmVpdFxuICAgICAqIFxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IHdpbm5lcklzQ3VycmVudFVzZXJcbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSBmb3JmZWl0XG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBmb3JmZWl0TG9zZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb21wbGV0ZUNoYWxsZW5nZSh3aW5uZXJJc0N1cnJlbnRVc2VyLCBmb3JmZWl0LCBmb3JmZWl0TG9zZXIpIHtcbiAgICAgIHZhciBwbGF5ZXIgPSBmb3JmZWl0TG9zZXIgfHwgdm0uY3VycmVudFVzZXJQbGF5ZXI7XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIodm0uY29tcGV0aXRpb25JZCwgcGxheWVyLl9pZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBzd2FwUG9zaXRpb25zID0gZmFsc2U7XG5cbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBmb3JmZWl0XG4gICAgICAgIGlmIChmb3JmZWl0KSB7XG4gICAgICAgICAgY2hhbGxlbmdlLmRhdGEuZm9yZmVpdCA9IHRydWU7XG4gICAgICAgICAgaWYgKGZvcmZlaXRMb3Nlci5jaGFsbGVuZ2UucG9zaXRpb24gPT09ICdvcHBvbmVudCcpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdjaGFsbGVuZ2VyJztcbiAgICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnb3Bwb25lbnQnO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBGaWd1cmUgb3V0IHdobyB0aGUgd2lubmVyIHdhcyB0byBzdG9yZSBpbiB0aGUgY2hhbGxlbmdlIHJlY29yZFxuICAgICAgICB9IGVsc2UgaWYgKHdpbm5lcklzQ3VycmVudFVzZXIpIHtcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci5faWQgPT09IHZtLmN1cnJlbnRVc2VyUGxheWVyLl9pZCkge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ2NoYWxsZW5nZXInO1xuICAgICAgICAgICAgc3dhcFBvc2l0aW9ucyA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdvcHBvbmVudCc7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLl9pZCA9PT0gdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnb3Bwb25lbnQnO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnY2hhbGxlbmdlcic7XG4gICAgICAgICAgICBzd2FwUG9zaXRpb25zID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTd2FwIHBvc2l0aW9ucyBhbmQgdGhlbiBjb21wbGV0ZSB0aGUgY2hhbGxlbmdlIG9yIGp1c3QgY29tcGxldGUgdGhlIGNoYWxsZW5nZVxuICAgICAgICAvLyBXZWJzb2NrZXQgZXZlbnQgd2lsbCByZWZyZXNoIHRoZSBweXJhbWlkXG4gICAgICAgIGlmIChzd2FwUG9zaXRpb25zKSB7XG4gICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLnN3YXBQb3NpdGlvbnModm0uY29tcGV0aXRpb25JZCwgY2hhbGxlbmdlLmRhdGEub3Bwb25lbnQsIGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBpZiAocmVtb3ZpbmdDdXJyZW50VXNlcikge1xuICAgICAgICAgICAgICAgIHJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHJlbW92aW5nQ3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgcmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0ucHlyYW1pZE1lbnVUb2dnbGUgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxscyB0aGUgY29tcGxldGUgY2hhbGxuZ2UgZnVuY3Rpb24gd2l0aCB0aGUgZm9yZmVpdGluZyBwbGF5ZXJcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHBsYXllclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNoYWxsZW5nZUV4cGlyZWQocGxheWVyKSB7XG4gICAgICBjb21wbGV0ZUNoYWxsZW5nZShudWxsLCB0cnVlLCBwbGF5ZXIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIHRoZSBjdXJyZW50IHVzZXIgdGhlIHB5cmFtaWQgXG4gICAgICogaWYgdGhleSdyZSBub3QgYWxyZWFkeSBvbiBpdCBhbmQgdGhlcmUncyBzcGFjZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZEN1cnJlbnRVc2VyVG9QeXJhbWlkKCkge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICBpZiAodm0ubnVtYmVyT2ZSZWFsUGxheWVycyA8IHZtLm1heFBsYXllcnMpIHtcbiAgICAgICAgICB2YXIgcGxheWVyID0ge1xuICAgICAgICAgICAgX2lkOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgbGFzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5sYXN0TmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgICBwb3NpdGlvbjogdm0ubnVtYmVyT2ZSZWFsUGxheWVycyArIDFcbiAgICAgICAgICB9O1xuICAgICAgICAgIGlmICh2bS5weXJhbWlkLm9wZW4pIHtcbiAgICAgICAgICAgIHN3YWwoe1xuICAgICAgICAgICAgICB0aXRsZTogJ0pvaW4gQ29tcGV0aXRpb24/JyxcbiAgICAgICAgICAgICAgdGV4dDogJ1lvdVxcJ2xsIGJlIGFkZGVkIHRvIHRoZSBib3R0b20nLFxuICAgICAgICAgICAgICB0eXBlOiAnd2FybmluZycsXG4gICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnSm9pbicsXG4gICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICdOZXZlcm1pbmQnLFxuICAgICAgICAgICAgICBjbG9zZU9uQ29uZmlybTogZmFsc2UsXG4gICAgICAgICAgICAgIGNsb3NlT25DYW5jZWw6IHRydWVcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmFkZFBsYXllclRvUHlyYW1pZCh2bS5jb21wZXRpdGlvbklkLCBwbGF5ZXIpO1xuICAgICAgICAgICAgICBzd2FsKCdXZWxjb21lIEFib2FyZCEnLCAnTm93IHN0YXJ0IGZpZ2h0aW5nIHlvdXIgd2F5IHRvIHRoZSB0b3AnLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgfSk7ICBcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3dhbCh7XG4gICAgICAgICAgICAgIHRpdGxlOiAnU2VuZCBKb2luIFJlcXVlc3Q/JyxcbiAgICAgICAgICAgICAgdGV4dDogJ1RoaXMgaXMgYSBjbG9zZWQgY29tcGV0aXRpb24gc28gdGhlIG93bmVyIG11c3QgYXBwcm92ZSB5b3VyIHJlcXVlc3QnLFxuICAgICAgICAgICAgICB0eXBlOiAnd2FybmluZycsXG4gICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnU2VuZCBSZXF1ZXN0JyxcbiAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ05ldmVybWluZCcsXG4gICAgICAgICAgICAgIGNsb3NlT25Db25maXJtOiBmYWxzZSxcbiAgICAgICAgICAgICAgY2xvc2VPbkNhbmNlbDogdHJ1ZVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBweXJhbWlkc1NlcnZpY2UuYWRkUGxheWVyVG9QeXJhbWlkUmVxdWVzdCh2bS5weXJhbWlkLCBwbGF5ZXIpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZtLmN1cnJlbnRVc2VySXNQZW5kaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHN3YWwoJ1JlcXVlc3QgU2VudCcsICdZb3Ugd2lsbCByZWNlaXZlIGFuIGVtYWlsIG9uY2UgdGhlIG93bmVyIHByb2Nlc3NlcyB0aGUgcmVxdWVzdC4nLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2Uud2FybmluZygnU29ycnksIHRoaXMgcHlyYW1pZCBpcyBmdWxsJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2Uud2FybmluZygnUGxlYXNlIGxvZ2luIHRvIGpvaW4gYSBjb21wZXRpdGlvbicpO1xuICAgICAgICAkc3RhdGUucHJldmlvdXMgPSAncHlyYW1pZHMudmlldyc7XG4gICAgICAgICRzdGF0ZS5wcmV2UGFyYW1zID0geydjb21wZXRpdGlvbklkJzogdm0uY29tcGV0aXRpb25JZH07XG4gICAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb25maXJtUmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCgpIHtcbiAgICAgIHN3YWwoe1xuICAgICAgICB0aXRsZTogJ0xlYXZlIFB5cmFtaWQ/JyxcbiAgICAgICAgdGV4dDogJ1lvdSB3aWxsIGxvc2UgeW91ciBzcG90IGFuZCBmb3JmZWl0IGFueSBhY3RpdmUgY2hhbGxlbmdlcy4nLFxuICAgICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLFxuICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ1llcywgbGVhdmUnLFxuICAgICAgICBjb25maXJtQnV0dG9uQ2xhc3M6ICdidG4tZGFuZ2VyJyxcbiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ05vLCBzdGF5JyxcbiAgICAgICAgY2xvc2VPbkNvbmZpcm06IGZhbHNlLFxuICAgICAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlXG4gICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQoKTtcbiAgICAgICAgc3dhbCgnT0ssIHlvdVxcJ3Igb3V0IScsICdZb3VcXCd2ZSBiZWVuIHJlbW92ZWQgZnJvbSB0aGUgcHlyYW1pZC4nLCAnc3VjY2VzcycpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gVXNlIHRoaXMgdG8gZW5mb3JjZSBvcmRlciBvZiBvcGVyYXRpb25zIHdoZW4gdGhlIHBsYXllciB0byBiZSByZW1vdmVkIGhhZCBhbiBhY3RpdmUgY2hhbGxlbmdlXG4gICAgdmFyIHJlbW92aW5nQ3VycmVudFVzZXIgPSBmYWxzZTtcblxuICAgIGZ1bmN0aW9uIHJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQoKSB7XG4gICAgICAvLyBNYWtlIHN1cmUgdGhlIHVzZXIgaXMgbG9nZ2VkIGluIGFuZCBpcyBvbiB0aGlzIHB5cmFtaWRcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkgJiYgdm0uY3VycmVudFVzZXJJc09uUHlyYW1pZCkge1xuICAgICAgICByZW1vdmluZ0N1cnJlbnRVc2VyID0gdHJ1ZTtcbiAgICAgICAgLy8gRm9yZmVpdCBpZiB0aGV5IGhhdmUgYW4gYWN0aXZlIGNoYWxsZW5nZVxuICAgICAgICBpZiAodm0uaGFzQWN0aXZlQ2hhbGxlbmdlKSB7XG4gICAgICAgICAgY29tcGxldGVDaGFsbGVuZ2UobnVsbCwgdHJ1ZSwgdm0uY3VycmVudFVzZXJQbGF5ZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIFNpbmNlIHdlIGFyZSByZW1vdmluZyB0aGVtIC4uLlxuICAgICAgICAgIHZtLmN1cnJlbnRVc2VySXNPblB5cmFtaWQgPSBmYWxzZTtcbiAgICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcblxuICAgICAgICAgIC8vIEdldCBhbiB1cGRhdGVkIGNvcHkgb2YgdGhlIHB5cmFtaWQgaW5jYXNlIGEgZm9yZmVpdCBoYXBwZW5lZFxuICAgICAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHApIHtcbiAgICAgICAgICAgIC8vIFN0b3JlIHRoZSB1cGRhdGVkIGNvcHkgbG9jYWxseSBzbyBhcyBub3QgdG8gZGlzdHJ1cHQgdGhlIHB5cmFtaWRcbiAgICAgICAgICAgIC8vIHVudGlsIHRoZSBwbGF5ZXIgaGFzIGJlZW4gcmVtb3ZlZFxuICAgICAgICAgICAgdmFyIHB5cmFtaWQgPSBwLmRhdGE7XG5cbiAgICAgICAgICAgIC8vIEtlZXAgdHJhY2sgb2YgdGhlIHNwb3QgdGhleSB3ZXJlIGluIG9uIHRoZSBweXJhbWlkXG4gICAgICAgICAgICB2YXIgb3BlblBvc2l0aW9uID0gdm0uY3VycmVudFVzZXJQbGF5ZXIucG9zaXRpb247XG5cbiAgICAgICAgICAgIC8vIE1vdmUgYWxsIHRoZSBwbGF5ZXJzIHVwIDEgcG9zaXRpb24gdGhhdCB3ZXJlIGJlaGluZCB0aGUgcmVtb3ZlZCBwbGF5ZXJcbiAgICAgICAgICAgIF8uZm9yRWFjaChweXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgICAgICAgaWYgKHBsYXllci5wb3NpdGlvbiA+PSBvcGVuUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIucG9zaXRpb24gLT0gMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZWQgdGhlIHBsYXllciBmcm9tIHRoZSBweXJhbWlkXG4gICAgICAgICAgICB2YXIgcmVtb3ZlZFBsYXllciA9IF8ucmVtb3ZlKHB5cmFtaWQucGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICAgICAgICByZXR1cm4gcGxheWVyLl9pZCA9PT0gdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIE1ha2UgYSBuZXcgYXJyYXkgb2YgYWxsIHRoZSBwbGF5ZXJzIHN0aWxsIG9uIHRoZSBweXJhbWlkXG4gICAgICAgICAgICAvLyBvbmx5IHVzZSB0aGUgcHJvcGVydGllcyB3ZSB3YW50IHRvIHN0b3JlIGluIHRoZSBweXJhbWlkIGRvY3VtZW50XG4gICAgICAgICAgICB2YXIgdXBkYXRlZFBsYXllcnMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ubnVtYmVyT2ZSZWFsUGxheWVycyAtIDE7ICsraSkge1xuICAgICAgICAgICAgICB2YXIgdXBkYXRlZFBsYXllciA9IHtcbiAgICAgICAgICAgICAgICBfaWQ6IHB5cmFtaWQucGxheWVyc1tpXS5faWQsXG4gICAgICAgICAgICAgICAgZmlyc3ROYW1lOiBweXJhbWlkLnBsYXllcnNbaV0uZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgIGxhc3ROYW1lOiBweXJhbWlkLnBsYXllcnNbaV0ubGFzdE5hbWUsXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHB5cmFtaWQucGxheWVyc1tpXS5wb3NpdGlvblxuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIHVwZGF0ZWRQbGF5ZXJzLnB1c2godXBkYXRlZFBsYXllcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENhbGwgc2VydmljZSB0byByZW1vdmUgdGhlIHBsYXllclxuICAgICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLnJlbW92ZWRQbGF5ZXJGcm9tUHlyYW1pZCh2bS5jb21wZXRpdGlvbklkLCByZW1vdmVkUGxheWVyWzBdLCB1cGRhdGVkUGxheWVycykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJlbW92aW5nQ3VycmVudFVzZXIgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlndXJlIG91dCB3aGF0IHRoZSBhcHByb3ByaWF0ZSBhY3Rpb24gaXMgYmFzZWQgb24gdGhlIHBsYXllciBjbGlja2luZyBhbmQgdGhlIHBsYXllciBiZWluZyBjbGlja2VkXG4gICAgICovXG4gICAgZnVuY3Rpb24gcGxheWVyQ2xpY2socGxheWVyKSB7XG4gICAgICAvLyBjbGlja2VkIG9uIGVtcHR5IHNwb3RcbiAgICAgIGlmIChwbGF5ZXIucG9zaXRpb24gPT09IDk5ICYmICF2bS5jdXJyZW50VXNlcklzT25QeXJhbWlkKSB7XG4gICAgICAgIGFkZEN1cnJlbnRVc2VyVG9QeXJhbWlkKCk7XG4gICAgICB9XG4gICAgICBpZiAocGxheWVyLmF2YWlsYWJsZSA9PT0gdHJ1ZSAmJiB2bS5jdXJyZW50VXNlcklzT25QeXJhbWlkICYmICF2bS5oYXNBY3RpdmVDaGFsbGVuZ2UpIHtcbiAgICAgICAgc3dhbCh7XG4gICAgICAgICAgdGl0bGU6ICdDaGFsbGVuZ2UgUmVxdWVzdCcsXG4gICAgICAgICAgdGV4dDogJ0NoYWxsZW5nZSAnICsgcGxheWVyLmZpcnN0TmFtZSArICcgJyArIHBsYXllci5sYXN0TmFtZSArICc/JyxcbiAgICAgICAgICB0eXBlOiAnd2FybmluZycsXG4gICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ1NlbmQgQ2hhbGxlbmdlJyxcbiAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAnTmV2ZXJtaW5kJyxcbiAgICAgICAgICBjbG9zZU9uQ29uZmlybTogZmFsc2UsXG4gICAgICAgICAgY2xvc2VPbkNhbmNlbDogdHJ1ZVxuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgY3JlYXRlQ2hhbGxlbmdlKHBsYXllcik7XG4gICAgICAgICAgc3dhbCgnQ2hhbGxlbmdlIFNlbnQnLCBwbGF5ZXIuZmlyc3ROYW1lICsgJyAnICsgcGxheWVyLmxhc3ROYW1lICsgJyBoYXMgYmVlbiBub3RpZmllZCBvZiB0aGUgY2hhbGxlbmdlLicsICdzdWNjZXNzJyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZnJlc2ggdGhlIHB5cmFtaWQgYmVjYXN1ZSBvZiBhbiB1cGRhdGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZWZyZXNoUHlyYW1pZCgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpweXJhbWlkX3VwZGF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twVXBkYXRlUGxheWVycycsIGtwVXBkYXRlUGxheWVycyk7XG5cbiAgZnVuY3Rpb24ga3BVcGRhdGVQbGF5ZXJzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcHlyYW1pZDogJz0nXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvcHlyYW1pZHMvY29tcG9uZW50cy91cGRhdGUtcGxheWVycy5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUsICRmaWx0ZXIsIHB5cmFtaWRzU2VydmljZSwgY2hhbGxlbmdlc1NlcnZpY2UsIHVzZXJTZXJ2aWNlKSB7XG4gICAgdmFyIHJlbW92ZWRQbGF5ZXJzID0gW107XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5hdmFpbGFibGVQbGF5ZXJzID0gW107XG4gICAgdm0udXBkYXRlUHlyYW1pZCA9IHVwZGF0ZVB5cmFtaWQ7XG4gICAgdm0uY2FuY2VsVXBkYXRlID0gY2FuY2VsVXBkYXRlO1xuICAgIHZtLnJlb3JkZXJQbGF5ZXJzID0gcmVvcmRlclBsYXllcnM7XG4gICAgdm0ucmVtb3ZlUGxheWVyID0gcmVtb3ZlUGxheWVyO1xuICAgIHZtLmFkZFBsYXllciA9IGFkZFBsYXllcjtcbiAgICB2bS5kaXNhYmxlU3VibWl0ID0gdHJ1ZTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICRzY29wZS4kd2F0Y2goJ3ZtLnB5cmFtaWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh2bS5weXJhbWlkKSB7XG4gICAgICAgICAgZ2V0QXZhaWxhYmxlUGxheWVycygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRBdmFpbGFibGVQbGF5ZXJzKCkge1xuICAgICAgdXNlclNlcnZpY2UuZ2V0QWxsVXNlcnMoKS50aGVuKGZ1bmN0aW9uICh1c2Vycykge1xuICAgICAgICBfLmZvckVhY2godm0ucHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocHlyYW1pZFBsYXllcikge1xuICAgICAgICAgIF8ucmVtb3ZlKHVzZXJzLmRhdGEsIGZ1bmN0aW9uIChhdmFpbGFibGVQbGF5ZXIpe1xuICAgICAgICAgICAgcmV0dXJuIHB5cmFtaWRQbGF5ZXIuX2lkID09PSBhdmFpbGFibGVQbGF5ZXIuX2lkO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IHVzZXJzLmRhdGE7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBQZXJmb3JtIHRoZSB1cGRhdGVzIHRoYXQgd2VyZSByZXF1c3RlZFxuICAgIGZ1bmN0aW9uIHVwZGF0ZVB5cmFtaWQoKSB7XG4gICAgICBfLmZvckVhY2gocmVtb3ZlZFBsYXllcnMsIGZ1bmN0aW9uKHBsYXllcikge1xuICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5kZWxldGVBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIodm0ucHlyYW1pZC5faWQsIHBsYXllci5faWQpO1xuICAgICAgfSk7XG4gICAgICBweXJhbWlkc1NlcnZpY2UudXBkYXRlUHlyYW1pZCh2bS5weXJhbWlkKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdm0uZGlzYWJsZVN1Ym1pdCA9IHRydWU7XG4gICAgICB9KTsgICBcbiAgICB9XG5cbiAgICAvLyBDYW5jZWwgdGhlIHVwZGF0ZSBhbmQgcHV0IGV2ZXJ5dGhpbmcgYmFjayB0byB0aGUgb3JnaW5hbFxuICAgIGZ1bmN0aW9uIGNhbmNlbFVwZGF0ZSgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLnB5cmFtaWQuX2lkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgIHB5cmFtaWQuZGF0YS5wbGF5ZXJzID0gJGZpbHRlcignb3JkZXJCeScpKHB5cmFtaWQuZGF0YS5wbGF5ZXJzLCAncG9zaXRpb24nKTtcbiAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgdm0uZGlzYWJsZVN1Ym1pdCA9IHRydWU7XG4gICAgICB9KTtcbiAgICAgIGdldEF2YWlsYWJsZVBsYXllcnMoKTtcbiAgICB9XG5cbiAgICAvLyBSZW9yZGVyIHRoZSBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBkcmFnLWRyb3BcbiAgICBmdW5jdGlvbiByZW9yZGVyUGxheWVycygpIHtcbiAgICAgIHZhciBpID0gMTtcbiAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgcGxheWVyLnBvc2l0aW9uID0gaTtcbiAgICAgICAgKytpO1xuICAgICAgfSk7XG4gICAgICB2bS5kaXNhYmxlU3VibWl0ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhIHBsYXllciBmcm9tIHRoZSBweXJhbWlkXG4gICAgICogUXVldWUgdXAgdGhlIHBsYXllcnMgdG8gYmUgcmVtb3ZlZCBhbmQgcmVtb3ZlIHRoZW0gZnJvbSB0aGUgZGlzcGxheVxuICAgICAqIEBwYXJhbSAge29iamVjdH0gcGxheWVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVtb3ZlUGxheWVyKHBsYXllcikge1xuICAgICAgcmVtb3ZlZFBsYXllcnMucHVzaChwbGF5ZXIpO1xuICAgICAgdm0uYXZhaWxhYmxlUGxheWVycy5wdXNoKF8ucmVtb3ZlKHZtLnB5cmFtaWQucGxheWVycywge19pZDogcGxheWVyLl9pZH0pWzBdKTtcbiAgICAgIHJlb3JkZXJQbGF5ZXJzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBhIHBsYXllciB0byB0aGUgbmV3IHB5cmFtaWRcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHBsYXllclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZFBsYXllcihwbGF5ZXIpIHtcbiAgICAgIHBsYXllci5wb3NpdGlvbiA9IHZtLnB5cmFtaWQucGxheWVycy5sZW5ndGggKyAxO1xuICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzLnB1c2goXy5yZW1vdmUodm0uYXZhaWxhYmxlUGxheWVycywge19pZDogcGxheWVyLl9pZH0pWzBdKTtcbiAgICAgIHZtLmRpc2FibGVTdWJtaXQgPSBmYWxzZTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgncHlyYW1pZHNTZXJ2aWNlJywgcHlyYW1pZHNTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBweXJhbWlkc1NlcnZpY2UoJGh0dHApIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGdldFB5cmFtaWQ6IGdldFB5cmFtaWQsXG4gICAgICBnZXRQeXJhbWlkc0ZvclVzZXI6IGdldFB5cmFtaWRzRm9yVXNlcixcbiAgICAgIGdldFB5cmFtaWRzOiBnZXRQeXJhbWlkcyxcbiAgICAgIGNyZWF0ZVB5cmFtaWQ6IGNyZWF0ZVB5cmFtaWQsXG4gICAgICB1cGRhdGVQeXJhbWlkOiB1cGRhdGVQeXJhbWlkLFxuICAgICAgZGVsZXRlUHlyYW1pZDogZGVsZXRlUHlyYW1pZCxcbiAgICAgIHN3YXBQb3NpdGlvbnM6IHN3YXBQb3NpdGlvbnMsXG4gICAgICBhZGRQbGF5ZXJUb1B5cmFtaWQ6IGFkZFBsYXllclRvUHlyYW1pZCxcbiAgICAgIGFkZFBsYXllclRvUHlyYW1pZFJlcXVlc3Q6IGFkZFBsYXllclRvUHlyYW1pZFJlcXVlc3QsXG4gICAgICByZW1vdmVkUGxheWVyRnJvbVB5cmFtaWQ6IHJlbW92ZWRQbGF5ZXJGcm9tUHlyYW1pZCxcbiAgICAgIGFwcHJvdmVQZW5kaW5nUGxheWVyOiBhcHByb3ZlUGVuZGluZ1BsYXllcixcbiAgICAgIGRlbnlQZW5kaW5nUGxheWVyOiBkZW55UGVuZGluZ1BsYXllclxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIC8qKlxuICAgICAqIEdldHMgYSBweXJhbWlkIGZyb20gdGhlIGRhdGFiYXNlIChvciBtZW1vcnkpXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcHlyYW1pZCBpZCBmb3IgdGhlIHJlcXVlc3RlZCBweXJhbWlkXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBweXJhbWlkXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZChjb21wZXRpdGlvbklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3B5cmFtaWQnLCB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhbGwgcHlyYW1pZHMgZnJvbSB0aGUgZGF0YWJhc2UgdGhhdCBhIHBhcnRpY3VsYXIgdXNlciBpcyBpbmNsdWRlZCBpblxuICAgICAqXG4gICAgICogQHBhcmFtIHt1c2VySWR9IHRoZSB1c2VyIGlkIGZvciB0aGUgcmVxdWVzdGVkIHVzZXJcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IHB5cmFtaWRzXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZHNGb3JVc2VyKHVzZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9weXJhbWlkcy91c2VyJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICB1c2VySWQ6IHVzZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGFsbCBhY3RpdmUgcHlyYW1pZHMgZnJvbSB0aGUgZGF0YWJhc2VcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge09iamVjdH0gcHlyYW1pZHNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRQeXJhbWlkcygpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcHlyYW1pZHMnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVQeXJhbWlkKHB5cmFtaWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2NyZWF0ZScsIHtcbiAgICAgICAgcHlyYW1pZDogcHlyYW1pZFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlUHlyYW1pZChweXJhbWlkKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy91cGRhdGUnLCB7XG4gICAgICAgIHB5cmFtaWQ6IHB5cmFtaWRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbGV0ZVB5cmFtaWQoY29tcGV0aXRpb25JZCkge1xuICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS9weXJhbWlkcy9kZWxldGUnLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN3YXBQb3NpdGlvbnMoY29tcGV0aXRpb25JZCwgY2hhbGxlbmdlciwgb3Bwb25lbnQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL3N3YXBQb3NpdGlvbnMnLCB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgIGNoYWxsZW5nZXI6IGNoYWxsZW5nZXIsXG4gICAgICAgIG9wcG9uZW50OiBvcHBvbmVudFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkUGxheWVyVG9QeXJhbWlkKGNvbXBldGl0aW9uSWQsIHBsYXllcikge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvYWRkUGxheWVyJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkUGxheWVyVG9QeXJhbWlkUmVxdWVzdChjb21wZXRpdGlvbiwgcGxheWVyKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9hZGRQbGF5ZXJSZXF1ZXN0Jywge1xuICAgICAgICBjb21wZXRpdGlvbjogY29tcGV0aXRpb24sXG4gICAgICAgIHBsYXllcjogcGxheWVyXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmVkUGxheWVyRnJvbVB5cmFtaWQoY29tcGV0aXRpb25JZCwgcmVtb3ZlZFBsYXllciwgcGxheWVycykge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvcmVtb3ZlUGxheWVyJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICByZW1vdmVkUGxheWVyOiByZW1vdmVkUGxheWVyLFxuICAgICAgICBwbGF5ZXJzOiBwbGF5ZXJzXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhcHByb3ZlUGVuZGluZ1BsYXllcihjb21wZXRpdGlvbklkLCBwbGF5ZXIpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2FwcHJvdmVQbGF5ZXInLCB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgIHBsYXllcjogcGxheWVyXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZW55UGVuZGluZ1BsYXllcihjb21wZXRpdGlvbklkLCBwbGF5ZXIpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2RlbnlQbGF5ZXInLCB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgIHBsYXllcjogcGxheWVyXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQWRtaW5DdHJsJywgQWRtaW5DdHJsKTtcblxuICBmdW5jdGlvbiBBZG1pbkN0cmwoJHNjb3BlLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgJGZpbHRlciwgcHlyYW1pZHNTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UsIG5vdGlmeVNlcnZpY2UsIGNoYWxsZW5nZXNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jb21wZXRpdGlvbklkID0gbnVsbDtcbiAgICB2bS51cGRhdGVQeXJhbWlkT3BlblN0YXR1cyA9IHVwZGF0ZVB5cmFtaWRPcGVuU3RhdHVzO1xuICAgIHZtLmRlbGV0ZVB5cmFtaWQgPSBkZWxldGVQeXJhbWlkO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMubXlQeXJhbWlkcycpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlZnJlc2hQeXJhbWlkKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhpcyB1c2VyIGlzIGFuIG93bmVyIG9mIHRoaXMgY29tcGV0aXRpb25cbiAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSAmJiBfLnNvbWUocHlyYW1pZC5kYXRhLm93bmVycywgWydfaWQnLCBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkXSkpIHtcbiAgICAgICAgICB2bS5pc093bmVyID0gdHJ1ZTtcbiAgICAgICAgICAvLyBEaXNwbGF5IHRoZSBwbGF5ZXJzIGluIHRoZSBwcm9wZXIgb3JkZXJcbiAgICAgICAgICBweXJhbWlkLmRhdGEucGxheWVycyA9ICRmaWx0ZXIoJ29yZGVyQnknKShweXJhbWlkLmRhdGEucGxheWVycywgJ3Bvc2l0aW9uJyk7XG4gICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLm15UHlyYW1pZHMnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIHZtLmNoYWxsZW5nZXMgPSBjaGFsbGVuZ2VzLmRhdGE7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBQZXJmb3JtIHRoZSB1cGRhdGVzIHRoYXQgd2VyZSByZXF1c3RlZFxuICAgIGZ1bmN0aW9uIHVwZGF0ZVB5cmFtaWRPcGVuU3RhdHVzKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICB2YXIgdXBkYXRlZFB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICAgIHVwZGF0ZWRQeXJhbWlkLm9wZW4gPSB2bS5weXJhbWlkLm9wZW47XG4gICAgICAgIHB5cmFtaWRzU2VydmljZS51cGRhdGVQeXJhbWlkKHVwZGF0ZWRQeXJhbWlkKTtcbiAgICAgIH0pOyAgICAgIFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbGV0ZVB5cmFtaWQoKSB7XG4gICAgICBzd2FsKHtcbiAgICAgICAgdGl0bGU6ICdEZWxldGUgQ29tcGV0aXRpb24/JyxcbiAgICAgICAgdGV4dDogJ1RoaXMgY2FuIG5vdCBiZSB1bmRvbmUnLFxuICAgICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLFxuICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ0RlbGV0ZScsXG4gICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICdOZXZlcm1pbmQnLFxuICAgICAgICBjbG9zZU9uQ29uZmlybTogdHJ1ZSxcbiAgICAgICAgY2xvc2VPbkNhbmNlbDogdHJ1ZVxuICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICBweXJhbWlkc1NlcnZpY2UuZGVsZXRlUHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLm15UHlyYW1pZHMnKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cHlyYW1pZF91cGRhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOnB5cmFtaWRfZGVsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy5teVB5cmFtaWRzJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiLyoqXG4gKiBDcmVhdGVzIGEgcHlyYW1pZFxuICovXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdDcmVhdGVQeXJhbWlkQ3RybCcsIENyZWF0ZVB5cmFtaWRDdHJsKTtcblxuICBmdW5jdGlvbiBDcmVhdGVQeXJhbWlkQ3RybCgkc3RhdGUsIHVzZXJTZXJ2aWNlLCBweXJhbWlkc1NlcnZpY2UsIGlkZW50aXR5U2VydmljZSkge1xuICAgIHZhciBicmVha1BvaW50cyA9IFtdO1xuICAgIHZhciBtYXhMZXZlbHMgPSAxMDtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLm5ld1B5cmFtaWQgPSB7XG4gICAgICBwbGF5ZXJzOiBbXSxcbiAgICAgIG9wZW46IGZhbHNlXG4gICAgfTtcbiAgICB2bS5hdmFpbGFibGVQbGF5ZXJzID0gW107XG4gICAgdm0uYWRkZWRQbGF5ZXJzID0gW107XG4gICAgdm0uY3JlYXRlUHlyYW1pZCA9IGNyZWF0ZVB5cmFtaWQ7XG4gICAgdm0uYWRkUGxheWVyID0gYWRkUGxheWVyO1xuICAgIHZtLnJlbW92ZVBsYXllciA9IHJlbW92ZVBsYXllcjtcbiAgICB2bS5yZW9yZGVyUGxheWVycyA9IHJlb3JkZXJQbGF5ZXJzO1xuICAgIHZtLm5ld1B5cmFtaWQuZm9yZmVpdERheXMgPSAxO1xuXG4gICAgYWN0aXZhdGUoKTtcbiAgICBcbiAgICAvKipcbiAgICAgKiBSdW5zIG9uIGNvbnRyb2xsZXIgaW5zdGFudGlhdGlvblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgdXNlclNlcnZpY2UuZ2V0QWxsVXNlcnMoKS50aGVuKGZ1bmN0aW9uICh1c2Vycykge1xuICAgICAgICB2bS5hdmFpbGFibGVQbGF5ZXJzID0gdXNlcnMuZGF0YTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDcmVhdGUgYnJlYWsgcG9pbnRzIGFycmF5XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1heExldmVsczsgaSsrKSB7XG4gICAgICAgIGJyZWFrUG9pbnRzLnB1c2goKCgoaSAqIChpICsgMSkpIC8gMikpICsgMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBhIHBsYXllciB0byB0aGUgbmV3IHB5cmFtaWRcbiAgICAgKiBDaGVja3MgdG8gbWFrZSBzdXJlIHlvdSBhcmUgbm90IGFkZGluZyB0b28gbWFueSBwbGF5ZXJzXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBwbGF5ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhZGRQbGF5ZXIocGxheWVyKSB7XG4gICAgICBwbGF5ZXIucG9zaXRpb24gPSB2bS5hZGRlZFBsYXllcnMubGVuZ3RoICsgMTtcbiAgICAgIHZtLmFkZGVkUGxheWVycy5wdXNoKF8ucmVtb3ZlKHZtLmF2YWlsYWJsZVBsYXllcnMsIHtfaWQ6IHBsYXllci5faWR9KVswXSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhIHByZXZpdW9zbHkgYWRkZWQgcGxheWVyIGZyb20gdGhlIHB5cmFtaWRcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHBsYXllclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlbW92ZVBsYXllcihwbGF5ZXIpIHtcbiAgICAgIHZtLmF2YWlsYWJsZVBsYXllcnMucHVzaChfLnJlbW92ZSh2bS5hZGRlZFBsYXllcnMsIHtfaWQ6IHBsYXllci5faWR9KVswXSk7XG4gICAgICByZW9yZGVyUGxheWVycygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlb3JkZXIgdGhlIHBsYXllcnMgYmFzZWQgb24gdGhlIGRyYWctZHJvcFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlb3JkZXJQbGF5ZXJzKCkge1xuICAgICAgdmFyIGkgPSAxO1xuICAgICAgXy5mb3JFYWNoKHZtLmFkZGVkUGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICBwbGF5ZXIucG9zaXRpb24gPSBpO1xuICAgICAgICArK2k7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBVc2VkIHRvIGtlZXAgdHJhY2sgb2YgcG9zaXRpb24gb24gdGhlIHB5cmFtaWQgYmFzZWQgb24gd2hlbiB0aGUgcGxheWVyIHdhcyBhZGRlZFxuICAgIHZhciBwb3NpdGlvbiA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgdGhlIHB5cmFtaWRcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHB5cmFtaWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVQeXJhbWlkKHB5cmFtaWQpIHtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaCh2bS5hZGRlZFBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgcG9zaXRpb24gKz0gMTtcbiAgICAgICAgdmFyIGFkZFBsYXllciA9IHtcbiAgICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sXG4gICAgICAgICAgX2lkOiBwbGF5ZXIuX2lkLFxuICAgICAgICAgIGVtYWlsOiBwbGF5ZXIudXNlcm5hbWUsXG4gICAgICAgICAgZmlyc3ROYW1lOiBwbGF5ZXIuZmlyc3ROYW1lLFxuICAgICAgICAgIGxhc3ROYW1lOiBwbGF5ZXIubGFzdE5hbWVcbiAgICAgICAgfTtcbiAgICAgICAgcHlyYW1pZC5wbGF5ZXJzLnB1c2goYWRkUGxheWVyKTtcbiAgICAgIH0pO1xuICAgICAgcHlyYW1pZC5vd25lcnMgPSBbe1xuICAgICAgICBfaWQ6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQsXG4gICAgICAgIGVtYWlsOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIudXNlcm5hbWUsXG4gICAgICAgIGZpcnN0TmFtZTogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmZpcnN0TmFtZSxcbiAgICAgICAgbGFzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5sYXN0TmFtZVxuICAgICAgfV07XG5cbiAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBvZiBsZXZlbHMgYmFzZWQgb24gdGhlIG51bWJlciBvZiBwbGF5ZXJzXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJyZWFrUG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChweXJhbWlkLnBsYXllcnMubGVuZ3RoIDwgYnJlYWtQb2ludHNbaV0pIHtcbiAgICAgICAgICBweXJhbWlkLmxldmVscyA9IGk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmNyZWF0ZVB5cmFtaWQocHlyYW1pZCkudGhlbihmdW5jdGlvbiAobmV3UHlyYW1pZCkge1xuICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLnZpZXcnLCB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogbmV3UHlyYW1pZC5kYXRhLl9pZFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdNeVB5cmFtaWRzQ3RybCcsIE15UHlyYW1pZHNDdHJsKTtcblxuICBmdW5jdGlvbiBNeVB5cmFtaWRzQ3RybCgkc2NvcGUsIHB5cmFtaWRzU2VydmljZSwgY2hhbGxlbmdlc1NlcnZpY2UsIGlkZW50aXR5U2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciBteVB5cmFtaWRzID0gW107XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5hY3RpdmVDaGFsbGVuZ2UgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgZ2V0UHlyYW1pZHNGb3JVc2VyKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZHNGb3JVc2VyKCkge1xuICAgICAgbXlQeXJhbWlkcyA9IFtdO1xuICAgICAgdm0uYWN0aXZlQ2hhbGxlbmdlID0gbnVsbDtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWRzRm9yVXNlcihpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkcykge1xuICAgICAgICAgIHZtLnB5cmFtaWRzID0gcHlyYW1pZHMuZGF0YTtcbiAgICAgICAgICBfLmZvckVhY2godm0ucHlyYW1pZHMsIGZ1bmN0aW9uKHB5cmFtaWQpIHtcbiAgICAgICAgICAgIG15UHlyYW1pZHMucHVzaChweXJhbWlkLl9pZCk7XG4gICAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIocHlyYW1pZC5faWQsIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICBweXJhbWlkLmFjdGl2ZUNoYWxsZW5nZSA9IGNoYWxsZW5nZS5kYXRhO1xuICAgICAgICAgICAgICAgIGlmIChweXJhbWlkLmFjdGl2ZUNoYWxsZW5nZS50aW1lTGltaXQgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgIHB5cmFtaWQuYWN0aXZlQ2hhbGxlbmdlLmV4cGlyZXMgPSAobW9tZW50KCkuZGlmZihtb21lbnQocHlyYW1pZC5hY3RpdmVDaGFsbGVuZ2UuY3JlYXRlZCkuYWRkKHB5cmFtaWQuYWN0aXZlQ2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2QnKSwncycpKSAqIC0xO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpweXJhbWlkX3VwZGF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKG15UHlyYW1pZHMuaW5kZXhPZihjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpID49IDApIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICBnZXRQeXJhbWlkc0ZvclVzZXIoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdQeXJhbWlkQ3RybCcsIFB5cmFtaWRDdHJsKTtcblxuICBmdW5jdGlvbiBQeXJhbWlkQ3RybCgkc2NvcGUsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBweXJhbWlkc1NlcnZpY2UsIG5vdGlmeVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNvbXBldGl0aW9uSWQgPSBudWxsO1xuICAgIHZtLnB5cmFtaWQgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcblxuICAgICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSkge1xuICAgICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy5teVB5cmFtaWRzJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cHlyYW1pZF9kZWxldGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLm15UHlyYW1pZHMnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdQeXJhbWlkc0N0cmwnLCBQeXJhbWlkc0N0cmwpO1xuXG4gIGZ1bmN0aW9uIFB5cmFtaWRzQ3RybChweXJhbWlkc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnB5cmFtaWRzID0gW107XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZHMoKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkcykge1xuICAgICAgICB2bS5weXJhbWlkcyA9IHB5cmFtaWRzLmRhdGE7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignU3RhdHNDdHJsJywgU3RhdHNDdHJsKTtcblxuICBmdW5jdGlvbiBTdGF0c0N0cmwoJHNjb3BlLCAkc3RhdGVQYXJhbXMsICRzdGF0ZSwgcHlyYW1pZHNTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY29tcGV0aXRpb25JZCA9IG51bGw7XG4gICAgdm0ucHlyYW1pZCA9IHt9O1xuICAgIHZtLnBsYXllcnNSZXN1bHRzID0gW107XG4gICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWZyZXNoUHlyYW1pZCgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSkge1xuICAgICAgICAgIHZtLnB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG5cbiAgICAgICAgICBfLmZvckVhY2godm0ucHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRQbGF5ZXJSZXN1bHRzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkLCBwbGF5ZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgIHBsYXllci5yZXN1bHRzID0gcmVzdWx0cy5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy5teVB5cmFtaWRzJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlcykge1xuICAgICAgICB2bS5jaGFsbGVuZ2VzID0gY2hhbGxlbmdlcy5kYXRhO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOnB5cmFtaWRfdXBkYXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpweXJhbWlkX2RlbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMubXlQeXJhbWlkcycpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1VzZXJDdHJsJywgVXNlckN0cmwpO1xuXG4gIGZ1bmN0aW9uIFVzZXJDdHJsKGlkZW50aXR5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge31cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2NPdmVyZmxvdycsIGNPdmVyZmxvdyk7XG5cbiAgZnVuY3Rpb24gY092ZXJmbG93KHNjcm9sbGJhclNlcnZpY2UpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICB2YXIgc2Nyb2xsYXhpcyA9IGF0dHJzLnNjcm9sbGF4aXMgfHwgJ3knO1xuICAgICAgdmFyIHRoZW1lID0gYXR0cnMudGhlbWUgfHwgJ21pbmltYWwtZGFyayc7XG4gICAgICB2YXIgbW91c2V3aGVlbGF4aXMgPSBhdHRycy5tb3VzZXdoZWVsYXhpcyB8fCAneSc7XG4gICAgICBpZiAoISQoJ2h0bWwnKS5oYXNDbGFzcygnaXNtb2JpbGUnKSkge1xuICAgICAgICBzY3JvbGxiYXJTZXJ2aWNlLm1hbGlodVNjcm9sbChlbGVtZW50LCB0aGVtZSwgc2Nyb2xsYXhpcywgbW91c2V3aGVlbGF4aXMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ3RvZ2dsZVN1Ym1lbnUnLCB0b2dnbGVTdWJtZW51KTtcblxuICBmdW5jdGlvbiB0b2dnbGVTdWJtZW51KCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWwpIHtcbiAgICAgIGVsLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZWwubmV4dCgpLnNsaWRlVG9nZ2xlKDIwMCk7XG4gICAgICAgIGVsLnBhcmVudCgpLnRvZ2dsZUNsYXNzKCd0b2dnbGVkJyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCd3YXZlc0VmZmVjdCcsIHdhdmVzRWZmZWN0KTtcblxuICBmdW5jdGlvbiB3YXZlc0VmZmVjdCgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdidG4taWNvbicpIHx8IGVsZW1lbnQuaGFzQ2xhc3MoJ2J0bi1mbG9hdCcpKSB7XG4gICAgICAgIFdhdmVzLmF0dGFjaChlbGVtZW50LCBbJ3dhdmVzLWNpcmNsZSddKTtcbiAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5oYXNDbGFzcygnYnRuLWxpZ2h0JykpIHtcbiAgICAgICAgV2F2ZXMuYXR0YWNoKGVsZW1lbnQsIFsnd2F2ZXMtbGlnaHQnXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBXYXZlcy5hdHRhY2goZWxlbWVudCk7XG4gICAgICB9XG5cbiAgICAgIFdhdmVzLmluaXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdmZ0xpbmUnLCBmZ0xpbmUpO1xuXG4gIGZ1bmN0aW9uIGZnTGluZSgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgIHZhciBpbnB1dCA9IGVsZW1lbnQuY2hpbGRyZW4oKS5maXJzdCgpO1xuICAgICAgdmFyIGlzRmxvYXRMYWJlbCA9IGVsZW1lbnQucGFyZW50KCkuaGFzQ2xhc3MoJ2ZnLWZsb2F0Jyk7XG4gICAgICBpbnB1dC5mb2N1cyhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ2ZnLXRvZ2dsZWQnKTtcbiAgICAgIH0pO1xuXG4gICAgICBpbnB1dC5ibHVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFpc0Zsb2F0TGFiZWwgfHwgKGlzRmxvYXRMYWJlbCAmJiBpbnB1dC52YWwoKS5sZW5ndGggPT09IDApKSB7XG4gICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnZmctdG9nZ2xlZCcpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
