angular.module("app",["ui.router","ui.bootstrap","ngAnimate","angular-loading-bar","nouislider","localytics.directives","timer","LocalStorageModule","angular-sortable-view"]),function(){"use strict ";function e(e,t){e.defaults.headers.get||(e.defaults.headers.get={}),e.defaults.headers.get["If-Modified-Since"]="Fri, 01 Jan 2016 05:00:00 GMT",e.defaults.headers.get["Cache-Control"]="no-cache",e.defaults.headers.get.Pragma="no-cache",t.options({appendToBody:!0})}e.$inject=["$httpProvider","$uibTooltipProvider"],angular.module("app").config(e)}(),function(){"use strict";function e(e,t){function n(e){t.set("sidebarLocked",e)}var r=this;r.$state=e,r.lockSidebar=t.get("sidebarLocked"),r.toggleSidebarLocked=n}e.$inject=["$state","localStorageService"],angular.module("app").controller("AppCtrl",e)}(),function(){"use strict";function e(e,i,o){var a={superAdmin:n,admin:t,user:r};o.html5Mode(!0),i.otherwise("/"),i.when("/pyramids/","/pyramids"),e.state("home",{url:"/",views:{content:{controller:"HomeCtrl",controllerAs:"vm",templateUrl:"common/views/home.html"}}}).state("pyramids",{url:"/pyramids",views:{content:{controller:"PyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramids.html"}}}).state("pyramids.myPyramids",{url:"/my-pyramids",views:{"content@":{controller:"MyPyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/my-pyramids.html"}},resolve:{auth:a.user}}).state("pyramids.view",{url:"/view/:competitionId",views:{"content@":{controller:"PyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramid.html"}}}).state("pyramids.stats",{url:"/stats/:competitionId",views:{"content@":{controller:"StatsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/stats.html"}}}).state("pyramids.admin",{url:"/admin/:competitionId",views:{"content@":{controller:"AdminCtrl",controllerAs:"vm",templateUrl:"pyramids/views/admin.html"}},resolve:{auth:a.user}}).state("pyramids.create",{url:"/create",views:{"content@":{controller:"CreatePyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/create-pyramid.html"}},resolve:{auth:a.user}}).state("login",{url:"/login",views:{content:{controller:"LoginCtrl",controllerAs:"vm",templateUrl:"authentication/views/login.html"}}}).state("register",{url:"/register",views:{content:{controller:"RegisterCtrl",controllerAs:"vm",templateUrl:"authentication/views/register.html"}}}).state("verify",{url:"/verification",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}}).state("verification",{url:"/verification/:userId/:verificationToken",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}})}function t(e){return e.authorizeCurrentUserForRoute("admin")}function n(e){return e.authorizeCurrentUserForRoute("super-admin")}function r(e){return e.authenticatedUserForRoute()}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app").config(e),t.$inject=["authService"],n.$inject=["authService"],r.$inject=["authService"]}(),function(){"use strict";function e(e,t,n){e.$on("$stateChangeError",function(e,n,r,i,o,a){"not authorized"===a&&(t.go("login"),t.previous=n,t.prevParams=r)}),e.$on("$stateChangeStart",function(){n.setSidebarStatus(!1)})}e.$inject=["$rootScope","$state","sidebarService"],angular.module("app").run(e)}(),function(){"use strict";function e(e,t,n,r,i,o){function a(e,r){var o=n.defer();return t.post("/login",{username:e,password:r}).then(function(e){e.data.success?(i.currentUser=e.data.user,o.resolve(!0)):"unverified"===e.data.message?o.resolve("unverified"):o.resolve(!1)}),o.promise}function l(e){var r=n.defer();return t.post("/api/users",{userData:e}).then(function(e){e.data?r.resolve(!0):r.resolve(!1)},function(e){"Error: Duplicate Username"===e.data.reason&&o.error("Sorry, an account already exists with that email address.")}),r.promise}function s(){var r=n.defer();return t.post("/logout",{logout:!0}).then(function(){i.currentUser=void 0,r.resolve(),e.go("home")}),r.promise}function c(e){return!!i.isAuthorized(e)||n.reject("not authorized")}function u(){return!!i.isAuthenticated()||n.reject("not authorized")}var d={authenticateUser:a,createUser:l,logout:s,authorizeCurrentUserForRoute:c,authenticatedUserForRoute:u};return d}e.$inject=["$state","$http","$q","userService","identityService","notifyService"],angular.module("app").factory("authService",e)}(),function(){"use strict";function e(e){function t(){return e.get("/api/users").then(function(e){return e})}function n(t,n){return e.get("/api/user/verification",{params:{userId:t,verificationToken:n}})}var r={getAllUsers:t,verifyUser:n};return r}e.$inject=["$http"],angular.module("app").factory("userService",e)}(),function(){"use strict";function e(e,t,n){function r(){}function i(r,i){t.authenticateUser(r,i).then(function(t){t?"unverified"===t?n.error("You must verify your email before you can login"):e.previous?(e.go(e.previous,e.prevParams),e.previous=null,e.prevParams=null):e.go("home"):n.error("Username / password combinaiton incorrect")})}var o=this;o.login=i,r()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("LoginCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){}function i(r){r.password!==r.confirmPassword?n.error("Passwords don't match!"):t.createUser(r).then(function(){e.go("verify")})}var o=this;o.register=i,r()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("RegisterCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){t.userId&&t.verificationToken&&(i.verifying=!0,i.verified=null,n.verifyUser(t.userId,t.verificationToken).then(function(e){e.data?i.verified=!0:i.verified=!1}))}var i=this;i.verified=void 0,i.verifying=!1,r()}e.$inject=["$state","$stateParams","userService"],angular.module("app").controller("VerificationCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@"},templateUrl:"/challenges/components/active-challenges.html"};return e}function t(e,t){function n(){r()}function r(){i.challenges=[],t.getActiveChallengesByCompetition(i.competitionId).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){0!==e.timeLimit&&(e.expires=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1)}))})}var i=this;i.challenges=[],n(),e.$on("ws:challenge_created",function(e,t){i.competitionId===t.competitionId&&r()}),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&r()}),e.$on("ws:pyramid_updated",function(e,t){i.competitionId===t.competitionId&&r()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpActiveChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@",limit:"@"},templateUrl:"/challenges/components/completed-challenges.html"};return e}function t(e,t){function n(){r()}function r(){i.challenges=[],t.getCompletedChallengesByCompetition(i.competitionId,i.limit).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){e.loser="challenger"===e.winner?"opponent":"challenger",e.whenCompleted=moment(e.completed).calendar(null,{sameDay:"[Today]",nextDay:"[Tomorrow]",nextWeek:"dddd",lastDay:"[Yesterday]",lastWeek:"[Last] dddd",sameElse:"DD/MM/YYYY"})}))})}var i=this;i.challenges=[],n(),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&r()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpCompletedChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@",player:"="},templateUrl:"/challenges/components/player-overall-results.html"};return e}function t(e){function t(){n(r.competitionId,r.player._id)}function n(t,n){e.getPlayerResultsByCompetition(t,n).then(function(e){for(var t=[],i=0;i<r.maxLevels;i++)t.push(i*(i+1)/2+1);r.player.level=t.length;for(var o=0;o<t.length;o++)if(r.player.position<t[o+1]){r.player.level=t.indexOf(t[o])+1;break}var a,l=0,s=!0;_.forEach(e.data,function(e){s&&("challenger"===e.winner&&e.challenger._id===n||"opponent"===e.winner&&e.opponent._id===n?"losing"!==a?(l+=1,a="winning"):s=!1:("opponent"===e.winner&&e.challenger._id===n||"challenger"===e.winner&&e.opponent._id===n)&&("winning"!==a?(l+=1,a="losing"):s=!1)),r.streak={type:a,value:l}}),r.wins.asOpponent=_.size(_.filter(e.data,function(e){return e.opponent._id===n&&"opponent"===e.winner})),r.wins.asChallenger=_.size(_.filter(e.data,function(e){return e.challenger._id===n&&"challenger"===e.winner})),r.wins.total=r.wins.asChallenger+r.wins.asOpponent,r.wins.byForfeit=_.size(_.filter(e.data,function(e){return e.forfeit&&(e.challenger._id===n&&"challenger"===e.winner||e.opponent._id===n&&"opponent"===e.winner)})),r.loses.asOpponent=_.size(_.filter(e.data,function(e){return e.opponent._id===n&&"challenger"===e.winner})),r.loses.asChallenger=_.size(_.filter(e.data,function(e){return e.challenger._id===n&&"opponent"===e.winner})),r.loses.total=r.loses.asChallenger+r.loses.asOpponent,r.loses.byForfeit=_.size(_.filter(e.data,function(e){return e.forfeit&&(e.challenger._id===n&&"opponent"===e.winner||e.opponent._id===n&&"challenger"===e.winner)}))})}var r=this;r.maxLevels=10,r.wins={total:0,asChallenger:0,asOpponent:0,byForfeit:0},r.loses={total:0,asChallenger:0,asOpponent:0,byForfeit:0},r.streak={type:null,value:0},t()}t.$inject=["challengesService"],angular.module("app").directive("kpPlayerOverallResults",e)}(),function(){"use strict";function e(e){function t(t){return e.post("/api/challenges/create",{challenge:t})}function n(t){return e.post("/api/challenges/complete",{challenge:t})}function r(t){return e.get("/api/challenges/competition",{params:{competitionId:t}})}function i(t){return e.get("/api/challenges/active/competition",{params:{competitionId:t}})}function o(t,n){return e.get("/api/challenges/active/competition/player",{params:{competitionId:t,playerId:n}})}function a(t,n){return e.get("/api/challenges/completed/competition",{params:{competitionId:t,limit:n}})}function l(t,n){return e.delete("/api/challenges/active/competition/player/delete",{params:{competitionId:t,playerId:n}})}function s(t,n){return e.get("/api/challenges/results/competition/player",{params:{competitionId:t,playerId:n}})}var c={createChallenge:t,completeChallenge:n,getChallengesByCompetition:r,getActiveChallengesByCompetition:i,getActiveChallengeByCompetitionByPlayer:o,getCompletedChallengesByCompetition:a,deleteActiveChallengeByCompetitionByPlayer:l,getPlayerResultsByCompetition:s};return c}e.$inject=["$http"],angular.module("app").factory("challengesService",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",templateUrl:"/common/components/footer.html"};return e}function t(e,t){function n(){t.logout()}var r=this;r.indentity=e,r.logout=n}t.$inject=["identityService","authService"],angular.module("app").directive("kpFooter",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"headerCtrl",restrict:"A",templateUrl:"/common/components/header.html"};return e}function t(e,t,n){function r(){o.sidebarStatus.left=!o.sidebarStatus.left,e.setSidebarStatus(o.sidebarStatus.left)}function i(){n.logout()}var o=this;o.indentity=t,o.logout=i,o.sidebarStatus=e.getSidebarStatus(),o.toggleSidebar=r}t.$inject=["sidebarService","identityService","authService"],angular.module("app").directive("kpHeader",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"sidebarCtrl",restrict:"A",templateUrl:"/common/components/sidebar.html"};return e}function t(e,t,n){function r(){t.logout()}var i=this;i.indentity=e,i.logout=r,i.sidebarStatus=n.getSidebarStatus()}t.$inject=["identityService","authService","sidebarService"],angular.module("app").directive("kpSidebar",e)}(),function(){"use strict";function e(){return function(e,t){if(!angular.isObject(e))return e;var n=[];for(var r in e)n.push(e[r]);return n.sort(function(e,n){return e=parseInt(e[t]),n=parseInt(n[t]),e-n}),n}}angular.module("app").filter("orderObjectBy",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("HomeCtrl",e)}(),function(){"use strict";function e(e){function t(){return!!this.currentUser}function n(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}var r;null!==e.bootstrappedUserObject&&(r=e.bootstrappedUserObject);var i={currentUser:r,isAuthenticated:t,isAuthorized:n};return i}e.$inject=["$window"],angular.module("app").factory("identityService",e)}(),function(){"use strict";function e(){function e(e,t,n){$.notify({message:e,url:t,target:n},{type:"info"})}function t(e,t,n){$.notify({message:e,url:t,target:n},{type:"success"})}function n(e,t,n){$.notify({message:e,url:t,target:n},{type:"warning"})}function r(e,t,n){$.notify({message:e,url:t,target:n},{type:"danger"})}function i(e,t,n){$.notify({message:e,url:t,target:n},{type:"inverse"})}var o={info:e,success:t,warning:n,error:r,inverse:i};return $.notifyDefaults({newest_on_top:!0,offset:{x:20,y:85}}),o}angular.module("app").factory("notifyService",e)}(),function(){"use strict";function e(){function e(e,t,n,r){$(e).mCustomScrollbar({theme:t,scrollInertia:100,axis:n,mouseWheel:{enable:!0,axis:r,preventDefault:!0}})}var t={malihuScroll:e};return t}angular.module("app").factory("scrollbarService",e)}(),function(){"use strict";function e(){function e(){return n}function t(e){n.left=e}var n={left:!1,right:!1},r={getSidebarStatus:e,setSidebarStatus:t};return r}angular.module("app").factory("sidebarService",e)}(),angular.module("app").service("websocketService",["$rootScope","$window",function(e,t){function n(){return"https:"===t.location.protocol?"wss://"+t.location.host:"ws://"+t.location.host}var r;this.connect=function(){r=new WebSocket(n()),r.onmessage=function(t){var n=JSON.parse(t.data);e.$broadcast("ws:"+n.topic,n.data)}},this.send=function(e,t){var n=JSON.stringify({topic:e,data:t});r.send(n)}}]).run(["websocketService",function(e){e.connect()}]),function(){"use strict";function e(e){function t(t){return e.get("/api/pyramid",{params:{competitionId:t}})}function n(t){return e.get("/api/pyramids/user",{params:{userId:t}})}function r(){return e.get("/api/pyramids")}function i(t){return e.post("/api/pyramids/create",{pyramid:t})}function o(t){return e.post("/api/pyramids/update",{pyramid:t})}function a(t,n,r){return e.post("/api/pyramids/swapPositions",{competitionId:t,challenger:n,opponent:r})}function l(t,n){return e.post("/api/pyramids/addPlayer",{competitionId:t,player:n})}function s(t,n){return e.post("/api/pyramids/addPlayerRequest",{competition:t,player:n})}function c(t,n,r){return e.post("/api/pyramids/removePlayer",{competitionId:t,removedPlayer:n,players:r})}function u(t,n){return e.post("/api/pyramids/approvePlayer",{competitionId:t,player:n})}function d(t,n){return e.post("/api/pyramids/denyPlayer",{competitionId:t,player:n})}var p={getPyramid:t,getPyramidsForUser:n,getPyramids:r,createPyramid:i,updatePyramid:o,swapPositions:a,addPlayerToPyramid:l,addPlayerToPyramidRequest:s,removedPlayerFromPyramid:c,approvePendingPlayer:u,denyPendingPlayer:d};return p}e.$inject=["$http"],angular.module("app").factory("pyramidsService",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{pyramid:"="},templateUrl:"/pyramids/components/pending-players.html"};return e}function t(e){function t(){}function n(t){t.position=i.pyramid.players.length+1,e.approvePendingPlayer(i.pyramid._id,t)}function r(t){e.denyPendingPlayer(i.pyramid._id,t)}var i=this;i.pendingPlayers=[],i.approvePendingPlayer=n,i.denyPendingPlayer=r,t()}t.$inject=["pyramidsService"],angular.module("app").directive("kpPendingPlayers",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{type:"@"},templateUrl:"/pyramids/components/pyramid-compact.html"};return e}function t(e,t){function n(){"user"===r.type?e.getPyramidsForUser(t.currentUser._id).then(function(e){r.pyramids=e.data}):e.getPyramids().then(function(e){r.pyramids=e.data})}var r=this;r.pyramids=null,n()}t.$inject=["pyramidsService","identityService"],angular.module("app").directive("kpPyramidCompact",e)}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"/pyramids/components/pyramid.html",replace:!0,scope:{competitionId:"@"},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,n,r,i,o,a){function l(){n.getPyramid(S.competitionId).then(function(e){for(var t=I;t>0;--t)S.maxPlayers+=t;e.data&&(S.pyramid=e.data,s(),c(),d(),p(),m())})}function s(){S.pyramid.players=r("orderBy")(S.pyramid.players,"position")}function c(){o.isAuthenticated()&&(S.currentUserIsOwner=_.some(S.pyramid.owners,["_id",o.currentUser._id])),S.currentUserIsOnPyramid=!1,S.hasActiveChallenge=!1,_.forEach(S.pyramid.players,function(e){o.isAuthenticated()&&e._id===o.currentUser._id&&(S.currentUserIsOnPyramid=!0,e.class="current-user",S.currentUserPlayer=e,a.getActiveChallengeByCompetitionByPlayer(S.competitionId,e._id).then(function(e){e.data&&(S.hasActiveChallenge=!0)}))}),S.currentUserIsPending=!1,_.forEach(S.pyramid.pendingPlayers,function(e){o.isAuthenticated()&&e._id===o.currentUser._id&&(S.currentUserIsPending=!0)}),a.getActiveChallengesByCompetition(S.competitionId).then(function(e){_.forEach(e.data,function(e){var t=_.find(S.pyramid.players,{_id:e.challenger._id});t.class="unavailable",t.challenge={position:"challenger"};var n=_.find(S.pyramid.players,{_id:e.opponent._id});if(n.class="unavailable",n.challenge={position:"opponent"},0!==e.timeLimit){var r=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1;r>0?n.challenge.expires=r:r<=0&&v(null,!0,n)}}),f()})}function u(){S.breakPoints=[];for(var e=0;e<I;e++)S.breakPoints.push(e*(e+1)/2+1)}function d(){var e=0;S.levels=[],u();for(var t=0;t<S.pyramid.players.length;t++)S.breakPoints.indexOf(t+1)>-1&&(e+=1,S.levels.push(e)),S.pyramid.players[t].level=e}function p(){S.numberOfBlocks=0;for(var e=_.last(S.levels);e>0;e--)S.numberOfBlocks+=e}function m(){S.numberOfRealPlayers=S.pyramid.players.length;for(var e=S.pyramid.players.length;e<S.numberOfBlocks;e++)S.pyramid.players.push({firstName:"Empty",lastName:"Spot",position:99,class:"empty"});d()}function f(){var e=S.currentUserPlayer.level>1?S.currentUserPlayer.level-1:null;_.forEach(S.pyramid.players,function(t){t.level===e&&99!==t.position&&"unavailable"!==t.class&&(S.availableChallenges=!0,t.available=!0)})}function y(e){if(e.available){S.hasActiveChallenge=!0;var t={competitionName:S.pyramid.name,competitionId:S.competitionId,complete:!1,forfeit:!1,timeLimit:S.pyramid.forfeitDays,challenger:{_id:S.currentUserPlayer._id,email:S.currentUserPlayer.email,firstName:S.currentUserPlayer.firstName,lastName:S.currentUserPlayer.lastName,position:S.currentUserPlayer.position},opponent:{_id:e._id,email:e.email,firstName:e.firstName,lastName:e.lastName,position:e.position}};a.createChallenge(t).then(function(){S.pyramidMenuToggle=!1})}else i.error("Sorry, that is not a valid challenge.")}function v(e,t,r){var i=r||S.currentUserPlayer;a.getActiveChallengeByCompetitionByPlayer(S.competitionId,i._id).then(function(i){S.hasActiveChallenge=!1;var o=!1;t?(i.data.forfeit=!0,"opponent"===r.challenge.position?(i.data.winner="challenger",o=!0):i.data.winner="opponent"):e?i.data.challenger._id===S.currentUserPlayer._id?(i.data.winner="challenger",o=!0):i.data.winner="opponent":i.data.challenger._id===S.currentUserPlayer._id?i.data.winner="opponent":(i.data.winner="challenger",o=!0),o?n.swapPositions(S.competitionId,i.data.opponent,i.data.challenger).then(function(){a.completeChallenge(i.data).then(function(){$&&w()})}):a.completeChallenge(i.data).then(function(){$&&w()}),S.pyramidMenuToggle=!1})}function g(e){v(null,!0,e)}function h(){if(o.isAuthenticated())if(S.numberOfRealPlayers<S.maxPlayers){var e={_id:o.currentUser._id,firstName:o.currentUser.firstName,lastName:o.currentUser.lastName,email:o.currentUser.username,position:S.numberOfRealPlayers+1};S.pyramid.open?swal({title:"Join Competition?",text:"You'll be added to the bottom",type:"warning",showCancelButton:!0,confirmButtonText:"Join",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToPyramid(S.competitionId,e),swal("Welcome Aboard!","Now start fighting your way to the top","success")}):swal({title:"Send Join Request?",text:"This is a closed competition so the owner must approve your request",type:"warning",showCancelButton:!0,confirmButtonText:"Send Request",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToPyramidRequest(S.pyramid,e).then(function(){S.currentUserIsPending=!0}),swal("Request Sent","You will receive an email once the owner processes the request.","success")})}else i.warning("Sorry, this pyramid is full");else t.go("login")}function P(){swal({title:"Leave Pyramid?",text:"You will lose your spot and forfeit any active challenges.",type:"error",showCancelButton:!0,confirmButtonText:"Yes, leave",confirmButtonClass:"btn-danger",cancelButtonText:"No, stay",closeOnConfirm:!1,closeOnCancel:!0},function(){w(),swal("OK, you'r out!","You've been removed from the pyramid.","success")})}function w(){o.isAuthenticated()&&S.currentUserIsOnPyramid&&($=!0,S.hasActiveChallenge?v(null,!0,S.currentUserPlayer):(S.currentUserIsOnPyramid=!1,S.hasActiveChallenge=!1,n.getPyramid(S.competitionId).then(function(e){var t=e.data,r=S.currentUserPlayer.position;_.forEach(t.players,function(e){e.position>=r&&(e.position-=1)});for(var i=_.remove(t.players,function(e){return e._id===S.currentUserPlayer._id}),o=[],a=0;a<S.numberOfRealPlayers-1;++a){var l={_id:t.players[a]._id,firstName:t.players[a].firstName,lastName:t.players[a].lastName,position:t.players[a].position};o.push(l)}n.removedPlayerFromPyramid(S.competitionId,i[0],o).then(function(){$=!1})})))}function C(){n.getPyramid(S.competitionId).then(function(e){S.pyramid=e.data,s(),c(),d(),p(),m()})}var I=10,S=this;S.pyramid={},S.breakPoints=[],S.levels=[],S.numberOfBlocks=0,S.currentUserIsOnPyramid=!1,S.currentUserIsPending=!1,S.currentUserIsOwner=!1,S.hasActiveChallenge=!1,S.availableChallenges=!1,S.createChallenge=y,S.completeChallenge=v,S.challengeExpired=g,S.currentUserPlayer={},S.pyramidMenuToggle=!1,S.addCurrentUserToPyramid=h,S.confirmRemoveCurrentUserFromPyramid=P,S.numberOfRealPlayers=0,S.maxPlayers=0,l();var $=!1;e.$on("ws:challenge_created",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:challenge_completed",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),$||C())}),e.$on("ws:player_added",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:player_removed",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:pyramid_updated",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())})}t.$inject=["$scope","$state","pyramidsService","$filter","notifyService","identityService","challengesService"],angular.module("app").directive("kpPyramid",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{pyramid:"="},templateUrl:"/pyramids/components/update-players.html"};return e}function t(e,t,n){function r(){}function i(){_.forEach(s,function(e){n.deleteActiveChallengeByCompetitionByPlayer(c.pyramid._id,e._id)}),t.updatePyramid(c.pyramid)}function o(){t.getPyramid(c.pyramid._id).then(function(t){t.data.players=e("orderBy")(t.data.players,"position"),c.pyramid=t.data})}function a(){var e=1;_.forEach(c.pyramid.players,function(t){t.position=e,++e})}function l(e,t){s.push(e),c.pyramid.players.splice(t,1),a()}var s=[],c=this;c.updatePyramid=i,c.cancelUpdate=o,c.reorderPlayers=a,c.removePlayer=l,r()}t.$inject=["$filter","pyramidsService","challengesService"],angular.module("app").directive("kpUpdatePlayers",e)}(),function(){"use strict";function e(e,t,n,r,i,o,a){function l(){n.competitionId?(u.competitionId=n.competitionId,s()):t.go("pyramids.myPyramids")}function s(){i.getPyramid(u.competitionId).then(function(e){e.data&&_.some(e.data.owners,["_id",o.currentUser._id])?(e.data.players=r("orderBy")(e.data.players,"position"),u.pyramid=e.data):t.go("pyramids.myPyramids")})}function c(){i.getPyramid(u.competitionId).then(function(e){var t=e.data;t.open=u.pyramid.open,i.updatePyramid(t)})}var u=this;u.competitionId=null,u.updatePyramidOpenStatus=c,l(),e.$on("ws:challenge_completed",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),s())}),e.$on("ws:player_added",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),s())}),e.$on("ws:player_removed",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),s())}),e.$on("ws:pyramid_updated",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),s())}),e.$on("ws:add_player_request",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),s())}),e.$on("ws:add_player_request_denied",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),s())})}e.$inject=["$scope","$state","$stateParams","$filter","pyramidsService","identityService","notifyService"],angular.module("app").controller("AdminCtrl",e)}(),function(){"use strict";function e(e,t,n,r){function i(){t.getAllUsers().then(function(e){d.availablePlayers=e.data});for(var e=0;e<u;e++)c.push(e*(e+1)/2+1)}function o(e){e.position=d.addedPlayers.length+1,d.addedPlayers.push(_.remove(d.availablePlayers,{_id:e._id})[0])}function a(e){d.availablePlayers.push(_.remove(d.addedPlayers,{_id:e._id})[0]),l()}function l(){var e=1;_.forEach(d.addedPlayers,function(t){t.position=e,++e})}function s(t){angular.forEach(d.addedPlayers,function(e){p+=1;var n={position:p,_id:e._id,email:e.username,firstName:e.firstName,lastName:e.lastName};t.players.push(n)}),t.owners=[{_id:r.currentUser._id,email:r.currentUser.username,firstName:r.currentUser.firstName,lastName:r.currentUser.lastName}];for(var i=0;i<c.length;i++)if(t.players.length<c[i]){t.levels=i;break}n.createPyramid(t).then(function(t){e.go("pyramids.view",{competitionId:t.data._id})})}var c=[],u=10,d=this;d.newPyramid={players:[],open:!1},d.availablePlayers=[],d.addedPlayers=[],d.createPyramid=s,d.addPlayer=o,d.removePlayer=a,d.reorderPlayers=l,d.newPyramid.forfeitDays=1,i();var p=0}e.$inject=["$state","userService","pyramidsService","identityService"],angular.module("app").controller("CreatePyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("MyPyramidsCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){t.competitionId&&(i.competitionId=t.competitionId,n.getPyramid(i.competitionId).then(function(t){t.data?i.pyramid=t.data:e.go("pyramids.myPyramids")}))}var i=this;i.competitionId=null,i.pyramid=null,r()}e.$inject=["$state","$stateParams","pyramidsService"],angular.module("app").controller("PyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("PyramidsCtrl",e)}(),function(){"use strict";function e(e,t,n,r,i){function o(){t.competitionId&&(l.competitionId=t.competitionId,a())}function a(){r.getPyramid(l.competitionId).then(function(e){e.data?l.pyramid=e.data:n.go("pyramids.myPyramids")})}var l=this;l.competitionId=null,l.pyramid=null,o(),e.$on("ws:challenge_completed",function(e,t){l.competitionId===t.competitionId&&(i.info(t.description),a())})}e.$inject=["$scope","$stateParams","$state","pyramidsService","notifyService"],angular.module("app").controller("StatsCtrl",e)}(),function(){"use strict";function e(e){function t(t,n,r){var i=r.scrollaxis||"y",o=r.theme||"minimal-dark",a=r.mousewheelaxis||"y";$("html").hasClass("ismobile")||e.malihuScroll(n,o,i,a)}var n={restrict:"C",link:t};return n}e.$inject=["scrollbarService"],angular.module("app").directive("cOverflow",e)}(),function(){"use strict";function e(){function e(e,t){t.click(function(){t.next().slideToggle(200),t.parent().toggleClass("toggled")})}var t={restrict:"A",link:e};return t}angular.module("app").directive("toggleSubmenu",e)}(),function(){"use strict";function e(){function e(e,t){t.hasClass("btn-icon")||t.hasClass("btn-float")?Waves.attach(t,["waves-circle"]):t.hasClass("btn-light")?Waves.attach(t,["waves-light"]):Waves.attach(t),Waves.init()}var t={restrict:"C",link:e};return t}angular.module("app").directive("wavesEffect",e)}(),function(){"use strict";function e(){function e(e,t){var n=t.children().first(),r=t.parent().hasClass("fg-float");n.focus(function(){t.addClass("fg-toggled")}),n.blur(function(){(!r||r&&0===n.val().length)&&t.removeClass("fg-toggled")})}var t={restrict:"C",link:e};return t}angular.module("app").directive("fgLine",e)}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiYXBwLmNvbnRyb2xsZXIuanMiLCJhcHAucm91dGVzLmpzIiwiYXBwLnJ1bi5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL2F1dGguc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL3VzZXIuc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3ZpZXdzL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJhdXRoZW50aWNhdGlvbi92aWV3cy9yZWdpc3Rlci5jb250cm9sbGVyLmpzIiwiYXV0aGVudGljYXRpb24vdmlld3MvdmVyaWZpY2F0aW9uLmNvbnRyb2xsZXIuanMiLCJjaGFsbGVuZ2VzL2NvbXBvbmVudHMvYWN0aXZlLWNoYWxsZW5nZXMuZGlyZWN0aXZlLmpzIiwiY2hhbGxlbmdlcy9jb21wb25lbnRzL2NvbXBsZXRlZC1jaGFsbGVuZ2VzLmRpcmVjdGl2ZS5qcyIsImNoYWxsZW5nZXMvY29tcG9uZW50cy9wbGF5ZXItb3ZlcmFsbC1yZXN1bHRzLmRpcmVjdGl2ZS5qcyIsImNoYWxsZW5nZXMvc2VydmljZXMvY2hhbGxlbmdlcy5zZXJ2aWNlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvZm9vdGVyLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL2hlYWRlci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy9zaWRlYmFyLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9maWx0ZXJzL29yZGVyLW9iamVjdC1ieS5maWx0ZXIuanMiLCJjb21tb24vdmlld3MvaG9tZS5jb250cm9sbGVyLmpzIiwiY29tbW9uL3NlcnZpY2VzL2luZGVudGl0eS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL25vdGlmeS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3Njcm9sbGJhci5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3NpZGViYXIuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy93ZWJzb2NrZXQuc2VydmljZS5qcyIsInB5cmFtaWRzL3NlcnZpY2VzL3B5cmFtaWRzLnNlcnZpY2UuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3BlbmRpbmctcGxheWVycy5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQtY29tcGFjdC5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQuZGlyZWN0aXZlLmpzIiwicHlyYW1pZHMvY29tcG9uZW50cy91cGRhdGUtcGxheWVycy5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy92aWV3cy9hZG1pbi5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvY3JlYXRlLXB5cmFtaWQuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL215LXB5cmFtaWRzLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy92aWV3cy9weXJhbWlkLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy92aWV3cy9weXJhbWlkcy5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3Mvc3RhdHMuY29udHJvbGxlci5qcyIsImNvbW1vbi9jb21wb25lbnRzL3VpL3Njcm9sbGJhci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS90b2dnbGUtc3VibWVudS5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS93YXZlcy5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS9mb3Jtcy9mZy1saW5lLmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlndXJhdGlvbiIsIiRodHRwUHJvdmlkZXIiLCIkdWliVG9vbHRpcFByb3ZpZGVyIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiZ2V0Iiwib3B0aW9ucyIsImFwcGVuZFRvQm9keSIsImNvbmZpZyIsIkFwcEN0cmwiLCIkc3RhdGUiLCJsb2NhbFN0b3JhZ2VTZXJ2aWNlIiwidG9nZ2xlU2lkZWJhckxvY2tlZCIsImxvY2tlZCIsInNldCIsImFwcEN0cmwiLCJ0aGlzIiwibG9ja1NpZGViYXIiLCJjb250cm9sbGVyIiwiY29uZmlndXJlUm91dGVzIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsInJvdXRlUm9sZUNoZWNrcyIsInN1cGVyQWRtaW4iLCJyZXF1aXJlU3VwZXJBZG1pbiIsImFkbWluIiwicmVxdWlyZUFkbWluIiwidXNlciIsInJlcXVpcmVBdXRoIiwiaHRtbDVNb2RlIiwib3RoZXJ3aXNlIiwid2hlbiIsInN0YXRlIiwidXJsIiwidmlld3MiLCJjb250ZW50IiwiY29udHJvbGxlckFzIiwidGVtcGxhdGVVcmwiLCJjb250ZW50QCIsInJlc29sdmUiLCJhdXRoIiwiYXV0aFNlcnZpY2UiLCJhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlIiwiYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSIsIiRpbmplY3QiLCJhcHBSdW4iLCIkcm9vdFNjb3BlIiwic2lkZWJhclNlcnZpY2UiLCIkb24iLCJldmVudCIsInRvU3RhdGUiLCJ0b1BhcmFtcyIsImZyb21TdGF0ZSIsImZyb21QYXJhbXMiLCJlcnJvciIsImdvIiwicHJldmlvdXMiLCJwcmV2UGFyYW1zIiwic2V0U2lkZWJhclN0YXR1cyIsInJ1biIsIiRodHRwIiwiJHEiLCJ1c2VyU2VydmljZSIsImlkZW50aXR5U2VydmljZSIsIm5vdGlmeVNlcnZpY2UiLCJhdXRoZW50aWNhdGVVc2VyIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsImRmZCIsImRlZmVyIiwicG9zdCIsInRoZW4iLCJyZXNwb25zZSIsImRhdGEiLCJzdWNjZXNzIiwiY3VycmVudFVzZXIiLCJtZXNzYWdlIiwicHJvbWlzZSIsImNyZWF0ZVVzZXIiLCJ1c2VyRGF0YSIsInJlYXNvbiIsImxvZ291dCIsInVuZGVmaW5lZCIsInJvbGUiLCJpc0F1dGhvcml6ZWQiLCJyZWplY3QiLCJpc0F1dGhlbnRpY2F0ZWQiLCJzZXJ2aWNlIiwiZmFjdG9yeSIsImdldEFsbFVzZXJzIiwidXNlcnMiLCJ2ZXJpZnlVc2VyIiwidXNlcklkIiwidmVyaWZpY2F0aW9uVG9rZW4iLCJwYXJhbXMiLCJMb2dpbkN0cmwiLCJhY3RpdmF0ZSIsImxvZ2luIiwidm0iLCJSZWdpc3RlckN0cmwiLCJyZWdpc3RlciIsIm5ld1VzZXIiLCJjb25maXJtUGFzc3dvcmQiLCJWZXJpZmljYXRpb25DdHJsIiwiJHN0YXRlUGFyYW1zIiwidmVyaWZ5aW5nIiwidmVyaWZpZWQiLCJrcEFjdGl2ZUNoYWxsZW5lZ2VzIiwiZGlyZWN0aXZlIiwiYmluZFRvQ29udHJvbGxlciIsImN0cmxGdW5jIiwicmVzdHJpY3QiLCJzY29wZSIsImNvbXBldGl0aW9uSWQiLCIkc2NvcGUiLCJjaGFsbGVuZ2VzU2VydmljZSIsImdldEFjdGl2ZUNoYWxsZW5nZXMiLCJjaGFsbGVuZ2VzIiwiZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24iLCJsZW5ndGgiLCJfIiwiZm9yRWFjaCIsImNoYWxsZW5nZSIsInRpbWVMaW1pdCIsImV4cGlyZXMiLCJtb21lbnQiLCJkaWZmIiwiY3JlYXRlZCIsImFkZCIsImNoYWxsZW5nZURldGFpbHMiLCJrcENvbXBsZXRlZENoYWxsZW5lZ2VzIiwibGltaXQiLCJnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzIiwiZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24iLCJsb3NlciIsIndpbm5lciIsIndoZW5Db21wbGV0ZWQiLCJjb21wbGV0ZWQiLCJjYWxlbmRhciIsInNhbWVEYXkiLCJuZXh0RGF5IiwibmV4dFdlZWsiLCJsYXN0RGF5IiwibGFzdFdlZWsiLCJzYW1lRWxzZSIsImtwUGxheWVyT3ZlcmFsbFJlc3VsdHMiLCJwbGF5ZXIiLCJnZXRQbGF5ZXJPdmVyYWxsUmVzdWx0cyIsIl9pZCIsInBsYXllcklkIiwiZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb24iLCJyZXN1bHRzIiwiYnJlYWtQb2ludHMiLCJpIiwibWF4TGV2ZWxzIiwicHVzaCIsImxldmVsIiwiaiIsInBvc2l0aW9uIiwiaW5kZXhPZiIsInN0cmVha1R5cGUiLCJzdHJlYWsiLCJjb250aW51ZVN0cmVhayIsImNoYWxsZW5nZXIiLCJvcHBvbmVudCIsInR5cGUiLCJ2YWx1ZSIsIndpbnMiLCJhc09wcG9uZW50Iiwic2l6ZSIsImZpbHRlciIsImFzQ2hhbGxlbmdlciIsInRvdGFsIiwiYnlGb3JmZWl0IiwiZm9yZmVpdCIsImxvc2VzIiwiY3JlYXRlQ2hhbGxlbmdlIiwiY29tcGxldGVDaGFsbGVuZ2UiLCJnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbiIsImdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllciIsImRlbGV0ZUFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllciIsImRlbGV0ZSIsImtwRm9vdGVyIiwiaW5kZW50aXR5Iiwia3BIZWFkZXIiLCJ0b2dnbGVTaWRlYmFyIiwic2lkZWJhclN0YXR1cyIsImxlZnQiLCJnZXRTaWRlYmFyU3RhdHVzIiwia3BTaWRlYmFyIiwib3JkZXJPYmplY3RCeSIsImlucHV0IiwiYXR0cmlidXRlIiwiaXNPYmplY3QiLCJhcnJheSIsIm9iamVjdEtleSIsInNvcnQiLCJhIiwiYiIsInBhcnNlSW50IiwiSG9tZUN0cmwiLCIkd2luZG93Iiwicm9sZXMiLCJib290c3RyYXBwZWRVc2VyT2JqZWN0IiwiaW5mbyIsInRhcmdldCIsIiQiLCJub3RpZnkiLCJ3YXJuaW5nIiwiaW52ZXJzZSIsIm5vdGlmeURlZmF1bHRzIiwibmV3ZXN0X29uX3RvcCIsIm9mZnNldCIsIngiLCJ5Iiwic2Nyb2xsYmFyU2VydmljZSIsIm1hbGlodVNjcm9sbCIsInNlbGVjdG9yIiwidGhlbWUiLCJzY3JvbGxheGlzIiwibW91c2V3aGVlbGF4aXMiLCJtQ3VzdG9tU2Nyb2xsYmFyIiwic2Nyb2xsSW5lcnRpYSIsImF4aXMiLCJtb3VzZVdoZWVsIiwiZW5hYmxlIiwicHJldmVudERlZmF1bHQiLCJzdGF0dXMiLCJyaWdodCIsIndlYnNvY2tldEhvc3QiLCJsb2NhdGlvbiIsInByb3RvY29sIiwiaG9zdCIsImNvbm5lY3Rpb24iLCJjb25uZWN0IiwiV2ViU29ja2V0Iiwib25tZXNzYWdlIiwiZSIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCIkYnJvYWRjYXN0IiwidG9waWMiLCJzZW5kIiwianNvbiIsInN0cmluZ2lmeSIsIndlYnNvY2tldFNlcnZpY2UiLCJweXJhbWlkc1NlcnZpY2UiLCJnZXRQeXJhbWlkIiwiZ2V0UHlyYW1pZHNGb3JVc2VyIiwiZ2V0UHlyYW1pZHMiLCJjcmVhdGVQeXJhbWlkIiwicHlyYW1pZCIsInVwZGF0ZVB5cmFtaWQiLCJzd2FwUG9zaXRpb25zIiwiYWRkUGxheWVyVG9QeXJhbWlkIiwiYWRkUGxheWVyVG9QeXJhbWlkUmVxdWVzdCIsImNvbXBldGl0aW9uIiwicmVtb3ZlZFBsYXllckZyb21QeXJhbWlkIiwicmVtb3ZlZFBsYXllciIsInBsYXllcnMiLCJhcHByb3ZlUGVuZGluZ1BsYXllciIsImRlbnlQZW5kaW5nUGxheWVyIiwia3BQZW5kaW5nUGxheWVycyIsInBlbmRpbmdQbGF5ZXJzIiwia3BQeXJhbWlkQ29tcGFjdCIsInB5cmFtaWRzIiwia3BQeXJhbWlkIiwicmVwbGFjZSIsIiRmaWx0ZXIiLCJtYXhQbGF5ZXJzIiwib3JkZXJQbGF5ZXJzIiwiZ2V0UGxheWVyc1N0YXR1cyIsImFzc2lnbkxldmVsc1RvUGxheWVycyIsImNhbGN1bGF0ZVB5cmFtaWRCbG9ja3MiLCJmaWxsSW5FbXB0eUJsb2NrcyIsImN1cnJlbnRVc2VySXNPd25lciIsInNvbWUiLCJvd25lcnMiLCJjdXJyZW50VXNlcklzT25QeXJhbWlkIiwiaGFzQWN0aXZlQ2hhbGxlbmdlIiwiY2xhc3MiLCJjdXJyZW50VXNlclBsYXllciIsImN1cnJlbnRVc2VySXNQZW5kaW5nIiwiZmluZCIsInRpbWVUb0V4cGlyZSIsImZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzIiwiY3JlYXRlQnJlYWtQb2ludHMiLCJsZXZlbHMiLCJudW1iZXJPZkJsb2NrcyIsImxhc3QiLCJudW1iZXJPZlJlYWxQbGF5ZXJzIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJsZXZlbEFib3ZlIiwiYXZhaWxhYmxlQ2hhbGxlbmdlcyIsImF2YWlsYWJsZSIsImNvbXBldGl0aW9uTmFtZSIsIm5hbWUiLCJjb21wbGV0ZSIsImZvcmZlaXREYXlzIiwiZW1haWwiLCJweXJhbWlkTWVudVRvZ2dsZSIsIndpbm5lcklzQ3VycmVudFVzZXIiLCJmb3JmZWl0TG9zZXIiLCJyZW1vdmluZ0N1cnJlbnRVc2VyIiwicmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCIsImNoYWxsZW5nZUV4cGlyZWQiLCJhZGRDdXJyZW50VXNlclRvUHlyYW1pZCIsIm9wZW4iLCJzd2FsIiwidGl0bGUiLCJ0ZXh0Iiwic2hvd0NhbmNlbEJ1dHRvbiIsImNvbmZpcm1CdXR0b25UZXh0IiwiY2FuY2VsQnV0dG9uVGV4dCIsImNsb3NlT25Db25maXJtIiwiY2xvc2VPbkNhbmNlbCIsImNvbmZpcm1SZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkIiwiY29uZmlybUJ1dHRvbkNsYXNzIiwicCIsIm9wZW5Qb3NpdGlvbiIsInJlbW92ZSIsInVwZGF0ZWRQbGF5ZXJzIiwidXBkYXRlZFBsYXllciIsInJlZnJlc2hQeXJhbWlkIiwiZGVzY3JpcHRpb24iLCJkZXRhaWxzIiwia3BVcGRhdGVQbGF5ZXJzIiwicmVtb3ZlZFBsYXllcnMiLCJjYW5jZWxVcGRhdGUiLCJyZW9yZGVyUGxheWVycyIsInJlbW92ZVBsYXllciIsInBsYXllckluZGV4Iiwic3BsaWNlIiwiQWRtaW5DdHJsIiwidXBkYXRlUHlyYW1pZE9wZW5TdGF0dXMiLCJ1cGRhdGVkUHlyYW1pZCIsIkNyZWF0ZVB5cmFtaWRDdHJsIiwiYXZhaWxhYmxlUGxheWVycyIsImFkZFBsYXllciIsImFkZGVkUGxheWVycyIsIm5ld1B5cmFtaWQiLCJNeVB5cmFtaWRzQ3RybCIsIlB5cmFtaWRDdHJsIiwiUHlyYW1pZHNDdHJsIiwiU3RhdHNDdHJsIiwiY092ZXJmbG93IiwibGlua0Z1bmMiLCJlbGVtZW50IiwiYXR0cnMiLCJoYXNDbGFzcyIsImxpbmsiLCJ0b2dnbGVTdWJtZW51IiwiZWwiLCJjbGljayIsIm5leHQiLCJzbGlkZVRvZ2dsZSIsInBhcmVudCIsInRvZ2dsZUNsYXNzIiwid2F2ZXNFZmZlY3QiLCJXYXZlcyIsImF0dGFjaCIsImluaXQiLCJmZ0xpbmUiLCJjaGlsZHJlbiIsImZpcnN0IiwiaXNGbG9hdExhYmVsIiwiZm9jdXMiLCJhZGRDbGFzcyIsImJsdXIiLCJ2YWwiLCJyZW1vdmVDbGFzcyJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQUFDLE9BQUEsT0FDQSxZQUNBLGVBQ0EsWUFDQSxzQkFDQSxhQUNBLHdCQUNBLFFBQ0EscUJBQ0EsMEJDVEEsd0JBSUEsU0FBQUMsR0FBQUMsRUFBQUMsR0FFQUQsRUFBQUUsU0FBQUMsUUFBQUMsTUFDQUosRUFBQUUsU0FBQUMsUUFBQUMsUUFHQUosRUFBQUUsU0FBQUMsUUFBQUMsSUFBQSxxQkFBQSxnQ0FFQUosRUFBQUUsU0FBQUMsUUFBQUMsSUFBQSxpQkFBQSxXQUNBSixFQUFBRSxTQUFBQyxRQUFBQyxJQUFBLE9BQUEsV0FFQUgsRUFBQUksU0FBQUMsY0FBQSxzREFiQVQsUUFBQUMsT0FBQSxPQUFBUyxPQUFBUixNQ0ZBLHVCQUlBLFNBQUFTLEdBQUFDLEVBQUFDLEdBUUEsUUFBQUMsR0FBQUMsR0FDQUYsRUFBQUcsSUFBQSxnQkFBQUQsR0FSQSxHQUFBRSxHQUFBQyxJQUVBRCxHQUFBTCxPQUFBQSxFQUVBSyxFQUFBRSxZQUFBTixFQUFBTixJQUFBLGlCQUNBVSxFQUFBSCxvQkFBQUEsNkNBUkFkLFFBQUFDLE9BQUEsT0FBQW1CLFdBQUEsVUFBQVQsTUNGQSx1QkFJQSxTQUFBVSxHQUFBQyxFQUFBQyxFQUFBQyxHQUNBLEdBQUFDLElBQ0FDLFdBQUFDLEVBQ0FDLE1BQUFDLEVBQ0FDLEtBQUFDLEVBR0FQLEdBQUFRLFdBQUEsR0FHQVQsRUFBQVUsVUFBQSxLQUVBVixFQUFBVyxL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RCxFQUFBRSxPQUFBQyxZQUFBLEtBQ0FILEVBQUFJLFNBQUFDLFlBQUEsYUFWQSxHQUFBM1AsSUFDQUcsU0FBQSxJQUNBaVAsS0FBQUosRUFHQSxPQUFBaFAsR0FWQS9HLFFBQ0FDLE9BQUEsT0FDQThHLFVBQUEsZ0JBQUFxUCxNQ0pBLFdBQ0EsWUFLQSxTQUFBTyxLQVFBLFFBQUFaLEdBQUE1TyxFQUFBNk8sR0FDQUEsRUFBQUUsU0FBQSxhQUFBRixFQUFBRSxTQUFBLGFBQ0FVLE1BQUFDLE9BQUFiLEdBQUEsaUJBQ0FBLEVBQUFFLFNBQUEsYUFDQVUsTUFBQUMsT0FBQWIsR0FBQSxnQkFFQVksTUFBQUMsT0FBQWIsR0FHQVksTUFBQUUsT0FoQkEsR0FBQS9QLElBQ0FHLFNBQUEsSUFDQWlQLEtBQUFKLEVBR0EsT0FBQWhQLEdBVkEvRyxRQUNBQyxPQUFBLE9BQ0E4RyxVQUFBLGNBQUE0UCxNQ0pBLFdBQ0EsWUFLQSxTQUFBSSxLQVFBLFFBQUFoQixHQUFBNU8sRUFBQTZPLEdBQ0EsR0FBQTlKLEdBQUE4SixFQUFBZ0IsV0FBQUMsUUFDQUMsRUFBQWxCLEVBQUFTLFNBQUFQLFNBQUEsV0FDQWhLLEdBQUFpTCxNQUFBLFdBQ0FuQixFQUFBb0IsU0FBQSxnQkFHQWxMLEVBQUFtTCxLQUFBLGFBQ0FILEdBQUFBLEdBQUEsSUFBQWhMLEVBQUFvTCxNQUFBNVAsU0FDQXNPLEVBQUF1QixZQUFBLGdCQWhCQSxHQUFBeFEsSUFDQUcsU0FBQSxJQUNBaVAsS0FBQUosRUFHQSxPQUFBaFAsR0FWQS9HLFFBQ0FDLE9BQUEsT0FDQThHLFVBQUEsU0FBQWdRIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICd1aS5yb3V0ZXInLFxuICAndWkuYm9vdHN0cmFwJyxcbiAgJ25nQW5pbWF0ZScsXG4gICdhbmd1bGFyLWxvYWRpbmctYmFyJyxcbiAgJ25vdWlzbGlkZXInLFxuICAnbG9jYWx5dGljcy5kaXJlY3RpdmVzJyxcbiAgJ3RpbWVyJyxcbiAgJ0xvY2FsU3RvcmFnZU1vZHVsZScsXG4gICdhbmd1bGFyLXNvcnRhYmxlLXZpZXcnXG5dKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCAnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29uZmlnKGNvbmZpZ3VyYXRpb24pO1xuXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyYXRpb24oJGh0dHBQcm92aWRlciwgJHVpYlRvb2x0aXBQcm92aWRlcikge1xuICAgIC8vaW5pdGlhbGl6ZSBnZXQgaWYgbm90IHRoZXJlXG4gICAgaWYgKCEkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0KSB7XG4gICAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0ID0ge307ICAgIFxuICAgIH0gICAgXG4gICAgLy9kaXNhYmxlIElFIGFqYXggcmVxdWVzdCBjYWNoaW5nXG4gICAgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldFsnSWYtTW9kaWZpZWQtU2luY2UnXSA9ICdGcmksIDAxIEphbiAyMDE2IDA1OjAwOjAwIEdNVCc7XG4gICAgLy8gZXh0cmFcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0WydDYWNoZS1Db250cm9sJ10gPSAnbm8tY2FjaGUnO1xuICAgICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXRbJ1ByYWdtYSddID0gJ25vLWNhY2hlJztcblxuICAgICR1aWJUb29sdGlwUHJvdmlkZXIub3B0aW9ucyh7IGFwcGVuZFRvQm9keTogdHJ1ZSB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdBcHBDdHJsJywgQXBwQ3RybCk7XG5cbiAgZnVuY3Rpb24gQXBwQ3RybCgkc3RhdGUsIGxvY2FsU3RvcmFnZVNlcnZpY2UpIHtcbiAgICB2YXIgYXBwQ3RybCA9IHRoaXM7XG4gICAgLy8gVXNlIHRoaXMgZm9yIFNpZGViYXIgbWVudVxuICAgIGFwcEN0cmwuJHN0YXRlID0gJHN0YXRlO1xuICAgIC8vIExvY2sgdGhlIHNpZGViYXIgaW4gdmlld1xuICAgIGFwcEN0cmwubG9ja1NpZGViYXIgPSBsb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldCgnc2lkZWJhckxvY2tlZCcpO1xuICAgIGFwcEN0cmwudG9nZ2xlU2lkZWJhckxvY2tlZCA9IHRvZ2dsZVNpZGViYXJMb2NrZWQ7XG5cbiAgICBmdW5jdGlvbiB0b2dnbGVTaWRlYmFyTG9ja2VkKGxvY2tlZCkge1xuICAgICAgbG9jYWxTdG9yYWdlU2VydmljZS5zZXQoJ3NpZGViYXJMb2NrZWQnLCBsb2NrZWQpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb25maWcoY29uZmlndXJlUm91dGVzKTtcblxuICBmdW5jdGlvbiBjb25maWd1cmVSb3V0ZXMoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICB2YXIgcm91dGVSb2xlQ2hlY2tzID0ge1xuICAgICAgc3VwZXJBZG1pbjogcmVxdWlyZVN1cGVyQWRtaW4sXG4gICAgICBhZG1pbjogcmVxdWlyZUFkbWluLFxuICAgICAgdXNlcjogcmVxdWlyZUF1dGhcbiAgICB9O1xuXG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgLy8gZm9yIGFueSB1bm1hdGNoZWQgdXJsXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLndoZW4oJy9weXJhbWlkcy8nLCAnL3B5cmFtaWRzJyk7XG5cbiAgICAkc3RhdGVQcm92aWRlclxuICAgICAgLnN0YXRlKCdob21lJywge1xuICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbW1vbi92aWV3cy9ob21lLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMnLCB7XG4gICAgICAgIHVybDogJy9weXJhbWlkcycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHlyYW1pZHNDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvcHlyYW1pZHMuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy5teVB5cmFtaWRzJywge1xuICAgICAgICB1cmw6ICcvbXktcHlyYW1pZHMnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNeVB5cmFtaWRzQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL215LXB5cmFtaWRzLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLnZpZXcnLCB7XG4gICAgICAgIHVybDogJy92aWV3Lzpjb21wZXRpdGlvbklkJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHlyYW1pZEN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9weXJhbWlkLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMuc3RhdHMnLCB7XG4gICAgICAgIHVybDogJy9zdGF0cy86Y29tcGV0aXRpb25JZCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0YXRzQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL3N0YXRzLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMuYWRtaW4nLCB7XG4gICAgICAgIHVybDogJy9hZG1pbi86Y29tcGV0aXRpb25JZCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0FkbWluQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL2FkbWluLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLmNyZWF0ZScsIHtcbiAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0NyZWF0ZVB5cmFtaWRDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvY3JlYXRlLXB5cmFtaWQuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICBhdXRoOiByb3V0ZVJvbGVDaGVja3MudXNlclxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvbG9naW4uaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdyZWdpc3RlcicsIHtcbiAgICAgICAgdXJsOiAnL3JlZ2lzdGVyJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy9yZWdpc3Rlci5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3ZlcmlmeScsIHtcbiAgICAgICAgdXJsOiAnL3ZlcmlmaWNhdGlvbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVmVyaWZpY2F0aW9uQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3ZlcmlmaWNhdGlvbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3ZlcmlmaWNhdGlvbicsIHtcbiAgICAgICAgdXJsOiAnL3ZlcmlmaWNhdGlvbi86dXNlcklkLzp2ZXJpZmljYXRpb25Ub2tlbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVmVyaWZpY2F0aW9uQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3ZlcmlmaWNhdGlvbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cblxuICByZXF1aXJlQWRtaW4uJGluamVjdCA9IFsnYXV0aFNlcnZpY2UnXTtcblxuICBmdW5jdGlvbiByZXF1aXJlQWRtaW4oYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSgnYWRtaW4nKTtcbiAgfVxuXG4gIHJlcXVpcmVTdXBlckFkbWluLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZVN1cGVyQWRtaW4oYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSgnc3VwZXItYWRtaW4nKTtcbiAgfVxuXG4gIHJlcXVpcmVBdXRoLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZUF1dGgoYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLnJ1bihhcHBSdW4pO1xuXG4gIGZ1bmN0aW9uIGFwcFJ1bigkcm9vdFNjb3BlLCAkc3RhdGUsIHNpZGViYXJTZXJ2aWNlKSB7XG4gICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZUVycm9yJywgZnVuY3Rpb24gKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCBlcnJvcikge1xuICAgICAgaWYgKGVycm9yID09PSAnbm90IGF1dGhvcml6ZWQnKSB7XG4gICAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcbiAgICAgICAgJHN0YXRlLnByZXZpb3VzID0gdG9TdGF0ZTtcbiAgICAgICAgJHN0YXRlLnByZXZQYXJhbXMgPSB0b1BhcmFtcztcbiAgICAgIH1cbiAgICB9KTtcblxuICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHNpZGViYXJTZXJ2aWNlLnNldFNpZGViYXJTdGF0dXMoZmFsc2UpO1xuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ2F1dGhTZXJ2aWNlJywgYXV0aFNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIGF1dGhTZXJ2aWNlKCRzdGF0ZSwgJGh0dHAsICRxLCB1c2VyU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBhdXRoZW50aWNhdGVVc2VyOiBhdXRoZW50aWNhdGVVc2VyLFxuICAgICAgY3JlYXRlVXNlcjogY3JlYXRlVXNlcixcbiAgICAgIGxvZ291dDogbG9nb3V0LFxuICAgICAgYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZTogYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSxcbiAgICAgIGF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGU6IGF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGVcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gYXV0aGVudGljYXRlVXNlcih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xuICAgICAgJGh0dHAucG9zdCgnL2xvZ2luJywge1xuICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3VjY2Vzcykge1xuICAgICAgICAgIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlciA9IHJlc3BvbnNlLmRhdGEudXNlcjtcbiAgICAgICAgICBkZmQucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UgPT09ICd1bnZlcmlmaWVkJykge1xuICAgICAgICAgIGRmZC5yZXNvbHZlKCd1bnZlcmlmaWVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVVc2VyKHVzZXJEYXRhKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG4gICAgICAgIHVzZXJEYXRhOiB1c2VyRGF0YVxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICBkZmQucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkZmQucmVzb2x2ZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5yZWFzb24gPT09ICdFcnJvcjogRHVwbGljYXRlIFVzZXJuYW1lJykge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1NvcnJ5LCBhbiBhY2NvdW50IGFscmVhZHkgZXhpc3RzIHdpdGggdGhhdCBlbWFpbCBhZGRyZXNzLicpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9sb2dvdXQnLCB7XG4gICAgICAgIGxvZ291dDogdHJ1ZVxuICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgZGZkLnJlc29sdmUoKTtcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlKHJvbGUpIHtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRob3JpemVkKHJvbGUpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICRxLnJlamVjdCgnbm90IGF1dGhvcml6ZWQnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlKCkge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoJ25vdCBhdXRob3JpemVkJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ3VzZXJTZXJ2aWNlJywgdXNlclNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHVzZXJTZXJ2aWNlKCRodHRwKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBnZXRBbGxVc2VyczogZ2V0QWxsVXNlcnMsXG4gICAgICB2ZXJpZnlVc2VyOiB2ZXJpZnlVc2VyXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGdldEFsbFVzZXJzKCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIHJldHVybiB1c2VycztcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZlcmlmeVVzZXIodXNlcklkLCB2ZXJpZmljYXRpb25Ub2tlbikge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VyL3ZlcmlmaWNhdGlvbicsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgdXNlcklkOiB1c2VySWQsXG4gICAgICAgICAgdmVyaWZpY2F0aW9uVG9rZW46IHZlcmlmaWNhdGlvblRva2VuXG4gICAgICAgIH1cbiAgICAgIH0pOyAgXG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIExvZ2luQ3RybCk7XG5cbiAgZnVuY3Rpb24gTG9naW5DdHJsKCRzdGF0ZSwgYXV0aFNlcnZpY2UsIG5vdGlmeVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmxvZ2luID0gbG9naW47XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICBhdXRoU2VydmljZS5hdXRoZW50aWNhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1VzZXJuYW1lIC8gcGFzc3dvcmQgY29tYmluYWl0b24gaW5jb3JyZWN0Jyk7XG4gICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UgPT09ICd1bnZlcmlmaWVkJykge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1lvdSBtdXN0IHZlcmlmeSB5b3VyIGVtYWlsIGJlZm9yZSB5b3UgY2FuIGxvZ2luJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKCRzdGF0ZS5wcmV2aW91cykge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCRzdGF0ZS5wcmV2aW91cywgJHN0YXRlLnByZXZQYXJhbXMpO1xuICAgICAgICAgICAgJHN0YXRlLnByZXZpb3VzID0gbnVsbDtcbiAgICAgICAgICAgICRzdGF0ZS5wcmV2UGFyYW1zID0gbnVsbDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJywgUmVnaXN0ZXJDdHJsKTtcblxuICBmdW5jdGlvbiBSZWdpc3RlckN0cmwoJHN0YXRlLCBhdXRoU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucmVnaXN0ZXIgPSByZWdpc3RlcjtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHt9XG5cbiAgICBmdW5jdGlvbiByZWdpc3RlcihuZXdVc2VyKSB7XG4gICAgICBpZiAobmV3VXNlci5wYXNzd29yZCAhPT0gbmV3VXNlci5jb25maXJtUGFzc3dvcmQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignUGFzc3dvcmRzIGRvblxcJ3QgbWF0Y2ghJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhdXRoU2VydmljZS5jcmVhdGVVc2VyKG5ld1VzZXIpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICRzdGF0ZS5nbygndmVyaWZ5Jyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdWZXJpZmljYXRpb25DdHJsJywgVmVyaWZpY2F0aW9uQ3RybCk7XG5cbiAgZnVuY3Rpb24gVmVyaWZpY2F0aW9uQ3RybCgkc3RhdGUsICRzdGF0ZVBhcmFtcywgdXNlclNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnZlcmlmaWVkID0gdW5kZWZpbmVkO1xuICAgIHZtLnZlcmlmeWluZyA9IGZhbHNlO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy51c2VySWQgJiYgJHN0YXRlUGFyYW1zLnZlcmlmaWNhdGlvblRva2VuKSB7XG4gICAgICAgIHZtLnZlcmlmeWluZyA9IHRydWU7XG4gICAgICAgIHZtLnZlcmlmaWVkID0gbnVsbDtcbiAgICAgICAgdXNlclNlcnZpY2UudmVyaWZ5VXNlcigkc3RhdGVQYXJhbXMudXNlcklkLCAkc3RhdGVQYXJhbXMudmVyaWZpY2F0aW9uVG9rZW4pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICAgIHZtLnZlcmlmaWVkID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdm0udmVyaWZpZWQgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BBY3RpdmVDaGFsbGVuZWdlcycsIGtwQWN0aXZlQ2hhbGxlbmVnZXMpO1xuXG4gIGZ1bmN0aW9uIGtwQWN0aXZlQ2hhbGxlbmVnZXMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jaGFsbGVuZ2VzL2NvbXBvbmVudHMvYWN0aXZlLWNoYWxsZW5nZXMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlcygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZXMoKSB7XG4gICAgICB2bS5jaGFsbGVuZ2VzID0gW107XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIGlmIChjaGFsbGVuZ2VzLmRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZtLmNoYWxsZW5nZXMgPSBjaGFsbGVuZ2VzLmRhdGE7XG4gICAgICAgICAgXy5mb3JFYWNoKHZtLmNoYWxsZW5nZXMsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICAgIGlmIChjaGFsbGVuZ2UudGltZUxpbWl0ICE9PSAwKSB7XG4gICAgICAgICAgICAgIGNoYWxsZW5nZS5leHBpcmVzID0gKG1vbWVudCgpLmRpZmYobW9tZW50KGNoYWxsZW5nZS5jcmVhdGVkKS5hZGQoY2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2QnKSwncycpKSAqIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NyZWF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIGdldEFjdGl2ZUNoYWxsZW5nZXMoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpweXJhbWlkX3VwZGF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twQ29tcGxldGVkQ2hhbGxlbmVnZXMnLCBrcENvbXBsZXRlZENoYWxsZW5lZ2VzKTtcblxuICBmdW5jdGlvbiBrcENvbXBsZXRlZENoYWxsZW5lZ2VzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogJ0AnLFxuICAgICAgICBsaW1pdDogJ0AnXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY2hhbGxlbmdlcy9jb21wb25lbnRzL2NvbXBsZXRlZC1jaGFsbGVuZ2VzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKCRzY29wZSwgY2hhbGxlbmdlc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNoYWxsZW5nZXMgPSBbXTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGdldENvbXBsZXRlZENoYWxsZW5nZXMoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzKCkge1xuICAgICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCwgdm0ubGltaXQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZXMpIHtcbiAgICAgICAgaWYgKGNoYWxsZW5nZXMuZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdm0uY2hhbGxlbmdlcyA9IGNoYWxsZW5nZXMuZGF0YTtcbiAgICAgICAgICBfLmZvckVhY2godm0uY2hhbGxlbmdlcywgZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmxvc2VyID0gY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInID8gJ29wcG9uZW50JyA6ICdjaGFsbGVuZ2VyJztcbiAgICAgICAgICAgIGNoYWxsZW5nZS53aGVuQ29tcGxldGVkID0gbW9tZW50KGNoYWxsZW5nZS5jb21wbGV0ZWQpLmNhbGVuZGFyKG51bGwsIHtcbiAgICAgICAgICAgICAgc2FtZURheTogJ1tUb2RheV0nLFxuICAgICAgICAgICAgICBuZXh0RGF5OiAnW1RvbW9ycm93XScsXG4gICAgICAgICAgICAgIG5leHRXZWVrOiAnZGRkZCcsXG4gICAgICAgICAgICAgIGxhc3REYXk6ICdbWWVzdGVyZGF5XScsXG4gICAgICAgICAgICAgIGxhc3RXZWVrOiAnW0xhc3RdIGRkZGQnLFxuICAgICAgICAgICAgICBzYW1lRWxzZTogJ0REL01NL1lZWVknXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jb21wbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twUGxheWVyT3ZlcmFsbFJlc3VsdHMnLCBrcFBsYXllck92ZXJhbGxSZXN1bHRzKTtcblxuICBmdW5jdGlvbiBrcFBsYXllck92ZXJhbGxSZXN1bHRzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogJ0AnLFxuICAgICAgICBwbGF5ZXI6ICc9J1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NoYWxsZW5nZXMvY29tcG9uZW50cy9wbGF5ZXItb3ZlcmFsbC1yZXN1bHRzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGNoYWxsZW5nZXNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5tYXhMZXZlbHMgPSAxMDtcbiAgICB2bS53aW5zID0ge1xuICAgICAgdG90YWw6IDAsXG4gICAgICBhc0NoYWxsZW5nZXI6IDAsXG4gICAgICBhc09wcG9uZW50OiAwLFxuICAgICAgYnlGb3JmZWl0OiAwXG4gICAgfTtcbiAgICB2bS5sb3NlcyA9IHtcbiAgICAgIHRvdGFsOiAwLFxuICAgICAgYXNDaGFsbGVuZ2VyOiAwLFxuICAgICAgYXNPcHBvbmVudDogMCxcbiAgICAgIGJ5Rm9yZmVpdDogMFxuICAgIH07XG4gICAgdm0uc3RyZWFrID0ge1xuICAgICAgdHlwZTogbnVsbCxcbiAgICAgIHZhbHVlOiAwXG4gICAgfTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGdldFBsYXllck92ZXJhbGxSZXN1bHRzKHZtLmNvbXBldGl0aW9uSWQsIHZtLnBsYXllci5faWQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFBsYXllck92ZXJhbGxSZXN1bHRzKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRQbGF5ZXJSZXN1bHRzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkudGhlbihmdW5jdGlvbiAocmVzdWx0cykge1xuXG4gICAgICAgIC8vIERldGVybWluZSBhbGwgdGhlIGJyZWFrIHBvaW50cyB0byBmaWd1cmUgb3V0IGxldmVsc1xuICAgICAgICB2YXIgYnJlYWtQb2ludHMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2bS5tYXhMZXZlbHM7IGkrKykge1xuICAgICAgICAgIGJyZWFrUG9pbnRzLnB1c2goKCgoaSAqIChpICsgMSkpIC8gMikpICsgMSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZhdWx0IGFsbCBwbGF5ZXJzIHRvIHRoZSBsb3dlc3QgbGV2ZWxcbiAgICAgICAgdm0ucGxheWVyLmxldmVsID0gYnJlYWtQb2ludHMubGVuZ3RoO1xuICAgICAgICAvLyBOb3cgY2hlY2sgdG8gc2VlIGlmIHRoZSBwbGF5ZXIgaXMgYXQgYSBoaWdoZXIgbGV2ZWxcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBicmVha1BvaW50cy5sZW5ndGg7IGorKykge1xuICAgICAgICAgIGlmICh2bS5wbGF5ZXIucG9zaXRpb24gPCBicmVha1BvaW50c1tqICsgMV0pIHtcbiAgICAgICAgICAgIHZtLnBsYXllci5sZXZlbCA9IGJyZWFrUG9pbnRzLmluZGV4T2YoYnJlYWtQb2ludHNbal0pICsgMTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIHBsYXllcidzIGN1cnJlbnQgc3RyZWFrXG4gICAgICAgIHZhciBzdHJlYWsgPSAwO1xuICAgICAgICB2YXIgY29udGludWVTdHJlYWsgPSB0cnVlO1xuICAgICAgICB2YXIgc3RyZWFrVHlwZTtcbiAgICAgICAgXy5mb3JFYWNoKHJlc3VsdHMuZGF0YSwgZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgIGlmIChjb250aW51ZVN0cmVhaykge1xuICAgICAgICAgICAgLy8gV2lubmluZyBTdHJlYWtcbiAgICAgICAgICAgIGlmICgoY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInICYmIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVySWQpIHx8XG4gICAgICAgICAgICAgIChjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnICYmIGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkKSkge1xuICAgICAgICAgICAgICAvLyBJZiB0aGV5IGFyZSBub3QgYWxyZWFkeSBvbiBhIGxvc2luZyBzdHJlYWsgYW5kIDEgdG8gdGhlaXIgd2lubmluZyBzdHJlYWtcbiAgICAgICAgICAgICAgaWYgKHN0cmVha1R5cGUgIT09ICdsb3NpbmcnKSB7XG4gICAgICAgICAgICAgICAgc3RyZWFrICs9IDE7XG4gICAgICAgICAgICAgICAgc3RyZWFrVHlwZSA9ICd3aW5uaW5nJztcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZVN0cmVhayA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBMb3NpbmcgU3RyZWFrXG4gICAgICAgICAgICB9IGVsc2UgaWYgKChjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnICYmIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVySWQpIHx8XG4gICAgICAgICAgICAgIChjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcicgJiYgY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVySWQpKSB7XG4gICAgICAgICAgICAgIC8vIElmIHRoZXkgYXJlIG5vdCBhbHJlYWR5IG9uIGEgd2lubmluZyBzdHJlYWsgYW5kIDEgdG8gdGhlaXIgbG9zaW5nIHN0cmVha1xuICAgICAgICAgICAgICBpZiAoc3RyZWFrVHlwZSAhPT0gJ3dpbm5pbmcnKSB7XG4gICAgICAgICAgICAgICAgc3RyZWFrICs9IDE7XG4gICAgICAgICAgICAgICAgc3RyZWFrVHlwZSA9ICdsb3NpbmcnO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlU3RyZWFrID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdm0uc3RyZWFrID0ge1xuICAgICAgICAgICAgdHlwZTogc3RyZWFrVHlwZSxcbiAgICAgICAgICAgIHZhbHVlOiBzdHJlYWtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBGaWd1cmUgb3V0IHdpbnMgYW5kIGxvc2VzXG4gICAgICAgIHZtLndpbnMuYXNPcHBvbmVudCA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVySWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50J1xuICAgICAgICAgICk7XG4gICAgICAgIH0pKTtcblxuICAgICAgICB2bS53aW5zLmFzQ2hhbGxlbmdlciA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcidcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgdm0ud2lucy50b3RhbCA9IHZtLndpbnMuYXNDaGFsbGVuZ2VyICsgdm0ud2lucy5hc09wcG9uZW50O1xuXG4gICAgICAgIHZtLndpbnMuYnlGb3JmZWl0ID0gXy5zaXplKF8uZmlsdGVyKHJlc3VsdHMuZGF0YSwgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBjaGFsbGVuZ2UuZm9yZmVpdCAmJiAoKGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVySWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInKSB8fFxuICAgICAgICAgICAgKGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCcpKVxuICAgICAgICAgICk7XG4gICAgICAgIH0pKTtcblxuICAgICAgICB2bS5sb3Nlcy5hc09wcG9uZW50ID0gXy5zaXplKF8uZmlsdGVyKHJlc3VsdHMuZGF0YSwgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcidcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgdm0ubG9zZXMuYXNDaGFsbGVuZ2VyID0gXy5zaXplKF8uZmlsdGVyKHJlc3VsdHMuZGF0YSwgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCdcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgdm0ubG9zZXMudG90YWwgPSB2bS5sb3Nlcy5hc0NoYWxsZW5nZXIgKyB2bS5sb3Nlcy5hc09wcG9uZW50O1xuXG4gICAgICAgIHZtLmxvc2VzLmJ5Rm9yZmVpdCA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLmZvcmZlaXQgJiYgKChjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCcpIHx8XG4gICAgICAgICAgICAoY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVySWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInKSlcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnY2hhbGxlbmdlc1NlcnZpY2UnLCBjaGFsbGVuZ2VzU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gY2hhbGxlbmdlc1NlcnZpY2UoJGh0dHApIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGNyZWF0ZUNoYWxsZW5nZTogY3JlYXRlQ2hhbGxlbmdlLFxuICAgICAgY29tcGxldGVDaGFsbGVuZ2U6IGNvbXBsZXRlQ2hhbGxlbmdlLFxuICAgICAgZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyOiBnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIsXG4gICAgICBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbjogZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24sXG4gICAgICBkZWxldGVBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXI6IGRlbGV0ZUFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcixcbiAgICAgIGdldFBsYXllclJlc3VsdHNCeUNvbXBldGl0aW9uOiBnZXRQbGF5ZXJSZXN1bHRzQnlDb21wZXRpdGlvblxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYWxsZW5nZShjaGFsbGVuZ2UpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NoYWxsZW5nZXMvY3JlYXRlJywge1xuICAgICAgICBjaGFsbGVuZ2U6IGNoYWxsZW5nZVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jaGFsbGVuZ2VzL2NvbXBsZXRlJywgIHtcbiAgICAgICAgY2hhbGxlbmdlOiBjaGFsbGVuZ2VcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2FjdGl2ZS9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvYWN0aXZlL2NvbXBldGl0aW9uL3BsYXllcicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgcGxheWVySWQ6IHBsYXllcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENvbXBsZXRlZENoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQsIGxpbWl0KSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvY29tcGxldGVkL2NvbXBldGl0aW9uJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBsaW1pdDogbGltaXRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsZXRlQWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZGVsZXRlKCcvYXBpL2NoYWxsZW5nZXMvYWN0aXZlL2NvbXBldGl0aW9uL3BsYXllci9kZWxldGUnLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICAgIHBsYXllcklkOiBwbGF5ZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJSZXN1bHRzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL3Jlc3VsdHMvY29tcGV0aXRpb24vcGxheWVyJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBwbGF5ZXJJZDogcGxheWVySWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcEZvb3RlcicsIGtwRm9vdGVyKTtcblxuICBmdW5jdGlvbiBrcEZvb3RlcigpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbW1vbi9jb21wb25lbnRzL2Zvb3Rlci5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYyhpZGVudGl0eVNlcnZpY2UsIGF1dGhTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pbmRlbnRpdHkgPSBpZGVudGl0eVNlcnZpY2U7XG4gICAgdm0ubG9nb3V0ID0gbG9nb3V0O1xuXG4gICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcEhlYWRlcicsIGtwSGVhZGVyKTtcblxuICBmdW5jdGlvbiBrcEhlYWRlcigpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAnaGVhZGVyQ3RybCcsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY29tbW9uL2NvbXBvbmVudHMvaGVhZGVyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKHNpZGViYXJTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UsIGF1dGhTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pbmRlbnRpdHkgPSBpZGVudGl0eVNlcnZpY2U7XG4gICAgdm0ubG9nb3V0ID0gbG9nb3V0O1xuICAgIHZtLnNpZGViYXJTdGF0dXMgPSBzaWRlYmFyU2VydmljZS5nZXRTaWRlYmFyU3RhdHVzKCk7XG4gICAgdm0udG9nZ2xlU2lkZWJhciA9IHRvZ2dsZVNpZGViYXI7XG5cbiAgICBmdW5jdGlvbiB0b2dnbGVTaWRlYmFyKCkge1xuICAgICAgdm0uc2lkZWJhclN0YXR1cy5sZWZ0ID0gIXZtLnNpZGViYXJTdGF0dXMubGVmdDtcbiAgICAgIHNpZGViYXJTZXJ2aWNlLnNldFNpZGViYXJTdGF0dXModm0uc2lkZWJhclN0YXR1cy5sZWZ0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twU2lkZWJhcicsIGtwU2lkZWJhcik7XG5cbiAgZnVuY3Rpb24ga3BTaWRlYmFyKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICdzaWRlYmFyQ3RybCcsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY29tbW9uL2NvbXBvbmVudHMvc2lkZWJhci5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYyhpZGVudGl0eVNlcnZpY2UsIGF1dGhTZXJ2aWNlLCBzaWRlYmFyU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgIHZtLmxvZ291dCA9IGxvZ291dDtcbiAgICB2bS5zaWRlYmFyU3RhdHVzID0gc2lkZWJhclNlcnZpY2UuZ2V0U2lkZWJhclN0YXR1cygpO1xuXG4gICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZpbHRlcignb3JkZXJPYmplY3RCeScsIG9yZGVyT2JqZWN0QnkpO1xuXG4gIGZ1bmN0aW9uIG9yZGVyT2JqZWN0QnkoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChpbnB1dCwgYXR0cmlidXRlKSB7XG4gICAgICBpZiAoIWFuZ3VsYXIuaXNPYmplY3QoaW5wdXQpKSByZXR1cm4gaW5wdXQ7XG5cbiAgICAgIHZhciBhcnJheSA9IFtdO1xuICAgICAgZm9yICh2YXIgb2JqZWN0S2V5IGluIGlucHV0KSB7XG4gICAgICAgIGFycmF5LnB1c2goaW5wdXRbb2JqZWN0S2V5XSk7XG4gICAgICB9XG5cbiAgICAgIGFycmF5LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgYSA9IHBhcnNlSW50KGFbYXR0cmlidXRlXSk7XG4gICAgICAgIGIgPSBwYXJzZUludChiW2F0dHJpYnV0ZV0pO1xuICAgICAgICByZXR1cm4gYSAtIGI7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBhcnJheTtcbiAgICB9O1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0hvbWVDdHJsJywgSG9tZUN0cmwpO1xuXG4gIGZ1bmN0aW9uIEhvbWVDdHJsKCkge1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge31cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdpZGVudGl0eVNlcnZpY2UnLCBpZGVudGl0eVNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIGlkZW50aXR5U2VydmljZSgkd2luZG93KSB7XG4gICAgdmFyIGN1cnJlbnRVc2VyO1xuICAgIGlmICgkd2luZG93LmJvb3RzdHJhcHBlZFVzZXJPYmplY3QgIT09IG51bGwpIHtcbiAgICAgIGN1cnJlbnRVc2VyID0gJHdpbmRvdy5ib290c3RyYXBwZWRVc2VyT2JqZWN0O1xuICAgIH1cbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGN1cnJlbnRVc2VyOiBjdXJyZW50VXNlcixcbiAgICAgIGlzQXV0aGVudGljYXRlZDogaXNBdXRoZW50aWNhdGVkLFxuICAgICAgaXNBdXRob3JpemVkOiBpc0F1dGhvcml6ZWRcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gaXNBdXRoZW50aWNhdGVkKCkge1xuICAgICAgcmV0dXJuICEhdGhpcy5jdXJyZW50VXNlcjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0F1dGhvcml6ZWQocm9sZSkge1xuICAgICAgcmV0dXJuICEhdGhpcy5jdXJyZW50VXNlciAmJiB0aGlzLmN1cnJlbnRVc2VyLnJvbGVzLmluZGV4T2Yocm9sZSkgPiAtMTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnbm90aWZ5U2VydmljZScsIG5vdGlmeVNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIG5vdGlmeVNlcnZpY2UoKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBpbmZvOiBpbmZvLFxuICAgICAgc3VjY2Vzczogc3VjY2VzcyxcbiAgICAgIHdhcm5pbmc6IHdhcm5pbmcsXG4gICAgICBlcnJvcjogZXJyb3IsXG4gICAgICBpbnZlcnNlOiBpbnZlcnNlXG4gICAgfTtcblxuICAgICQubm90aWZ5RGVmYXVsdHMoe1xuICAgICAgbmV3ZXN0X29uX3RvcDogdHJ1ZSxcbiAgICAgIG9mZnNldDoge1xuICAgICAgICB4OiAyMCxcbiAgICAgICAgeTogODVcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gaW5mbyhtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnaW5mbydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Y2Nlc3MobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB3YXJuaW5nKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICd3YXJuaW5nJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXJyb3IobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ2RhbmdlcidcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGludmVyc2UobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ2ludmVyc2UnXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnc2Nyb2xsYmFyU2VydmljZScsIHNjcm9sbGJhclNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHNjcm9sbGJhclNlcnZpY2UoKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBtYWxpaHVTY3JvbGw6IG1hbGlodVNjcm9sbFxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIG1hbGlodVNjcm9sbChzZWxlY3RvciwgdGhlbWUsIHNjcm9sbGF4aXMsIG1vdXNld2hlZWxheGlzKSB7XG4gICAgICAkKHNlbGVjdG9yKS5tQ3VzdG9tU2Nyb2xsYmFyKHtcbiAgICAgICAgdGhlbWU6IHRoZW1lLFxuICAgICAgICBzY3JvbGxJbmVydGlhOiAxMDAsXG4gICAgICAgIGF4aXM6IHNjcm9sbGF4aXMsXG4gICAgICAgIG1vdXNlV2hlZWw6IHtcbiAgICAgICAgICBlbmFibGU6IHRydWUsXG4gICAgICAgICAgYXhpczogbW91c2V3aGVlbGF4aXMsXG4gICAgICAgICAgcHJldmVudERlZmF1bHQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmZhY3RvcnkoJ3NpZGViYXJTZXJ2aWNlJywgc2lkZWJhclNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHNpZGViYXJTZXJ2aWNlKCkge1xuICAgIHZhciBzaWRlYmFyU3RhdHVzID0ge1xuICAgICAgbGVmdDogZmFsc2UsXG4gICAgICByaWdodDogZmFsc2VcbiAgICB9O1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0U2lkZWJhclN0YXR1czogZ2V0U2lkZWJhclN0YXR1cyxcbiAgICAgIHNldFNpZGViYXJTdGF0dXM6IHNldFNpZGViYXJTdGF0dXNcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBnZXRTaWRlYmFyU3RhdHVzKCkge1xuICAgICAgcmV0dXJuIHNpZGViYXJTdGF0dXM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0U2lkZWJhclN0YXR1cyhzdGF0dXMpIHtcbiAgICAgIHNpZGViYXJTdGF0dXMubGVmdCA9IHN0YXR1cztcbiAgICB9XG4gIH1cbn0pKCk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gIC5zZXJ2aWNlKCd3ZWJzb2NrZXRTZXJ2aWNlJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICR3aW5kb3cpIHtcbiAgICBmdW5jdGlvbiB3ZWJzb2NrZXRIb3N0KCkge1xuICAgICAgaWYgKCR3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT09ICdodHRwczonKSB7XG4gICAgICAgIHJldHVybiAnd3NzOi8vJyArICR3aW5kb3cubG9jYXRpb24uaG9zdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAnd3M6Ly8nICsgJHdpbmRvdy5sb2NhdGlvbi5ob3N0O1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBjb25uZWN0aW9uO1xuICAgIHRoaXMuY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHdlYnNvY2tldEhvc3QoKSk7XG5cbiAgICAgIGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHBheWxvYWQgPSBKU09OLnBhcnNlKGUuZGF0YSk7XG4gICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudG9waWMsIHBheWxvYWQuZGF0YSk7XG4gICAgICB9O1xuICAgIH07XG5cbiAgICB0aGlzLnNlbmQgPSBmdW5jdGlvbiAodG9waWMsIGRhdGEpIHtcbiAgICAgIHZhciBqc29uID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICB0b3BpYzogdG9waWMsXG4gICAgICAgIGRhdGE6IGRhdGFcbiAgICAgIH0pO1xuICAgICAgY29ubmVjdGlvbi5zZW5kKGpzb24pO1xuICAgIH07XG4gIH0pLnJ1bihmdW5jdGlvbiAod2Vic29ja2V0U2VydmljZSkge1xuICAgIHdlYnNvY2tldFNlcnZpY2UuY29ubmVjdCgpO1xuICB9KTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdweXJhbWlkc1NlcnZpY2UnLCBweXJhbWlkc1NlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHB5cmFtaWRzU2VydmljZSgkaHR0cCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0UHlyYW1pZDogZ2V0UHlyYW1pZCxcbiAgICAgIGdldFB5cmFtaWRzRm9yVXNlcjogZ2V0UHlyYW1pZHNGb3JVc2VyLFxuICAgICAgZ2V0UHlyYW1pZHM6IGdldFB5cmFtaWRzLFxuICAgICAgY3JlYXRlUHlyYW1pZDogY3JlYXRlUHlyYW1pZCxcbiAgICAgIHVwZGF0ZVB5cmFtaWQ6IHVwZGF0ZVB5cmFtaWQsXG4gICAgICBzd2FwUG9zaXRpb25zOiBzd2FwUG9zaXRpb25zLFxuICAgICAgYWRkUGxheWVyVG9QeXJhbWlkOiBhZGRQbGF5ZXJUb1B5cmFtaWQsXG4gICAgICBhZGRQbGF5ZXJUb1B5cmFtaWRSZXF1ZXN0OiBhZGRQbGF5ZXJUb1B5cmFtaWRSZXF1ZXN0LFxuICAgICAgcmVtb3ZlZFBsYXllckZyb21QeXJhbWlkOiByZW1vdmVkUGxheWVyRnJvbVB5cmFtaWQsXG4gICAgICBhcHByb3ZlUGVuZGluZ1BsYXllcjogYXBwcm92ZVBlbmRpbmdQbGF5ZXIsXG4gICAgICBkZW55UGVuZGluZ1BsYXllcjogZGVueVBlbmRpbmdQbGF5ZXJcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGEgcHlyYW1pZCBmcm9tIHRoZSBkYXRhYmFzZSAob3IgbWVtb3J5KVxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHB5cmFtaWQgaWQgZm9yIHRoZSByZXF1ZXN0ZWQgcHlyYW1pZFxuICAgICAqIEByZXR1cm4ge09iamVjdH0gcHlyYW1pZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFB5cmFtaWQoY29tcGV0aXRpb25JZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9weXJhbWlkJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYWxsIHB5cmFtaWRzIGZyb20gdGhlIGRhdGFiYXNlIHRoYXQgYSBwYXJ0aWN1bGFyIHVzZXIgaXMgaW5jbHVkZWQgaW5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7dXNlcklkfSB0aGUgdXNlciBpZCBmb3IgdGhlIHJlcXVlc3RlZCB1c2VyXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBweXJhbWlkc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFB5cmFtaWRzRm9yVXNlcih1c2VySWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcHlyYW1pZHMvdXNlcicsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgdXNlcklkOiB1c2VySWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhbGwgYWN0aXZlIHB5cmFtaWRzIGZyb20gdGhlIGRhdGFiYXNlXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IHB5cmFtaWRzXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZHMoKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3B5cmFtaWRzJyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlUHlyYW1pZChweXJhbWlkKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9jcmVhdGUnLCB7XG4gICAgICAgIHB5cmFtaWQ6IHB5cmFtaWRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZVB5cmFtaWQocHlyYW1pZCkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvdXBkYXRlJywge1xuICAgICAgICBweXJhbWlkOiBweXJhbWlkXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzd2FwUG9zaXRpb25zKGNvbXBldGl0aW9uSWQsIGNoYWxsZW5nZXIsIG9wcG9uZW50KSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9zd2FwUG9zaXRpb25zJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICBjaGFsbGVuZ2VyOiBjaGFsbGVuZ2VyLFxuICAgICAgICBvcHBvbmVudDogb3Bwb25lbnRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFBsYXllclRvUHlyYW1pZChjb21wZXRpdGlvbklkLCBwbGF5ZXIpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2FkZFBsYXllcicsIHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgcGxheWVyOiBwbGF5ZXJcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFBsYXllclRvUHlyYW1pZFJlcXVlc3QoY29tcGV0aXRpb24sIHBsYXllcikge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvYWRkUGxheWVyUmVxdWVzdCcsIHtcbiAgICAgICAgY29tcGV0aXRpb246IGNvbXBldGl0aW9uLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVtb3ZlZFBsYXllckZyb21QeXJhbWlkKGNvbXBldGl0aW9uSWQsIHJlbW92ZWRQbGF5ZXIsIHBsYXllcnMpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL3JlbW92ZVBsYXllcicsIHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgcmVtb3ZlZFBsYXllcjogcmVtb3ZlZFBsYXllcixcbiAgICAgICAgcGxheWVyczogcGxheWVyc1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXBwcm92ZVBlbmRpbmdQbGF5ZXIoY29tcGV0aXRpb25JZCwgcGxheWVyKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9hcHByb3ZlUGxheWVyJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVueVBlbmRpbmdQbGF5ZXIoY29tcGV0aXRpb25JZCwgcGxheWVyKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9kZW55UGxheWVyJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFBlbmRpbmdQbGF5ZXJzJywga3BQZW5kaW5nUGxheWVycyk7XG5cbiAgZnVuY3Rpb24ga3BQZW5kaW5nUGxheWVycygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHB5cmFtaWQ6ICc9J1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3B5cmFtaWRzL2NvbXBvbmVudHMvcGVuZGluZy1wbGF5ZXJzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKHB5cmFtaWRzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucGVuZGluZ1BsYXllcnMgPSBbXTtcbiAgICB2bS5hcHByb3ZlUGVuZGluZ1BsYXllciA9IGFwcHJvdmVQZW5kaW5nUGxheWVyO1xuICAgIHZtLmRlbnlQZW5kaW5nUGxheWVyID0gZGVueVBlbmRpbmdQbGF5ZXI7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuXG4gICAgZnVuY3Rpb24gYXBwcm92ZVBlbmRpbmdQbGF5ZXIocGxheWVyKSB7XG4gICAgICBwbGF5ZXIucG9zaXRpb24gPSB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoICsgMTtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5hcHByb3ZlUGVuZGluZ1BsYXllcih2bS5weXJhbWlkLl9pZCwgcGxheWVyKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZW55UGVuZGluZ1BsYXllcihwbGF5ZXIpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5kZW55UGVuZGluZ1BsYXllcih2bS5weXJhbWlkLl9pZCwgcGxheWVyKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twUHlyYW1pZENvbXBhY3QnLCBrcFB5cmFtaWRDb21wYWN0KTtcblxuICBmdW5jdGlvbiBrcFB5cmFtaWRDb21wYWN0KCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgdHlwZTogJ0AnLFxuXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvcHlyYW1pZHMvY29tcG9uZW50cy9weXJhbWlkLWNvbXBhY3QuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMocHlyYW1pZHNTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnB5cmFtaWRzID0gbnVsbDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICh2bS50eXBlID09PSAndXNlcicpIHtcbiAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWRzRm9yVXNlcihpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkcykge1xuICAgICAgICAgIHZtLnB5cmFtaWRzID0gcHlyYW1pZHMuZGF0YTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZHMoKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkcykge1xuICAgICAgICAgIHZtLnB5cmFtaWRzID0gcHlyYW1pZHMuZGF0YTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BQeXJhbWlkJywga3BQeXJhbWlkKTtcblxuICBmdW5jdGlvbiBrcFB5cmFtaWQoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9weXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQuaHRtbCcsXG4gICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogJ0AnXG4gICAgICB9LFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCAkc3RhdGUsIHB5cmFtaWRzU2VydmljZSwgJGZpbHRlciwgbm90aWZ5U2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciBtYXhMZXZlbHMgPSAxMDtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnB5cmFtaWQgPSB7fTtcbiAgICB2bS5icmVha1BvaW50cyA9IFtdO1xuICAgIHZtLmxldmVscyA9IFtdO1xuICAgIHZtLm51bWJlck9mQmxvY2tzID0gMDtcbiAgICB2bS5jdXJyZW50VXNlcklzT25QeXJhbWlkID0gZmFsc2U7XG4gICAgdm0uY3VycmVudFVzZXJJc1BlbmRpbmcgPSBmYWxzZTtcbiAgICB2bS5jdXJyZW50VXNlcklzT3duZXIgPSBmYWxzZTtcbiAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcbiAgICB2bS5hdmFpbGFibGVDaGFsbGVuZ2VzID0gZmFsc2U7XG4gICAgdm0uY3JlYXRlQ2hhbGxlbmdlID0gY3JlYXRlQ2hhbGxlbmdlO1xuICAgIHZtLmNvbXBsZXRlQ2hhbGxlbmdlID0gY29tcGxldGVDaGFsbGVuZ2U7XG4gICAgdm0uY2hhbGxlbmdlRXhwaXJlZCA9IGNoYWxsZW5nZUV4cGlyZWQ7XG4gICAgdm0uY3VycmVudFVzZXJQbGF5ZXIgPSB7fTtcbiAgICB2bS5weXJhbWlkTWVudVRvZ2dsZSA9IGZhbHNlO1xuICAgIHZtLmFkZEN1cnJlbnRVc2VyVG9QeXJhbWlkID0gYWRkQ3VycmVudFVzZXJUb1B5cmFtaWQ7XG4gICAgdm0uY29uZmlybVJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQgPSBjb25maXJtUmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZDtcbiAgICB2bS5udW1iZXJPZlJlYWxQbGF5ZXJzID0gMDtcbiAgICB2bS5tYXhQbGF5ZXJzID0gMDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBtYXhpbXVtIG51bWJlciBvZiBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBtYXhpbXVtIG51bWJlciBvZiBsZXZlbHNcbiAgICAgICAgZm9yICh2YXIgaSA9IG1heExldmVsczsgaSA+IDA7IC0taSkge1xuICAgICAgICAgIHZtLm1heFBsYXllcnMgKz0gaTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChweXJhbWlkLmRhdGEpIHtcbiAgICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuXG4gICAgICAgICAgb3JkZXJQbGF5ZXJzKCk7XG4gICAgICAgICAgZ2V0UGxheWVyc1N0YXR1cygpO1xuICAgICAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgICAgICAgIGNhbGN1bGF0ZVB5cmFtaWRCbG9ja3MoKTtcbiAgICAgICAgICBmaWxsSW5FbXB0eUJsb2NrcygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPcmRlciB0aGUgcGxheWVycyBieSB0aGUgcG9zaXRpb24gcHJvcGVydHkgb2YgdGhlIHBsYXllcnMgYXJyYXkgaW4gdGhlIHB5cmFtaWQgb2JqZWN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gb3JkZXJQbGF5ZXJzKCkge1xuICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzID0gJGZpbHRlcignb3JkZXJCeScpKHZtLnB5cmFtaWQucGxheWVycywgJ3Bvc2l0aW9uJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlndXJlIG91dCBpZiBlYWNoIHBsYXllciBpcyBhbHJlYWR5IGNoYWxsZW5nZWQgYW5kIHNldCBzb21lIHN0dWZmXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UGxheWVyc1N0YXR1cygpIHtcbiAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGUgY3VycmVudCB1c2VyIGlzIGFuIG93bmVyIG9mIHRoaXMgcHlyYW1pZFxuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICB2bS5jdXJyZW50VXNlcklzT3duZXIgPSBfLnNvbWUodm0ucHlyYW1pZC5vd25lcnMsIFsnX2lkJywgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZF0pO1xuICAgICAgfVxuXG4gICAgICB2bS5jdXJyZW50VXNlcklzT25QeXJhbWlkID0gZmFsc2U7XG4gICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcbiAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgLy8gRmluZCB0aGUgY3VycmVudCB1c2VyIGlmIHRoZXkgYXJlIG9uIHRoaXMgcHlyYW1pZCBhbmQgc2V0IHNvbWUgcHJvcGVydGllc1xuICAgICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpICYmIHBsYXllci5faWQgPT09IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQpIHtcbiAgICAgICAgICB2bS5jdXJyZW50VXNlcklzT25QeXJhbWlkID0gdHJ1ZTtcbiAgICAgICAgICBwbGF5ZXIuY2xhc3MgPSAnY3VycmVudC11c2VyJztcbiAgICAgICAgICB2bS5jdXJyZW50VXNlclBsYXllciA9IHBsYXllcjtcblxuICAgICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcih2bS5jb21wZXRpdGlvbklkLCBwbGF5ZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YSkge1xuICAgICAgICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIGEgcGVuZGluZyByZXF1ZXN0IHRvIGpvaW5cbiAgICAgIHZtLmN1cnJlbnRVc2VySXNQZW5kaW5nID0gZmFsc2U7XG4gICAgICBfLmZvckVhY2godm0ucHlyYW1pZC5wZW5kaW5nUGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpICYmIHBsYXllci5faWQgPT09IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQpIHtcbiAgICAgICAgICB2bS5jdXJyZW50VXNlcklzUGVuZGluZyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIF8uZm9yRWFjaChjaGFsbGVuZ2VzLmRhdGEsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcblxuICAgICAgICAgIHZhciBjaGFsbGVuZ2VyID0gXy5maW5kKHZtLnB5cmFtaWQucGxheWVycywgeyAnX2lkJzogY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkIH0pO1xuICAgICAgICAgIGNoYWxsZW5nZXIuY2xhc3MgPSAndW5hdmFpbGFibGUnO1xuICAgICAgICAgIGNoYWxsZW5nZXIuY2hhbGxlbmdlID0ge1xuICAgICAgICAgICAgcG9zaXRpb246ICdjaGFsbGVuZ2VyJ1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICB2YXIgb3Bwb25lbnQgPSBfLmZpbmQodm0ucHlyYW1pZC5wbGF5ZXJzLCB7ICdfaWQnOiBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkIH0pO1xuICAgICAgICAgIG9wcG9uZW50LmNsYXNzID0gJ3VuYXZhaWxhYmxlJztcbiAgICAgICAgICBvcHBvbmVudC5jaGFsbGVuZ2UgPSB7XG4gICAgICAgICAgICBwb3NpdGlvbjogJ29wcG9uZW50J1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICAvLyBUcmFjayB3aGVuIHRoZSBjaGFsbGVuZ2Ugd2lsbCBleHBpcmVcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLnRpbWVMaW1pdCAhPT0gMCkge1xuICAgICAgICAgICAgdmFyIHRpbWVUb0V4cGlyZSA9IG1vbWVudCgpLmRpZmYobW9tZW50KGNoYWxsZW5nZS5jcmVhdGVkKS5hZGQoY2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2QnKSwgJ3MnKSAqIC0xO1xuICAgICAgICAgICAgLy8gSWYgdGhlIGNoYWxsZW5nZSBoYXMgbm90IHlldCBleHBpcmVkIGRpc3BsYXkgYSBjb3VudGRvd24gb24gdGhlIG9wcG9uZW50XG4gICAgICAgICAgICBpZiAodGltZVRvRXhwaXJlID4gMCkge1xuICAgICAgICAgICAgICBvcHBvbmVudC5jaGFsbGVuZ2UuZXhwaXJlcyA9IHRpbWVUb0V4cGlyZTtcbiAgICAgICAgICAgICAgLy8gSWYgdGhlIGNoYWxsZW5nZSBleHBpcmVkIHdoaWxlIG5vIG9uZSB3YXMgdmlld2luZyB0aGlzIHB5cmFtaWQgY29tcGxldGUgdGhlIGNoYWxsZW5nZSBieSBmb3JmZWl0XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRpbWVUb0V4cGlyZSA8PSAwKSB7XG4gICAgICAgICAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlKG51bGwsIHRydWUsIG9wcG9uZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBOb3cgdGhhdCB3ZSBrbm93IHdoaWNoIHBsYXllcnMgYXJlIGluIGNoYWxsZW5nZXMgYW5kIHdoaWNoIGFyZW4ndFxuICAgICAgICAvLyBmaW5kIHRoZSBhdmFpbGFibGUgY2hhbGxlbmdlcyBmb3IgdGhpcyB1c2VyXG4gICAgICAgIGZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaWd1cmUgb3V0IHdoZXJlIHRvIHN0YXJ0IGVhY2ggbmV3IHJvdyBvbiB0aGUgcHlyYW1pZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZUJyZWFrUG9pbnRzKCkge1xuICAgICAgdm0uYnJlYWtQb2ludHMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4TGV2ZWxzOyBpKyspIHtcbiAgICAgICAgdm0uYnJlYWtQb2ludHMucHVzaCgoKChpICogKGkgKyAxKSkgLyAyKSkgKyAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHaXZlIGVhY2ggcGxheWVyIGEgbGV2ZWwgcHJvcGVydHkgYmFzZWQgb24gdGhlIGJyZWFrIHBvaW50c1xuICAgIC8vIFRoaXMgd2lsbCBiZSB1c2VkIHRvIGRldGVybWluZSB3aG8gb3RoZXIgcGxheWVycyBjYW4gY2hhbGxlbmdlXG4gICAgZnVuY3Rpb24gYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCkge1xuICAgICAgdmFyIGxldmVsID0gMDtcbiAgICAgIHZtLmxldmVscyA9IFtdO1xuICAgICAgY3JlYXRlQnJlYWtQb2ludHMoKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh2bS5icmVha1BvaW50cy5pbmRleE9mKGkgKyAxKSA+IC0xKSB7XG4gICAgICAgICAgbGV2ZWwgKz0gMTtcbiAgICAgICAgICAvLyBTZXQgdGhlIG51bWJlciBvZiB0b3RhbCBsZXZlbHNcbiAgICAgICAgICB2bS5sZXZlbHMucHVzaChsZXZlbCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gR2l2ZSBlYWNoIHBsYXllciBhIGxldmVsXG4gICAgICAgIHZtLnB5cmFtaWQucGxheWVyc1tpXS5sZXZlbCA9IGxldmVsO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhvdyBtYW55IHRvdGFsIGJsb2NrcyBpbiB0aGlzIHB5cmFtaWRcbiAgICBmdW5jdGlvbiBjYWxjdWxhdGVQeXJhbWlkQmxvY2tzKCkge1xuICAgICAgdm0ubnVtYmVyT2ZCbG9ja3MgPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IF8ubGFzdCh2bS5sZXZlbHMpOyBpID4gMDsgaS0tKSB7XG4gICAgICAgIHZtLm51bWJlck9mQmxvY2tzICs9IGk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmlsbCBvdXQgdGhlIHJlbWFpbmluZyBibG9ja3Mgb2YgdGhlIHB5cmFtaWQgd2l0aCBlbXB0eSBibG9ja3NcbiAgICBmdW5jdGlvbiBmaWxsSW5FbXB0eUJsb2NrcygpIHtcbiAgICAgIHZtLm51bWJlck9mUmVhbFBsYXllcnMgPSB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoO1xuICAgICAgZm9yICh2YXIgaSA9IHZtLnB5cmFtaWQucGxheWVycy5sZW5ndGg7IGkgPCB2bS5udW1iZXJPZkJsb2NrczsgaSsrKSB7XG4gICAgICAgIHZtLnB5cmFtaWQucGxheWVycy5wdXNoKHtcbiAgICAgICAgICBmaXJzdE5hbWU6ICdFbXB0eScsXG4gICAgICAgICAgbGFzdE5hbWU6ICdTcG90JyxcbiAgICAgICAgICBwb3NpdGlvbjogOTksXG4gICAgICAgICAgY2xhc3M6ICdlbXB0eSdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICAvLyBXZSBoYXZlIHRvIGdpdmUgbGV2ZWxzIHRvIHRoZSBuZXcgZW1wdHkgc3BvdHNcbiAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgIH1cblxuICAgIC8vIEZpbmQgYWxsIHRoZSBwbGF5ZXJzIHRoYXQgYXJlIGF2YWlsYWJsZSB0byBiZSBjaGFsbGVuZ2VkIGJ5IHRoaXMgdXNlclxuICAgIGZ1bmN0aW9uIGZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzKCkge1xuICAgICAgdmFyIGxldmVsQWJvdmUgPSB2bS5jdXJyZW50VXNlclBsYXllci5sZXZlbCA+IDEgPyB2bS5jdXJyZW50VXNlclBsYXllci5sZXZlbCAtIDEgOiBudWxsO1xuICAgICAgXy5mb3JFYWNoKHZtLnB5cmFtaWQucGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICBpZiAocGxheWVyLmxldmVsID09PSBsZXZlbEFib3ZlICYmIHBsYXllci5wb3NpdGlvbiAhPT0gOTkgJiYgcGxheWVyLmNsYXNzICE9PSAndW5hdmFpbGFibGUnKSB7XG4gICAgICAgICAgdm0uYXZhaWxhYmxlQ2hhbGxlbmdlcyA9IHRydWU7XG4gICAgICAgICAgcGxheWVyLmF2YWlsYWJsZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYWxsZW5nZShwbGF5ZXIpIHtcbiAgICAgIGlmICghcGxheWVyLmF2YWlsYWJsZSkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdTb3JyeSwgdGhhdCBpcyBub3QgYSB2YWxpZCBjaGFsbGVuZ2UuJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSB0cnVlO1xuICAgICAgICB2YXIgY2hhbGxlbmdlID0ge1xuICAgICAgICAgIGNvbXBldGl0aW9uTmFtZTogdm0ucHlyYW1pZC5uYW1lLFxuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IHZtLmNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgY29tcGxldGU6IGZhbHNlLFxuICAgICAgICAgIGZvcmZlaXQ6IGZhbHNlLFxuICAgICAgICAgIHRpbWVMaW1pdDogdm0ucHlyYW1pZC5mb3JmZWl0RGF5cyxcbiAgICAgICAgICBjaGFsbGVuZ2VyOiB7XG4gICAgICAgICAgICBfaWQ6IHZtLmN1cnJlbnRVc2VyUGxheWVyLl9pZCxcbiAgICAgICAgICAgIGVtYWlsOiB2bS5jdXJyZW50VXNlclBsYXllci5lbWFpbCxcbiAgICAgICAgICAgIGZpcnN0TmFtZTogdm0uY3VycmVudFVzZXJQbGF5ZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgbGFzdE5hbWU6IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxhc3ROYW1lLFxuICAgICAgICAgICAgcG9zaXRpb246IHZtLmN1cnJlbnRVc2VyUGxheWVyLnBvc2l0aW9uXG4gICAgICAgICAgfSxcbiAgICAgICAgICBvcHBvbmVudDoge1xuICAgICAgICAgICAgX2lkOiBwbGF5ZXIuX2lkLFxuICAgICAgICAgICAgZW1haWw6IHBsYXllci5lbWFpbCxcbiAgICAgICAgICAgIGZpcnN0TmFtZTogcGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiBwbGF5ZXIubGFzdE5hbWUsXG4gICAgICAgICAgICBwb3NpdGlvbjogcGxheWVyLnBvc2l0aW9uXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvLyBDcmVhdGUgdGhlIGNoYWxsZW5nZVxuICAgICAgICAvLyBXZWJzb2NrZXQgZXZlbnQgd2lsbCByZWZyZXNoIHRoZSBweXJhbWlkXG4gICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmNyZWF0ZUNoYWxsZW5nZShjaGFsbGVuZ2UpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZtLnB5cmFtaWRNZW51VG9nZ2xlID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wbGV0ZSBhIGNoYWxsZW5nZSBieSBhIHVzZXIgaW50ZXJhY3Rpb24gb3IgYSBmb3JmZWl0XG4gICAgICogXG4gICAgICogQHBhcmFtICB7Ym9vbGVhbn0gd2lubmVySXNDdXJyZW50VXNlclxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IGZvcmZlaXRcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IGZvcmZlaXRMb3NlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbXBsZXRlQ2hhbGxlbmdlKHdpbm5lcklzQ3VycmVudFVzZXIsIGZvcmZlaXQsIGZvcmZlaXRMb3Nlcikge1xuICAgICAgdmFyIHBsYXllciA9IGZvcmZlaXRMb3NlciB8fCB2bS5jdXJyZW50VXNlclBsYXllcjtcbiAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcih2bS5jb21wZXRpdGlvbklkLCBwbGF5ZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIHN3YXBQb3NpdGlvbnMgPSBmYWxzZTtcblxuICAgICAgICAvLyBJZiB0aGVyZSBpcyBhIGZvcmZlaXRcbiAgICAgICAgaWYgKGZvcmZlaXQpIHtcbiAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS5mb3JmZWl0ID0gdHJ1ZTtcbiAgICAgICAgICBpZiAoZm9yZmVpdExvc2VyLmNoYWxsZW5nZS5wb3NpdGlvbiA9PT0gJ29wcG9uZW50Jykge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ2NoYWxsZW5nZXInO1xuICAgICAgICAgICAgc3dhcFBvc2l0aW9ucyA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdvcHBvbmVudCc7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIEZpZ3VyZSBvdXQgd2hvIHRoZSB3aW5uZXIgd2FzIHRvIHN0b3JlIGluIHRoZSBjaGFsbGVuZ2UgcmVjb3JkXG4gICAgICAgIH0gZWxzZSBpZiAod2lubmVySXNDdXJyZW50VXNlcikge1xuICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLl9pZCA9PT0gdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnY2hhbGxlbmdlcic7XG4gICAgICAgICAgICBzd2FwUG9zaXRpb25zID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ29wcG9uZW50JztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIuX2lkID09PSB2bS5jdXJyZW50VXNlclBsYXllci5faWQpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdvcHBvbmVudCc7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdjaGFsbGVuZ2VyJztcbiAgICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN3YXAgcG9zaXRpb25zIGFuZCB0aGVuIGNvbXBsZXRlIHRoZSBjaGFsbGVuZ2Ugb3IganVzdCBjb21wbGV0ZSB0aGUgY2hhbGxlbmdlXG4gICAgICAgIC8vIFdlYnNvY2tldCBldmVudCB3aWxsIHJlZnJlc2ggdGhlIHB5cmFtaWRcbiAgICAgICAgaWYgKHN3YXBQb3NpdGlvbnMpIHtcbiAgICAgICAgICBweXJhbWlkc1NlcnZpY2Uuc3dhcFBvc2l0aW9ucyh2bS5jb21wZXRpdGlvbklkLCBjaGFsbGVuZ2UuZGF0YS5vcHBvbmVudCwgY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlcikudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jb21wbGV0ZUNoYWxsZW5nZShjaGFsbGVuZ2UuZGF0YSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIGlmIChyZW1vdmluZ0N1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jb21wbGV0ZUNoYWxsZW5nZShjaGFsbGVuZ2UuZGF0YSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAocmVtb3ZpbmdDdXJyZW50VXNlcikge1xuICAgICAgICAgICAgICByZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5weXJhbWlkTWVudVRvZ2dsZSA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxzIHRoZSBjb21wbGV0ZSBjaGFsbG5nZSBmdW5jdGlvbiB3aXRoIHRoZSBmb3JmZWl0aW5nIHBsYXllclxuICAgICAqIEBwYXJhbSAge29iamVjdH0gcGxheWVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2hhbGxlbmdlRXhwaXJlZChwbGF5ZXIpIHtcbiAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlKG51bGwsIHRydWUsIHBsYXllcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgdGhlIGN1cnJlbnQgdXNlciB0aGUgcHlyYW1pZCBcbiAgICAgKiBpZiB0aGV5J3JlIG5vdCBhbHJlYWR5IG9uIGl0IGFuZCB0aGVyZSdzIHNwYWNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWRkQ3VycmVudFVzZXJUb1B5cmFtaWQoKSB7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgIGlmICh2bS5udW1iZXJPZlJlYWxQbGF5ZXJzIDwgdm0ubWF4UGxheWVycykge1xuICAgICAgICAgIHZhciBwbGF5ZXIgPSB7XG4gICAgICAgICAgICBfaWQ6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQsXG4gICAgICAgICAgICBmaXJzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5maXJzdE5hbWUsXG4gICAgICAgICAgICBsYXN0TmFtZTogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmxhc3ROYW1lLFxuICAgICAgICAgICAgZW1haWw6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci51c2VybmFtZSxcbiAgICAgICAgICAgIHBvc2l0aW9uOiB2bS5udW1iZXJPZlJlYWxQbGF5ZXJzICsgMVxuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKHZtLnB5cmFtaWQub3Blbikge1xuICAgICAgICAgICAgc3dhbCh7XG4gICAgICAgICAgICAgIHRpdGxlOiAnSm9pbiBDb21wZXRpdGlvbj8nLFxuICAgICAgICAgICAgICB0ZXh0OiAnWW91XFwnbGwgYmUgYWRkZWQgdG8gdGhlIGJvdHRvbScsXG4gICAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJyxcbiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICdKb2luJyxcbiAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ05ldmVybWluZCcsXG4gICAgICAgICAgICAgIGNsb3NlT25Db25maXJtOiBmYWxzZSxcbiAgICAgICAgICAgICAgY2xvc2VPbkNhbmNlbDogdHJ1ZVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBweXJhbWlkc1NlcnZpY2UuYWRkUGxheWVyVG9QeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllcik7XG4gICAgICAgICAgICAgIHN3YWwoJ1dlbGNvbWUgQWJvYXJkIScsICdOb3cgc3RhcnQgZmlnaHRpbmcgeW91ciB3YXkgdG8gdGhlIHRvcCcsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICB9KTsgIFxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzd2FsKHtcbiAgICAgICAgICAgICAgdGl0bGU6ICdTZW5kIEpvaW4gUmVxdWVzdD8nLFxuICAgICAgICAgICAgICB0ZXh0OiAnVGhpcyBpcyBhIGNsb3NlZCBjb21wZXRpdGlvbiBzbyB0aGUgb3duZXIgbXVzdCBhcHByb3ZlIHlvdXIgcmVxdWVzdCcsXG4gICAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJyxcbiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICdTZW5kIFJlcXVlc3QnLFxuICAgICAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAnTmV2ZXJtaW5kJyxcbiAgICAgICAgICAgICAgY2xvc2VPbkNvbmZpcm06IGZhbHNlLFxuICAgICAgICAgICAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHB5cmFtaWRzU2VydmljZS5hZGRQbGF5ZXJUb1B5cmFtaWRSZXF1ZXN0KHZtLnB5cmFtaWQsIHBsYXllcikudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdm0uY3VycmVudFVzZXJJc1BlbmRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgc3dhbCgnUmVxdWVzdCBTZW50JywgJ1lvdSB3aWxsIHJlY2VpdmUgYW4gZW1haWwgb25jZSB0aGUgb3duZXIgcHJvY2Vzc2VzIHRoZSByZXF1ZXN0LicsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS53YXJuaW5nKCdTb3JyeSwgdGhpcyBweXJhbWlkIGlzIGZ1bGwnKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvbmZpcm1SZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkKCkge1xuICAgICAgc3dhbCh7XG4gICAgICAgIHRpdGxlOiAnTGVhdmUgUHlyYW1pZD8nLFxuICAgICAgICB0ZXh0OiAnWW91IHdpbGwgbG9zZSB5b3VyIHNwb3QgYW5kIGZvcmZlaXQgYW55IGFjdGl2ZSBjaGFsbGVuZ2VzLicsXG4gICAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnWWVzLCBsZWF2ZScsXG4gICAgICAgIGNvbmZpcm1CdXR0b25DbGFzczogJ2J0bi1kYW5nZXInLFxuICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAnTm8sIHN0YXknLFxuICAgICAgICBjbG9zZU9uQ29uZmlybTogZmFsc2UsXG4gICAgICAgIGNsb3NlT25DYW5jZWw6IHRydWVcbiAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCgpO1xuICAgICAgICBzd2FsKCdPSywgeW91XFwnciBvdXQhJywgJ1lvdVxcJ3ZlIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSBweXJhbWlkLicsICdzdWNjZXNzJyk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBVc2UgdGhpcyB0byBlbmZvcmNlIG9yZGVyIG9mIG9wZXJhdGlvbnMgd2hlbiB0aGUgcGxheWVyIHRvIGJlIHJlbW92ZWQgaGFkIGFuIGFjdGl2ZSBjaGFsbGVuZ2VcbiAgICB2YXIgcmVtb3ZpbmdDdXJyZW50VXNlciA9IGZhbHNlO1xuXG4gICAgZnVuY3Rpb24gcmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCgpIHtcbiAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgdXNlciBpcyBsb2dnZWQgaW4gYW5kIGlzIG9uIHRoaXMgcHlyYW1pZFxuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSAmJiB2bS5jdXJyZW50VXNlcklzT25QeXJhbWlkKSB7XG4gICAgICAgIHJlbW92aW5nQ3VycmVudFVzZXIgPSB0cnVlO1xuICAgICAgICAvLyBGb3JmZWl0IGlmIHRoZXkgaGF2ZSBhbiBhY3RpdmUgY2hhbGxlbmdlXG4gICAgICAgIGlmICh2bS5oYXNBY3RpdmVDaGFsbGVuZ2UpIHtcbiAgICAgICAgICBjb21wbGV0ZUNoYWxsZW5nZShudWxsLCB0cnVlLCB2bS5jdXJyZW50VXNlclBsYXllcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gU2luY2Ugd2UgYXJlIHJlbW92aW5nIHRoZW0gLi4uXG4gICAgICAgICAgdm0uY3VycmVudFVzZXJJc09uUHlyYW1pZCA9IGZhbHNlO1xuICAgICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IGZhbHNlO1xuXG4gICAgICAgICAgLy8gR2V0IGFuIHVwZGF0ZWQgY29weSBvZiB0aGUgcHlyYW1pZCBpbmNhc2UgYSBmb3JmZWl0IGhhcHBlbmVkXG4gICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIHVwZGF0ZWQgY29weSBsb2NhbGx5IHNvIGFzIG5vdCB0byBkaXN0cnVwdCB0aGUgcHlyYW1pZFxuICAgICAgICAgICAgLy8gdW50aWwgdGhlIHBsYXllciBoYXMgYmVlbiByZW1vdmVkXG4gICAgICAgICAgICB2YXIgcHlyYW1pZCA9IHAuZGF0YTtcblxuICAgICAgICAgICAgLy8gS2VlcCB0cmFjayBvZiB0aGUgc3BvdCB0aGV5IHdlcmUgaW4gb24gdGhlIHB5cmFtaWRcbiAgICAgICAgICAgIHZhciBvcGVuUG9zaXRpb24gPSB2bS5jdXJyZW50VXNlclBsYXllci5wb3NpdGlvbjtcblxuICAgICAgICAgICAgLy8gTW92ZSBhbGwgdGhlIHBsYXllcnMgdXAgMSBwb3NpdGlvbiB0aGF0IHdlcmUgYmVoaW5kIHRoZSByZW1vdmVkIHBsYXllclxuICAgICAgICAgICAgXy5mb3JFYWNoKHB5cmFtaWQucGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICAgICAgICBpZiAocGxheWVyLnBvc2l0aW9uID49IG9wZW5Qb3NpdGlvbikge1xuICAgICAgICAgICAgICAgIHBsYXllci5wb3NpdGlvbiAtPSAxO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gUmVtb3ZlZCB0aGUgcGxheWVyIGZyb20gdGhlIHB5cmFtaWRcbiAgICAgICAgICAgIHZhciByZW1vdmVkUGxheWVyID0gXy5yZW1vdmUocHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgICAgICAgIHJldHVybiBwbGF5ZXIuX2lkID09PSB2bS5jdXJyZW50VXNlclBsYXllci5faWQ7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gTWFrZSBhIG5ldyBhcnJheSBvZiBhbGwgdGhlIHBsYXllcnMgc3RpbGwgb24gdGhlIHB5cmFtaWRcbiAgICAgICAgICAgIC8vIG9ubHkgdXNlIHRoZSBwcm9wZXJ0aWVzIHdlIHdhbnQgdG8gc3RvcmUgaW4gdGhlIHB5cmFtaWQgZG9jdW1lbnRcbiAgICAgICAgICAgIHZhciB1cGRhdGVkUGxheWVycyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2bS5udW1iZXJPZlJlYWxQbGF5ZXJzIC0gMTsgKytpKSB7XG4gICAgICAgICAgICAgIHZhciB1cGRhdGVkUGxheWVyID0ge1xuICAgICAgICAgICAgICAgIF9pZDogcHlyYW1pZC5wbGF5ZXJzW2ldLl9pZCxcbiAgICAgICAgICAgICAgICBmaXJzdE5hbWU6IHB5cmFtaWQucGxheWVyc1tpXS5maXJzdE5hbWUsXG4gICAgICAgICAgICAgICAgbGFzdE5hbWU6IHB5cmFtaWQucGxheWVyc1tpXS5sYXN0TmFtZSxcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogcHlyYW1pZC5wbGF5ZXJzW2ldLnBvc2l0aW9uXG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgdXBkYXRlZFBsYXllcnMucHVzaCh1cGRhdGVkUGxheWVyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ2FsbCBzZXJ2aWNlIHRvIHJlbW92ZSB0aGUgcGxheWVyXG4gICAgICAgICAgICBweXJhbWlkc1NlcnZpY2UucmVtb3ZlZFBsYXllckZyb21QeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQsIHJlbW92ZWRQbGF5ZXJbMF0sIHVwZGF0ZWRQbGF5ZXJzKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmVtb3ZpbmdDdXJyZW50VXNlciA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWZyZXNoIHRoZSBweXJhbWlkIGJlY2FzdWUgb2YgYW4gdXBkYXRlXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVmcmVzaFB5cmFtaWQoKSB7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgIHZtLnB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICAgIG9yZGVyUGxheWVycygpO1xuICAgICAgICBnZXRQbGF5ZXJzU3RhdHVzKCk7XG4gICAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgICAgICBjYWxjdWxhdGVQeXJhbWlkQmxvY2tzKCk7XG4gICAgICAgIGZpbGxJbkVtcHR5QmxvY2tzKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NyZWF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgaWYgKCFyZW1vdmluZ0N1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOnBsYXllcl9hZGRlZCcsIGZ1bmN0aW9uIChfLCBkZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gZGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhkZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpwbGF5ZXJfcmVtb3ZlZCcsIGZ1bmN0aW9uIChfLCBkZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gZGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhkZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpweXJhbWlkX3VwZGF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twVXBkYXRlUGxheWVycycsIGtwVXBkYXRlUGxheWVycyk7XG5cbiAgZnVuY3Rpb24ga3BVcGRhdGVQbGF5ZXJzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcHlyYW1pZDogJz0nXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvcHlyYW1pZHMvY29tcG9uZW50cy91cGRhdGUtcGxheWVycy5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkZmlsdGVyLCBweXJhbWlkc1NlcnZpY2UsIGNoYWxsZW5nZXNTZXJ2aWNlKSB7XG4gICAgdmFyIHJlbW92ZWRQbGF5ZXJzID0gW107XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS51cGRhdGVQeXJhbWlkID0gdXBkYXRlUHlyYW1pZDtcbiAgICB2bS5jYW5jZWxVcGRhdGUgPSBjYW5jZWxVcGRhdGU7XG4gICAgdm0ucmVvcmRlclBsYXllcnMgPSByZW9yZGVyUGxheWVycztcbiAgICB2bS5yZW1vdmVQbGF5ZXIgPSByZW1vdmVQbGF5ZXI7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuXG4gICAgLy8gUGVyZm9ybSB0aGUgdXBkYXRlcyB0aGF0IHdlcmUgcmVxdXN0ZWRcbiAgICBmdW5jdGlvbiB1cGRhdGVQeXJhbWlkKCkge1xuICAgICAgXy5mb3JFYWNoKHJlbW92ZWRQbGF5ZXJzLCBmdW5jdGlvbihwbGF5ZXIpIHtcbiAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZGVsZXRlQWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKHZtLnB5cmFtaWQuX2lkLCBwbGF5ZXIuX2lkKTtcbiAgICAgIH0pO1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLnVwZGF0ZVB5cmFtaWQodm0ucHlyYW1pZCk7ICAgICAgXG4gICAgfVxuXG4gICAgLy8gQ2FuY2VsIHRoZSB1cGRhdGUgYW5kIHB1dCBldmVyeXRoaW5nIGJhY2sgdG8gdGhlIG9yZ2luYWxcbiAgICBmdW5jdGlvbiBjYW5jZWxVcGRhdGUoKSB7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5weXJhbWlkLl9pZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICBweXJhbWlkLmRhdGEucGxheWVycyA9ICRmaWx0ZXIoJ29yZGVyQnknKShweXJhbWlkLmRhdGEucGxheWVycywgJ3Bvc2l0aW9uJyk7XG4gICAgICAgIHZtLnB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBSZW9yZGVyIHRoZSBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBkcmFnLWRyb3BcbiAgICBmdW5jdGlvbiByZW9yZGVyUGxheWVycygpIHtcbiAgICAgIHZhciBpID0gMTtcbiAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgcGxheWVyLnBvc2l0aW9uID0gaTtcbiAgICAgICAgKytpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUXVldWUgdXAgdGhlIHBsYXllcnMgdG8gYmUgcmVtb3ZlZCBhbmQgcmVtb3ZlIHRoZW0gZnJvbSB0aGUgZGlzcGxheVxuICAgIGZ1bmN0aW9uIHJlbW92ZVBsYXllcihwbGF5ZXIsIHBsYXllckluZGV4KSB7XG4gICAgICByZW1vdmVkUGxheWVycy5wdXNoKHBsYXllcik7XG4gICAgICB2bS5weXJhbWlkLnBsYXllcnMuc3BsaWNlKHBsYXllckluZGV4LCAxKTtcbiAgICAgIHJlb3JkZXJQbGF5ZXJzKCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0FkbWluQ3RybCcsIEFkbWluQ3RybCk7XG5cbiAgZnVuY3Rpb24gQWRtaW5DdHJsKCRzY29wZSwgJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRmaWx0ZXIsIHB5cmFtaWRzU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jb21wZXRpdGlvbklkID0gbnVsbDtcbiAgICB2bS51cGRhdGVQeXJhbWlkT3BlblN0YXR1cyA9IHVwZGF0ZVB5cmFtaWRPcGVuU3RhdHVzO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMubXlQeXJhbWlkcycpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlZnJlc2hQeXJhbWlkKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhpcyB1c2VyIGlzIGFuIG93bmVyIG9mIHRoaXMgY29tcGV0aXRpb25cbiAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSAmJiBfLnNvbWUocHlyYW1pZC5kYXRhLm93bmVycywgWydfaWQnLCBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkXSkpIHtcbiAgICAgICAgICAvLyBEaXNwbGF5IHRoZSBwbGF5ZXJzIGluIHRoZSBwcm9wZXIgb3JkZXJcbiAgICAgICAgICBweXJhbWlkLmRhdGEucGxheWVycyA9ICRmaWx0ZXIoJ29yZGVyQnknKShweXJhbWlkLmRhdGEucGxheWVycywgJ3Bvc2l0aW9uJyk7XG4gICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLm15UHlyYW1pZHMnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUGVyZm9ybSB0aGUgdXBkYXRlcyB0aGF0IHdlcmUgcmVxdXN0ZWRcbiAgICBmdW5jdGlvbiB1cGRhdGVQeXJhbWlkT3BlblN0YXR1cygpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgdmFyIHVwZGF0ZWRQeXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuICAgICAgICB1cGRhdGVkUHlyYW1pZC5vcGVuID0gdm0ucHlyYW1pZC5vcGVuO1xuICAgICAgICBweXJhbWlkc1NlcnZpY2UudXBkYXRlUHlyYW1pZCh1cGRhdGVkUHlyYW1pZCk7XG4gICAgICB9KTsgICAgICBcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpwbGF5ZXJfYWRkZWQnLCBmdW5jdGlvbiAoXywgZGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGRldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oZGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cGxheWVyX3JlbW92ZWQnLCBmdW5jdGlvbiAoXywgZGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGRldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oZGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cHlyYW1pZF91cGRhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmFkZF9wbGF5ZXJfcmVxdWVzdCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czphZGRfcGxheWVyX3JlcXVlc3RfZGVuaWVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIi8qKlxuICogQ3JlYXRlcyBhIHB5cmFtaWRcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQ3JlYXRlUHlyYW1pZEN0cmwnLCBDcmVhdGVQeXJhbWlkQ3RybCk7XG5cbiAgZnVuY3Rpb24gQ3JlYXRlUHlyYW1pZEN0cmwoJHN0YXRlLCB1c2VyU2VydmljZSwgcHlyYW1pZHNTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UpIHtcbiAgICB2YXIgYnJlYWtQb2ludHMgPSBbXTtcbiAgICB2YXIgbWF4TGV2ZWxzID0gMTA7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5uZXdQeXJhbWlkID0ge1xuICAgICAgcGxheWVyczogW10sXG4gICAgICBvcGVuOiBmYWxzZVxuICAgIH07XG4gICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IFtdO1xuICAgIHZtLmFkZGVkUGxheWVycyA9IFtdO1xuICAgIHZtLmNyZWF0ZVB5cmFtaWQgPSBjcmVhdGVQeXJhbWlkO1xuICAgIHZtLmFkZFBsYXllciA9IGFkZFBsYXllcjtcbiAgICB2bS5yZW1vdmVQbGF5ZXIgPSByZW1vdmVQbGF5ZXI7XG4gICAgdm0ucmVvcmRlclBsYXllcnMgPSByZW9yZGVyUGxheWVycztcbiAgICB2bS5uZXdQeXJhbWlkLmZvcmZlaXREYXlzID0gMTtcblxuICAgIGFjdGl2YXRlKCk7XG4gICAgXG4gICAgLyoqXG4gICAgICogUnVucyBvbiBjb250cm9sbGVyIGluc3RhbnRpYXRpb25cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIHVzZXJTZXJ2aWNlLmdldEFsbFVzZXJzKCkudGhlbihmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IHVzZXJzLmRhdGE7XG4gICAgICB9KTtcblxuICAgICAgLy8gQ3JlYXRlIGJyZWFrIHBvaW50cyBhcnJheVxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXhMZXZlbHM7IGkrKykge1xuICAgICAgICBicmVha1BvaW50cy5wdXNoKCgoKGkgKiAoaSArIDEpKSAvIDIpKSArIDEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBwbGF5ZXIgdG8gdGhlIG5ldyBweXJhbWlkXG4gICAgICogQ2hlY2tzIHRvIG1ha2Ugc3VyZSB5b3UgYXJlIG5vdCBhZGRpbmcgdG9vIG1hbnkgcGxheWVyc1xuICAgICAqIEBwYXJhbSAge29iamVjdH0gcGxheWVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWRkUGxheWVyKHBsYXllcikge1xuICAgICAgcGxheWVyLnBvc2l0aW9uID0gdm0uYWRkZWRQbGF5ZXJzLmxlbmd0aCArIDE7XG4gICAgICB2bS5hZGRlZFBsYXllcnMucHVzaChfLnJlbW92ZSh2bS5hdmFpbGFibGVQbGF5ZXJzLCB7X2lkOiBwbGF5ZXIuX2lkfSlbMF0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYSBwcmV2aXVvc2x5IGFkZGVkIHBsYXllciBmcm9tIHRoZSBweXJhbWlkXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBwbGF5ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZW1vdmVQbGF5ZXIocGxheWVyKSB7XG4gICAgICB2bS5hdmFpbGFibGVQbGF5ZXJzLnB1c2goXy5yZW1vdmUodm0uYWRkZWRQbGF5ZXJzLCB7X2lkOiBwbGF5ZXIuX2lkfSlbMF0pO1xuICAgICAgcmVvcmRlclBsYXllcnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW9yZGVyIHRoZSBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBkcmFnLWRyb3BcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZW9yZGVyUGxheWVycygpIHtcbiAgICAgIHZhciBpID0gMTtcbiAgICAgIF8uZm9yRWFjaCh2bS5hZGRlZFBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgcGxheWVyLnBvc2l0aW9uID0gaTtcbiAgICAgICAgKytpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gVXNlZCB0byBrZWVwIHRyYWNrIG9mIHBvc2l0aW9uIG9uIHRoZSBweXJhbWlkIGJhc2VkIG9uIHdoZW4gdGhlIHBsYXllciB3YXMgYWRkZWRcbiAgICB2YXIgcG9zaXRpb24gPSAwO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHRoZSBweXJhbWlkXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBweXJhbWlkXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlUHlyYW1pZChweXJhbWlkKSB7XG4gICAgICBhbmd1bGFyLmZvckVhY2godm0uYWRkZWRQbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIHBvc2l0aW9uICs9IDE7XG4gICAgICAgIHZhciBhZGRQbGF5ZXIgPSB7XG4gICAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLFxuICAgICAgICAgIF9pZDogcGxheWVyLl9pZCxcbiAgICAgICAgICBlbWFpbDogcGxheWVyLnVzZXJuYW1lLFxuICAgICAgICAgIGZpcnN0TmFtZTogcGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICBsYXN0TmFtZTogcGxheWVyLmxhc3ROYW1lXG4gICAgICAgIH07XG4gICAgICAgIHB5cmFtaWQucGxheWVycy5wdXNoKGFkZFBsYXllcik7XG4gICAgICB9KTtcbiAgICAgIHB5cmFtaWQub3duZXJzID0gW3tcbiAgICAgICAgX2lkOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkLFxuICAgICAgICBlbWFpbDogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLnVzZXJuYW1lLFxuICAgICAgICBmaXJzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5maXJzdE5hbWUsXG4gICAgICAgIGxhc3ROYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIubGFzdE5hbWVcbiAgICAgIH1dO1xuXG4gICAgICAvLyBGaWd1cmUgb3V0IHRoZSBudW1iZXIgb2YgbGV2ZWxzIGJhc2VkIG9uIHRoZSBudW1iZXIgb2YgcGxheWVyc1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBicmVha1BvaW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocHlyYW1pZC5wbGF5ZXJzLmxlbmd0aCA8IGJyZWFrUG9pbnRzW2ldKSB7XG4gICAgICAgICAgcHlyYW1pZC5sZXZlbHMgPSBpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHB5cmFtaWRzU2VydmljZS5jcmVhdGVQeXJhbWlkKHB5cmFtaWQpLnRoZW4oZnVuY3Rpb24gKG5ld1B5cmFtaWQpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy52aWV3Jywge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IG5ld1B5cmFtaWQuZGF0YS5faWRcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTXlQeXJhbWlkc0N0cmwnLCBNeVB5cmFtaWRzQ3RybCk7XG5cbiAgZnVuY3Rpb24gTXlQeXJhbWlkc0N0cmwoKSB7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1B5cmFtaWRDdHJsJywgUHlyYW1pZEN0cmwpO1xuXG4gIGZ1bmN0aW9uIFB5cmFtaWRDdHJsKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBweXJhbWlkc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNvbXBldGl0aW9uSWQgPSBudWxsO1xuICAgIHZtLnB5cmFtaWQgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcblxuICAgICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSkge1xuICAgICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy5teVB5cmFtaWRzJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUHlyYW1pZHNDdHJsJywgUHlyYW1pZHNDdHJsKTtcblxuICBmdW5jdGlvbiBQeXJhbWlkc0N0cmwoKSB7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1N0YXRzQ3RybCcsIFN0YXRzQ3RybCk7XG5cbiAgZnVuY3Rpb24gU3RhdHNDdHJsKCRzY29wZSwgJHN0YXRlUGFyYW1zLCAkc3RhdGUsIHB5cmFtaWRzU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY29tcGV0aXRpb25JZCA9IG51bGw7XG4gICAgdm0ucHlyYW1pZCA9IG51bGw7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBpZiAoJHN0YXRlUGFyYW1zLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgdm0uY29tcGV0aXRpb25JZCA9ICRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlZnJlc2hQeXJhbWlkKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICBpZiAocHlyYW1pZC5kYXRhKSB7XG4gICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLm15UHlyYW1pZHMnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jb21wbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdjT3ZlcmZsb3cnLCBjT3ZlcmZsb3cpO1xuXG4gIGZ1bmN0aW9uIGNPdmVyZmxvdyhzY3JvbGxiYXJTZXJ2aWNlKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQycsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgdmFyIHNjcm9sbGF4aXMgPSBhdHRycy5zY3JvbGxheGlzIHx8ICd5JztcbiAgICAgIHZhciB0aGVtZSA9IGF0dHJzLnRoZW1lIHx8ICdtaW5pbWFsLWRhcmsnO1xuICAgICAgdmFyIG1vdXNld2hlZWxheGlzID0gYXR0cnMubW91c2V3aGVlbGF4aXMgfHwgJ3knO1xuICAgICAgaWYgKCEkKCdodG1sJykuaGFzQ2xhc3MoJ2lzbW9iaWxlJykpIHtcbiAgICAgICAgc2Nyb2xsYmFyU2VydmljZS5tYWxpaHVTY3JvbGwoZWxlbWVudCwgdGhlbWUsIHNjcm9sbGF4aXMsIG1vdXNld2hlZWxheGlzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCd0b2dnbGVTdWJtZW51JywgdG9nZ2xlU3VibWVudSk7XG5cbiAgZnVuY3Rpb24gdG9nZ2xlU3VibWVudSgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsKSB7XG4gICAgICBlbC5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVsLm5leHQoKS5zbGlkZVRvZ2dsZSgyMDApO1xuICAgICAgICBlbC5wYXJlbnQoKS50b2dnbGVDbGFzcygndG9nZ2xlZCcpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnd2F2ZXNFZmZlY3QnLCB3YXZlc0VmZmVjdCk7XG5cbiAgZnVuY3Rpb24gd2F2ZXNFZmZlY3QoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQycsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICBpZiAoZWxlbWVudC5oYXNDbGFzcygnYnRuLWljb24nKSB8fCBlbGVtZW50Lmhhc0NsYXNzKCdidG4tZmxvYXQnKSkge1xuICAgICAgICBXYXZlcy5hdHRhY2goZWxlbWVudCwgWyd3YXZlcy1jaXJjbGUnXSk7XG4gICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ2J0bi1saWdodCcpKSB7XG4gICAgICAgIFdhdmVzLmF0dGFjaChlbGVtZW50LCBbJ3dhdmVzLWxpZ2h0J10pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgV2F2ZXMuYXR0YWNoKGVsZW1lbnQpO1xuICAgICAgfVxuXG4gICAgICBXYXZlcy5pbml0KCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnZmdMaW5lJywgZmdMaW5lKTtcblxuICBmdW5jdGlvbiBmZ0xpbmUoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQycsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICB2YXIgaW5wdXQgPSBlbGVtZW50LmNoaWxkcmVuKCkuZmlyc3QoKTtcbiAgICAgIHZhciBpc0Zsb2F0TGFiZWwgPSBlbGVtZW50LnBhcmVudCgpLmhhc0NsYXNzKCdmZy1mbG9hdCcpO1xuICAgICAgaW5wdXQuZm9jdXMoZnVuY3Rpb24gKCkge1xuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdmZy10b2dnbGVkJyk7XG4gICAgICB9KTtcblxuICAgICAgaW5wdXQuYmx1cihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghaXNGbG9hdExhYmVsIHx8IChpc0Zsb2F0TGFiZWwgJiYgaW5wdXQudmFsKCkubGVuZ3RoID09PSAwKSkge1xuICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2ZnLXRvZ2dsZWQnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyJdfQ==
