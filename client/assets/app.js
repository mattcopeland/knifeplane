angular.module("app",["ui.router","ui.bootstrap","ngAnimate","angular-loading-bar","nouislider","localytics.directives","timer","LocalStorageModule"]),function(){"use strict ";function e(e,t){e.defaults.headers.get||(e.defaults.headers.get={}),e.defaults.headers.get["If-Modified-Since"]="Fri, 01 Jan 2016 05:00:00 GMT",e.defaults.headers.get["Cache-Control"]="no-cache",e.defaults.headers.get.Pragma="no-cache",t.options({appendToBody:!0})}e.$inject=["$httpProvider","$uibTooltipProvider"],angular.module("app").config(e)}(),function(){"use strict";function e(e,t){function n(e){t.set("sidebarLocked",e)}var r=this;r.$state=e,r.lockSidebar=t.get("sidebarLocked"),r.toggleSidebarLocked=n}e.$inject=["$state","localStorageService"],angular.module("app").controller("AppCtrl",e)}(),function(){"use strict";function e(e,i,a){var o={superAdmin:n,admin:t,user:r};a.html5Mode(!0),i.otherwise("/"),i.when("/pyramids/","/pyramids"),e.state("home",{url:"/",views:{content:{controller:"HomeCtrl",controllerAs:"vm",templateUrl:"common/views/home.html"}}}).state("pyramids",{url:"/pyramids",views:{content:{controller:"PyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramids.html"}}}).state("pyramids.myPyramids",{url:"/my-pyramids",views:{"content@":{controller:"MyPyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/my-pyramids.html"}},resolve:{auth:o.user}}).state("pyramids.view",{url:"/view/:competitionId",views:{"content@":{controller:"PyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramid.html"}}}).state("pyramids.stats",{url:"/stats/:competitionId",views:{"content@":{controller:"StatsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/stats.html"}}}).state("pyramids.admin",{url:"/admin/:competitionId",views:{"content@":{controller:"AdminCtrl",controllerAs:"vm",templateUrl:"pyramids/views/admin.html"}},resolve:{auth:o.user}}).state("pyramids.create",{url:"/create",views:{"content@":{controller:"CreatePyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/create-pyramid.html"}},resolve:{auth:o.user}}).state("login",{url:"/login",views:{content:{controller:"LoginCtrl",controllerAs:"vm",templateUrl:"authentication/views/login.html"}}}).state("register",{url:"/register",views:{content:{controller:"RegisterCtrl",controllerAs:"vm",templateUrl:"authentication/views/register.html"}}}).state("verify",{url:"/verification",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}}).state("verification",{url:"/verification/:userId/:verificationToken",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}})}function t(e){return e.authorizeCurrentUserForRoute("admin")}function n(e){return e.authorizeCurrentUserForRoute("super-admin")}function r(e){return e.authenticatedUserForRoute()}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app").config(e),t.$inject=["authService"],n.$inject=["authService"],r.$inject=["authService"]}(),function(){"use strict";function e(e,t,n){e.$on("$stateChangeError",function(e,n,r,i,a,o){"not authorized"===o&&(t.go("login"),t.previous=n,t.prevParams=r)}),e.$on("$stateChangeStart",function(){n.setSidebarStatus(!1)})}e.$inject=["$rootScope","$state","sidebarService"],angular.module("app").run(e)}(),function(){"use strict";function e(e,t,n,r,i,a){function o(e,r){var a=n.defer();return t.post("/login",{username:e,password:r}).then(function(e){e.data.success?(i.currentUser=e.data.user,a.resolve(!0)):"unverified"===e.data.message?a.resolve("unverified"):a.resolve(!1)}),a.promise}function l(e){var r=n.defer();return t.post("/api/users",{userData:e}).then(function(e){e.data?r.resolve(!0):r.resolve(!1)},function(e){"Error: Duplicate Username"===e.data.reason&&a.error("Sorry, an account already exists with that email address.")}),r.promise}function s(){var r=n.defer();return t.post("/logout",{logout:!0}).then(function(){i.currentUser=void 0,r.resolve(),e.go("home")}),r.promise}function c(e){return!!i.isAuthorized(e)||n.reject("not authorized")}function u(){return!!i.isAuthenticated()||n.reject("not authorized")}var d={authenticateUser:o,createUser:l,logout:s,authorizeCurrentUserForRoute:c,authenticatedUserForRoute:u};return d}e.$inject=["$state","$http","$q","userService","identityService","notifyService"],angular.module("app").factory("authService",e)}(),function(){"use strict";function e(e){function t(){return e.get("/api/users").then(function(e){return e})}function n(t,n){return e.get("/api/user/verification",{params:{userId:t,verificationToken:n}})}var r={getAllUsers:t,verifyUser:n};return r}e.$inject=["$http"],angular.module("app").factory("userService",e)}(),function(){"use strict";function e(e,t,n){function r(){}function i(r,i){t.authenticateUser(r,i).then(function(t){t?"unverified"===t?n.error("You must verify your email before you can login"):e.previous?(e.go(e.previous,e.prevParams),e.previous=null,e.prevParams=null):e.go("home"):n.error("Username / password combinaiton incorrect")})}var a=this;a.login=i,r()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("LoginCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){}function i(r){r.password!==r.confirmPassword?n.error("Passwords don't match!"):t.createUser(r).then(function(){e.go("verify")})}var a=this;a.register=i,r()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("RegisterCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){t.userId&&t.verificationToken&&(i.verifying=!0,i.verified=null,n.verifyUser(t.userId,t.verificationToken).then(function(e){e.data?i.verified=!0:i.verified=!1}))}var i=this;i.verified=void 0,i.verifying=!1,r()}e.$inject=["$state","$stateParams","userService"],angular.module("app").controller("VerificationCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@"},templateUrl:"/challenges/components/active-challenges.html"};return e}function t(e,t){function n(){r()}function r(){i.challenges=[],t.getActiveChallengesByCompetition(i.competitionId).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){0!==e.timeLimit&&(e.expires=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1)}))})}var i=this;i.challenges=[],n(),e.$on("ws:challenge_created",function(e,t){i.competitionId===t.competitionId&&r()}),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&r()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpActiveChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@",limit:"@"},templateUrl:"/challenges/components/completed-challenges.html"};return e}function t(e,t){function n(){r()}function r(){i.challenges=[],t.getCompletedChallengesByCompetition(i.competitionId,i.limit).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){e.loser="challenger"===e.winner?"opponent":"challenger",e.whenCompleted=moment(e.completed).calendar(null,{sameDay:"[Today]",nextDay:"[Tomorrow]",nextWeek:"dddd",lastDay:"[Yesterday]",lastWeek:"[Last] dddd",sameElse:"DD/MM/YYYY"})}))})}var i=this;i.challenges=[],n(),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&r()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpCompletedChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@",player:"="},templateUrl:"/challenges/components/player-overall-results.html"};return e}function t(e,t,n){function r(){i(a.competitionId,a.player._id)}function i(e,n){t.getPlayerResultsByCompetition(e,n).then(function(e){for(var t=[],r=0;r<a.maxLevels;r++)t.push(r*(r+1)/2+1);a.player.level=t.length;for(var i=0;i<t.length;i++)if(a.player.position<t[i+1]){a.player.level=t.indexOf(t[i])+1;break}var o,l=0,s=!0;_.forEach(e.data,function(e){s&&("challenger"===e.winner&&e.challenger._id===n||"opponent"===e.winner&&e.opponent._id===n?"losing"!==o?(l+=1,o="winning"):s=!1:("opponent"===e.winner&&e.challenger._id===n||"challenger"===e.winner&&e.opponent._id===n)&&("winning"!==o?(l+=1,o="losing"):s=!1)),a.streak={type:o,value:l}}),a.wins.asOpponent=_.size(_.filter(e.data,function(e){return e.opponent._id===n&&"opponent"===e.winner})),a.wins.asChallenger=_.size(_.filter(e.data,function(e){return e.challenger._id===n&&"challenger"===e.winner})),a.wins.total=a.wins.asChallenger+a.wins.asOpponent,a.wins.byForfeit=_.size(_.filter(e.data,function(e){return e.forfeit&&(e.challenger._id===n&&"challenger"===e.winner||e.opponent._id===n&&"opponent"===e.winner)})),a.loses.asOpponent=_.size(_.filter(e.data,function(e){return e.opponent._id===n&&"challenger"===e.winner})),a.loses.asChallenger=_.size(_.filter(e.data,function(e){return e.challenger._id===n&&"opponent"===e.winner})),a.loses.total=a.loses.asChallenger+a.loses.asOpponent,a.loses.byForfeit=_.size(_.filter(e.data,function(e){return e.forfeit&&(e.challenger._id===n&&"opponent"===e.winner||e.opponent._id===n&&"challenger"===e.winner)}))})}var a=this;a.maxLevels=10,a.wins={total:0,asChallenger:0,asOpponent:0,byForfeit:0},a.loses={total:0,asChallenger:0,asOpponent:0,byForfeit:0},a.streak={type:null,value:0},r(),e.$on("ws:challenge_completed",function(e,t){a.competitionId===t.competitionId&&(a.player._id===t.challengerId?(n.info(t.description),i(t.competitionId,t.challengerId)):a.player._id===t.opponentId&&i(t.competitionId,t.opponentId))})}t.$inject=["$scope","challengesService","notifyService"],angular.module("app").directive("kpPlayerOverallResults",e)}(),function(){"use strict";function e(e){function t(t){return e.post("/api/challenges/create",{challenge:t})}function n(t){return e.post("/api/challenges/complete",{challenge:t})}function r(t){return e.get("/api/challenges/competition",{params:{competitionId:t}})}function i(t){return e.get("/api/challenges/active/competition",{params:{competitionId:t}})}function a(t,n){return e.get("/api/challenges/active/competition/player",{params:{competitionId:t,playerId:n}})}function o(t,n){return e.get("/api/challenges/completed/competition",{params:{competitionId:t,limit:n}})}function l(t,n){return e.get("/api/challenges/results/competition/player",{params:{competitionId:t,playerId:n}})}var s={createChallenge:t,completeChallenge:n,getChallengesByCompetition:r,getActiveChallengesByCompetition:i,getActiveChallengeByCompetitionByPlayer:a,getCompletedChallengesByCompetition:o,getPlayerResultsByCompetition:l};return s}e.$inject=["$http"],angular.module("app").factory("challengesService",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",templateUrl:"/common/components/footer.html"};return e}function t(e,t){function n(){t.logout()}var r=this;r.indentity=e,r.logout=n}t.$inject=["identityService","authService"],angular.module("app").directive("kpFooter",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"headerCtrl",restrict:"A",templateUrl:"/common/components/header.html"};return e}function t(e,t,n){function r(){a.sidebarStatus.left=!a.sidebarStatus.left,e.setSidebarStatus(a.sidebarStatus.left)}function i(){n.logout()}var a=this;a.indentity=t,a.logout=i,a.sidebarStatus=e.getSidebarStatus(),a.toggleSidebar=r}t.$inject=["sidebarService","identityService","authService"],angular.module("app").directive("kpHeader",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"sidebarCtrl",restrict:"A",templateUrl:"/common/components/sidebar.html"};return e}function t(e,t,n){function r(){t.logout()}var i=this;i.indentity=e,i.logout=r,i.sidebarStatus=n.getSidebarStatus()}t.$inject=["identityService","authService","sidebarService"],angular.module("app").directive("kpSidebar",e)}(),function(){"use strict";function e(){return function(e,t){if(!angular.isObject(e))return e;var n=[];for(var r in e)n.push(e[r]);return n.sort(function(e,n){return e=parseInt(e[t]),n=parseInt(n[t]),e-n}),n}}angular.module("app").filter("orderObjectBy",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("HomeCtrl",e)}(),function(){"use strict";function e(e){function t(){return!!this.currentUser}function n(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}var r;null!==e.bootstrappedUserObject&&(r=e.bootstrappedUserObject);var i={currentUser:r,isAuthenticated:t,isAuthorized:n};return i}e.$inject=["$window"],angular.module("app").factory("identityService",e)}(),function(){"use strict";function e(){function e(e,t,n){$.notify({message:e,url:t,target:n},{type:"info"})}function t(e,t,n){$.notify({message:e,url:t,target:n},{type:"success"})}function n(e,t,n){$.notify({message:e,url:t,target:n},{type:"warning"})}function r(e,t,n){$.notify({message:e,url:t,target:n},{type:"danger"})}function i(e,t,n){$.notify({message:e,url:t,target:n},{type:"inverse"})}var a={info:e,success:t,warning:n,error:r,inverse:i};return $.notifyDefaults({newest_on_top:!0,offset:{x:20,y:85}}),a}angular.module("app").factory("notifyService",e)}(),function(){"use strict";function e(){function e(e,t,n,r){$(e).mCustomScrollbar({theme:t,scrollInertia:100,axis:n,mouseWheel:{enable:!0,axis:r,preventDefault:!0}})}var t={malihuScroll:e};return t}angular.module("app").factory("scrollbarService",e)}(),function(){"use strict";function e(){function e(){return n}function t(e){n.left=e}var n={left:!1,right:!1},r={getSidebarStatus:e,setSidebarStatus:t};return r}angular.module("app").factory("sidebarService",e)}(),angular.module("app").service("websocketService",["$rootScope","$window",function(e,t){function n(){return"https:"===t.location.protocol?"wss://"+t.location.host:"ws://"+t.location.host}var r;this.connect=function(){r=new WebSocket(n()),r.onmessage=function(t){var n=JSON.parse(t.data);e.$broadcast("ws:"+n.topic,n.data)}},this.send=function(e,t){var n=JSON.stringify({topic:e,data:t});r.send(n)}}]).run(["websocketService",function(e){e.connect()}]),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@"},templateUrl:"/pyramids/components/pending-players.html"};return e}function t(e,t){function n(){r()}function r(){o.pendingPlayers=[],t.getPyramid(o.competitionId).then(function(e){o.pyramid=e.data,e.data&&e.data.pendingPlayers.length>0&&(o.pendingPlayers=e.data.pendingPlayers)})}function i(e){e.position=o.pyramid.players.length+1,t.approvePendingPlayer(o.competitionId,e).then(r)}function a(e){t.denyPendingPlayer(o.competitionId,e).then(r)}var o=this;o.pyramid={},o.pendingPlayers=[],o.approvePendingPlayer=i,o.denyPendingPlayer=a,n()}t.$inject=["$scope","pyramidsService"],angular.module("app").directive("kpPendingPlayers",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{type:"@"},templateUrl:"/pyramids/components/pyramid-compact.html"};return e}function t(e,t){function n(){"user"===r.type?e.getPyramidsForUser(t.currentUser._id).then(function(e){r.pyramids=e.data}):e.getPyramids().then(function(e){r.pyramids=e.data})}var r=this;r.pyramids=null,n()}t.$inject=["pyramidsService","identityService"],angular.module("app").directive("kpPyramidCompact",e)}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"/pyramids/components/pyramid.html",replace:!0,scope:{competitionId:"@"},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,n,r,i,a,o){function l(){n.getPyramid(S.competitionId).then(function(e){for(var t=I;t>0;--t)S.maxPlayers+=t;e.data&&(S.pyramid=e.data,s(),c(),d(),p(),m())})}function s(){S.pyramid.players=r("orderBy")(S.pyramid.players,"position")}function c(){a.isAuthenticated()&&(S.currentUserIsOwner=_.some(S.pyramid.owners,["_id",a.currentUser._id])),_.forEach(S.pyramid.players,function(e){a.isAuthenticated()&&e._id===a.currentUser._id&&(S.currentUserIsOnPyramid=!0,e.class="current-user",S.currentUserPlayer=e,o.getActiveChallengeByCompetitionByPlayer(S.competitionId,e._id).then(function(e){e.data&&(S.hasActiveChallenge=!0)}))}),_.forEach(S.pyramid.pendingPlayers,function(e){a.isAuthenticated()&&e._id===a.currentUser._id&&(S.currentUserIsPending=!0)}),o.getActiveChallengesByCompetition(S.competitionId).then(function(e){_.forEach(e.data,function(e){var t=_.find(S.pyramid.players,{_id:e.challenger._id});t.class="unavailable",t.challenge={position:"challenger"};var n=_.find(S.pyramid.players,{_id:e.opponent._id});if(n.class="unavailable",n.challenge={position:"opponent"},0!==e.timeLimit){var r=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1;r>0?n.challenge.expires=r:r<=0&&g(null,!0,n)}}),f()})}function u(){S.breakPoints=[];for(var e=0;e<I;e++)S.breakPoints.push(e*(e+1)/2+1)}function d(){var e=0;S.levels=[],u();for(var t=0;t<S.pyramid.players.length;t++)S.breakPoints.indexOf(t+1)>-1&&(e+=1,S.levels.push(e)),S.pyramid.players[t].level=e}function p(){S.numberOfBlocks=0;for(var e=_.last(S.levels);e>0;e--)S.numberOfBlocks+=e}function m(){S.numberOfRealPlayers=S.pyramid.players.length;for(var e=S.pyramid.players.length;e<S.numberOfBlocks;e++)S.pyramid.players.push({firstName:"Empty",lastName:"Spot",position:99,class:"empty"});d()}function f(){var e=S.currentUserPlayer.level>1?S.currentUserPlayer.level-1:null;_.forEach(S.pyramid.players,function(t){t.level===e&&99!==t.position&&"unavailable"!==t.class&&(S.availableChallenges=!0,t.available=!0)})}function y(e){if(e.available){S.hasActiveChallenge=!0;var t={competitionName:S.pyramid.name,competitionId:S.competitionId,complete:!1,forfeit:!1,timeLimit:S.pyramid.forfeitDays,challenger:{_id:S.currentUserPlayer._id,email:S.currentUserPlayer.email,firstName:S.currentUserPlayer.firstName,lastName:S.currentUserPlayer.lastName,position:S.currentUserPlayer.position},opponent:{_id:e._id,email:e.email,firstName:e.firstName,lastName:e.lastName,position:e.position}};o.createChallenge(t).then(function(){S.pyramidMenuToggle=!1})}else i.error("Sorry, that is not a valid challenge.")}function g(e,t,r){var i=r||S.currentUserPlayer;o.getActiveChallengeByCompetitionByPlayer(S.competitionId,i._id).then(function(i){S.hasActiveChallenge=!1;var a=!1;t?(i.data.forfeit=!0,"opponent"===r.challenge.position?(i.data.winner="challenger",a=!0):i.data.winner="opponent"):e?i.data.challenger._id===S.currentUserPlayer._id?(i.data.winner="challenger",a=!0):i.data.winner="opponent":i.data.challenger._id===S.currentUserPlayer._id?i.data.winner="opponent":(i.data.winner="challenger",a=!0),a?n.swapPositions(S.competitionId,i.data.opponent,i.data.challenger).then(function(){o.completeChallenge(i.data).then(function(){b&&w()})}):o.completeChallenge(i.data).then(function(){b&&w()}),S.pyramidMenuToggle=!1})}function v(e){g(null,!0,e)}function h(){if(a.isAuthenticated())if(S.numberOfRealPlayers<S.maxPlayers){var e={_id:a.currentUser._id,firstName:a.currentUser.firstName,lastName:a.currentUser.lastName,email:a.currentUser.username,position:S.numberOfRealPlayers+1};S.pyramid.open?swal({title:"Join Competition?",text:"You'll be added to the bottom",type:"warning",showCancelButton:!0,confirmButtonText:"Join",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToPyramid(S.competitionId,e),swal("Welcome Aboard!","Now start fighting your way to the top","success")}):swal({title:"Send Join Request?",text:"This is a closed competition so the owner must approve your request",type:"warning",showCancelButton:!0,confirmButtonText:"Send Request",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToPyramidRequest(S.pyramid,e).then(function(){S.currentUserIsPending=!0}),swal("Request Sent","You will receive an email once the owner processes the request.","success")})}else i.warning("Sorry, this pyramid is full");else t.go("login")}function P(){swal({title:"Leave Pyramid?",text:"You will lose your spot and forfeit any active challenges.",type:"error",showCancelButton:!0,confirmButtonText:"Yes, leave",confirmButtonClass:"btn-danger",cancelButtonText:"No, stay",closeOnConfirm:!1,closeOnCancel:!0},function(){w(),swal("OK, you'r out!","You've been removed from the pyramid.","success")})}function w(){a.isAuthenticated()&&S.currentUserIsOnPyramid&&(b=!0,S.hasActiveChallenge?g(null,!0,S.currentUserPlayer):(S.currentUserIsOnPyramid=!1,S.hasActiveChallenge=!1,n.getPyramid(S.competitionId).then(function(e){var t=e.data,r=S.currentUserPlayer.position;_.forEach(t.players,function(e){e.position>=r&&(e.position-=1)});for(var i=_.remove(t.players,function(e){return e._id===S.currentUserPlayer._id}),a=[],o=0;o<S.numberOfRealPlayers-1;++o){var l={_id:t.players[o]._id,firstName:t.players[o].firstName,lastName:t.players[o].lastName,position:t.players[o].position};a.push(l)}n.removedPlayerFromPyramid(S.competitionId,i[0],a).then(function(){b=!1})})))}function C(){n.getPyramid(S.competitionId).then(function(e){S.pyramid=e.data,s(),c(),d(),p(),m()})}var I=10,S=this;S.pyramid={},S.breakPoints=[],S.levels=[],S.numberOfBlocks=0,S.currentUserIsOnPyramid=!1,S.currentUserIsPending=!1,S.currentUserIsOwner=!1,S.hasActiveChallenge=!1,S.availableChallenges=!1,S.createChallenge=y,S.completeChallenge=g,S.challengeExpired=v,S.currentUserPlayer={},S.pyramidMenuToggle=!1,S.addCurrentUserToPyramid=h,S.confirmRemoveCurrentUserFromPyramid=P,S.numberOfRealPlayers=0,S.maxPlayers=0,l();var b=!1;e.$on("ws:challenge_created",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:challenge_completed",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),b||C())}),e.$on("ws:player_added",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:player_removed",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())})}t.$inject=["$scope","$state","pyramidsService","$filter","notifyService","identityService","challengesService"],angular.module("app").directive("kpPyramid",e)}(),function(){"use strict";function e(e){function t(t){return e.get("/api/pyramid",{params:{competitionId:t}})}function n(t){return e.get("/api/pyramids/user",{params:{userId:t}})}function r(){return e.get("/api/pyramids")}function i(t){return e.post("/api/pyramids/create",{pyramid:t})}function a(t,n,r){return e.post("/api/pyramids/swapPositions",{competitionId:t,challenger:n,opponent:r})}function o(t,n){return e.post("/api/pyramids/addPlayer",{competitionId:t,player:n})}function l(t,n){return e.post("/api/pyramids/addPlayerRequest",{competition:t,player:n})}function s(t,n,r){return e.post("/api/pyramids/removePlayer",{competitionId:t,removedPlayer:n,players:r})}function c(t,n){return e.post("/api/pyramids/approvePlayer",{competitionId:t,player:n})}function u(t,n){return e.post("/api/pyramids/denyPlayer",{competitionId:t,player:n})}var d={getPyramid:t,getPyramidsForUser:n,getPyramids:r,createPyramid:i,swapPositions:a,addPlayerToPyramid:o,addPlayerToPyramidRequest:l,removedPlayerFromPyramid:s,approvePendingPlayer:c,denyPendingPlayer:u};return d}e.$inject=["$http"],angular.module("app").factory("pyramidsService",e)}(),function(){"use strict";function e(e,t,n,r){function i(){t.competitionId?(a.competitionId=t.competitionId,n.getPyramid(a.competitionId).then(function(t){t.data&&_.some(t.data.owners,["_id",r.currentUser._id])?a.pyramid=t.data:e.go("pyramids.myPyramids")})):e.go("pyramids.myPyramids")}var a=this;a.competitionId=null,a.pyramid=null,i()}e.$inject=["$state","$stateParams","pyramidsService","identityService"],angular.module("app").controller("AdminCtrl",e)}(),function(){"use strict";function e(e,t,n,r,i){function a(){t.getAllUsers().then(function(e){d.availablePlayers=e.data});for(var e=0;e<u;e++)c.push(e*(e+1)/2+1)}function o(e){d.addedPlayers.push(_.remove(d.availablePlayers,{_id:e._id})[0])}function l(e){d.availablePlayers.push(_.remove(d.addedPlayers,{_id:e._id})[0])}function s(t){angular.forEach(d.addedPlayers,function(e){p+=1;var n={position:p,_id:e._id,email:e.username,firstName:e.firstName,lastName:e.lastName};t.players.push(n)}),t.owners=[{_id:i.currentUser._id,email:i.currentUser.username,firstName:i.currentUser.firstName,lastName:i.currentUser.lastName}];for(var r=0;r<c.length;r++)if(t.players.length<c[r]){t.levels=r;break}n.createPyramid(t).then(function(t){e.go("pyramids.view",{competitionId:t.data._id})})}var c=[],u=10,d=this;d.newPyramid={players:[],open:!1},d.availablePlayers=[],d.addedPlayers=[],d.createPyramid=s,d.addPlayer=o,d.removePlayer=l,d.newPyramid.forfeitDays=1,a();var p=0}e.$inject=["$state","userService","pyramidsService","notifyService","identityService"],angular.module("app").controller("CreatePyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("MyPyramidsCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){t.competitionId&&(i.competitionId=t.competitionId,n.getPyramid(i.competitionId).then(function(t){t.data?i.pyramid=t.data:e.go("pyramids.myPyramids")}))}var i=this;i.competitionId=null,i.pyramid=null,r()}e.$inject=["$state","$stateParams","pyramidsService"],angular.module("app").controller("PyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("PyramidsCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){e.competitionId&&(i.competitionId=e.competitionId,n.getPyramid(i.competitionId).then(function(e){e.data?i.pyramid=e.data:t.go("pyramids.myPyramids")}))}var i=this;i.competitionId=null,i.pyramid=null,r()}e.$inject=["$stateParams","$state","pyramidsService"],angular.module("app").controller("StatsCtrl",e)}(),function(){"use strict";function e(e){function t(t,n,r){var i=r.scrollaxis||"y",a=r.theme||"minimal-dark",o=r.mousewheelaxis||"y";$("html").hasClass("ismobile")||e.malihuScroll(n,a,i,o)}var n={restrict:"C",link:t};return n}e.$inject=["scrollbarService"],angular.module("app").directive("cOverflow",e)}(),function(){"use strict";function e(){function e(e,t){t.click(function(){t.next().slideToggle(200),t.parent().toggleClass("toggled")})}var t={restrict:"A",link:e};return t}angular.module("app").directive("toggleSubmenu",e)}(),function(){"use strict";function e(){function e(e,t){t.hasClass("btn-icon")||t.hasClass("btn-float")?Waves.attach(t,["waves-circle"]):t.hasClass("btn-light")?Waves.attach(t,["waves-light"]):Waves.attach(t),Waves.init()}var t={restrict:"C",link:e};return t}angular.module("app").directive("wavesEffect",e)}(),function(){"use strict";function e(){function e(e,t){var n=t.children().first(),r=t.parent().hasClass("fg-float");n.focus(function(){t.addClass("fg-toggled")}),n.blur(function(){(!r||r&&0===n.val().length)&&t.removeClass("fg-toggled")})}var t={restrict:"C",link:e};return t}angular.module("app").directive("fgLine",e)}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiYXBwLmNvbnRyb2xsZXIuanMiLCJhcHAucm91dGVzLmpzIiwiYXBwLnJ1bi5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL2F1dGguc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL3VzZXIuc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3ZpZXdzL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJhdXRoZW50aWNhdGlvbi92aWV3cy9yZWdpc3Rlci5jb250cm9sbGVyLmpzIiwiYXV0aGVudGljYXRpb24vdmlld3MvdmVyaWZpY2F0aW9uLmNvbnRyb2xsZXIuanMiLCJjaGFsbGVuZ2VzL2NvbXBvbmVudHMvYWN0aXZlLWNoYWxsZW5nZXMuZGlyZWN0aXZlLmpzIiwiY2hhbGxlbmdlcy9jb21wb25lbnRzL2NvbXBsZXRlZC1jaGFsbGVuZ2VzLmRpcmVjdGl2ZS5qcyIsImNoYWxsZW5nZXMvY29tcG9uZW50cy9wbGF5ZXItb3ZlcmFsbC1yZXN1bHRzLmRpcmVjdGl2ZS5qcyIsImNoYWxsZW5nZXMvc2VydmljZXMvY2hhbGxlbmdlcy5zZXJ2aWNlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvZm9vdGVyLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL2hlYWRlci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy9zaWRlYmFyLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9maWx0ZXJzL29yZGVyLW9iamVjdC1ieS5maWx0ZXIuanMiLCJjb21tb24vdmlld3MvaG9tZS5jb250cm9sbGVyLmpzIiwiY29tbW9uL3NlcnZpY2VzL2luZGVudGl0eS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL25vdGlmeS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3Njcm9sbGJhci5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3NpZGViYXIuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy93ZWJzb2NrZXQuc2VydmljZS5qcyIsInB5cmFtaWRzL2NvbXBvbmVudHMvcGVuZGluZy1wbGF5ZXJzLmRpcmVjdGl2ZS5qcyIsInB5cmFtaWRzL2NvbXBvbmVudHMvcHlyYW1pZC1jb21wYWN0LmRpcmVjdGl2ZS5qcyIsInB5cmFtaWRzL2NvbXBvbmVudHMvcHlyYW1pZC5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9zZXJ2aWNlcy9weXJhbWlkcy5zZXJ2aWNlLmpzIiwicHlyYW1pZHMvdmlld3MvYWRtaW4uY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL2NyZWF0ZS1weXJhbWlkLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy92aWV3cy9teS1weXJhbWlkcy5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvcHlyYW1pZC5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvcHlyYW1pZHMuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL3N0YXRzLmNvbnRyb2xsZXIuanMiLCJjb21tb24vY29tcG9uZW50cy91aS9zY3JvbGxiYXIuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvdWkvdG9nZ2xlLXN1Ym1lbnUuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvdWkvd2F2ZXMuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvdWkvZm9ybXMvZmctbGluZS5kaXJlY3RpdmUuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZ3VyYXRpb24iLCIkaHR0cFByb3ZpZGVyIiwiJHVpYlRvb2x0aXBQcm92aWRlciIsImRlZmF1bHRzIiwiaGVhZGVycyIsImdldCIsIm9wdGlvbnMiLCJhcHBlbmRUb0JvZHkiLCJjb25maWciLCJBcHBDdHJsIiwiJHN0YXRlIiwibG9jYWxTdG9yYWdlU2VydmljZSIsInRvZ2dsZVNpZGViYXJMb2NrZWQiLCJsb2NrZWQiLCJzZXQiLCJhcHBDdHJsIiwidGhpcyIsImxvY2tTaWRlYmFyIiwiY29udHJvbGxlciIsImNvbmZpZ3VyZVJvdXRlcyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJyb3V0ZVJvbGVDaGVja3MiLCJzdXBlckFkbWluIiwicmVxdWlyZVN1cGVyQWRtaW4iLCJhZG1pbiIsInJlcXVpcmVBZG1pbiIsInVzZXIiLCJyZXF1aXJlQXV0aCIsImh0bWw1TW9kZSIsIm90aGVyd2lzZSIsIndoZW4iLCJzdGF0ZSIsInVybCIsInZpZXdzIiwiY29udGVudCIsImNvbnRyb2xsZXJBcyIsInRlbXBsYXRlVXJsIiwiY29udGVudEAiLCJyZXNvbHZlIiwiYXV0aCIsImF1dGhTZXJ2aWNlIiwiYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSIsImF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUiLCIkaW5qZWN0IiwiYXBwUnVuIiwiJHJvb3RTY29wZSIsInNpZGViYXJTZXJ2aWNlIiwiJG9uIiwiZXZlbnQiLCJ0b1N0YXRlIiwidG9QYXJhbXMiLCJmcm9tU3RhdGUiLCJmcm9tUGFyYW1zIiwiZXJyb3IiLCJnbyIsInByZXZpb3VzIiwicHJldlBhcmFtcyIsInNldFNpZGViYXJTdGF0dXMiLCJydW4iLCIkaHR0cCIsIiRxIiwidXNlclNlcnZpY2UiLCJpZGVudGl0eVNlcnZpY2UiLCJub3RpZnlTZXJ2aWNlIiwiYXV0aGVudGljYXRlVXNlciIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJkZmQiLCJkZWZlciIsInBvc3QiLCJ0aGVuIiwicmVzcG9uc2UiLCJkYXRhIiwic3VjY2VzcyIsImN1cnJlbnRVc2VyIiwibWVzc2FnZSIsInByb21pc2UiLCJjcmVhdGVVc2VyIiwidXNlckRhdGEiLCJyZWFzb24iLCJsb2dvdXQiLCJ1bmRlZmluZWQiLCJyb2xlIiwiaXNBdXRob3JpemVkIiwicmVqZWN0IiwiaXNBdXRoZW50aWNhdGVkIiwic2VydmljZSIsImZhY3RvcnkiLCJnZXRBbGxVc2VycyIsInVzZXJzIiwidmVyaWZ5VXNlciIsInVzZXJJZCIsInZlcmlmaWNhdGlvblRva2VuIiwicGFyYW1zIiwiTG9naW5DdHJsIiwiYWN0aXZhdGUiLCJsb2dpbiIsInZtIiwiUmVnaXN0ZXJDdHJsIiwicmVnaXN0ZXIiLCJuZXdVc2VyIiwiY29uZmlybVBhc3N3b3JkIiwiVmVyaWZpY2F0aW9uQ3RybCIsIiRzdGF0ZVBhcmFtcyIsInZlcmlmeWluZyIsInZlcmlmaWVkIiwia3BBY3RpdmVDaGFsbGVuZWdlcyIsImRpcmVjdGl2ZSIsImJpbmRUb0NvbnRyb2xsZXIiLCJjdHJsRnVuYyIsInJlc3RyaWN0Iiwic2NvcGUiLCJjb21wZXRpdGlvbklkIiwiJHNjb3BlIiwiY2hhbGxlbmdlc1NlcnZpY2UiLCJnZXRBY3RpdmVDaGFsbGVuZ2VzIiwiY2hhbGxlbmdlcyIsImdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uIiwibGVuZ3RoIiwiXyIsImZvckVhY2giLCJjaGFsbGVuZ2UiLCJ0aW1lTGltaXQiLCJleHBpcmVzIiwibW9tZW50IiwiZGlmZiIsImNyZWF0ZWQiLCJhZGQiLCJjaGFsbGVuZ2VEZXRhaWxzIiwia3BDb21wbGV0ZWRDaGFsbGVuZWdlcyIsImxpbWl0IiwiZ2V0Q29tcGxldGVkQ2hhbGxlbmdlcyIsImdldENvbXBsZXRlZENoYWxsZW5nZXNCeUNvbXBldGl0aW9uIiwibG9zZXIiLCJ3aW5uZXIiLCJ3aGVuQ29tcGxldGVkIiwiY29tcGxldGVkIiwiY2FsZW5kYXIiLCJzYW1lRGF5IiwibmV4dERheSIsIm5leHRXZWVrIiwibGFzdERheSIsImxhc3RXZWVrIiwic2FtZUVsc2UiLCJrcFBsYXllck92ZXJhbGxSZXN1bHRzIiwicGxheWVyIiwiZ2V0UGxheWVyT3ZlcmFsbFJlc3VsdHMiLCJfaWQiLCJwbGF5ZXJJZCIsImdldFBsYXllclJlc3VsdHNCeUNvbXBldGl0aW9uIiwicmVzdWx0cyIsImJyZWFrUG9pbnRzIiwiaSIsIm1heExldmVscyIsInB1c2giLCJsZXZlbCIsImoiLCJwb3NpdGlvbiIsImluZGV4T2YiLCJzdHJlYWtUeXBlIiwic3RyZWFrIiwiY29udGludWVTdHJlYWsiLCJjaGFsbGVuZ2VyIiwib3Bwb25lbnQiLCJ0eXBlIiwidmFsdWUiLCJ3aW5zIiwiYXNPcHBvbmVudCIsInNpemUiLCJmaWx0ZXIiLCJhc0NoYWxsZW5nZXIiLCJ0b3RhbCIsImJ5Rm9yZmVpdCIsImZvcmZlaXQiLCJsb3NlcyIsImNoYWxsZW5nZXJJZCIsImluZm8iLCJkZXNjcmlwdGlvbiIsIm9wcG9uZW50SWQiLCJjcmVhdGVDaGFsbGVuZ2UiLCJjb21wbGV0ZUNoYWxsZW5nZSIsImdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uIiwiZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyIiwia3BGb290ZXIiLCJpbmRlbnRpdHkiLCJrcEhlYWRlciIsInRvZ2dsZVNpZGViYXIiLCJzaWRlYmFyU3RhdHVzIiwibGVmdCIsImdldFNpZGViYXJTdGF0dXMiLCJrcFNpZGViYXIiLCJvcmRlck9iamVjdEJ5IiwiaW5wdXQiLCJhdHRyaWJ1dGUiLCJpc09iamVjdCIsImFycmF5Iiwib2JqZWN0S2V5Iiwic29ydCIsImEiLCJiIiwicGFyc2VJbnQiLCJIb21lQ3RybCIsIiR3aW5kb3ciLCJyb2xlcyIsImJvb3RzdHJhcHBlZFVzZXJPYmplY3QiLCJ0YXJnZXQiLCIkIiwibm90aWZ5Iiwid2FybmluZyIsImludmVyc2UiLCJub3RpZnlEZWZhdWx0cyIsIm5ld2VzdF9vbl90b3AiLCJvZmZzZXQiLCJ4IiwieSIsInNjcm9sbGJhclNlcnZpY2UiLCJtYWxpaHVTY3JvbGwiLCJzZWxlY3RvciIsInRoZW1lIiwic2Nyb2xsYXhpcyIsIm1vdXNld2hlZWxheGlzIiwibUN1c3RvbVNjcm9sbGJhciIsInNjcm9sbEluZXJ0aWEiLCJheGlzIiwibW91c2VXaGVlbCIsImVuYWJsZSIsInByZXZlbnREZWZhdWx0Iiwic3RhdHVzIiwicmlnaHQiLCJ3ZWJzb2NrZXRIb3N0IiwibG9jYXRpb24iLCJwcm90b2NvbCIsImhvc3QiLCJjb25uZWN0aW9uIiwiY29ubmVjdCIsIldlYlNvY2tldCIsIm9ubWVzc2FnZSIsImUiLCJwYXlsb2FkIiwiSlNPTiIsInBhcnNlIiwiJGJyb2FkY2FzdCIsInRvcGljIiwic2VuZCIsImpzb24iLCJzdHJpbmdpZnkiLCJ3ZWJzb2NrZXRTZXJ2aWNlIiwia3BQZW5kaW5nUGxheWVycyIsInB5cmFtaWRzU2VydmljZSIsImdldFBlbmRpbmdQbGF5ZXJzIiwicGVuZGluZ1BsYXllcnMiLCJnZXRQeXJhbWlkIiwicHlyYW1pZCIsImFwcHJvdmVQZW5kaW5nUGxheWVyIiwicGxheWVycyIsImRlbnlQZW5kaW5nUGxheWVyIiwia3BQeXJhbWlkQ29tcGFjdCIsImdldFB5cmFtaWRzRm9yVXNlciIsInB5cmFtaWRzIiwiZ2V0UHlyYW1pZHMiLCJrcFB5cmFtaWQiLCJyZXBsYWNlIiwiJGZpbHRlciIsIm1heFBsYXllcnMiLCJvcmRlclBsYXllcnMiLCJnZXRQbGF5ZXJzU3RhdHVzIiwiYXNzaWduTGV2ZWxzVG9QbGF5ZXJzIiwiY2FsY3VsYXRlUHlyYW1pZEJsb2NrcyIsImZpbGxJbkVtcHR5QmxvY2tzIiwiY3VycmVudFVzZXJJc093bmVyIiwic29tZSIsIm93bmVycyIsImN1cnJlbnRVc2VySXNPblB5cmFtaWQiLCJjbGFzcyIsImN1cnJlbnRVc2VyUGxheWVyIiwiaGFzQWN0aXZlQ2hhbGxlbmdlIiwiY3VycmVudFVzZXJJc1BlbmRpbmciLCJmaW5kIiwidGltZVRvRXhwaXJlIiwiZmluZEF2YWlsYWJsZUNoYWxsZW5nZXMiLCJjcmVhdGVCcmVha1BvaW50cyIsImxldmVscyIsIm51bWJlck9mQmxvY2tzIiwibGFzdCIsIm51bWJlck9mUmVhbFBsYXllcnMiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsImxldmVsQWJvdmUiLCJhdmFpbGFibGVDaGFsbGVuZ2VzIiwiYXZhaWxhYmxlIiwiY29tcGV0aXRpb25OYW1lIiwibmFtZSIsImNvbXBsZXRlIiwiZm9yZmVpdERheXMiLCJlbWFpbCIsInB5cmFtaWRNZW51VG9nZ2xlIiwid2lubmVySXNDdXJyZW50VXNlciIsImZvcmZlaXRMb3NlciIsInN3YXBQb3NpdGlvbnMiLCJyZW1vdmluZ0N1cnJlbnRVc2VyIiwicmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCIsImNoYWxsZW5nZUV4cGlyZWQiLCJhZGRDdXJyZW50VXNlclRvUHlyYW1pZCIsIm9wZW4iLCJzd2FsIiwidGl0bGUiLCJ0ZXh0Iiwic2hvd0NhbmNlbEJ1dHRvbiIsImNvbmZpcm1CdXR0b25UZXh0IiwiY2FuY2VsQnV0dG9uVGV4dCIsImNsb3NlT25Db25maXJtIiwiY2xvc2VPbkNhbmNlbCIsImFkZFBsYXllclRvUHlyYW1pZCIsImFkZFBsYXllclRvUHlyYW1pZFJlcXVlc3QiLCJjb25maXJtUmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCIsImNvbmZpcm1CdXR0b25DbGFzcyIsInAiLCJvcGVuUG9zaXRpb24iLCJyZW1vdmVkUGxheWVyIiwicmVtb3ZlIiwidXBkYXRlZFBsYXllcnMiLCJ1cGRhdGVkUGxheWVyIiwicmVtb3ZlZFBsYXllckZyb21QeXJhbWlkIiwicmVmcmVzaFB5cmFtaWQiLCJkZXRhaWxzIiwiY3JlYXRlUHlyYW1pZCIsImNvbXBldGl0aW9uIiwiQWRtaW5DdHJsIiwiQ3JlYXRlUHlyYW1pZEN0cmwiLCJhdmFpbGFibGVQbGF5ZXJzIiwiYWRkUGxheWVyIiwiYWRkZWRQbGF5ZXJzIiwicmVtb3ZlUGxheWVyIiwibmV3UHlyYW1pZCIsIk15UHlyYW1pZHNDdHJsIiwiUHlyYW1pZEN0cmwiLCJQeXJhbWlkc0N0cmwiLCJTdGF0c0N0cmwiLCJjT3ZlcmZsb3ciLCJsaW5rRnVuYyIsImVsZW1lbnQiLCJhdHRycyIsImhhc0NsYXNzIiwibGluayIsInRvZ2dsZVN1Ym1lbnUiLCJlbCIsImNsaWNrIiwibmV4dCIsInNsaWRlVG9nZ2xlIiwicGFyZW50IiwidG9nZ2xlQ2xhc3MiLCJ3YXZlc0VmZmVjdCIsIldhdmVzIiwiYXR0YWNoIiwiaW5pdCIsImZnTGluZSIsImNoaWxkcmVuIiwiZmlyc3Qi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QUNBQSxFQUFBRSxTQUFBLGFBQ0FVLE1BQUFDLE9BQUFiLEdBQUEsZ0JBRUFZLE1BQUFDLE9BQUFiLEdBR0FZLE1BQUFFLE9BaEJBLEdBQUF2UCxJQUNBRyxTQUFBLElBQ0F5TyxLQUFBSixFQUdBLE9BQUF4TyxHQVZBL0csUUFDQUMsT0FBQSxPQUNBOEcsVUFBQSxjQUFBb1AsTUNKQSxXQUNBLFlBS0EsU0FBQUksS0FRQSxRQUFBaEIsR0FBQXBPLEVBQUFxTyxHQUNBLEdBQUFwSixHQUFBb0osRUFBQWdCLFdBQUFDLFFBQ0FDLEVBQUFsQixFQUFBUyxTQUFBUCxTQUFBLFdBQ0F0SixHQUFBdUssTUFBQSxXQUNBbkIsRUFBQW9CLFNBQUEsZ0JBR0F4SyxFQUFBeUssS0FBQSxhQUNBSCxHQUFBQSxHQUFBLElBQUF0SyxFQUFBMEssTUFBQXBQLFNBQ0E4TixFQUFBdUIsWUFBQSxnQkFoQkEsR0FBQWhRLElBQ0FHLFNBQUEsSUFDQXlPLEtBQUFKLEVBR0EsT0FBQXhPLEdBVkEvRyxRQUNBQyxPQUFBLE9BQ0E4RyxVQUFBLFNBQUF3UCIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAndWkucm91dGVyJyxcbiAgJ3VpLmJvb3RzdHJhcCcsXG4gICduZ0FuaW1hdGUnLFxuICAnYW5ndWxhci1sb2FkaW5nLWJhcicsXG4gICdub3Vpc2xpZGVyJyxcbiAgJ2xvY2FseXRpY3MuZGlyZWN0aXZlcycsXG4gICd0aW1lcicsXG4gICdMb2NhbFN0b3JhZ2VNb2R1bGUnXG5dKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCAnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29uZmlnKGNvbmZpZ3VyYXRpb24pO1xuXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyYXRpb24oJGh0dHBQcm92aWRlciwgJHVpYlRvb2x0aXBQcm92aWRlcikge1xuICAgIC8vaW5pdGlhbGl6ZSBnZXQgaWYgbm90IHRoZXJlXG4gICAgaWYgKCEkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0KSB7XG4gICAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0ID0ge307ICAgIFxuICAgIH0gICAgXG4gICAgLy9kaXNhYmxlIElFIGFqYXggcmVxdWVzdCBjYWNoaW5nXG4gICAgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldFsnSWYtTW9kaWZpZWQtU2luY2UnXSA9ICdGcmksIDAxIEphbiAyMDE2IDA1OjAwOjAwIEdNVCc7XG4gICAgLy8gZXh0cmFcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0WydDYWNoZS1Db250cm9sJ10gPSAnbm8tY2FjaGUnO1xuICAgICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXRbJ1ByYWdtYSddID0gJ25vLWNhY2hlJztcblxuICAgICR1aWJUb29sdGlwUHJvdmlkZXIub3B0aW9ucyh7IGFwcGVuZFRvQm9keTogdHJ1ZSB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdBcHBDdHJsJywgQXBwQ3RybCk7XG5cbiAgZnVuY3Rpb24gQXBwQ3RybCgkc3RhdGUsIGxvY2FsU3RvcmFnZVNlcnZpY2UpIHtcbiAgICB2YXIgYXBwQ3RybCA9IHRoaXM7XG4gICAgLy8gVXNlIHRoaXMgZm9yIFNpZGViYXIgbWVudVxuICAgIGFwcEN0cmwuJHN0YXRlID0gJHN0YXRlO1xuICAgIC8vIExvY2sgdGhlIHNpZGViYXIgaW4gdmlld1xuICAgIGFwcEN0cmwubG9ja1NpZGViYXIgPSBsb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldCgnc2lkZWJhckxvY2tlZCcpO1xuICAgIGFwcEN0cmwudG9nZ2xlU2lkZWJhckxvY2tlZCA9IHRvZ2dsZVNpZGViYXJMb2NrZWQ7XG5cbiAgICBmdW5jdGlvbiB0b2dnbGVTaWRlYmFyTG9ja2VkKGxvY2tlZCkge1xuICAgICAgbG9jYWxTdG9yYWdlU2VydmljZS5zZXQoJ3NpZGViYXJMb2NrZWQnLCBsb2NrZWQpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb25maWcoY29uZmlndXJlUm91dGVzKTtcblxuICBmdW5jdGlvbiBjb25maWd1cmVSb3V0ZXMoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICB2YXIgcm91dGVSb2xlQ2hlY2tzID0ge1xuICAgICAgc3VwZXJBZG1pbjogcmVxdWlyZVN1cGVyQWRtaW4sXG4gICAgICBhZG1pbjogcmVxdWlyZUFkbWluLFxuICAgICAgdXNlcjogcmVxdWlyZUF1dGhcbiAgICB9O1xuXG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgLy8gZm9yIGFueSB1bm1hdGNoZWQgdXJsXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLndoZW4oJy9weXJhbWlkcy8nLCAnL3B5cmFtaWRzJyk7XG5cbiAgICAkc3RhdGVQcm92aWRlclxuICAgICAgLnN0YXRlKCdob21lJywge1xuICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbW1vbi92aWV3cy9ob21lLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMnLCB7XG4gICAgICAgIHVybDogJy9weXJhbWlkcycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHlyYW1pZHNDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvcHlyYW1pZHMuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy5teVB5cmFtaWRzJywge1xuICAgICAgICB1cmw6ICcvbXktcHlyYW1pZHMnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNeVB5cmFtaWRzQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL215LXB5cmFtaWRzLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLnZpZXcnLCB7XG4gICAgICAgIHVybDogJy92aWV3Lzpjb21wZXRpdGlvbklkJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHlyYW1pZEN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9weXJhbWlkLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMuc3RhdHMnLCB7XG4gICAgICAgIHVybDogJy9zdGF0cy86Y29tcGV0aXRpb25JZCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0YXRzQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL3N0YXRzLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMuYWRtaW4nLCB7XG4gICAgICAgIHVybDogJy9hZG1pbi86Y29tcGV0aXRpb25JZCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0FkbWluQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL2FkbWluLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLmNyZWF0ZScsIHtcbiAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0NyZWF0ZVB5cmFtaWRDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvY3JlYXRlLXB5cmFtaWQuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICBhdXRoOiByb3V0ZVJvbGVDaGVja3MudXNlclxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvbG9naW4uaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdyZWdpc3RlcicsIHtcbiAgICAgICAgdXJsOiAnL3JlZ2lzdGVyJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy9yZWdpc3Rlci5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3ZlcmlmeScsIHtcbiAgICAgICAgdXJsOiAnL3ZlcmlmaWNhdGlvbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVmVyaWZpY2F0aW9uQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3ZlcmlmaWNhdGlvbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3ZlcmlmaWNhdGlvbicsIHtcbiAgICAgICAgdXJsOiAnL3ZlcmlmaWNhdGlvbi86dXNlcklkLzp2ZXJpZmljYXRpb25Ub2tlbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVmVyaWZpY2F0aW9uQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3ZlcmlmaWNhdGlvbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cblxuICByZXF1aXJlQWRtaW4uJGluamVjdCA9IFsnYXV0aFNlcnZpY2UnXTtcblxuICBmdW5jdGlvbiByZXF1aXJlQWRtaW4oYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSgnYWRtaW4nKTtcbiAgfVxuXG4gIHJlcXVpcmVTdXBlckFkbWluLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZVN1cGVyQWRtaW4oYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSgnc3VwZXItYWRtaW4nKTtcbiAgfVxuXG4gIHJlcXVpcmVBdXRoLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZUF1dGgoYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLnJ1bihhcHBSdW4pO1xuXG4gIGZ1bmN0aW9uIGFwcFJ1bigkcm9vdFNjb3BlLCAkc3RhdGUsIHNpZGViYXJTZXJ2aWNlKSB7XG4gICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZUVycm9yJywgZnVuY3Rpb24gKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCBlcnJvcikge1xuICAgICAgaWYgKGVycm9yID09PSAnbm90IGF1dGhvcml6ZWQnKSB7XG4gICAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcbiAgICAgICAgJHN0YXRlLnByZXZpb3VzID0gdG9TdGF0ZTtcbiAgICAgICAgJHN0YXRlLnByZXZQYXJhbXMgPSB0b1BhcmFtcztcbiAgICAgIH1cbiAgICB9KTtcblxuICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHNpZGViYXJTZXJ2aWNlLnNldFNpZGViYXJTdGF0dXMoZmFsc2UpO1xuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ2F1dGhTZXJ2aWNlJywgYXV0aFNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIGF1dGhTZXJ2aWNlKCRzdGF0ZSwgJGh0dHAsICRxLCB1c2VyU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBhdXRoZW50aWNhdGVVc2VyOiBhdXRoZW50aWNhdGVVc2VyLFxuICAgICAgY3JlYXRlVXNlcjogY3JlYXRlVXNlcixcbiAgICAgIGxvZ291dDogbG9nb3V0LFxuICAgICAgYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZTogYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSxcbiAgICAgIGF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGU6IGF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGVcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gYXV0aGVudGljYXRlVXNlcih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xuICAgICAgJGh0dHAucG9zdCgnL2xvZ2luJywge1xuICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3VjY2Vzcykge1xuICAgICAgICAgIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlciA9IHJlc3BvbnNlLmRhdGEudXNlcjtcbiAgICAgICAgICBkZmQucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UgPT09ICd1bnZlcmlmaWVkJykge1xuICAgICAgICAgIGRmZC5yZXNvbHZlKCd1bnZlcmlmaWVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVVc2VyKHVzZXJEYXRhKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG4gICAgICAgIHVzZXJEYXRhOiB1c2VyRGF0YVxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICBkZmQucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkZmQucmVzb2x2ZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5yZWFzb24gPT09ICdFcnJvcjogRHVwbGljYXRlIFVzZXJuYW1lJykge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1NvcnJ5LCBhbiBhY2NvdW50IGFscmVhZHkgZXhpc3RzIHdpdGggdGhhdCBlbWFpbCBhZGRyZXNzLicpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9sb2dvdXQnLCB7XG4gICAgICAgIGxvZ291dDogdHJ1ZVxuICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgZGZkLnJlc29sdmUoKTtcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlKHJvbGUpIHtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRob3JpemVkKHJvbGUpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICRxLnJlamVjdCgnbm90IGF1dGhvcml6ZWQnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlKCkge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoJ25vdCBhdXRob3JpemVkJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ3VzZXJTZXJ2aWNlJywgdXNlclNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHVzZXJTZXJ2aWNlKCRodHRwKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBnZXRBbGxVc2VyczogZ2V0QWxsVXNlcnMsXG4gICAgICB2ZXJpZnlVc2VyOiB2ZXJpZnlVc2VyXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGdldEFsbFVzZXJzKCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIHJldHVybiB1c2VycztcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZlcmlmeVVzZXIodXNlcklkLCB2ZXJpZmljYXRpb25Ub2tlbikge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VyL3ZlcmlmaWNhdGlvbicsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgdXNlcklkOiB1c2VySWQsXG4gICAgICAgICAgdmVyaWZpY2F0aW9uVG9rZW46IHZlcmlmaWNhdGlvblRva2VuXG4gICAgICAgIH1cbiAgICAgIH0pOyAgXG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIExvZ2luQ3RybCk7XG5cbiAgZnVuY3Rpb24gTG9naW5DdHJsKCRzdGF0ZSwgYXV0aFNlcnZpY2UsIG5vdGlmeVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmxvZ2luID0gbG9naW47XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICBhdXRoU2VydmljZS5hdXRoZW50aWNhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1VzZXJuYW1lIC8gcGFzc3dvcmQgY29tYmluYWl0b24gaW5jb3JyZWN0Jyk7XG4gICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UgPT09ICd1bnZlcmlmaWVkJykge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1lvdSBtdXN0IHZlcmlmeSB5b3VyIGVtYWlsIGJlZm9yZSB5b3UgY2FuIGxvZ2luJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKCRzdGF0ZS5wcmV2aW91cykge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCRzdGF0ZS5wcmV2aW91cywgJHN0YXRlLnByZXZQYXJhbXMpO1xuICAgICAgICAgICAgJHN0YXRlLnByZXZpb3VzID0gbnVsbDtcbiAgICAgICAgICAgICRzdGF0ZS5wcmV2UGFyYW1zID0gbnVsbDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJywgUmVnaXN0ZXJDdHJsKTtcblxuICBmdW5jdGlvbiBSZWdpc3RlckN0cmwoJHN0YXRlLCBhdXRoU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucmVnaXN0ZXIgPSByZWdpc3RlcjtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHt9XG5cbiAgICBmdW5jdGlvbiByZWdpc3RlcihuZXdVc2VyKSB7XG4gICAgICBpZiAobmV3VXNlci5wYXNzd29yZCAhPT0gbmV3VXNlci5jb25maXJtUGFzc3dvcmQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignUGFzc3dvcmRzIGRvblxcJ3QgbWF0Y2ghJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhdXRoU2VydmljZS5jcmVhdGVVc2VyKG5ld1VzZXIpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICRzdGF0ZS5nbygndmVyaWZ5Jyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdWZXJpZmljYXRpb25DdHJsJywgVmVyaWZpY2F0aW9uQ3RybCk7XG5cbiAgZnVuY3Rpb24gVmVyaWZpY2F0aW9uQ3RybCgkc3RhdGUsICRzdGF0ZVBhcmFtcywgdXNlclNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnZlcmlmaWVkID0gdW5kZWZpbmVkO1xuICAgIHZtLnZlcmlmeWluZyA9IGZhbHNlO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy51c2VySWQgJiYgJHN0YXRlUGFyYW1zLnZlcmlmaWNhdGlvblRva2VuKSB7XG4gICAgICAgIHZtLnZlcmlmeWluZyA9IHRydWU7XG4gICAgICAgIHZtLnZlcmlmaWVkID0gbnVsbDtcbiAgICAgICAgdXNlclNlcnZpY2UudmVyaWZ5VXNlcigkc3RhdGVQYXJhbXMudXNlcklkLCAkc3RhdGVQYXJhbXMudmVyaWZpY2F0aW9uVG9rZW4pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICAgIHZtLnZlcmlmaWVkID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdm0udmVyaWZpZWQgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BBY3RpdmVDaGFsbGVuZWdlcycsIGtwQWN0aXZlQ2hhbGxlbmVnZXMpO1xuXG4gIGZ1bmN0aW9uIGtwQWN0aXZlQ2hhbGxlbmVnZXMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jaGFsbGVuZ2VzL2NvbXBvbmVudHMvYWN0aXZlLWNoYWxsZW5nZXMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlcygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZXMoKSB7XG4gICAgICB2bS5jaGFsbGVuZ2VzID0gW107XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIGlmIChjaGFsbGVuZ2VzLmRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZtLmNoYWxsZW5nZXMgPSBjaGFsbGVuZ2VzLmRhdGE7XG4gICAgICAgICAgXy5mb3JFYWNoKHZtLmNoYWxsZW5nZXMsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICAgIGlmIChjaGFsbGVuZ2UudGltZUxpbWl0ICE9PSAwKSB7XG4gICAgICAgICAgICAgIGNoYWxsZW5nZS5leHBpcmVzID0gKG1vbWVudCgpLmRpZmYobW9tZW50KGNoYWxsZW5nZS5jcmVhdGVkKS5hZGQoY2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2QnKSwncycpKSAqIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NyZWF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIGdldEFjdGl2ZUNoYWxsZW5nZXMoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BDb21wbGV0ZWRDaGFsbGVuZWdlcycsIGtwQ29tcGxldGVkQ2hhbGxlbmVnZXMpO1xuXG4gIGZ1bmN0aW9uIGtwQ29tcGxldGVkQ2hhbGxlbmVnZXMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCcsXG4gICAgICAgIGxpbWl0OiAnQCdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jaGFsbGVuZ2VzL2NvbXBvbmVudHMvY29tcGxldGVkLWNoYWxsZW5nZXMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgZ2V0Q29tcGxldGVkQ2hhbGxlbmdlcygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENvbXBsZXRlZENoYWxsZW5nZXMoKSB7XG4gICAgICB2bS5jaGFsbGVuZ2VzID0gW107XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkLCB2bS5saW1pdCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlcykge1xuICAgICAgICBpZiAoY2hhbGxlbmdlcy5kYXRhLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB2bS5jaGFsbGVuZ2VzID0gY2hhbGxlbmdlcy5kYXRhO1xuICAgICAgICAgIF8uZm9yRWFjaCh2bS5jaGFsbGVuZ2VzLCBmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UubG9zZXIgPSBjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcicgPyAnb3Bwb25lbnQnIDogJ2NoYWxsZW5nZXInO1xuICAgICAgICAgICAgY2hhbGxlbmdlLndoZW5Db21wbGV0ZWQgPSBtb21lbnQoY2hhbGxlbmdlLmNvbXBsZXRlZCkuY2FsZW5kYXIobnVsbCwge1xuICAgICAgICAgICAgICBzYW1lRGF5OiAnW1RvZGF5XScsXG4gICAgICAgICAgICAgIG5leHREYXk6ICdbVG9tb3Jyb3ddJyxcbiAgICAgICAgICAgICAgbmV4dFdlZWs6ICdkZGRkJyxcbiAgICAgICAgICAgICAgbGFzdERheTogJ1tZZXN0ZXJkYXldJyxcbiAgICAgICAgICAgICAgbGFzdFdlZWs6ICdbTGFzdF0gZGRkZCcsXG4gICAgICAgICAgICAgIHNhbWVFbHNlOiAnREQvTU0vWVlZWSdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIGdldENvbXBsZXRlZENoYWxsZW5nZXMoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BQbGF5ZXJPdmVyYWxsUmVzdWx0cycsIGtwUGxheWVyT3ZlcmFsbFJlc3VsdHMpO1xuXG4gIGZ1bmN0aW9uIGtwUGxheWVyT3ZlcmFsbFJlc3VsdHMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCcsXG4gICAgICAgIHBsYXllcjogJz0nXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY2hhbGxlbmdlcy9jb21wb25lbnRzL3BsYXllci1vdmVyYWxsLXJlc3VsdHMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBjaGFsbGVuZ2VzU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubWF4TGV2ZWxzID0gMTA7XG4gICAgdm0ud2lucyA9IHtcbiAgICAgIHRvdGFsOiAwLFxuICAgICAgYXNDaGFsbGVuZ2VyOiAwLFxuICAgICAgYXNPcHBvbmVudDogMCxcbiAgICAgIGJ5Rm9yZmVpdDogMFxuICAgIH07XG4gICAgdm0ubG9zZXMgPSB7XG4gICAgICB0b3RhbDogMCxcbiAgICAgIGFzQ2hhbGxlbmdlcjogMCxcbiAgICAgIGFzT3Bwb25lbnQ6IDAsXG4gICAgICBieUZvcmZlaXQ6IDBcbiAgICB9O1xuICAgIHZtLnN0cmVhayA9IHtcbiAgICAgIHR5cGU6IG51bGwsXG4gICAgICB2YWx1ZTogMFxuICAgIH07XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBnZXRQbGF5ZXJPdmVyYWxsUmVzdWx0cyh2bS5jb21wZXRpdGlvbklkLCB2bS5wbGF5ZXIuX2lkKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJPdmVyYWxsUmVzdWx0cyhjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkge1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCwgcGxheWVySWQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHtcblxuICAgICAgICAvLyBEZXRlcm1pbmUgYWxsIHRoZSBicmVhayBwb2ludHMgdG8gZmlndXJlIG91dCBsZXZlbHNcbiAgICAgICAgdmFyIGJyZWFrUG9pbnRzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ubWF4TGV2ZWxzOyBpKyspIHtcbiAgICAgICAgICBicmVha1BvaW50cy5wdXNoKCgoKGkgKiAoaSArIDEpKSAvIDIpKSArIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGVmYXVsdCBhbGwgcGxheWVycyB0byB0aGUgbG93ZXN0IGxldmVsXG4gICAgICAgIHZtLnBsYXllci5sZXZlbCA9IGJyZWFrUG9pbnRzLmxlbmd0aDtcbiAgICAgICAgLy8gTm93IGNoZWNrIHRvIHNlZSBpZiB0aGUgcGxheWVyIGlzIGF0IGEgaGlnaGVyIGxldmVsXG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgYnJlYWtQb2ludHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBpZiAodm0ucGxheWVyLnBvc2l0aW9uIDwgYnJlYWtQb2ludHNbaiArIDFdKSB7XG4gICAgICAgICAgICB2bS5wbGF5ZXIubGV2ZWwgPSBicmVha1BvaW50cy5pbmRleE9mKGJyZWFrUG9pbnRzW2pdKSArIDE7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGaWd1cmUgb3V0IHRoZSBwbGF5ZXIncyBjdXJyZW50IHN0cmVha1xuICAgICAgICB2YXIgc3RyZWFrID0gMDtcbiAgICAgICAgdmFyIGNvbnRpbnVlU3RyZWFrID0gdHJ1ZTtcbiAgICAgICAgdmFyIHN0cmVha1R5cGU7XG4gICAgICAgIF8uZm9yRWFjaChyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICBpZiAoY29udGludWVTdHJlYWspIHtcbiAgICAgICAgICAgIC8vIFdpbm5pbmcgU3RyZWFrXG4gICAgICAgICAgICBpZiAoKGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJyAmJiBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkKSB8fFxuICAgICAgICAgICAgICAoY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50JyAmJiBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkID09PSBwbGF5ZXJJZCkpIHtcbiAgICAgICAgICAgICAgLy8gSWYgdGhleSBhcmUgbm90IGFscmVhZHkgb24gYSBsb3Npbmcgc3RyZWFrIGFuZCAxIHRvIHRoZWlyIHdpbm5pbmcgc3RyZWFrXG4gICAgICAgICAgICAgIGlmIChzdHJlYWtUeXBlICE9PSAnbG9zaW5nJykge1xuICAgICAgICAgICAgICAgIHN0cmVhayArPSAxO1xuICAgICAgICAgICAgICAgIHN0cmVha1R5cGUgPSAnd2lubmluZyc7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGludWVTdHJlYWsgPSBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gTG9zaW5nIFN0cmVha1xuICAgICAgICAgICAgfSBlbHNlIGlmICgoY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50JyAmJiBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkKSB8fFxuICAgICAgICAgICAgICAoY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInICYmIGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkKSkge1xuICAgICAgICAgICAgICAvLyBJZiB0aGV5IGFyZSBub3QgYWxyZWFkeSBvbiBhIHdpbm5pbmcgc3RyZWFrIGFuZCAxIHRvIHRoZWlyIGxvc2luZyBzdHJlYWtcbiAgICAgICAgICAgICAgaWYgKHN0cmVha1R5cGUgIT09ICd3aW5uaW5nJykge1xuICAgICAgICAgICAgICAgIHN0cmVhayArPSAxO1xuICAgICAgICAgICAgICAgIHN0cmVha1R5cGUgPSAnbG9zaW5nJztcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZVN0cmVhayA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHZtLnN0cmVhayA9IHtcbiAgICAgICAgICAgIHR5cGU6IHN0cmVha1R5cGUsXG4gICAgICAgICAgICB2YWx1ZTogc3RyZWFrXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRmlndXJlIG91dCB3aW5zIGFuZCBsb3Nlc1xuICAgICAgICB2bS53aW5zLmFzT3Bwb25lbnQgPSBfLnNpemUoXy5maWx0ZXIocmVzdWx0cy5kYXRhLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCdcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgdm0ud2lucy5hc0NoYWxsZW5nZXIgPSBfLnNpemUoXy5maWx0ZXIocmVzdWx0cy5kYXRhLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVySWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInXG4gICAgICAgICAgKTtcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHZtLndpbnMudG90YWwgPSB2bS53aW5zLmFzQ2hhbGxlbmdlciArIHZtLndpbnMuYXNPcHBvbmVudDtcblxuICAgICAgICB2bS53aW5zLmJ5Rm9yZmVpdCA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLmZvcmZlaXQgJiYgKChjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJykgfHxcbiAgICAgICAgICAgIChjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnKSlcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgdm0ubG9zZXMuYXNPcHBvbmVudCA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVySWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInXG4gICAgICAgICAgKTtcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHZtLmxvc2VzLmFzQ2hhbGxlbmdlciA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnXG4gICAgICAgICAgKTtcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHZtLmxvc2VzLnRvdGFsID0gdm0ubG9zZXMuYXNDaGFsbGVuZ2VyICsgdm0ubG9zZXMuYXNPcHBvbmVudDtcblxuICAgICAgICB2bS5sb3Nlcy5ieUZvcmZlaXQgPSBfLnNpemUoXy5maWx0ZXIocmVzdWx0cy5kYXRhLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGNoYWxsZW5nZS5mb3JmZWl0ICYmICgoY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnKSB8fFxuICAgICAgICAgICAgKGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJykpXG4gICAgICAgICAgKTtcbiAgICAgICAgfSkpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jb21wbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBpZiAodm0ucGxheWVyLl9pZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jaGFsbGVuZ2VySWQpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgICAgZ2V0UGxheWVyT3ZlcmFsbFJlc3VsdHMoY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkLCBjaGFsbGVuZ2VEZXRhaWxzLmNoYWxsZW5nZXJJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAodm0ucGxheWVyLl9pZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5vcHBvbmVudElkKSB7XG4gICAgICAgICAgZ2V0UGxheWVyT3ZlcmFsbFJlc3VsdHMoY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkLCBjaGFsbGVuZ2VEZXRhaWxzLm9wcG9uZW50SWQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnY2hhbGxlbmdlc1NlcnZpY2UnLCBjaGFsbGVuZ2VzU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gY2hhbGxlbmdlc1NlcnZpY2UoJGh0dHApIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGNyZWF0ZUNoYWxsZW5nZTogY3JlYXRlQ2hhbGxlbmdlLFxuICAgICAgY29tcGxldGVDaGFsbGVuZ2U6IGNvbXBsZXRlQ2hhbGxlbmdlLFxuICAgICAgZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyOiBnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIsXG4gICAgICBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbjogZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24sXG4gICAgICBnZXRQbGF5ZXJSZXN1bHRzQnlDb21wZXRpdGlvbjogZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb25cbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jaGFsbGVuZ2VzL2NyZWF0ZScsIHtcbiAgICAgICAgY2hhbGxlbmdlOiBjaGFsbGVuZ2VcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvbXBsZXRlQ2hhbGxlbmdlKGNoYWxsZW5nZSkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvY2hhbGxlbmdlcy9jb21wbGV0ZScsICB7XG4gICAgICAgIGNoYWxsZW5nZTogY2hhbGxlbmdlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvY29tcGV0aXRpb24nLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9hY3RpdmUvY29tcGV0aXRpb24nLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcihjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2FjdGl2ZS9jb21wZXRpdGlvbi9wbGF5ZXInLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICAgIHBsYXllcklkOiBwbGF5ZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkLCBsaW1pdCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2NvbXBsZXRlZC9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgbGltaXQ6IGxpbWl0XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFBsYXllclJlc3VsdHNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvcmVzdWx0cy9jb21wZXRpdGlvbi9wbGF5ZXInLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICAgIHBsYXllcklkOiBwbGF5ZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twRm9vdGVyJywga3BGb290ZXIpO1xuXG4gIGZ1bmN0aW9uIGtwRm9vdGVyKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY29tbW9uL2NvbXBvbmVudHMvZm9vdGVyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmluZGVudGl0eSA9IGlkZW50aXR5U2VydmljZTtcbiAgICB2bS5sb2dvdXQgPSBsb2dvdXQ7XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twSGVhZGVyJywga3BIZWFkZXIpO1xuXG4gIGZ1bmN0aW9uIGtwSGVhZGVyKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICdoZWFkZXJDdHJsJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9oZWFkZXIuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoc2lkZWJhclNlcnZpY2UsIGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmluZGVudGl0eSA9IGlkZW50aXR5U2VydmljZTtcbiAgICB2bS5sb2dvdXQgPSBsb2dvdXQ7XG4gICAgdm0uc2lkZWJhclN0YXR1cyA9IHNpZGViYXJTZXJ2aWNlLmdldFNpZGViYXJTdGF0dXMoKTtcbiAgICB2bS50b2dnbGVTaWRlYmFyID0gdG9nZ2xlU2lkZWJhcjtcblxuICAgIGZ1bmN0aW9uIHRvZ2dsZVNpZGViYXIoKSB7XG4gICAgICB2bS5zaWRlYmFyU3RhdHVzLmxlZnQgPSAhdm0uc2lkZWJhclN0YXR1cy5sZWZ0O1xuICAgICAgc2lkZWJhclNlcnZpY2Uuc2V0U2lkZWJhclN0YXR1cyh2bS5zaWRlYmFyU3RhdHVzLmxlZnQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BTaWRlYmFyJywga3BTaWRlYmFyKTtcblxuICBmdW5jdGlvbiBrcFNpZGViYXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3NpZGViYXJDdHJsJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9zaWRlYmFyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UsIHNpZGViYXJTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pbmRlbnRpdHkgPSBpZGVudGl0eVNlcnZpY2U7XG4gICAgdm0ubG9nb3V0ID0gbG9nb3V0O1xuICAgIHZtLnNpZGViYXJTdGF0dXMgPSBzaWRlYmFyU2VydmljZS5nZXRTaWRlYmFyU3RhdHVzKCk7XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmlsdGVyKCdvcmRlck9iamVjdEJ5Jywgb3JkZXJPYmplY3RCeSk7XG5cbiAgZnVuY3Rpb24gb3JkZXJPYmplY3RCeSgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGlucHV0LCBhdHRyaWJ1dGUpIHtcbiAgICAgIGlmICghYW5ndWxhci5pc09iamVjdChpbnB1dCkpIHJldHVybiBpbnB1dDtcblxuICAgICAgdmFyIGFycmF5ID0gW107XG4gICAgICBmb3IgKHZhciBvYmplY3RLZXkgaW4gaW5wdXQpIHtcbiAgICAgICAgYXJyYXkucHVzaChpbnB1dFtvYmplY3RLZXldKTtcbiAgICAgIH1cblxuICAgICAgYXJyYXkuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICBhID0gcGFyc2VJbnQoYVthdHRyaWJ1dGVdKTtcbiAgICAgICAgYiA9IHBhcnNlSW50KGJbYXR0cmlidXRlXSk7XG4gICAgICAgIHJldHVybiBhIC0gYjtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH07XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignSG9tZUN0cmwnLCBIb21lQ3RybCk7XG5cbiAgZnVuY3Rpb24gSG9tZUN0cmwoKSB7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ2lkZW50aXR5U2VydmljZScsIGlkZW50aXR5U2VydmljZSk7XG5cbiAgZnVuY3Rpb24gaWRlbnRpdHlTZXJ2aWNlKCR3aW5kb3cpIHtcbiAgICB2YXIgY3VycmVudFVzZXI7XG4gICAgaWYgKCR3aW5kb3cuYm9vdHN0cmFwcGVkVXNlck9iamVjdCAhPT0gbnVsbCkge1xuICAgICAgY3VycmVudFVzZXIgPSAkd2luZG93LmJvb3RzdHJhcHBlZFVzZXJPYmplY3Q7XG4gICAgfVxuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgY3VycmVudFVzZXI6IGN1cnJlbnRVc2VyLFxuICAgICAgaXNBdXRoZW50aWNhdGVkOiBpc0F1dGhlbnRpY2F0ZWQsXG4gICAgICBpc0F1dGhvcml6ZWQ6IGlzQXV0aG9yaXplZFxuICAgIH07XG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBpc0F1dGhlbnRpY2F0ZWQoKSB7XG4gICAgICByZXR1cm4gISF0aGlzLmN1cnJlbnRVc2VyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzQXV0aG9yaXplZChyb2xlKSB7XG4gICAgICByZXR1cm4gISF0aGlzLmN1cnJlbnRVc2VyICYmIHRoaXMuY3VycmVudFVzZXIucm9sZXMuaW5kZXhPZihyb2xlKSA+IC0xO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdub3RpZnlTZXJ2aWNlJywgbm90aWZ5U2VydmljZSk7XG5cbiAgZnVuY3Rpb24gbm90aWZ5U2VydmljZSgpIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGluZm86IGluZm8sXG4gICAgICBzdWNjZXNzOiBzdWNjZXNzLFxuICAgICAgd2FybmluZzogd2FybmluZyxcbiAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgIGludmVyc2U6IGludmVyc2VcbiAgICB9O1xuXG4gICAgJC5ub3RpZnlEZWZhdWx0cyh7XG4gICAgICBuZXdlc3Rfb25fdG9wOiB0cnVlLFxuICAgICAgb2Zmc2V0OiB7XG4gICAgICAgIHg6IDIwLFxuICAgICAgICB5OiA4NVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBpbmZvKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdpbmZvJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3VjY2VzcyhtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnc3VjY2VzcydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ3dhcm5pbmcnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnZGFuZ2VyJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW52ZXJzZShtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnaW52ZXJzZSdcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdzY3JvbGxiYXJTZXJ2aWNlJywgc2Nyb2xsYmFyU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gc2Nyb2xsYmFyU2VydmljZSgpIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIG1hbGlodVNjcm9sbDogbWFsaWh1U2Nyb2xsXG4gICAgfTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gbWFsaWh1U2Nyb2xsKHNlbGVjdG9yLCB0aGVtZSwgc2Nyb2xsYXhpcywgbW91c2V3aGVlbGF4aXMpIHtcbiAgICAgICQoc2VsZWN0b3IpLm1DdXN0b21TY3JvbGxiYXIoe1xuICAgICAgICB0aGVtZTogdGhlbWUsXG4gICAgICAgIHNjcm9sbEluZXJ0aWE6IDEwMCxcbiAgICAgICAgYXhpczogc2Nyb2xsYXhpcyxcbiAgICAgICAgbW91c2VXaGVlbDoge1xuICAgICAgICAgIGVuYWJsZTogdHJ1ZSxcbiAgICAgICAgICBheGlzOiBtb3VzZXdoZWVsYXhpcyxcbiAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnc2lkZWJhclNlcnZpY2UnLCBzaWRlYmFyU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gc2lkZWJhclNlcnZpY2UoKSB7XG4gICAgdmFyIHNpZGViYXJTdGF0dXMgPSB7XG4gICAgICBsZWZ0OiBmYWxzZSxcbiAgICAgIHJpZ2h0OiBmYWxzZVxuICAgIH07XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBnZXRTaWRlYmFyU3RhdHVzOiBnZXRTaWRlYmFyU3RhdHVzLFxuICAgICAgc2V0U2lkZWJhclN0YXR1czogc2V0U2lkZWJhclN0YXR1c1xuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGdldFNpZGViYXJTdGF0dXMoKSB7XG4gICAgICByZXR1cm4gc2lkZWJhclN0YXR1cztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRTaWRlYmFyU3RhdHVzKHN0YXR1cykge1xuICAgICAgc2lkZWJhclN0YXR1cy5sZWZ0ID0gc3RhdHVzO1xuICAgIH1cbiAgfVxufSkoKTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgLnNlcnZpY2UoJ3dlYnNvY2tldFNlcnZpY2UnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHdpbmRvdykge1xuICAgIGZ1bmN0aW9uIHdlYnNvY2tldEhvc3QoKSB7XG4gICAgICBpZiAoJHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHBzOicpIHtcbiAgICAgICAgcmV0dXJuICd3c3M6Ly8nICsgJHdpbmRvdy5sb2NhdGlvbi5ob3N0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICd3czovLycgKyAkd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGNvbm5lY3Rpb247XG4gICAgdGhpcy5jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgY29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQod2Vic29ja2V0SG9zdCgpKTtcblxuICAgICAgY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgcGF5bG9hZCA9IEpTT04ucGFyc2UoZS5kYXRhKTtcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd3czonICsgcGF5bG9hZC50b3BpYywgcGF5bG9hZC5kYXRhKTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIHRoaXMuc2VuZCA9IGZ1bmN0aW9uICh0b3BpYywgZGF0YSkge1xuICAgICAgdmFyIGpzb24gPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIHRvcGljOiB0b3BpYyxcbiAgICAgICAgZGF0YTogZGF0YVxuICAgICAgfSk7XG4gICAgICBjb25uZWN0aW9uLnNlbmQoanNvbik7XG4gICAgfTtcbiAgfSkucnVuKGZ1bmN0aW9uICh3ZWJzb2NrZXRTZXJ2aWNlKSB7XG4gICAgd2Vic29ja2V0U2VydmljZS5jb25uZWN0KCk7XG4gIH0pOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFBlbmRpbmdQbGF5ZXJzJywga3BQZW5kaW5nUGxheWVycyk7XG5cbiAgZnVuY3Rpb24ga3BQZW5kaW5nUGxheWVycygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6ICdAJ1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3B5cmFtaWRzL2NvbXBvbmVudHMvcGVuZGluZy1wbGF5ZXJzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKCRzY29wZSwgcHlyYW1pZHNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5weXJhbWlkID0ge307XG4gICAgdm0ucGVuZGluZ1BsYXllcnMgPSBbXTtcbiAgICB2bS5hcHByb3ZlUGVuZGluZ1BsYXllciA9IGFwcHJvdmVQZW5kaW5nUGxheWVyO1xuICAgIHZtLmRlbnlQZW5kaW5nUGxheWVyID0gZGVueVBlbmRpbmdQbGF5ZXI7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBnZXRQZW5kaW5nUGxheWVycygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFBlbmRpbmdQbGF5ZXJzKCkge1xuICAgICAgdm0ucGVuZGluZ1BsYXllcnMgPSBbXTtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSAmJiBweXJhbWlkLmRhdGEucGVuZGluZ1BsYXllcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZtLnBlbmRpbmdQbGF5ZXJzID0gcHlyYW1pZC5kYXRhLnBlbmRpbmdQbGF5ZXJzO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhcHByb3ZlUGVuZGluZ1BsYXllcihwbGF5ZXIpIHtcbiAgICAgIHBsYXllci5wb3NpdGlvbiA9IHZtLnB5cmFtaWQucGxheWVycy5sZW5ndGggKyAxO1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmFwcHJvdmVQZW5kaW5nUGxheWVyKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllcikudGhlbihnZXRQZW5kaW5nUGxheWVycyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVueVBlbmRpbmdQbGF5ZXIocGxheWVyKSB7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuZGVueVBlbmRpbmdQbGF5ZXIodm0uY29tcGV0aXRpb25JZCwgcGxheWVyKS50aGVuKGdldFBlbmRpbmdQbGF5ZXJzKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twUHlyYW1pZENvbXBhY3QnLCBrcFB5cmFtaWRDb21wYWN0KTtcblxuICBmdW5jdGlvbiBrcFB5cmFtaWRDb21wYWN0KCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgdHlwZTogJ0AnLFxuXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvcHlyYW1pZHMvY29tcG9uZW50cy9weXJhbWlkLWNvbXBhY3QuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMocHlyYW1pZHNTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnB5cmFtaWRzID0gbnVsbDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICh2bS50eXBlID09PSAndXNlcicpIHtcbiAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWRzRm9yVXNlcihpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkcykge1xuICAgICAgICAgIHZtLnB5cmFtaWRzID0gcHlyYW1pZHMuZGF0YTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZHMoKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkcykge1xuICAgICAgICAgIHZtLnB5cmFtaWRzID0gcHlyYW1pZHMuZGF0YTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BQeXJhbWlkJywga3BQeXJhbWlkKTtcblxuICBmdW5jdGlvbiBrcFB5cmFtaWQoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9weXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQuaHRtbCcsXG4gICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogJ0AnXG4gICAgICB9LFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCAkc3RhdGUsIHB5cmFtaWRzU2VydmljZSwgJGZpbHRlciwgbm90aWZ5U2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciBtYXhMZXZlbHMgPSAxMDtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnB5cmFtaWQgPSB7fTtcbiAgICB2bS5icmVha1BvaW50cyA9IFtdO1xuICAgIHZtLmxldmVscyA9IFtdO1xuICAgIHZtLm51bWJlck9mQmxvY2tzID0gMDtcbiAgICB2bS5jdXJyZW50VXNlcklzT25QeXJhbWlkID0gZmFsc2U7XG4gICAgdm0uY3VycmVudFVzZXJJc1BlbmRpbmcgPSBmYWxzZTtcbiAgICB2bS5jdXJyZW50VXNlcklzT3duZXIgPSBmYWxzZTtcbiAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcbiAgICB2bS5hdmFpbGFibGVDaGFsbGVuZ2VzID0gZmFsc2U7XG4gICAgdm0uY3JlYXRlQ2hhbGxlbmdlID0gY3JlYXRlQ2hhbGxlbmdlO1xuICAgIHZtLmNvbXBsZXRlQ2hhbGxlbmdlID0gY29tcGxldGVDaGFsbGVuZ2U7XG4gICAgdm0uY2hhbGxlbmdlRXhwaXJlZCA9IGNoYWxsZW5nZUV4cGlyZWQ7XG4gICAgdm0uY3VycmVudFVzZXJQbGF5ZXIgPSB7fTtcbiAgICB2bS5weXJhbWlkTWVudVRvZ2dsZSA9IGZhbHNlO1xuICAgIHZtLmFkZEN1cnJlbnRVc2VyVG9QeXJhbWlkID0gYWRkQ3VycmVudFVzZXJUb1B5cmFtaWQ7XG4gICAgdm0uY29uZmlybVJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQgPSBjb25maXJtUmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZDtcbiAgICB2bS5udW1iZXJPZlJlYWxQbGF5ZXJzID0gMDtcbiAgICB2bS5tYXhQbGF5ZXJzID0gMDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBtYXhpbXVtIG51bWJlciBvZiBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBtYXhpbXVtIG51bWJlciBvZiBsZXZlbHNcbiAgICAgICAgZm9yICh2YXIgaSA9IG1heExldmVsczsgaSA+IDA7IC0taSkge1xuICAgICAgICAgIHZtLm1heFBsYXllcnMgKz0gaTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChweXJhbWlkLmRhdGEpIHtcbiAgICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuXG4gICAgICAgICAgb3JkZXJQbGF5ZXJzKCk7XG4gICAgICAgICAgZ2V0UGxheWVyc1N0YXR1cygpO1xuICAgICAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgICAgICAgIGNhbGN1bGF0ZVB5cmFtaWRCbG9ja3MoKTtcbiAgICAgICAgICBmaWxsSW5FbXB0eUJsb2NrcygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPcmRlciB0aGUgcGxheWVycyBieSB0aGUgcG9zaXRpb24gcHJvcGVydHkgb2YgdGhlIHBsYXllcnMgYXJyYXkgaW4gdGhlIHB5cmFtaWQgb2JqZWN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gb3JkZXJQbGF5ZXJzKCkge1xuICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzID0gJGZpbHRlcignb3JkZXJCeScpKHZtLnB5cmFtaWQucGxheWVycywgJ3Bvc2l0aW9uJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlndXJlIG91dCBpZiBlYWNoIHBsYXllciBpcyBhbHJlYWR5IGNoYWxsZW5nZWQgYW5kIHNldCBzb21lIHN0dWZmXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UGxheWVyc1N0YXR1cygpIHtcbiAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGUgY3VycmVudCB1c2VyIGlzIGFuIG93bmVyIG9mIHRoaXMgcHlyYW1pZFxuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICB2bS5jdXJyZW50VXNlcklzT3duZXIgPSBfLnNvbWUodm0ucHlyYW1pZC5vd25lcnMsIFsnX2lkJywgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZF0pO1xuICAgICAgfVxuXG4gICAgICBfLmZvckVhY2godm0ucHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIC8vIEZpbmQgdGhlIGN1cnJlbnQgdXNlciBpZiB0aGV5IGFyZSBvbiB0aGlzIHB5cmFtaWQgYW5kIHNldCBzb21lIHByb3BlcnRpZXNcbiAgICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSAmJiBwbGF5ZXIuX2lkID09PSBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkKSB7XG4gICAgICAgICAgdm0uY3VycmVudFVzZXJJc09uUHlyYW1pZCA9IHRydWU7XG4gICAgICAgICAgcGxheWVyLmNsYXNzID0gJ2N1cnJlbnQtdXNlcic7XG4gICAgICAgICAgdm0uY3VycmVudFVzZXJQbGF5ZXIgPSBwbGF5ZXI7XG5cbiAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIodm0uY29tcGV0aXRpb25JZCwgcGxheWVyLl9pZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEpIHtcbiAgICAgICAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBhIHBlbmRpbmcgcmVxdWVzdCB0byBqb2luXG4gICAgICBfLmZvckVhY2godm0ucHlyYW1pZC5wZW5kaW5nUGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpICYmIHBsYXllci5faWQgPT09IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQpIHtcbiAgICAgICAgICB2bS5jdXJyZW50VXNlcklzUGVuZGluZyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIF8uZm9yRWFjaChjaGFsbGVuZ2VzLmRhdGEsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcblxuICAgICAgICAgIHZhciBjaGFsbGVuZ2VyID0gXy5maW5kKHZtLnB5cmFtaWQucGxheWVycywgeyAnX2lkJzogY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkIH0pO1xuICAgICAgICAgIGNoYWxsZW5nZXIuY2xhc3MgPSAndW5hdmFpbGFibGUnO1xuICAgICAgICAgIGNoYWxsZW5nZXIuY2hhbGxlbmdlID0ge1xuICAgICAgICAgICAgcG9zaXRpb246ICdjaGFsbGVuZ2VyJ1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICB2YXIgb3Bwb25lbnQgPSBfLmZpbmQodm0ucHlyYW1pZC5wbGF5ZXJzLCB7ICdfaWQnOiBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkIH0pO1xuICAgICAgICAgIG9wcG9uZW50LmNsYXNzID0gJ3VuYXZhaWxhYmxlJztcbiAgICAgICAgICBvcHBvbmVudC5jaGFsbGVuZ2UgPSB7XG4gICAgICAgICAgICBwb3NpdGlvbjogJ29wcG9uZW50J1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICAvLyBUcmFjayB3aGVuIHRoZSBjaGFsbGVuZ2Ugd2lsbCBleHBpcmVcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLnRpbWVMaW1pdCAhPT0gMCkge1xuICAgICAgICAgICAgdmFyIHRpbWVUb0V4cGlyZSA9IG1vbWVudCgpLmRpZmYobW9tZW50KGNoYWxsZW5nZS5jcmVhdGVkKS5hZGQoY2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2QnKSwgJ3MnKSAqIC0xO1xuICAgICAgICAgICAgLy8gSWYgdGhlIGNoYWxsZW5nZSBoYXMgbm90IHlldCBleHBpcmVkIGRpc3BsYXkgYSBjb3VudGRvd24gb24gdGhlIG9wcG9uZW50XG4gICAgICAgICAgICBpZiAodGltZVRvRXhwaXJlID4gMCkge1xuICAgICAgICAgICAgICBvcHBvbmVudC5jaGFsbGVuZ2UuZXhwaXJlcyA9IHRpbWVUb0V4cGlyZTtcbiAgICAgICAgICAgICAgLy8gSWYgdGhlIGNoYWxsZW5nZSBleHBpcmVkIHdoaWxlIG5vIG9uZSB3YXMgdmlld2luZyB0aGlzIHB5cmFtaWQgY29tcGxldGUgdGhlIGNoYWxsZW5nZSBieSBmb3JmZWl0XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRpbWVUb0V4cGlyZSA8PSAwKSB7XG4gICAgICAgICAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlKG51bGwsIHRydWUsIG9wcG9uZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBOb3cgdGhhdCB3ZSBrbm93IHdoaWNoIHBsYXllcnMgYXJlIGluIGNoYWxsZW5nZXMgYW5kIHdoaWNoIGFyZW4ndFxuICAgICAgICAvLyBmaW5kIHRoZSBhdmFpbGFibGUgY2hhbGxlbmdlcyBmb3IgdGhpcyB1c2VyXG4gICAgICAgIGZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaWd1cmUgb3V0IHdoZXJlIHRvIHN0YXJ0IGVhY2ggbmV3IHJvdyBvbiB0aGUgcHlyYW1pZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZUJyZWFrUG9pbnRzKCkge1xuICAgICAgdm0uYnJlYWtQb2ludHMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4TGV2ZWxzOyBpKyspIHtcbiAgICAgICAgdm0uYnJlYWtQb2ludHMucHVzaCgoKChpICogKGkgKyAxKSkgLyAyKSkgKyAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHaXZlIGVhY2ggcGxheWVyIGEgbGV2ZWwgcHJvcGVydHkgYmFzZWQgb24gdGhlIGJyZWFrIHBvaW50c1xuICAgIC8vIFRoaXMgd2lsbCBiZSB1c2VkIHRvIGRldGVybWluZSB3aG8gb3RoZXIgcGxheWVycyBjYW4gY2hhbGxlbmdlXG4gICAgZnVuY3Rpb24gYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCkge1xuICAgICAgdmFyIGxldmVsID0gMDtcbiAgICAgIHZtLmxldmVscyA9IFtdO1xuICAgICAgY3JlYXRlQnJlYWtQb2ludHMoKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh2bS5icmVha1BvaW50cy5pbmRleE9mKGkgKyAxKSA+IC0xKSB7XG4gICAgICAgICAgbGV2ZWwgKz0gMTtcbiAgICAgICAgICAvLyBTZXQgdGhlIG51bWJlciBvZiB0b3RhbCBsZXZlbHNcbiAgICAgICAgICB2bS5sZXZlbHMucHVzaChsZXZlbCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gR2l2ZSBlYWNoIHBsYXllciBhIGxldmVsXG4gICAgICAgIHZtLnB5cmFtaWQucGxheWVyc1tpXS5sZXZlbCA9IGxldmVsO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhvdyBtYW55IHRvdGFsIGJsb2NrcyBpbiB0aGlzIHB5cmFtaWRcbiAgICBmdW5jdGlvbiBjYWxjdWxhdGVQeXJhbWlkQmxvY2tzKCkge1xuICAgICAgdm0ubnVtYmVyT2ZCbG9ja3MgPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IF8ubGFzdCh2bS5sZXZlbHMpOyBpID4gMDsgaS0tKSB7XG4gICAgICAgIHZtLm51bWJlck9mQmxvY2tzICs9IGk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmlsbCBvdXQgdGhlIHJlbWFpbmluZyBibG9ja3Mgb2YgdGhlIHB5cmFtaWQgd2l0aCBlbXB0eSBibG9ja3NcbiAgICBmdW5jdGlvbiBmaWxsSW5FbXB0eUJsb2NrcygpIHtcbiAgICAgIHZtLm51bWJlck9mUmVhbFBsYXllcnMgPSB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoO1xuICAgICAgZm9yICh2YXIgaSA9IHZtLnB5cmFtaWQucGxheWVycy5sZW5ndGg7IGkgPCB2bS5udW1iZXJPZkJsb2NrczsgaSsrKSB7XG4gICAgICAgIHZtLnB5cmFtaWQucGxheWVycy5wdXNoKHtcbiAgICAgICAgICBmaXJzdE5hbWU6ICdFbXB0eScsXG4gICAgICAgICAgbGFzdE5hbWU6ICdTcG90JyxcbiAgICAgICAgICBwb3NpdGlvbjogOTksXG4gICAgICAgICAgY2xhc3M6ICdlbXB0eSdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICAvLyBXZSBoYXZlIHRvIGdpdmUgbGV2ZWxzIHRvIHRoZSBuZXcgZW1wdHkgc3BvdHNcbiAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgIH1cblxuICAgIC8vIEZpbmQgYWxsIHRoZSBwbGF5ZXJzIHRoYXQgYXJlIGF2YWlsYWJsZSB0byBiZSBjaGFsbGVuZ2VkIGJ5IHRoaXMgdXNlclxuICAgIGZ1bmN0aW9uIGZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzKCkge1xuICAgICAgdmFyIGxldmVsQWJvdmUgPSB2bS5jdXJyZW50VXNlclBsYXllci5sZXZlbCA+IDEgPyB2bS5jdXJyZW50VXNlclBsYXllci5sZXZlbCAtIDEgOiBudWxsO1xuICAgICAgXy5mb3JFYWNoKHZtLnB5cmFtaWQucGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICBpZiAocGxheWVyLmxldmVsID09PSBsZXZlbEFib3ZlICYmIHBsYXllci5wb3NpdGlvbiAhPT0gOTkgJiYgcGxheWVyLmNsYXNzICE9PSAndW5hdmFpbGFibGUnKSB7XG4gICAgICAgICAgdm0uYXZhaWxhYmxlQ2hhbGxlbmdlcyA9IHRydWU7XG4gICAgICAgICAgcGxheWVyLmF2YWlsYWJsZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYWxsZW5nZShwbGF5ZXIpIHtcbiAgICAgIGlmICghcGxheWVyLmF2YWlsYWJsZSkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdTb3JyeSwgdGhhdCBpcyBub3QgYSB2YWxpZCBjaGFsbGVuZ2UuJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSB0cnVlO1xuICAgICAgICB2YXIgY2hhbGxlbmdlID0ge1xuICAgICAgICAgIGNvbXBldGl0aW9uTmFtZTogdm0ucHlyYW1pZC5uYW1lLFxuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IHZtLmNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgY29tcGxldGU6IGZhbHNlLFxuICAgICAgICAgIGZvcmZlaXQ6IGZhbHNlLFxuICAgICAgICAgIHRpbWVMaW1pdDogdm0ucHlyYW1pZC5mb3JmZWl0RGF5cyxcbiAgICAgICAgICBjaGFsbGVuZ2VyOiB7XG4gICAgICAgICAgICBfaWQ6IHZtLmN1cnJlbnRVc2VyUGxheWVyLl9pZCxcbiAgICAgICAgICAgIGVtYWlsOiB2bS5jdXJyZW50VXNlclBsYXllci5lbWFpbCxcbiAgICAgICAgICAgIGZpcnN0TmFtZTogdm0uY3VycmVudFVzZXJQbGF5ZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgbGFzdE5hbWU6IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxhc3ROYW1lLFxuICAgICAgICAgICAgcG9zaXRpb246IHZtLmN1cnJlbnRVc2VyUGxheWVyLnBvc2l0aW9uXG4gICAgICAgICAgfSxcbiAgICAgICAgICBvcHBvbmVudDoge1xuICAgICAgICAgICAgX2lkOiBwbGF5ZXIuX2lkLFxuICAgICAgICAgICAgZW1haWw6IHBsYXllci5lbWFpbCxcbiAgICAgICAgICAgIGZpcnN0TmFtZTogcGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiBwbGF5ZXIubGFzdE5hbWUsXG4gICAgICAgICAgICBwb3NpdGlvbjogcGxheWVyLnBvc2l0aW9uXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvLyBDcmVhdGUgdGhlIGNoYWxsZW5nZVxuICAgICAgICAvLyBXZWJzb2NrZXQgZXZlbnQgd2lsbCByZWZyZXNoIHRoZSBweXJhbWlkXG4gICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmNyZWF0ZUNoYWxsZW5nZShjaGFsbGVuZ2UpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZtLnB5cmFtaWRNZW51VG9nZ2xlID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wbGV0ZSBhIGNoYWxsZW5nZSBieSBhIHVzZXIgaW50ZXJhY3Rpb24gb3IgYSBmb3JmZWl0XG4gICAgICogXG4gICAgICogQHBhcmFtICB7Ym9vbGVhbn0gd2lubmVySXNDdXJyZW50VXNlclxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IGZvcmZlaXRcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IGZvcmZlaXRMb3NlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbXBsZXRlQ2hhbGxlbmdlKHdpbm5lcklzQ3VycmVudFVzZXIsIGZvcmZlaXQsIGZvcmZlaXRMb3Nlcikge1xuICAgICAgdmFyIHBsYXllciA9IGZvcmZlaXRMb3NlciB8fCB2bS5jdXJyZW50VXNlclBsYXllcjtcbiAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcih2bS5jb21wZXRpdGlvbklkLCBwbGF5ZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIHN3YXBQb3NpdGlvbnMgPSBmYWxzZTtcblxuICAgICAgICAvLyBJZiB0aGVyZSBpcyBhIGZvcmZlaXRcbiAgICAgICAgaWYgKGZvcmZlaXQpIHtcbiAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS5mb3JmZWl0ID0gdHJ1ZTtcbiAgICAgICAgICBpZiAoZm9yZmVpdExvc2VyLmNoYWxsZW5nZS5wb3NpdGlvbiA9PT0gJ29wcG9uZW50Jykge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ2NoYWxsZW5nZXInO1xuICAgICAgICAgICAgc3dhcFBvc2l0aW9ucyA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdvcHBvbmVudCc7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIEZpZ3VyZSBvdXQgd2hvIHRoZSB3aW5uZXIgd2FzIHRvIHN0b3JlIGluIHRoZSBjaGFsbGVuZ2UgcmVjb3JkXG4gICAgICAgIH0gZWxzZSBpZiAod2lubmVySXNDdXJyZW50VXNlcikge1xuICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLl9pZCA9PT0gdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnY2hhbGxlbmdlcic7XG4gICAgICAgICAgICBzd2FwUG9zaXRpb25zID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ29wcG9uZW50JztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIuX2lkID09PSB2bS5jdXJyZW50VXNlclBsYXllci5faWQpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdvcHBvbmVudCc7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdjaGFsbGVuZ2VyJztcbiAgICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN3YXAgcG9zaXRpb25zIGFuZCB0aGVuIGNvbXBsZXRlIHRoZSBjaGFsbGVuZ2Ugb3IganVzdCBjb21wbGV0ZSB0aGUgY2hhbGxlbmdlXG4gICAgICAgIC8vIFdlYnNvY2tldCBldmVudCB3aWxsIHJlZnJlc2ggdGhlIHB5cmFtaWRcbiAgICAgICAgaWYgKHN3YXBQb3NpdGlvbnMpIHtcbiAgICAgICAgICBweXJhbWlkc1NlcnZpY2Uuc3dhcFBvc2l0aW9ucyh2bS5jb21wZXRpdGlvbklkLCBjaGFsbGVuZ2UuZGF0YS5vcHBvbmVudCwgY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlcikudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jb21wbGV0ZUNoYWxsZW5nZShjaGFsbGVuZ2UuZGF0YSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIGlmIChyZW1vdmluZ0N1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jb21wbGV0ZUNoYWxsZW5nZShjaGFsbGVuZ2UuZGF0YSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAocmVtb3ZpbmdDdXJyZW50VXNlcikge1xuICAgICAgICAgICAgICByZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5weXJhbWlkTWVudVRvZ2dsZSA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxzIHRoZSBjb21wbGV0ZSBjaGFsbG5nZSBmdW5jdGlvbiB3aXRoIHRoZSBmb3JmZWl0aW5nIHBsYXllclxuICAgICAqIEBwYXJhbSAge29iamVjdH0gcGxheWVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2hhbGxlbmdlRXhwaXJlZChwbGF5ZXIpIHtcbiAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlKG51bGwsIHRydWUsIHBsYXllcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgdGhlIGN1cnJlbnQgdXNlciB0aGUgcHlyYW1pZCBcbiAgICAgKiBpZiB0aGV5J3JlIG5vdCBhbHJlYWR5IG9uIGl0IGFuZCB0aGVyZSdzIHNwYWNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWRkQ3VycmVudFVzZXJUb1B5cmFtaWQoKSB7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgIGlmICh2bS5udW1iZXJPZlJlYWxQbGF5ZXJzIDwgdm0ubWF4UGxheWVycykge1xuICAgICAgICAgIHZhciBwbGF5ZXIgPSB7XG4gICAgICAgICAgICBfaWQ6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQsXG4gICAgICAgICAgICBmaXJzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5maXJzdE5hbWUsXG4gICAgICAgICAgICBsYXN0TmFtZTogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmxhc3ROYW1lLFxuICAgICAgICAgICAgZW1haWw6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci51c2VybmFtZSxcbiAgICAgICAgICAgIHBvc2l0aW9uOiB2bS5udW1iZXJPZlJlYWxQbGF5ZXJzICsgMVxuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKHZtLnB5cmFtaWQub3Blbikge1xuICAgICAgICAgICAgc3dhbCh7XG4gICAgICAgICAgICAgIHRpdGxlOiAnSm9pbiBDb21wZXRpdGlvbj8nLFxuICAgICAgICAgICAgICB0ZXh0OiAnWW91XFwnbGwgYmUgYWRkZWQgdG8gdGhlIGJvdHRvbScsXG4gICAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJyxcbiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICdKb2luJyxcbiAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ05ldmVybWluZCcsXG4gICAgICAgICAgICAgIGNsb3NlT25Db25maXJtOiBmYWxzZSxcbiAgICAgICAgICAgICAgY2xvc2VPbkNhbmNlbDogdHJ1ZVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBweXJhbWlkc1NlcnZpY2UuYWRkUGxheWVyVG9QeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllcik7XG4gICAgICAgICAgICAgIHN3YWwoJ1dlbGNvbWUgQWJvYXJkIScsICdOb3cgc3RhcnQgZmlnaHRpbmcgeW91ciB3YXkgdG8gdGhlIHRvcCcsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICB9KTsgIFxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzd2FsKHtcbiAgICAgICAgICAgICAgdGl0bGU6ICdTZW5kIEpvaW4gUmVxdWVzdD8nLFxuICAgICAgICAgICAgICB0ZXh0OiAnVGhpcyBpcyBhIGNsb3NlZCBjb21wZXRpdGlvbiBzbyB0aGUgb3duZXIgbXVzdCBhcHByb3ZlIHlvdXIgcmVxdWVzdCcsXG4gICAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJyxcbiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICdTZW5kIFJlcXVlc3QnLFxuICAgICAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAnTmV2ZXJtaW5kJyxcbiAgICAgICAgICAgICAgY2xvc2VPbkNvbmZpcm06IGZhbHNlLFxuICAgICAgICAgICAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHB5cmFtaWRzU2VydmljZS5hZGRQbGF5ZXJUb1B5cmFtaWRSZXF1ZXN0KHZtLnB5cmFtaWQsIHBsYXllcikudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdm0uY3VycmVudFVzZXJJc1BlbmRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgc3dhbCgnUmVxdWVzdCBTZW50JywgJ1lvdSB3aWxsIHJlY2VpdmUgYW4gZW1haWwgb25jZSB0aGUgb3duZXIgcHJvY2Vzc2VzIHRoZSByZXF1ZXN0LicsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS53YXJuaW5nKCdTb3JyeSwgdGhpcyBweXJhbWlkIGlzIGZ1bGwnKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvbmZpcm1SZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkKCkge1xuICAgICAgc3dhbCh7XG4gICAgICAgIHRpdGxlOiAnTGVhdmUgUHlyYW1pZD8nLFxuICAgICAgICB0ZXh0OiAnWW91IHdpbGwgbG9zZSB5b3VyIHNwb3QgYW5kIGZvcmZlaXQgYW55IGFjdGl2ZSBjaGFsbGVuZ2VzLicsXG4gICAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnWWVzLCBsZWF2ZScsXG4gICAgICAgIGNvbmZpcm1CdXR0b25DbGFzczogJ2J0bi1kYW5nZXInLFxuICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAnTm8sIHN0YXknLFxuICAgICAgICBjbG9zZU9uQ29uZmlybTogZmFsc2UsXG4gICAgICAgIGNsb3NlT25DYW5jZWw6IHRydWVcbiAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCgpO1xuICAgICAgICBzd2FsKCdPSywgeW91XFwnciBvdXQhJywgJ1lvdVxcJ3ZlIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSBweXJhbWlkLicsICdzdWNjZXNzJyk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBVc2UgdGhpcyB0byBlbmZvcmNlIG9yZGVyIG9mIG9wZXJhdGlvbnMgd2hlbiB0aGUgcGxheWVyIHRvIGJlIHJlbW92ZWQgaGFkIGFuIGFjdGl2ZSBjaGFsbGVuZ2VcbiAgICB2YXIgcmVtb3ZpbmdDdXJyZW50VXNlciA9IGZhbHNlO1xuXG4gICAgZnVuY3Rpb24gcmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCgpIHtcbiAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgdXNlciBpcyBsb2dnZWQgaW4gYW5kIGlzIG9uIHRoaXMgcHlyYW1pZFxuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSAmJiB2bS5jdXJyZW50VXNlcklzT25QeXJhbWlkKSB7XG4gICAgICAgIHJlbW92aW5nQ3VycmVudFVzZXIgPSB0cnVlO1xuICAgICAgICAvLyBGb3JmZWl0IGlmIHRoZXkgaGF2ZSBhbiBhY3RpdmUgY2hhbGxlbmdlXG4gICAgICAgIGlmICh2bS5oYXNBY3RpdmVDaGFsbGVuZ2UpIHtcbiAgICAgICAgICBjb21wbGV0ZUNoYWxsZW5nZShudWxsLCB0cnVlLCB2bS5jdXJyZW50VXNlclBsYXllcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gU2luY2Ugd2UgYXJlIHJlbW92aW5nIHRoZW0gLi4uXG4gICAgICAgICAgdm0uY3VycmVudFVzZXJJc09uUHlyYW1pZCA9IGZhbHNlO1xuICAgICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IGZhbHNlO1xuXG4gICAgICAgICAgLy8gR2V0IGFuIHVwZGF0ZWQgY29weSBvZiB0aGUgcHlyYW1pZCBpbmNhc2UgYSBmb3JmZWl0IGhhcHBlbmVkXG4gICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIHVwZGF0ZWQgY29weSBsb2NhbGx5IHNvIGFzIG5vdCB0byBkaXN0cnVwdCB0aGUgcHlyYW1pZFxuICAgICAgICAgICAgLy8gdW50aWwgdGhlIHBsYXllciBoYXMgYmVlbiByZW1vdmVkXG4gICAgICAgICAgICB2YXIgcHlyYW1pZCA9IHAuZGF0YTtcblxuICAgICAgICAgICAgLy8gS2VlcCB0cmFjayBvZiB0aGUgc3BvdCB0aGV5IHdlcmUgaW4gb24gdGhlIHB5cmFtaWRcbiAgICAgICAgICAgIHZhciBvcGVuUG9zaXRpb24gPSB2bS5jdXJyZW50VXNlclBsYXllci5wb3NpdGlvbjtcblxuICAgICAgICAgICAgLy8gTW92ZSBhbGwgdGhlIHBsYXllcnMgdXAgMSBwb3NpdGlvbiB0aGF0IHdlcmUgYmVoaW5kIHRoZSByZW1vdmVkIHBsYXllclxuICAgICAgICAgICAgXy5mb3JFYWNoKHB5cmFtaWQucGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICAgICAgICBpZiAocGxheWVyLnBvc2l0aW9uID49IG9wZW5Qb3NpdGlvbikge1xuICAgICAgICAgICAgICAgIHBsYXllci5wb3NpdGlvbiAtPSAxO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gUmVtb3ZlZCB0aGUgcGxheWVyIGZyb20gdGhlIHB5cmFtaWRcbiAgICAgICAgICAgIHZhciByZW1vdmVkUGxheWVyID0gXy5yZW1vdmUocHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgICAgICAgIHJldHVybiBwbGF5ZXIuX2lkID09PSB2bS5jdXJyZW50VXNlclBsYXllci5faWQ7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gTWFrZSBhIG5ldyBhcnJheSBvZiBhbGwgdGhlIHBsYXllcnMgc3RpbGwgb24gdGhlIHB5cmFtaWRcbiAgICAgICAgICAgIC8vIG9ubHkgdXNlIHRoZSBwcm9wZXJ0aWVzIHdlIHdhbnQgdG8gc3RvcmUgaW4gdGhlIHB5cmFtaWQgZG9jdW1lbnRcbiAgICAgICAgICAgIHZhciB1cGRhdGVkUGxheWVycyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2bS5udW1iZXJPZlJlYWxQbGF5ZXJzIC0gMTsgKytpKSB7XG4gICAgICAgICAgICAgIHZhciB1cGRhdGVkUGxheWVyID0ge1xuICAgICAgICAgICAgICAgIF9pZDogcHlyYW1pZC5wbGF5ZXJzW2ldLl9pZCxcbiAgICAgICAgICAgICAgICBmaXJzdE5hbWU6IHB5cmFtaWQucGxheWVyc1tpXS5maXJzdE5hbWUsXG4gICAgICAgICAgICAgICAgbGFzdE5hbWU6IHB5cmFtaWQucGxheWVyc1tpXS5sYXN0TmFtZSxcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogcHlyYW1pZC5wbGF5ZXJzW2ldLnBvc2l0aW9uXG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgdXBkYXRlZFBsYXllcnMucHVzaCh1cGRhdGVkUGxheWVyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ2FsbCBzZXJ2aWNlIHRvIHJlbW92ZSB0aGUgcGxheWVyXG4gICAgICAgICAgICBweXJhbWlkc1NlcnZpY2UucmVtb3ZlZFBsYXllckZyb21QeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQsIHJlbW92ZWRQbGF5ZXJbMF0sIHVwZGF0ZWRQbGF5ZXJzKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmVtb3ZpbmdDdXJyZW50VXNlciA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWZyZXNoIHRoZSBweXJhbWlkIGJlY2FzdWUgb2YgYW4gdXBkYXRlXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVmcmVzaFB5cmFtaWQoKSB7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgIHZtLnB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICAgIG9yZGVyUGxheWVycygpO1xuICAgICAgICBnZXRQbGF5ZXJzU3RhdHVzKCk7XG4gICAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgICAgICBjYWxjdWxhdGVQeXJhbWlkQmxvY2tzKCk7XG4gICAgICAgIGZpbGxJbkVtcHR5QmxvY2tzKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NyZWF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgaWYgKCFyZW1vdmluZ0N1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOnBsYXllcl9hZGRlZCcsIGZ1bmN0aW9uIChfLCBkZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gZGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhkZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpwbGF5ZXJfcmVtb3ZlZCcsIGZ1bmN0aW9uIChfLCBkZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gZGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhkZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdweXJhbWlkc1NlcnZpY2UnLCBweXJhbWlkc1NlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHB5cmFtaWRzU2VydmljZSgkaHR0cCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0UHlyYW1pZDogZ2V0UHlyYW1pZCxcbiAgICAgIGdldFB5cmFtaWRzRm9yVXNlcjogZ2V0UHlyYW1pZHNGb3JVc2VyLFxuICAgICAgZ2V0UHlyYW1pZHM6IGdldFB5cmFtaWRzLFxuICAgICAgY3JlYXRlUHlyYW1pZDogY3JlYXRlUHlyYW1pZCxcbiAgICAgIHN3YXBQb3NpdGlvbnM6IHN3YXBQb3NpdGlvbnMsXG4gICAgICBhZGRQbGF5ZXJUb1B5cmFtaWQ6IGFkZFBsYXllclRvUHlyYW1pZCxcbiAgICAgIGFkZFBsYXllclRvUHlyYW1pZFJlcXVlc3Q6IGFkZFBsYXllclRvUHlyYW1pZFJlcXVlc3QsXG4gICAgICByZW1vdmVkUGxheWVyRnJvbVB5cmFtaWQ6IHJlbW92ZWRQbGF5ZXJGcm9tUHlyYW1pZCxcbiAgICAgIGFwcHJvdmVQZW5kaW5nUGxheWVyOiBhcHByb3ZlUGVuZGluZ1BsYXllcixcbiAgICAgIGRlbnlQZW5kaW5nUGxheWVyOiBkZW55UGVuZGluZ1BsYXllclxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIC8qKlxuICAgICAqIEdldHMgYSBweXJhbWlkIGZyb20gdGhlIGRhdGFiYXNlIChvciBtZW1vcnkpXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcHlyYW1pZCBpZCBmb3IgdGhlIHJlcXVlc3RlZCBweXJhbWlkXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBweXJhbWlkXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZChjb21wZXRpdGlvbklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3B5cmFtaWQnLCB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhbGwgcHlyYW1pZHMgZnJvbSB0aGUgZGF0YWJhc2UgdGhhdCBhIHBhcnRpY3VsYXIgdXNlciBpcyBpbmNsdWRlZCBpblxuICAgICAqXG4gICAgICogQHBhcmFtIHt1c2VySWR9IHRoZSB1c2VyIGlkIGZvciB0aGUgcmVxdWVzdGVkIHVzZXJcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IHB5cmFtaWRzXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZHNGb3JVc2VyKHVzZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9weXJhbWlkcy91c2VyJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICB1c2VySWQ6IHVzZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGFsbCBhY3RpdmUgcHlyYW1pZHMgZnJvbSB0aGUgZGF0YWJhc2VcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge09iamVjdH0gcHlyYW1pZHNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRQeXJhbWlkcygpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcHlyYW1pZHMnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVQeXJhbWlkKHB5cmFtaWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2NyZWF0ZScsIHtcbiAgICAgICAgcHlyYW1pZDogcHlyYW1pZFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3dhcFBvc2l0aW9ucyhjb21wZXRpdGlvbklkLCBjaGFsbGVuZ2VyLCBvcHBvbmVudCkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvc3dhcFBvc2l0aW9ucycsIHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgY2hhbGxlbmdlcjogY2hhbGxlbmdlcixcbiAgICAgICAgb3Bwb25lbnQ6IG9wcG9uZW50XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRQbGF5ZXJUb1B5cmFtaWQoY29tcGV0aXRpb25JZCwgcGxheWVyKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9hZGRQbGF5ZXInLCB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgIHBsYXllcjogcGxheWVyXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRQbGF5ZXJUb1B5cmFtaWRSZXF1ZXN0KGNvbXBldGl0aW9uLCBwbGF5ZXIpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2FkZFBsYXllclJlcXVlc3QnLCB7XG4gICAgICAgIGNvbXBldGl0aW9uOiBjb21wZXRpdGlvbixcbiAgICAgICAgcGxheWVyOiBwbGF5ZXJcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZWRQbGF5ZXJGcm9tUHlyYW1pZChjb21wZXRpdGlvbklkLCByZW1vdmVkUGxheWVyLCBwbGF5ZXJzKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9yZW1vdmVQbGF5ZXInLCB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgIHJlbW92ZWRQbGF5ZXI6IHJlbW92ZWRQbGF5ZXIsXG4gICAgICAgIHBsYXllcnM6IHBsYXllcnNcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFwcHJvdmVQZW5kaW5nUGxheWVyKGNvbXBldGl0aW9uSWQsIHBsYXllcikge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvYXBwcm92ZVBsYXllcicsIHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgcGxheWVyOiBwbGF5ZXJcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbnlQZW5kaW5nUGxheWVyKGNvbXBldGl0aW9uSWQsIHBsYXllcikge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvZGVueVBsYXllcicsIHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgcGxheWVyOiBwbGF5ZXJcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdBZG1pbkN0cmwnLCBBZG1pbkN0cmwpO1xuXG4gIGZ1bmN0aW9uIEFkbWluQ3RybCgkc3RhdGUsICRzdGF0ZVBhcmFtcywgcHlyYW1pZHNTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNvbXBldGl0aW9uSWQgPSBudWxsO1xuICAgIHZtLnB5cmFtaWQgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcbiAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGlzIHVzZXIgaXMgYW4gb3duZXIgb2YgdGhpcyBjb21wZXRpdGlvblxuICAgICAgICAgIGlmIChweXJhbWlkLmRhdGEgJiYgXy5zb21lKHB5cmFtaWQuZGF0YS5vd25lcnMsIFsnX2lkJywgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZF0pKSB7XG4gICAgICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLm15UHlyYW1pZHMnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy5teVB5cmFtaWRzJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIi8qKlxuICogQ3JlYXRlcyBhIHB5cmFtaWRcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQ3JlYXRlUHlyYW1pZEN0cmwnLCBDcmVhdGVQeXJhbWlkQ3RybCk7XG5cbiAgZnVuY3Rpb24gQ3JlYXRlUHlyYW1pZEN0cmwoJHN0YXRlLCB1c2VyU2VydmljZSwgcHlyYW1pZHNTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UpIHtcbiAgICB2YXIgYnJlYWtQb2ludHMgPSBbXTtcbiAgICB2YXIgbWF4TGV2ZWxzID0gMTA7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5uZXdQeXJhbWlkID0ge1xuICAgICAgcGxheWVyczogW10sXG4gICAgICBvcGVuOiBmYWxzZVxuICAgIH07XG4gICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IFtdO1xuICAgIHZtLmFkZGVkUGxheWVycyA9IFtdO1xuICAgIHZtLmNyZWF0ZVB5cmFtaWQgPSBjcmVhdGVQeXJhbWlkO1xuICAgIHZtLmFkZFBsYXllciA9IGFkZFBsYXllcjtcbiAgICB2bS5yZW1vdmVQbGF5ZXIgPSByZW1vdmVQbGF5ZXI7XG4gICAgdm0ubmV3UHlyYW1pZC5mb3JmZWl0RGF5cyA9IDE7XG5cbiAgICBhY3RpdmF0ZSgpO1xuICAgIFxuICAgIC8qKlxuICAgICAqIFJ1bnMgb24gY29udHJvbGxlciBpbnN0YW50aWF0aW9uXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICB1c2VyU2VydmljZS5nZXRBbGxVc2VycygpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIHZtLmF2YWlsYWJsZVBsYXllcnMgPSB1c2Vycy5kYXRhO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENyZWF0ZSBicmVhayBwb2ludHMgYXJyYXlcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4TGV2ZWxzOyBpKyspIHtcbiAgICAgICAgYnJlYWtQb2ludHMucHVzaCgoKChpICogKGkgKyAxKSkgLyAyKSkgKyAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgcGxheWVyIHRvIHRoZSBuZXcgcHlyYW1pZFxuICAgICAqIENoZWNrcyB0byBtYWtlIHN1cmUgeW91IGFyZSBub3QgYWRkaW5nIHRvbyBtYW55IHBsYXllcnNcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHBsYXllclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZFBsYXllcihwbGF5ZXIpIHtcbiAgICAgIHZtLmFkZGVkUGxheWVycy5wdXNoKF8ucmVtb3ZlKHZtLmF2YWlsYWJsZVBsYXllcnMsIHtfaWQ6IHBsYXllci5faWR9KVswXSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhIHByZXZpdW9zbHkgYWRkZWQgcGxheWVyIGZyb20gdGhlIHB5cmFtaWRcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHBsYXllclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlbW92ZVBsYXllcihwbGF5ZXIpIHtcbiAgICAgIHZtLmF2YWlsYWJsZVBsYXllcnMucHVzaChfLnJlbW92ZSh2bS5hZGRlZFBsYXllcnMsIHtfaWQ6IHBsYXllci5faWR9KVswXSk7XG4gICAgfVxuXG4gICAgLy8gVXNlZCB0byBrZWVwIHRyYWNrIG9mIHBvc2l0aW9uIG9uIHRoZSBweXJhbWlkIGJhc2VkIG9uIHdoZW4gdGhlIHBsYXllciB3YXMgYWRkZWRcbiAgICB2YXIgcG9zaXRpb24gPSAwO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHRoZSBweXJhbWlkXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBweXJhbWlkXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlUHlyYW1pZChweXJhbWlkKSB7XG4gICAgICBhbmd1bGFyLmZvckVhY2godm0uYWRkZWRQbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIHBvc2l0aW9uICs9IDE7XG4gICAgICAgIHZhciBhZGRQbGF5ZXIgPSB7XG4gICAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLFxuICAgICAgICAgIF9pZDogcGxheWVyLl9pZCxcbiAgICAgICAgICBlbWFpbDogcGxheWVyLnVzZXJuYW1lLFxuICAgICAgICAgIGZpcnN0TmFtZTogcGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICBsYXN0TmFtZTogcGxheWVyLmxhc3ROYW1lXG4gICAgICAgIH07XG4gICAgICAgIHB5cmFtaWQucGxheWVycy5wdXNoKGFkZFBsYXllcik7XG4gICAgICB9KTtcbiAgICAgIHB5cmFtaWQub3duZXJzID0gW3tcbiAgICAgICAgX2lkOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkLFxuICAgICAgICBlbWFpbDogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLnVzZXJuYW1lLFxuICAgICAgICBmaXJzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5maXJzdE5hbWUsXG4gICAgICAgIGxhc3ROYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIubGFzdE5hbWVcbiAgICAgIH1dO1xuXG4gICAgICAvLyBGaWd1cmUgb3V0IHRoZSBudW1iZXIgb2YgbGV2ZWxzIGJhc2VkIG9uIHRoZSBudW1iZXIgb2YgcGxheWVyc1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBicmVha1BvaW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocHlyYW1pZC5wbGF5ZXJzLmxlbmd0aCA8IGJyZWFrUG9pbnRzW2ldKSB7XG4gICAgICAgICAgcHlyYW1pZC5sZXZlbHMgPSBpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHB5cmFtaWRzU2VydmljZS5jcmVhdGVQeXJhbWlkKHB5cmFtaWQpLnRoZW4oZnVuY3Rpb24gKG5ld1B5cmFtaWQpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy52aWV3Jywge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IG5ld1B5cmFtaWQuZGF0YS5faWRcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTXlQeXJhbWlkc0N0cmwnLCBNeVB5cmFtaWRzQ3RybCk7XG5cbiAgZnVuY3Rpb24gTXlQeXJhbWlkc0N0cmwoKSB7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1B5cmFtaWRDdHJsJywgUHlyYW1pZEN0cmwpO1xuXG4gIGZ1bmN0aW9uIFB5cmFtaWRDdHJsKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBweXJhbWlkc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNvbXBldGl0aW9uSWQgPSBudWxsO1xuICAgIHZtLnB5cmFtaWQgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcblxuICAgICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSkge1xuICAgICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy5teVB5cmFtaWRzJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUHlyYW1pZHNDdHJsJywgUHlyYW1pZHNDdHJsKTtcblxuICBmdW5jdGlvbiBQeXJhbWlkc0N0cmwoKSB7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1N0YXRzQ3RybCcsIFN0YXRzQ3RybCk7XG5cbiAgZnVuY3Rpb24gU3RhdHNDdHJsKCRzdGF0ZVBhcmFtcywgJHN0YXRlLCBweXJhbWlkc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNvbXBldGl0aW9uSWQgPSBudWxsO1xuICAgIHZtLnB5cmFtaWQgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcbiAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICAgIGlmIChweXJhbWlkLmRhdGEpIHtcbiAgICAgICAgICAgIHZtLnB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMubXlQeXJhbWlkcycpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnY092ZXJmbG93JywgY092ZXJmbG93KTtcblxuICBmdW5jdGlvbiBjT3ZlcmZsb3coc2Nyb2xsYmFyU2VydmljZSkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0MnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgIHZhciBzY3JvbGxheGlzID0gYXR0cnMuc2Nyb2xsYXhpcyB8fCAneSc7XG4gICAgICB2YXIgdGhlbWUgPSBhdHRycy50aGVtZSB8fCAnbWluaW1hbC1kYXJrJztcbiAgICAgIHZhciBtb3VzZXdoZWVsYXhpcyA9IGF0dHJzLm1vdXNld2hlZWxheGlzIHx8ICd5JztcbiAgICAgIGlmICghJCgnaHRtbCcpLmhhc0NsYXNzKCdpc21vYmlsZScpKSB7XG4gICAgICAgIHNjcm9sbGJhclNlcnZpY2UubWFsaWh1U2Nyb2xsKGVsZW1lbnQsIHRoZW1lLCBzY3JvbGxheGlzLCBtb3VzZXdoZWVsYXhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgndG9nZ2xlU3VibWVudScsIHRvZ2dsZVN1Ym1lbnUpO1xuXG4gIGZ1bmN0aW9uIHRvZ2dsZVN1Ym1lbnUoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbCkge1xuICAgICAgZWwuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBlbC5uZXh0KCkuc2xpZGVUb2dnbGUoMjAwKTtcbiAgICAgICAgZWwucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ3RvZ2dsZWQnKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ3dhdmVzRWZmZWN0Jywgd2F2ZXNFZmZlY3QpO1xuXG4gIGZ1bmN0aW9uIHdhdmVzRWZmZWN0KCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0MnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCkge1xuICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ2J0bi1pY29uJykgfHwgZWxlbWVudC5oYXNDbGFzcygnYnRuLWZsb2F0JykpIHtcbiAgICAgICAgV2F2ZXMuYXR0YWNoKGVsZW1lbnQsIFsnd2F2ZXMtY2lyY2xlJ10pO1xuICAgICAgfSBlbHNlIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdidG4tbGlnaHQnKSkge1xuICAgICAgICBXYXZlcy5hdHRhY2goZWxlbWVudCwgWyd3YXZlcy1saWdodCddKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFdhdmVzLmF0dGFjaChlbGVtZW50KTtcbiAgICAgIH1cblxuICAgICAgV2F2ZXMuaW5pdCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2ZnTGluZScsIGZnTGluZSk7XG5cbiAgZnVuY3Rpb24gZmdMaW5lKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0MnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCkge1xuICAgICAgdmFyIGlucHV0ID0gZWxlbWVudC5jaGlsZHJlbigpLmZpcnN0KCk7XG4gICAgICB2YXIgaXNGbG9hdExhYmVsID0gZWxlbWVudC5wYXJlbnQoKS5oYXNDbGFzcygnZmctZmxvYXQnKTtcbiAgICAgIGlucHV0LmZvY3VzKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnZmctdG9nZ2xlZCcpO1xuICAgICAgfSk7XG5cbiAgICAgIGlucHV0LmJsdXIoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIWlzRmxvYXRMYWJlbCB8fCAoaXNGbG9hdExhYmVsICYmIGlucHV0LnZhbCgpLmxlbmd0aCA9PT0gMCkpIHtcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdmZy10b2dnbGVkJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiXX0=
