angular.module("app",["ui.router","ui.bootstrap","ngAnimate","angular-loading-bar","nouislider","localytics.directives","timer"]),function(){"use strict ";function e(){}angular.module("app").config(e)}(),function(){"use strict";function e(e){var t=this;t.$state=e}e.$inject=["$state"],angular.module("app").controller("AppCtrl",e)}(),function(){"use strict";function e(e,i,a){var o={superAdmin:r,admin:t,user:n};a.html5Mode(!0),i.otherwise("/"),i.when("/pyramids/","/pyramids"),e.state("home",{url:"/",views:{content:{controller:"HomeCtrl",controllerAs:"vm",templateUrl:"common/views/home.html"}}}).state("pyramids",{url:"/pyramids",views:{content:{controller:"PyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramids.html"}}}).state("pyramids.myPyramids",{url:"/my-pyramids",views:{"content@":{controller:"MyPyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/my-pyramids.html"}},resolve:{auth:o.user}}).state("pyramids.view",{url:"/view/:pyramidId",views:{"content@":{controller:"PyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramid.html"}}}).state("pyramids.create",{url:"/create",views:{"content@":{controller:"CreatePyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/create-pyramid.html"}},resolve:{auth:o.user}}).state("login",{url:"/login",views:{content:{controller:"LoginCtrl",controllerAs:"vm",templateUrl:"authentication/views/login.html"}}}).state("register",{url:"/register",views:{content:{controller:"RegisterCtrl",controllerAs:"vm",templateUrl:"authentication/views/register.html"}}})}function t(e){return e.authorizeCurrentUserForRoute("admin")}function r(e){return e.authorizeCurrentUserForRoute("super-admin")}function n(e){return e.authenticatedUserForRoute()}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app").config(e),t.$inject=["authService"],r.$inject=["authService"],n.$inject=["authService"]}(),function(){"use strict";function e(e,t,r){e.$on("$stateChangeError",function(e,r,n,i,a,o){"not authorized"===o&&(t.go("login"),t.previous=r)}),e.$on("$stateChangeStart",function(){r.setSidebarStatus(!1)})}e.$inject=["$rootScope","$state","sidebarService"],angular.module("app").run(e)}(),function(){"use strict";function e(e,t,r,n,i){function a(e,n){var a=r.defer();return t.post("/login",{username:e,password:n}).then(function(e){e.data.success?(i.currentUser=e.data.user,a.resolve(!0)):a.resolve(!1)}),a.promise}function o(e){var n=r.defer();return t.post("/api/users",{userData:e}).then(function(e){e.data?(i.currentUser=e.data,n.resolve(!0)):n.resolve(!1)}),n.promise}function c(){var n=r.defer();return t.post("/logout",{logout:!0}).then(function(){i.currentUser=void 0,n.resolve(),e.go("home")}),n.promise}function l(e){return!!i.isAuthorized(e)||r.reject("not authorized")}function s(){return!!i.isAuthenticated()||r.reject("not authorized")}var u={authenticateUser:a,createUser:o,logout:c,authorizeCurrentUserForRoute:l,authenticatedUserForRoute:s};return u}e.$inject=["$state","$http","$q","userService","identityService"],angular.module("app").factory("authService",e)}(),function(){"use strict";function e(e,t){function r(){return e.get("/api/users").then(function(e){return e})}var n={getAllUsers:r};return n}e.$inject=["$http","identityService"],angular.module("app").factory("userService",e)}(),function(){"use strict";function e(e,t,r){function n(){}function i(n,i){t.authenticateUser(n,i).then(function(t){t?e.previous?e.go(e.previous):e.go("home"):r.error("Username / password combinaiton incorrect")})}var a=this;a.login=i,n()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("LoginCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){}function i(e){r.createUser(e).then(function(e){t.go("home")})}var a=this;a.register=i,n()}e.$inject=["$scope","$state","authService"],angular.module("app").controller("RegisterCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@"},templateUrl:"/challenges/components/active-challenges.html"};return e}function t(e,t){function r(){n()}function n(){i.challenges=[],t.getActiveChallengesByCompetition(i.competitionId).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){e.expires=moment().diff(moment(e.created).add(e.timeLimit,"h"),"s")*-1}))})}var i=this;i.challenges=[],r(),e.$on("ws:challenge_created",function(e,t){i.competitionId===t.competitionId&&n()}),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&n()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpActiveChalleneges",e)}(),function(){"use strict";function e(e){function t(t){return e.post("/api/challenges/create",{challenge:t})}function r(t){return e.post("/api/challenges/complete",{challenge:t})}function n(t){return e.get("/api/challenges/competition",{params:{competitionId:t}})}function i(t){return e.get("/api/challenges/active/competition",{params:{competitionId:t}})}function a(t,r){return e.get("/api/challenges/active/competition/player",{params:{competitionId:t,playerId:r}})}var o={createChallenge:t,completeChallenge:r,getChallengesByCompetition:n,getActiveChallengesByCompetition:i,getActiveChallengeByCompetitionByPlayer:a};return o}e.$inject=["$http"],angular.module("app").factory("challengesService",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",templateUrl:"/common/components/footer.html"};return e}function t(e,t){function r(){t.logout()}var n=this;n.indentity=e,n.logout=r}t.$inject=["identityService","authService"],angular.module("app").directive("kpFooter",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"headerCtrl",restrict:"A",templateUrl:"/common/components/header.html"};return e}function t(e,t,r){function n(){a.sidebarStatus.left=!a.sidebarStatus.left,e.setSidebarStatus(a.sidebarStatus.left)}function i(){r.logout()}var a=this;a.indentity=t,a.logout=i,a.sidebarStatus=e.getSidebarStatus(),a.toggleSidebar=n}t.$inject=["sidebarService","identityService","authService"],angular.module("app").directive("kpHeader",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"sidebarCtrl",restrict:"A",templateUrl:"/common/components/sidebar.html"};return e}function t(e,t,r){function n(){t.logout()}var i=this;i.indentity=e,i.logout=n,i.sidebarStatus=r.getSidebarStatus()}t.$inject=["identityService","authService","sidebarService"],angular.module("app").directive("kpSidebar",e)}(),function(){"use strict";function e(e){function t(){return!!this.currentUser}function r(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}var n;null!==e.bootstrappedUserObject&&(n=e.bootstrappedUserObject);var i={currentUser:n,isAuthenticated:t,isAuthorized:r};return i}e.$inject=["$window"],angular.module("app").factory("identityService",e)}(),function(){"use strict";function e(){function e(e,t,r){$.notify({message:e,url:t,target:r},{type:"info"})}function t(e,t,r){$.notify({message:e,url:t,target:r},{type:"success"})}function r(e,t,r){$.notify({message:e,url:t,target:r},{type:"warning"})}function n(e,t,r){$.notify({message:e,url:t,target:r},{type:"danger"})}function i(e,t,r){$.notify({message:e,url:t,target:r},{type:"inverse"})}var a={info:e,success:t,warning:r,error:n,inverse:i};return $.notifyDefaults({offset:{x:20,y:85}}),a}angular.module("app").factory("notifyService",e)}(),function(){"use strict";function e(){function e(){return r}function t(e){r.left=e}var r={left:!1,right:!1},n={getSidebarStatus:e,setSidebarStatus:t};return n}angular.module("app").factory("sidebarService",e)}(),angular.module("app").service("websocketService",["$rootScope","$window",function(e,t){function r(){return"https:"===t.location.protocol?"wss://"+t.location.host:"ws://"+t.location.host}var n;this.connect=function(){n=new WebSocket(r()),n.onmessage=function(t){var r=JSON.parse(t.data);e.$broadcast("ws:"+r.topic,r.data)}},this.send=function(e,t){var r=JSON.stringify({topic:e,data:t});n.send(r)}}]).run(["websocketService",function(e){e.connect()}]),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("HomeCtrl",e)}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"/pyramids/components/pyramid.html",replace:!0,scope:{competitionId:"@"},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,r,n,i,a){function o(){t.getPyramid(h.competitionId).then(function(e){h.pyramid=e.data,h.levels=[];for(var t=1;t<=e.data.levels;++t)h.levels.push(t);c(),l(),u(),d(),p()})}function c(){h.pyramid.players=r("orderBy")(h.pyramid.players,"position")}function l(){_.forEach(h.pyramid.players,function(e){i.currentUser&&e._id===i.currentUser._id&&(h.isCurrentUserOnPyramid=!0,e.class="current-user",h.currentUserPlayer=e,a.getActiveChallengeByCompetitionByPlayer(h.competitionId,e._id).then(function(e){e.data&&(h.hasActiveChallenge=!0)}))}),a.getActiveChallengesByCompetition(h.competitionId).then(function(e){_.forEach(e.data,function(e){var t=_.find(h.pyramid.players,{_id:e.challenger._id});t.class="unavailable",t.challenge={position:"challenger"};var r=_.find(h.pyramid.players,{_id:e.opponent._id});r.class="unavailable",r.challenge={position:"opponent"};var n=moment().diff(moment(e.created).add(e.timeLimit,"h"),"s")*-1;n>0?r.challenge.expires=n:n<=0&&g(null,!0,r)}),m()})}function s(){h.breakPoints=[];for(var e=0;e<h.pyramid.levels;e++)h.breakPoints.push(e*(e+1)/2+1)}function u(){h.numberOfBlocks=0;for(var e=h.pyramid.levels;e>0;e--)h.numberOfBlocks+=e}function d(){for(var e=h.pyramid.players.length;e<h.numberOfBlocks;e++)h.pyramid.players.push({firstName:"Empty",lastName:"Spot",position:99,class:"empty"})}function p(){var e=0;s();for(var t=0;t<h.pyramid.players.length;t++)h.breakPoints.indexOf(t+1)>-1&&(e+=1),h.pyramid.players[t].level=e}function m(){var e=h.currentUserPlayer.level>1?h.currentUserPlayer.level-1:null;_.forEach(h.pyramid.players,function(t){t.level===e&&99!==t.position&&"unavailable"!==t.class&&(h.availableChallenges=!0,t.available=!0)})}function f(e){if(e.available){h.hasActiveChallenge=!0;var t={competitionId:h.competitionId,complete:!1,forfeit:!1,timeLimit:24,challenger:{_id:h.currentUserPlayer._id,firstName:h.currentUserPlayer.firstName,lastName:h.currentUserPlayer.lastName,nickname:h.currentUserPlayer.nickname,position:h.currentUserPlayer.position},opponent:{_id:e._id,firstName:e.firstName,lastName:e.lastName,nickname:e.nickname,position:e.position}};a.createChallenge(t).then(function(){y(),h.pyramidMenuToggle=!1})}else n.error("Sorry, that is not a valid challenge.")}function g(e,r,n){var i=n||h.currentUserPlayer;a.getActiveChallengeByCompetitionByPlayer(h.competitionId,i._id).then(function(n){h.hasActiveChallenge=!1;var i=!1;r?(n.data.forfeit=!0,n.data.challenger.winner=!0,i=!0):e?n.data.challenger._id===h.currentUserPlayer._id?(n.data.challenger.winner=!0,i=!0):n.data.opponent.winner=!0:n.data.challenger._id===h.currentUserPlayer._id?n.data.opponent.winner=!0:(n.data.challenger.winner=!0,i=!0),i?t.swapPositions(h.competitionId,n.data.opponent,n.data.challenger).then(function(){a.completeChallenge(n.data)}):a.completeChallenge(n.data),h.pyramidMenuToggle=!1})}function v(e){g(null,!0,e)}function y(){t.getPyramid(h.competitionId).then(function(e){h.pyramid=e.data,c(),l(),d(),p()})}var h=this;h.pyramid={},h.breakPoints=[],h.numberOfBlocks=0,h.isCurrentUserOnPyramid=!1,h.hasActiveChallenge=!1,h.availableChallenges=!1,h.createChallenge=f,h.completeChallenge=g,h.challengeExpired=v,h.currentUserPlayer={},h.pyramidMenuToggle=!1,o(),e.$on("ws:challenge_created",function(e,t){h.competitionId===t.competitionId&&(n.info(t.description),y())}),e.$on("ws:challenge_completed",function(e,t){h.competitionId===t.competitionId&&(n.info(t.description),y())})}t.$inject=["$scope","pyramidsService","$filter","notifyService","identityService","challengesService"],angular.module("app").directive("kpPyramid",e)}(),function(){"use strict";function e(e){function t(t){return e.get("/api/pyramid",{params:{pyramidId:t}})}function r(t){return e.get("/api/pyramids/user",{params:{userId:t}})}function n(t){return e.post("/api/pyramids/create",{pyramid:t})}function i(t,r,n){return e.post("/api/pyramids/swapPositions",{pyramidId:t,challenger:r,opponent:n})}function a(t,r){return e.post("/api/pyramids/addPlayer",{pyramidId:t,player:r})}var o={getPyramid:t,getPyramidsForUser:r,createPyramid:n,swapPositions:i,addPlayerToPyramid:a};return o}e.$inject=["$http"],angular.module("app").factory("pyramidsService",e)}(),function(){"use strict";function e(e,t,r,n){function i(){r.getAllUsers().then(function(e){c.availablePlayers=e.data})}function a(e){l+=1;var t={position:l,_id:e._id,firstName:e.firstName,lastName:e.lastName,nickname:e.nickname};c.newPyramid.players.push(t),_.remove(c.availablePlayers,{_id:e._id})}function o(t){n.createPyramid(t).then(function(t){e.go("pyramids.view",{pyramidId:t.data._id})})}var c=this;c.availablePlayers=[],c.addPlayerToPyramid=a,c.createPyramid=o,i();var l=0}e.$inject=["$state","$stateParams","userService","pyramidsService"],angular.module("app").controller("AddPlayerCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){t.getAllUsers().then(function(e){a.availablePlayers=e.data})}function i(t){angular.forEach(a.addedPlayers,function(e){o+=1;var t={position:o,_id:e._id,firstName:e.firstName,lastName:e.lastName,nickname:e.nickname};a.newPyramid.players.push(t)}),r.createPyramid(t).then(function(t){e.go("pyramids.view",{pyramidId:t.data._id})})}var a=this;a.newPyramid={players:[]},a.availablePlayers=[],a.addedPlayers=[],a.createPyramid=i,a.newPyramid.levels=4,n();var o=0}e.$inject=["$state","userService","pyramidsService"],angular.module("app").controller("CreatePyramidCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){t.getPyramidsForUser(r.currentUser._id).then(function(e){i.pyramids=e.data})}var i=this;i.pyramids=null,n()}e.$inject=["$state","pyramidsService","identityService"],angular.module("app").controller("MyPyramidsCtrl",e)}(),function(){"use strict";function e(e){function t(){e.pyramidId&&(r.pyramidId=e.pyramidId)}var r=this;r.pyramidId=null,t()}e.$inject=["$stateParams"],angular.module("app").controller("PyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}var t=this;t.pyramids=null,e()}angular.module("app").controller("PyramidsCtrl",e)}(),function(){"use strict";function e(){function e(e,t){t.click(function(){t.next().slideToggle(200),t.parent().toggleClass("toggled")})}var t={restrict:"A",link:e};return t}angular.module("app").directive("toggleSubmenu",e)}(),function(){"use strict";function e(){function e(e,t){t.hasClass("btn-icon")||t.hasClass("btn-float")?Waves.attach(t,["waves-circle"]):t.hasClass("btn-light")?Waves.attach(t,["waves-light"]):Waves.attach(t),Waves.init()}var t={restrict:"C",link:e};return t}angular.module("app").directive("wavesEffect",e)}(),function(){"use strict";function e(){function e(e,t){var r=t.children().first(),n=t.parent().hasClass("fg-float");r.focus(function(){t.addClass("fg-toggled")}),r.blur(function(){(!n||n&&0===r.val().length)&&t.removeClass("fg-toggled")})}var t={restrict:"C",link:e};return t}angular.module("app").directive("fgLine",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiYXBwLmNvbnRyb2xsZXIuanMiLCJhcHAucm91dGVzLmpzIiwiYXBwLnJ1bi5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL2F1dGguc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL3VzZXIuc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3ZpZXdzL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJhdXRoZW50aWNhdGlvbi92aWV3cy9yZWdpc3Rlci5jb250cm9sbGVyLmpzIiwiY2hhbGxlbmdlcy9jb21wb25lbnRzL2FjdGl2ZS1jaGFsbGVuZ2VzLmRpcmVjdGl2ZS5qcyIsImNoYWxsZW5nZXMvc2VydmljZXMvY2hhbGxlbmdlcy5zZXJ2aWNlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvZm9vdGVyLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL2hlYWRlci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy9zaWRlYmFyLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy9pbmRlbnRpdHkuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy9ub3RpZnkuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy9zaWRlYmFyLnNlcnZpY2UuanMiLCJjb21tb24vc2VydmljZXMvd2Vic29ja2V0LnNlcnZpY2UuanMiLCJjb21tb24vdmlld3MvaG9tZS5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvY29tcG9uZW50cy9weXJhbWlkLmRpcmVjdGl2ZS5qcyIsInB5cmFtaWRzL3NlcnZpY2VzL3B5cmFtaWRzLnNlcnZpY2UuanMiLCJweXJhbWlkcy92aWV3cy9hZGQtcGxheWVyLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy92aWV3cy9jcmVhdGUtcHlyYW1pZC5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvbXktcHlyYW1pZHMuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL3B5cmFtaWQuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL3B5cmFtaWRzLmNvbnRyb2xsZXIuanMiLCJjb21tb24vY29tcG9uZW50cy91aS90b2dnbGUtc3VibWVudS5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS93YXZlcy5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS9mb3Jtcy9mZy1saW5lLmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlndXJhdGlvbiIsImNvbmZpZyIsIkFwcEN0cmwiLCIkc3RhdGUiLCJhcHBDdHJsIiwidGhpcyIsImNvbnRyb2xsZXIiLCJjb25maWd1cmVSb3V0ZXMiLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwicm91dGVSb2xlQ2hlY2tzIiwic3VwZXJBZG1pbiIsInJlcXVpcmVTdXBlckFkbWluIiwiYWRtaW4iLCJyZXF1aXJlQWRtaW4iLCJ1c2VyIiwicmVxdWlyZUF1dGgiLCJodG1sNU1vZGUiLCJvdGhlcndpc2UiLCJ3aGVuIiwic3RhdGUiLCJ1cmwiLCJ2aWV3cyIsImNvbnRlbnQiLCJjb250cm9sbGVyQXMiLCJ0ZW1wbGF0ZVVybCIsImNvbnRlbnRAIiwicmVzb2x2ZSIsImF1dGgiLCJhdXRoU2VydmljZSIsImF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUiLCJhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlIiwiJGluamVjdCIsImFwcFJ1biIsIiRyb290U2NvcGUiLCJzaWRlYmFyU2VydmljZSIsIiRvbiIsImV2ZW50IiwidG9TdGF0ZSIsInRvUGFyYW1zIiwiZnJvbVN0YXRlIiwiZnJvbVBhcmFtcyIsImVycm9yIiwiZ28iLCJwcmV2aW91cyIsInNldFNpZGViYXJTdGF0dXMiLCJydW4iLCIkaHR0cCIsIiRxIiwidXNlclNlcnZpY2UiLCJpZGVudGl0eVNlcnZpY2UiLCJhdXRoZW50aWNhdGVVc2VyIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsImRmZCIsImRlZmVyIiwicG9zdCIsInRoZW4iLCJyZXNwb25zZSIsImRhdGEiLCJzdWNjZXNzIiwiY3VycmVudFVzZXIiLCJwcm9taXNlIiwiY3JlYXRlVXNlciIsInVzZXJEYXRhIiwibG9nb3V0IiwidW5kZWZpbmVkIiwicm9sZSIsImlzQXV0aG9yaXplZCIsInJlamVjdCIsImlzQXV0aGVudGljYXRlZCIsInNlcnZpY2UiLCJmYWN0b3J5IiwiZ2V0QWxsVXNlcnMiLCJnZXQiLCJ1c2VycyIsIkxvZ2luQ3RybCIsIm5vdGlmeVNlcnZpY2UiLCJhY3RpdmF0ZSIsImxvZ2luIiwidm0iLCJSZWdpc3RlckN0cmwiLCIkc2NvcGUiLCJyZWdpc3RlciIsIm5ld1VzZXIiLCJrcEFjdGl2ZUNoYWxsZW5lZ2VzIiwiZGlyZWN0aXZlIiwiYmluZFRvQ29udHJvbGxlciIsImN0cmxGdW5jIiwicmVzdHJpY3QiLCJzY29wZSIsImNvbXBldGl0aW9uSWQiLCJjaGFsbGVuZ2VzU2VydmljZSIsImdldEFjdGl2ZUNoYWxsZW5nZXMiLCJjaGFsbGVuZ2VzIiwiZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24iLCJsZW5ndGgiLCJfIiwiZm9yRWFjaCIsImNoYWxsZW5nZSIsImV4cGlyZXMiLCJtb21lbnQiLCJkaWZmIiwiY3JlYXRlZCIsImFkZCIsInRpbWVMaW1pdCIsImNoYWxsZW5nZURldGFpbHMiLCJjcmVhdGVDaGFsbGVuZ2UiLCJjb21wbGV0ZUNoYWxsZW5nZSIsImdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uIiwicGFyYW1zIiwiZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyIiwicGxheWVySWQiLCJrcEZvb3RlciIsImluZGVudGl0eSIsImtwSGVhZGVyIiwidG9nZ2xlU2lkZWJhciIsInNpZGViYXJTdGF0dXMiLCJsZWZ0IiwiZ2V0U2lkZWJhclN0YXR1cyIsImtwU2lkZWJhciIsIiR3aW5kb3ciLCJyb2xlcyIsImluZGV4T2YiLCJib290c3RyYXBwZWRVc2VyT2JqZWN0IiwiaW5mbyIsIm1lc3NhZ2UiLCJ0YXJnZXQiLCIkIiwibm90aWZ5IiwidHlwZSIsIndhcm5pbmciLCJpbnZlcnNlIiwibm90aWZ5RGVmYXVsdHMiLCJvZmZzZXQiLCJ4IiwieSIsInN0YXR1cyIsInJpZ2h0Iiwid2Vic29ja2V0SG9zdCIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJob3N0IiwiY29ubmVjdGlvbiIsImNvbm5lY3QiLCJXZWJTb2NrZXQiLCJvbm1lc3NhZ2UiLCJlIiwicGF5bG9hZCIsIkpTT04iLCJwYXJzZSIsIiRicm9hZGNhc3QiLCJ0b3BpYyIsInNlbmQiLCJqc29uIiwic3RyaW5naWZ5Iiwid2Vic29ja2V0U2VydmljZSIsIkhvbWVDdHJsIiwia3BQeXJhbWlkIiwicmVwbGFjZSIsInB5cmFtaWRzU2VydmljZSIsIiRmaWx0ZXIiLCJnZXRQeXJhbWlkIiwicHlyYW1pZCIsImxldmVscyIsImkiLCJwdXNoIiwib3JkZXJQbGF5ZXJzIiwiZ2V0UGxheWVyc1N0YXR1cyIsImNhbGN1bGF0ZVB5cmFtaWRCbG9ja3MiLCJmaWxsSW5FbXB0eUJsb2NrcyIsImFzc2lnbkxldmVsc1RvUGxheWVycyIsInBsYXllcnMiLCJwbGF5ZXIiLCJfaWQiLCJpc0N1cnJlbnRVc2VyT25QeXJhbWlkIiwiY2xhc3MiLCJjdXJyZW50VXNlclBsYXllciIsImhhc0FjdGl2ZUNoYWxsZW5nZSIsImNoYWxsZW5nZXIiLCJmaW5kIiwicG9zaXRpb24iLCJvcHBvbmVudCIsInRpbWVUb0V4cGlyZSIsImZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzIiwiY3JlYXRlQnJlYWtQb2ludHMiLCJicmVha1BvaW50cyIsIm51bWJlck9mQmxvY2tzIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJsZXZlbCIsImxldmVsQWJvdmUiLCJhdmFpbGFibGVDaGFsbGVuZ2VzIiwiYXZhaWxhYmxlIiwiY29tcGxldGUiLCJmb3JmZWl0Iiwibmlja25hbWUiLCJyZWZyZXNoUHlyYW1pZCIsInB5cmFtaWRNZW51VG9nZ2xlIiwid2lubmVySXNDdXJyZW50VXNlciIsImZvcmZlaXRMb3NlciIsInN3YXBQb3NpdGlvbnMiLCJ3aW5uZXIiLCJjaGFsbGVuZ2VFeHBpcmVkIiwiZGVzY3JpcHRpb24iLCJweXJhbWlkSWQiLCJnZXRQeXJhbWlkc0ZvclVzZXIiLCJ1c2VySWQiLCJjcmVhdGVQeXJhbWlkIiwiYWRkUGxheWVyVG9QeXJhbWlkIiwiQWRkUGxheWVyQ3RybCIsIiRzdGF0ZVBhcmFtcyIsImF2YWlsYWJsZVBsYXllcnMiLCJhZGRQbGF5ZXIiLCJuZXdQeXJhbWlkIiwicmVtb3ZlIiwiQ3JlYXRlUHlyYW1pZEN0cmwiLCJhZGRlZFBsYXllcnMiLCJNeVB5cmFtaWRzQ3RybCIsInB5cmFtaWRzIiwiUHlyYW1pZEN0cmwiLCJQeXJhbWlkc0N0cmwiLCJ0b2dnbGVTdWJtZW51IiwibGlua0Z1bmMiLCJlbCIsImNsaWNrIiwibmV4dCIsInNsaWRlVG9nZ2xlIiwicGFyZW50IiwidG9nZ2xlQ2xhc3MiLCJsaW5rIiwid2F2ZXNFZmZlY3QiLCJlbGVtZW50IiwiaGFzQ2xhc3MiLCJXYXZlcyIsImF0dGFjaCIsImluaXQiLCJmZ0xpbmUiLCJpbnB1dCIsImNoaWxkcmVuIiwiZmlyc3QiLCJpc0Zsb2F0TGFiZWwiLCJmb2N1cyIsImFkZENsYXNzIiwiYmx1ciIsInZhbCIsInJlbW92ZUNsYXNzIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxPQUNBLFlBQ0EsZUFDQSxZQUNBLHNCQUNBLGFBQ0Esd0JBQ0EsVUNQQSxXQUNBLGFBR0EsU0FBQUMsTUFGQUYsUUFBQUMsT0FBQSxPQUFBRSxPQUFBRCxNQ0ZBLHVCQUlBLFNBQUFFLEdBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsSUFDQUQsR0FBQUQsT0FBQUEsdUJBSkFMLFFBQUFDLE9BQUEsT0FBQU8sV0FBQSxVQUFBSixNQ0ZBLHVCQUlBLFNBQUFLLEdBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsSUFDQUMsV0FBQUMsRUFDQUMsTUFBQUMs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U0FBQSxXQUNBSyxHQUFBSSxNQUFBLFdBQ0FWLEVBQUFXLFNBQUEsZ0JBR0FMLEVBQUFNLEtBQUEsYUFDQUgsR0FBQUEsR0FBQSxJQUFBSCxFQUFBTyxNQUFBckosU0FDQXdJLEVBQUFjLFlBQUEsZ0JBaEJBLEdBQUFoSyxJQUNBRyxTQUFBLElBQ0E2SSxLQUFBUCxFQUdBLE9BQUF6SSxHQVZBekYsUUFDQUMsT0FBQSxPQUNBd0YsVUFBQSxTQUFBdUoiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcbiAgJ3VpLnJvdXRlcicsXG4gICd1aS5ib290c3RyYXAnLFxuICAnbmdBbmltYXRlJyxcbiAgJ2FuZ3VsYXItbG9hZGluZy1iYXInLFxuICAnbm91aXNsaWRlcicsXG4gICdsb2NhbHl0aWNzLmRpcmVjdGl2ZXMnLFxuICAndGltZXInXG5dKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCAnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29uZmlnKGNvbmZpZ3VyYXRpb24pO1xuXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyYXRpb24oKSB7XG5cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdBcHBDdHJsJywgQXBwQ3RybCk7XG5cbiAgZnVuY3Rpb24gQXBwQ3RybCgkc3RhdGUpIHtcbiAgICB2YXIgYXBwQ3RybCA9IHRoaXM7XG4gICAgYXBwQ3RybC4kc3RhdGUgPSAkc3RhdGU7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29uZmlnKGNvbmZpZ3VyZVJvdXRlcyk7XG5cbiAgZnVuY3Rpb24gY29uZmlndXJlUm91dGVzKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgdmFyIHJvdXRlUm9sZUNoZWNrcyA9IHtcbiAgICAgIHN1cGVyQWRtaW46IHJlcXVpcmVTdXBlckFkbWluLFxuICAgICAgYWRtaW46IHJlcXVpcmVBZG1pbixcbiAgICAgIHVzZXI6IHJlcXVpcmVBdXRoXG4gICAgfTtcblxuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcblxuICAgIC8vIGZvciBhbnkgdW5tYXRjaGVkIHVybFxuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcblxuICAgICR1cmxSb3V0ZXJQcm92aWRlci53aGVuKCcvcHlyYW1pZHMvJywgJy9weXJhbWlkcycpO1xuXG4gICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgIC5zdGF0ZSgnaG9tZScsIHtcbiAgICAgICAgdXJsOiAnLycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21tb24vdmlld3MvaG9tZS5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzJywge1xuICAgICAgICB1cmw6ICcvcHlyYW1pZHMnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1B5cmFtaWRzQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL3B5cmFtaWRzLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMubXlQeXJhbWlkcycsIHtcbiAgICAgICAgdXJsOiAnL215LXB5cmFtaWRzJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTXlQeXJhbWlkc0N0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9teS1weXJhbWlkcy5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIGF1dGg6IHJvdXRlUm9sZUNoZWNrcy51c2VyXG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy52aWV3Jywge1xuICAgICAgICB1cmw6ICcvdmlldy86cHlyYW1pZElkJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHlyYW1pZEN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9weXJhbWlkLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMuY3JlYXRlJywge1xuICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQ3JlYXRlUHlyYW1pZEN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9jcmVhdGUtcHlyYW1pZC5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIGF1dGg6IHJvdXRlUm9sZUNoZWNrcy51c2VyXG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdsb2dpbicsIHtcbiAgICAgICAgdXJsOiAnL2xvZ2luJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy9sb2dpbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3JlZ2lzdGVyJywge1xuICAgICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3JlZ2lzdGVyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgfVxuXG4gIHJlcXVpcmVBZG1pbi4kaW5qZWN0ID0gWydhdXRoU2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIHJlcXVpcmVBZG1pbihhdXRoU2VydmljZSkge1xuICAgIHJldHVybiBhdXRoU2VydmljZS5hdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlKCdhZG1pbicpO1xuICB9XG5cbiAgcmVxdWlyZVN1cGVyQWRtaW4uJGluamVjdCA9IFsnYXV0aFNlcnZpY2UnXTtcblxuICBmdW5jdGlvbiByZXF1aXJlU3VwZXJBZG1pbihhdXRoU2VydmljZSkge1xuICAgIHJldHVybiBhdXRoU2VydmljZS5hdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlKCdzdXBlci1hZG1pbicpO1xuICB9XG5cbiAgcmVxdWlyZUF1dGguJGluamVjdCA9IFsnYXV0aFNlcnZpY2UnXTtcblxuICBmdW5jdGlvbiByZXF1aXJlQXV0aChhdXRoU2VydmljZSkge1xuICAgIHJldHVybiBhdXRoU2VydmljZS5hdXRoZW50aWNhdGVkVXNlckZvclJvdXRlKCk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykucnVuKGFwcFJ1bik7XG5cbiAgZnVuY3Rpb24gYXBwUnVuKCRyb290U2NvcGUsICRzdGF0ZSwgc2lkZWJhclNlcnZpY2UpIHtcbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlRXJyb3InLCBmdW5jdGlvbiAoZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMsIGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgPT09ICdub3QgYXV0aG9yaXplZCcpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgICAkc3RhdGUucHJldmlvdXMgPSB0b1N0YXRlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKCkge1xuICAgICAgc2lkZWJhclNlcnZpY2Uuc2V0U2lkZWJhclN0YXR1cyhmYWxzZSk7XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnYXV0aFNlcnZpY2UnLCBhdXRoU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gYXV0aFNlcnZpY2UoJHN0YXRlLCAkaHR0cCwgJHEsIHVzZXJTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UpIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGF1dGhlbnRpY2F0ZVVzZXI6IGF1dGhlbnRpY2F0ZVVzZXIsXG4gICAgICBjcmVhdGVVc2VyOiBjcmVhdGVVc2VyLFxuICAgICAgbG9nb3V0OiBsb2dvdXQsXG4gICAgICBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlOiBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlLFxuICAgICAgYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZTogYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZVxuICAgIH07XG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBhdXRoZW50aWNhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5wb3N0KCcvbG9naW4nLCB7XG4gICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcbiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyID0gcmVzcG9uc2UuZGF0YS51c2VyO1xuICAgICAgICAgIGRmZC5yZXNvbHZlKHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRmZC5yZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlVXNlcih1c2VyRGF0YSkge1xuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywge1xuICAgICAgICB1c2VyRGF0YTogdXNlckRhdGFcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICBkZmQucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkZmQucmVzb2x2ZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xuICAgICAgJGh0dHAucG9zdCgnL2xvZ291dCcsIHtcbiAgICAgICAgbG9nb3V0OiB0cnVlXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyID0gdW5kZWZpbmVkO1xuICAgICAgICBkZmQucmVzb2x2ZSgpO1xuICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUocm9sZSkge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhvcml6ZWQocm9sZSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJHEucmVqZWN0KCdub3QgYXV0aG9yaXplZCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUoKSB7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICRxLnJlamVjdCgnbm90IGF1dGhvcml6ZWQnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgndXNlclNlcnZpY2UnLCB1c2VyU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gdXNlclNlcnZpY2UoJGh0dHAsIGlkZW50aXR5U2VydmljZSkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0QWxsVXNlcnM6IGdldEFsbFVzZXJzXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGdldEFsbFVzZXJzKCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIHJldHVybiB1c2VycztcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBMb2dpbkN0cmwpO1xuXG4gIGZ1bmN0aW9uIExvZ2luQ3RybCgkc3RhdGUsIGF1dGhTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5sb2dpbiA9IGxvZ2luO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgYXV0aFNlcnZpY2UuYXV0aGVudGljYXRlVXNlcih1c2VybmFtZSwgcGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdVc2VybmFtZSAvIHBhc3N3b3JkIGNvbWJpbmFpdG9uIGluY29ycmVjdCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICgkc3RhdGUucHJldmlvdXMpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygkc3RhdGUucHJldmlvdXMpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBSZWdpc3RlckN0cmwpO1xuXG4gIGZ1bmN0aW9uIFJlZ2lzdGVyQ3RybCgkc2NvcGUsICRzdGF0ZSwgYXV0aFNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnJlZ2lzdGVyID0gcmVnaXN0ZXI7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXIobmV3VXNlcikge1xuICAgICAgYXV0aFNlcnZpY2UuY3JlYXRlVXNlcihuZXdVc2VyKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BBY3RpdmVDaGFsbGVuZWdlcycsIGtwQWN0aXZlQ2hhbGxlbmVnZXMpO1xuXG4gIGZ1bmN0aW9uIGtwQWN0aXZlQ2hhbGxlbmVnZXMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jaGFsbGVuZ2VzL2NvbXBvbmVudHMvYWN0aXZlLWNoYWxsZW5nZXMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlcygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZXMoKSB7XG4gICAgICB2bS5jaGFsbGVuZ2VzID0gW107XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIGlmIChjaGFsbGVuZ2VzLmRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZtLmNoYWxsZW5nZXMgPSBjaGFsbGVuZ2VzLmRhdGE7XG4gICAgICAgICAgXy5mb3JFYWNoKHZtLmNoYWxsZW5nZXMsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5leHBpcmVzID0gKG1vbWVudCgpLmRpZmYobW9tZW50KGNoYWxsZW5nZS5jcmVhdGVkKS5hZGQoY2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2gnKSwncycpKSAqIC0xO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NyZWF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIGdldEFjdGl2ZUNoYWxsZW5nZXMoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdjaGFsbGVuZ2VzU2VydmljZScsIGNoYWxsZW5nZXNTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBjaGFsbGVuZ2VzU2VydmljZSgkaHR0cCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgY3JlYXRlQ2hhbGxlbmdlOiBjcmVhdGVDaGFsbGVuZ2UsXG4gICAgICBjb21wbGV0ZUNoYWxsZW5nZTogY29tcGxldGVDaGFsbGVuZ2UsXG4gICAgICBnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbjogZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb24sXG4gICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbjogZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24sXG4gICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXI6IGdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllclxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYWxsZW5nZShjaGFsbGVuZ2UpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NoYWxsZW5nZXMvY3JlYXRlJywge1xuICAgICAgICBjaGFsbGVuZ2U6IGNoYWxsZW5nZVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jaGFsbGVuZ2VzL2NvbXBsZXRlJywgIHtcbiAgICAgICAgY2hhbGxlbmdlOiBjaGFsbGVuZ2VcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2FjdGl2ZS9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvYWN0aXZlL2NvbXBldGl0aW9uL3BsYXllcicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgcGxheWVySWQ6IHBsYXllcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BGb290ZXInLCBrcEZvb3Rlcik7XG5cbiAgZnVuY3Rpb24ga3BGb290ZXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9mb290ZXIuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoaWRlbnRpdHlTZXJ2aWNlLCBhdXRoU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgIHZtLmxvZ291dCA9IGxvZ291dDtcblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BIZWFkZXInLCBrcEhlYWRlcik7XG5cbiAgZnVuY3Rpb24ga3BIZWFkZXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ2hlYWRlckN0cmwnLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbW1vbi9jb21wb25lbnRzL2hlYWRlci5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYyhzaWRlYmFyU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBhdXRoU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgIHZtLmxvZ291dCA9IGxvZ291dDtcbiAgICB2bS5zaWRlYmFyU3RhdHVzID0gc2lkZWJhclNlcnZpY2UuZ2V0U2lkZWJhclN0YXR1cygpO1xuICAgIHZtLnRvZ2dsZVNpZGViYXIgPSB0b2dnbGVTaWRlYmFyO1xuXG4gICAgZnVuY3Rpb24gdG9nZ2xlU2lkZWJhcigpIHtcbiAgICAgIHZtLnNpZGViYXJTdGF0dXMubGVmdCA9ICF2bS5zaWRlYmFyU3RhdHVzLmxlZnQ7XG4gICAgICBzaWRlYmFyU2VydmljZS5zZXRTaWRlYmFyU3RhdHVzKHZtLnNpZGViYXJTdGF0dXMubGVmdCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFNpZGViYXInLCBrcFNpZGViYXIpO1xuXG4gIGZ1bmN0aW9uIGtwU2lkZWJhcigpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAnc2lkZWJhckN0cmwnLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbW1vbi9jb21wb25lbnRzL3NpZGViYXIuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoaWRlbnRpdHlTZXJ2aWNlLCBhdXRoU2VydmljZSwgc2lkZWJhclNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmluZGVudGl0eSA9IGlkZW50aXR5U2VydmljZTtcbiAgICB2bS5sb2dvdXQgPSBsb2dvdXQ7XG4gICAgdm0uc2lkZWJhclN0YXR1cyA9IHNpZGViYXJTZXJ2aWNlLmdldFNpZGViYXJTdGF0dXMoKTtcblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdpZGVudGl0eVNlcnZpY2UnLCBpZGVudGl0eVNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIGlkZW50aXR5U2VydmljZSgkd2luZG93KSB7XG4gICAgdmFyIGN1cnJlbnRVc2VyO1xuICAgIGlmICgkd2luZG93LmJvb3RzdHJhcHBlZFVzZXJPYmplY3QgIT09IG51bGwpIHtcbiAgICAgIGN1cnJlbnRVc2VyID0gJHdpbmRvdy5ib290c3RyYXBwZWRVc2VyT2JqZWN0O1xuICAgIH1cbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGN1cnJlbnRVc2VyOiBjdXJyZW50VXNlcixcbiAgICAgIGlzQXV0aGVudGljYXRlZDogaXNBdXRoZW50aWNhdGVkLFxuICAgICAgaXNBdXRob3JpemVkOiBpc0F1dGhvcml6ZWRcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gaXNBdXRoZW50aWNhdGVkKCkge1xuICAgICAgcmV0dXJuICEhdGhpcy5jdXJyZW50VXNlcjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0F1dGhvcml6ZWQocm9sZSkge1xuICAgICAgcmV0dXJuICEhdGhpcy5jdXJyZW50VXNlciAmJiB0aGlzLmN1cnJlbnRVc2VyLnJvbGVzLmluZGV4T2Yocm9sZSkgPiAtMTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnbm90aWZ5U2VydmljZScsIG5vdGlmeVNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIG5vdGlmeVNlcnZpY2UoKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBpbmZvOiBpbmZvLFxuICAgICAgc3VjY2Vzczogc3VjY2VzcyxcbiAgICAgIHdhcm5pbmc6IHdhcm5pbmcsXG4gICAgICBlcnJvcjogZXJyb3IsXG4gICAgICBpbnZlcnNlOiBpbnZlcnNlXG4gICAgfTtcblxuICAgICQubm90aWZ5RGVmYXVsdHMoe1xuICAgICAgb2Zmc2V0OiB7XG4gICAgICAgIHg6IDIwLFxuICAgICAgICB5OiA4NVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBpbmZvKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdpbmZvJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3VjY2VzcyhtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnc3VjY2VzcydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ3dhcm5pbmcnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnZGFuZ2VyJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW52ZXJzZShtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnaW52ZXJzZSdcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdzaWRlYmFyU2VydmljZScsIHNpZGViYXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBzaWRlYmFyU2VydmljZSgpIHtcbiAgICB2YXIgc2lkZWJhclN0YXR1cyA9IHtcbiAgICAgIGxlZnQ6IGZhbHNlLFxuICAgICAgcmlnaHQ6IGZhbHNlXG4gICAgfTtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGdldFNpZGViYXJTdGF0dXM6IGdldFNpZGViYXJTdGF0dXMsXG4gICAgICBzZXRTaWRlYmFyU3RhdHVzOiBzZXRTaWRlYmFyU3RhdHVzXG4gICAgfTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gZ2V0U2lkZWJhclN0YXR1cygpIHtcbiAgICAgIHJldHVybiBzaWRlYmFyU3RhdHVzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFNpZGViYXJTdGF0dXMoc3RhdHVzKSB7XG4gICAgICBzaWRlYmFyU3RhdHVzLmxlZnQgPSBzdGF0dXM7XG4gICAgfVxuICB9XG59KSgpOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAuc2VydmljZSgnd2Vic29ja2V0U2VydmljZScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkd2luZG93KSB7XG4gICAgZnVuY3Rpb24gd2Vic29ja2V0SG9zdCgpIHtcbiAgICAgIGlmICgkd2luZG93LmxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cHM6Jykge1xuICAgICAgICByZXR1cm4gJ3dzczovLycgKyAkd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJ3dzOi8vJyArICR3aW5kb3cubG9jYXRpb24uaG9zdDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgY29ubmVjdGlvbjtcbiAgICB0aGlzLmNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh3ZWJzb2NrZXRIb3N0KCkpO1xuXG4gICAgICBjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpO1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3dzOicgKyBwYXlsb2FkLnRvcGljLCBwYXlsb2FkLmRhdGEpO1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgdGhpcy5zZW5kID0gZnVuY3Rpb24gKHRvcGljLCBkYXRhKSB7XG4gICAgICB2YXIganNvbiA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgdG9waWM6IHRvcGljLFxuICAgICAgICBkYXRhOiBkYXRhXG4gICAgICB9KTtcbiAgICAgIGNvbm5lY3Rpb24uc2VuZChqc29uKTtcbiAgICB9O1xuICB9KS5ydW4oZnVuY3Rpb24gKHdlYnNvY2tldFNlcnZpY2UpIHtcbiAgICB3ZWJzb2NrZXRTZXJ2aWNlLmNvbm5lY3QoKTtcbiAgfSk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignSG9tZUN0cmwnLCBIb21lQ3RybCk7XG5cbiAgZnVuY3Rpb24gSG9tZUN0cmwoKSB7XG4gICAgdmFyIHZtID0gdGhpcztcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHt9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFB5cmFtaWQnLCBrcFB5cmFtaWQpO1xuXG4gIGZ1bmN0aW9uIGtwUHlyYW1pZCgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3B5cmFtaWRzL2NvbXBvbmVudHMvcHlyYW1pZC5odG1sJyxcbiAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCdcbiAgICAgIH0sXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWVcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUsIHB5cmFtaWRzU2VydmljZSwgJGZpbHRlciwgbm90aWZ5U2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucHlyYW1pZCA9IHt9O1xuICAgIHZtLmJyZWFrUG9pbnRzID0gW107XG4gICAgdm0ubnVtYmVyT2ZCbG9ja3MgPSAwO1xuICAgIHZtLmlzQ3VycmVudFVzZXJPblB5cmFtaWQgPSBmYWxzZTtcbiAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcbiAgICB2bS5hdmFpbGFibGVDaGFsbGVuZ2VzID0gZmFsc2U7XG4gICAgdm0uY3JlYXRlQ2hhbGxlbmdlID0gY3JlYXRlQ2hhbGxlbmdlO1xuICAgIHZtLmNvbXBsZXRlQ2hhbGxlbmdlID0gY29tcGxldGVDaGFsbGVuZ2U7XG4gICAgdm0uY2hhbGxlbmdlRXhwaXJlZCA9IGNoYWxsZW5nZUV4cGlyZWQ7XG4gICAgdm0uY3VycmVudFVzZXJQbGF5ZXIgPSB7fTtcbiAgICB2bS5weXJhbWlkTWVudVRvZ2dsZSA9IGZhbHNlO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuXG4gICAgICAgIHZtLmxldmVscyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSBweXJhbWlkLmRhdGEubGV2ZWxzOyArK2kpIHtcbiAgICAgICAgICB2bS5sZXZlbHMucHVzaChpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG9yZGVyUGxheWVycygpO1xuICAgICAgICBnZXRQbGF5ZXJzU3RhdHVzKCk7XG4gICAgICAgIGNhbGN1bGF0ZVB5cmFtaWRCbG9ja3MoKTtcbiAgICAgICAgZmlsbEluRW1wdHlCbG9ja3MoKTtcbiAgICAgICAgYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPcmRlciB0aGUgcGxheWVycyBieSB0aGUgcG9zaXRpb24gcHJvcGVydHkgb2YgdGhlIHBsYXllcnMgYXJyYXkgaW4gdGhlIHB5cmFtaWQgb2JqZWN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gb3JkZXJQbGF5ZXJzKCkge1xuICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzID0gJGZpbHRlcignb3JkZXJCeScpKHZtLnB5cmFtaWQucGxheWVycywgJ3Bvc2l0aW9uJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlndXJlIG91dCBpZiBlYWNoIHBsYXllciBpcyBhbHJlYWR5IGNoYWxsZW5nZWQgYW5kIHNldCBzb21lIHN0dWZmXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UGxheWVyc1N0YXR1cygpIHtcbiAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcblxuICAgICAgICAvLyBGaW5kIHRoZSBjdXJyZW50IHVzZXIgaWYgdGhleSBhcmUgb24gdGhpcyBweXJhbWlkIGFuZCBzZXQgc29tZSBwcm9wZXJ0aWVzXG4gICAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgJiYgcGxheWVyLl9pZCA9PT0gaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCkge1xuICAgICAgICAgIHZtLmlzQ3VycmVudFVzZXJPblB5cmFtaWQgPSB0cnVlO1xuICAgICAgICAgIHBsYXllci5jbGFzcyA9ICdjdXJyZW50LXVzZXInO1xuICAgICAgICAgIHZtLmN1cnJlbnRVc2VyUGxheWVyID0gcGxheWVyO1xuXG4gICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllci5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgaWYgKGNoYWxsZW5nZS5kYXRhKSB7XG4gICAgICAgICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIF8uZm9yRWFjaChjaGFsbGVuZ2VzLmRhdGEsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcblxuICAgICAgICAgIHZhciBjaGFsbGVuZ2VyID0gXy5maW5kKHZtLnB5cmFtaWQucGxheWVycywgeydfaWQnOiBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWR9KTtcbiAgICAgICAgICBjaGFsbGVuZ2VyLmNsYXNzID0gJ3VuYXZhaWxhYmxlJztcbiAgICAgICAgICBjaGFsbGVuZ2VyLmNoYWxsZW5nZSA9IHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnY2hhbGxlbmdlcidcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgdmFyIG9wcG9uZW50ID0gXy5maW5kKHZtLnB5cmFtaWQucGxheWVycywgeydfaWQnOiBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkfSk7XG4gICAgICAgICAgb3Bwb25lbnQuY2xhc3MgPSAndW5hdmFpbGFibGUnO1xuICAgICAgICAgIG9wcG9uZW50LmNoYWxsZW5nZSA9IHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnb3Bwb25lbnQnXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIC8vIFRyYWNrIHdoZW4gdGhlIGNoYWxsZW5nZSB3aWxsIGV4cGlyZVxuICAgICAgICAgIHZhciB0aW1lVG9FeHBpcmUgPSBtb21lbnQoKS5kaWZmKG1vbWVudChjaGFsbGVuZ2UuY3JlYXRlZCkuYWRkKGNoYWxsZW5nZS50aW1lTGltaXQsICdoJyksICdzJykgKiAtMTtcbiAgICAgICAgICAvLyBJZiB0aGUgY2hhbGxlbmdlIGhhcyBub3QgeWV0IGV4cGlyZWQgZGlzcGxheSBhIGNvdW50ZG93biBvbiB0aGUgb3Bwb25lbnRcbiAgICAgICAgICBpZiAodGltZVRvRXhwaXJlID4gMCkge1xuICAgICAgICAgICAgb3Bwb25lbnQuY2hhbGxlbmdlLmV4cGlyZXMgPSB0aW1lVG9FeHBpcmU7XG4gICAgICAgICAgICAvLyBJZiB0aGUgY2hhbGxlbmdlIGV4cGlyZWQgd2hpbGUgbm8gb25lIHdhcyB2aWV3aW5nIHRoaXMgcHlyYW1pZCBjb21wbGV0ZSB0aGUgY2hhbGxlbmdlIGJ5IGZvcmZlaXRcbiAgICAgICAgICB9IGVsc2UgaWYgKHRpbWVUb0V4cGlyZSA8PSAwKSB7XG4gICAgICAgICAgICBjb21wbGV0ZUNoYWxsZW5nZShudWxsLCB0cnVlLCBvcHBvbmVudCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gTm93IHRoYXQgd2Uga25vdyB3aGljaCBwbGF5ZXJzIGFyZSBpbiBjaGFsbGVuZ2VzIGFuZCB3aGljaCBhcmVuJ3RcbiAgICAgICAgLy8gZmluZCB0aGUgYXZhaWxhYmxlIGNoYWxsZW5nZXMgZm9yIHRoaXMgdXNlclxuICAgICAgICBmaW5kQXZhaWxhYmxlQ2hhbGxlbmdlcygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlndXJlIG91dCB3aGVyZSB0byBzdGFydCBlYWNoIG5ldyByb3cgb24gdGhlIHB5cmFtaWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVCcmVha1BvaW50cygpIHtcbiAgICAgIHZtLmJyZWFrUG9pbnRzID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLnB5cmFtaWQubGV2ZWxzOyBpKyspIHtcbiAgICAgICAgdm0uYnJlYWtQb2ludHMucHVzaCgoKChpICogKGkgKyAxKSkgLyAyKSkgKyAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBIb3cgbWFueSB0b3RhbCBibG9ja3MgaW4gdGhpcyBweXJhbWlkXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlUHlyYW1pZEJsb2NrcygpIHtcbiAgICAgIHZtLm51bWJlck9mQmxvY2tzID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSB2bS5weXJhbWlkLmxldmVsczsgaSA+IDA7IGktLSkge1xuICAgICAgICB2bS5udW1iZXJPZkJsb2NrcyArPSBpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZpbGwgb3V0IHRoZSByZW1haW5pbmcgYmxvY2tzIG9mIHRoZSBweXJhbWlkIHdpdGggZW1wdHkgYmxvY2tzXG4gICAgZnVuY3Rpb24gZmlsbEluRW1wdHlCbG9ja3MoKSB7XG4gICAgICBmb3IgKHZhciBpID0gdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDsgaSA8IHZtLm51bWJlck9mQmxvY2tzOyBpKyspIHtcbiAgICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzLnB1c2goe1xuICAgICAgICAgIGZpcnN0TmFtZTogJ0VtcHR5JyxcbiAgICAgICAgICBsYXN0TmFtZTogJ1Nwb3QnLFxuICAgICAgICAgIHBvc2l0aW9uOiA5OSxcbiAgICAgICAgICBjbGFzczogJ2VtcHR5J1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHaXZlIGVhY2ggcGxheWVyIGEgbGV2ZWwgcHJvcGVydHkgYmFzZWQgb24gdGhlIGJyZWFrIHBvaW50c1xuICAgIC8vIFRoaXMgd2lsbCBiZSB1c2VkIHRvIGRldGVybWluZSB3aG8gb3RoZXIgcGxheWVycyBjYW4gY2hhbGxlbmdlXG4gICAgZnVuY3Rpb24gYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCkge1xuICAgICAgdmFyIGxldmVsID0gMDtcbiAgICAgIGNyZWF0ZUJyZWFrUG9pbnRzKCk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLnB5cmFtaWQucGxheWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAodm0uYnJlYWtQb2ludHMuaW5kZXhPZihpICsgMSkgPiAtMSkge1xuICAgICAgICAgIGxldmVsICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzW2ldLmxldmVsID0gbGV2ZWw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmluZCBhbGwgdGhlIHBsYXllcnMgdGhhdCBhcmUgYXZhaWxhYmxlIHRvIGJlIGNoYWxsZW5nZWQgYnkgdGhpcyB1c2VyXG4gICAgZnVuY3Rpb24gZmluZEF2YWlsYWJsZUNoYWxsZW5nZXMoKSB7XG4gICAgICB2YXIgbGV2ZWxBYm92ZSA9IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxldmVsID4gMSA/IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxldmVsIC0gMSA6IG51bGw7XG4gICAgICBfLmZvckVhY2godm0ucHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIGlmIChwbGF5ZXIubGV2ZWwgPT09IGxldmVsQWJvdmUgJiYgcGxheWVyLnBvc2l0aW9uICE9PSA5OSAmJiBwbGF5ZXIuY2xhc3MgIT09ICd1bmF2YWlsYWJsZScpIHtcbiAgICAgICAgICB2bS5hdmFpbGFibGVDaGFsbGVuZ2VzID0gdHJ1ZTtcbiAgICAgICAgICBwbGF5ZXIuYXZhaWxhYmxlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlQ2hhbGxlbmdlKHBsYXllcikge1xuICAgICAgaWYgKCFwbGF5ZXIuYXZhaWxhYmxlKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1NvcnJ5LCB0aGF0IGlzIG5vdCBhIHZhbGlkIGNoYWxsZW5nZS4nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IHRydWU7XG4gICAgICAgIHZhciBjaGFsbGVuZ2UgPSB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogdm0uY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBjb21wbGV0ZTogZmFsc2UsXG4gICAgICAgICAgZm9yZmVpdDogZmFsc2UsXG4gICAgICAgICAgdGltZUxpbWl0OiAyNCxcbiAgICAgICAgICBjaGFsbGVuZ2VyOiB7XG4gICAgICAgICAgICBfaWQ6IHZtLmN1cnJlbnRVc2VyUGxheWVyLl9pZCxcbiAgICAgICAgICAgIGZpcnN0TmFtZTogdm0uY3VycmVudFVzZXJQbGF5ZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgbGFzdE5hbWU6IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxhc3ROYW1lLFxuICAgICAgICAgICAgbmlja25hbWU6IHZtLmN1cnJlbnRVc2VyUGxheWVyLm5pY2tuYW1lLFxuICAgICAgICAgICAgcG9zaXRpb246IHZtLmN1cnJlbnRVc2VyUGxheWVyLnBvc2l0aW9uXG4gICAgICAgICAgfSxcbiAgICAgICAgICBvcHBvbmVudDoge1xuICAgICAgICAgICAgX2lkOiBwbGF5ZXIuX2lkLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiBwbGF5ZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgbGFzdE5hbWU6IHBsYXllci5sYXN0TmFtZSxcbiAgICAgICAgICAgIG5pY2tuYW1lOiBwbGF5ZXIubmlja25hbWUsXG4gICAgICAgICAgICBwb3NpdGlvbjogcGxheWVyLnBvc2l0aW9uXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jcmVhdGVDaGFsbGVuZ2UoY2hhbGxlbmdlKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgICAgIHZtLnB5cmFtaWRNZW51VG9nZ2xlID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wbGV0ZSBhIGNoYWxsZW5nZSBieSBhIHVzZXIgaW50ZXJhY3Rpb24gb3IgYSBmb3JmZWl0XG4gICAgICogXG4gICAgICogQHBhcmFtICB7Ym9vbGVhbn0gd2lubmVySXNDdXJyZW50VXNlclxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IGZvcmZlaXRcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IGZvcmZlaXRMb3NlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbXBsZXRlQ2hhbGxlbmdlKHdpbm5lcklzQ3VycmVudFVzZXIsIGZvcmZlaXQsIGZvcmZlaXRMb3Nlcikge1xuICAgICAgdmFyIHBsYXllciA9IGZvcmZlaXRMb3NlciB8fCB2bS5jdXJyZW50VXNlclBsYXllcjtcbiAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcih2bS5jb21wZXRpdGlvbklkLCBwbGF5ZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIHN3YXBQb3NpdGlvbnMgPSBmYWxzZTtcblxuICAgICAgICAvLyBJZiB0aGVyZSBpcyBhIGZvcmZlaXQgdGhhbiBzd2FwIHBvc2l0aW9uIGFuZCBtYWtlIHRoZSBjaGFsbGVuZ2VyIHRoZSB3aW5uZXJcbiAgICAgICAgaWYgKGZvcmZlaXQpIHtcbiAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS5mb3JmZWl0ID0gdHJ1ZTtcbiAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLndpbm5lciA9IHRydWU7XG4gICAgICAgICAgc3dhcFBvc2l0aW9ucyA9IHRydWU7XG4gICAgICAgICAgLy8gRmlndXJlIG91dCB3aG8gdGhlIHdpbm5lciB3YXMgdG8gc3RvcmUgaW4gdGhlIGNoYWxsZW5nZSByZWNvcmRcbiAgICAgICAgfSBlbHNlIGlmICh3aW5uZXJJc0N1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgaWYgKGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIuX2lkID09PSB2bS5jdXJyZW50VXNlclBsYXllci5faWQpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIud2lubmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS5vcHBvbmVudC53aW5uZXIgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci5faWQgPT09IHZtLmN1cnJlbnRVc2VyUGxheWVyLl9pZCkge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEub3Bwb25lbnQud2lubmVyID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci53aW5uZXIgPSB0cnVlO1xuICAgICAgICAgICAgc3dhcFBvc2l0aW9ucyA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3dhcCBwb3NpdGlvbnMgYW5kIHRoZW4gY29tcGxldGUgdGhlIGNoYWxsZW5nZSBvciBqdXN0IGNvbXBsZXRlIHRoZSBjaGFsbGVuZ2VcbiAgICAgICAgLy8gV2Vic29ja2V0IGV2ZW50IHdpbGwgcmVmcmVzaCB0aGUgcHlyYW1pZFxuICAgICAgICBpZiAoc3dhcFBvc2l0aW9ucykge1xuICAgICAgICAgIHB5cmFtaWRzU2VydmljZS5zd2FwUG9zaXRpb25zKHZtLmNvbXBldGl0aW9uSWQsIGNoYWxsZW5nZS5kYXRhLm9wcG9uZW50LCBjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmNvbXBsZXRlQ2hhbGxlbmdlKGNoYWxsZW5nZS5kYXRhKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jb21wbGV0ZUNoYWxsZW5nZShjaGFsbGVuZ2UuZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHZtLnB5cmFtaWRNZW51VG9nZ2xlID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjaGFsbGVuZ2VFeHBpcmVkKHBsYXllcikge1xuICAgICAgY29tcGxldGVDaGFsbGVuZ2UobnVsbCwgdHJ1ZSwgcGxheWVyKTtcbiAgICB9XG5cbiAgICAvLyBSZWZyZXNoIHRoZSBweXJhbWlkIGJlY2FzdWUgb2YgYW4gdXBkYXRlXG4gICAgZnVuY3Rpb24gcmVmcmVzaFB5cmFtaWQoKSB7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgIHZtLnB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICAgIG9yZGVyUGxheWVycygpO1xuICAgICAgICBnZXRQbGF5ZXJzU3RhdHVzKCk7XG4gICAgICAgIGZpbGxJbkVtcHR5QmxvY2tzKCk7XG4gICAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jcmVhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jb21wbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgncHlyYW1pZHNTZXJ2aWNlJywgcHlyYW1pZHNTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBweXJhbWlkc1NlcnZpY2UoJGh0dHApIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGdldFB5cmFtaWQ6IGdldFB5cmFtaWQsXG4gICAgICBnZXRQeXJhbWlkc0ZvclVzZXI6IGdldFB5cmFtaWRzRm9yVXNlcixcbiAgICAgIGNyZWF0ZVB5cmFtaWQ6IGNyZWF0ZVB5cmFtaWQsXG4gICAgICBzd2FwUG9zaXRpb25zOiBzd2FwUG9zaXRpb25zLFxuICAgICAgYWRkUGxheWVyVG9QeXJhbWlkOiBhZGRQbGF5ZXJUb1B5cmFtaWRcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGEgcHlyYW1pZCBmcm9tIHRoZSBkYXRhYmFzZSAob3IgbWVtb3J5KVxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHB5cmFtaWQgaWQgZm9yIHRoZSByZXF1ZXN0ZWQgcHlyYW1pZFxuICAgICAqIEByZXR1cm4ge09iamVjdH0gcHlyYW1pZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFB5cmFtaWQocHlyYW1pZElkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3B5cmFtaWQnLCB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHB5cmFtaWRJZDogcHlyYW1pZElkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYWxsIHB5cmFtaWRzIGZyb20gdGhlIGRhdGFiYXNlIHRoZSBhIHBhcnRpY3VsYXIgdXNlciBpcyBpbmNsdWRlZCBpblxuICAgICAqXG4gICAgICogQHBhcmFtIHt1c2VySWR9IHRoZSB1c2VyIGlkIGZvciB0aGUgcmVxdWVzdGVkIHVzZXJcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IHB5cmFtaWRzXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZHNGb3JVc2VyKHVzZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9weXJhbWlkcy91c2VyJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICB1c2VySWQ6IHVzZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVQeXJhbWlkKHB5cmFtaWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2NyZWF0ZScsIHtcbiAgICAgICAgcHlyYW1pZDogcHlyYW1pZFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3dhcFBvc2l0aW9ucyhweXJhbWlkSWQsIGNoYWxsZW5nZXIsIG9wcG9uZW50KSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9zd2FwUG9zaXRpb25zJywge1xuICAgICAgICBweXJhbWlkSWQ6IHB5cmFtaWRJZCxcbiAgICAgICAgY2hhbGxlbmdlcjogY2hhbGxlbmdlcixcbiAgICAgICAgb3Bwb25lbnQ6IG9wcG9uZW50XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRQbGF5ZXJUb1B5cmFtaWQocHlyYW1pZElkLCBwbGF5ZXIpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2FkZFBsYXllcicsIHtcbiAgICAgICAgcHlyYW1pZElkOiBweXJhbWlkSWQsXG4gICAgICAgIHBsYXllcjogcGxheWVyXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQWRkUGxheWVyQ3RybCcsIEFkZFBsYXllckN0cmwpO1xuXG4gIGZ1bmN0aW9uIEFkZFBsYXllckN0cmwoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIHVzZXJTZXJ2aWNlLCBweXJhbWlkc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmF2YWlsYWJsZVBsYXllcnMgPSBbXTtcbiAgICB2bS5hZGRQbGF5ZXJUb1B5cmFtaWQgPSBhZGRQbGF5ZXJUb1B5cmFtaWQ7XG4gICAgdm0uY3JlYXRlUHlyYW1pZCA9IGNyZWF0ZVB5cmFtaWQ7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICB1c2VyU2VydmljZS5nZXRBbGxVc2VycygpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIHZtLmF2YWlsYWJsZVBsYXllcnMgPSB1c2Vycy5kYXRhO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmFyIHBvc2l0aW9uID0gMDtcblxuICAgIGZ1bmN0aW9uIGFkZFBsYXllclRvUHlyYW1pZChwbGF5ZXIpIHtcbiAgICAgIC8vIEFkZCB0aGUgc2VsZWN0ZWQgcGxheWVyIHRvIHRoZSBwbGF5ZXJzIGFycmF5XG4gICAgICBwb3NpdGlvbiArPSAxO1xuICAgICAgdmFyIGFkZFBsYXllciA9IHtcbiAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLFxuICAgICAgICBfaWQ6IHBsYXllci5faWQsXG4gICAgICAgIGZpcnN0TmFtZTogcGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgbGFzdE5hbWU6IHBsYXllci5sYXN0TmFtZSxcbiAgICAgICAgbmlja25hbWU6IHBsYXllci5uaWNrbmFtZVxuICAgICAgfTtcbiAgICAgIHZtLm5ld1B5cmFtaWQucGxheWVycy5wdXNoKGFkZFBsYXllcik7XG4gICAgICAvLyBSZW1vdmUgdGhlIHNlbGVjdGVkIHBsYXllciBmcm9tIHRoZSBhdmFpbGFibGUgcGxheWVyc1xuICAgICAgXy5yZW1vdmUodm0uYXZhaWxhYmxlUGxheWVycywge1xuICAgICAgICBfaWQ6IHBsYXllci5faWRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVB5cmFtaWQocHlyYW1pZCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmNyZWF0ZVB5cmFtaWQocHlyYW1pZCkudGhlbihmdW5jdGlvbiAobmV3UHlyYW1pZCkge1xuICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLnZpZXcnLCB7XG4gICAgICAgICAgcHlyYW1pZElkOiBuZXdQeXJhbWlkLmRhdGEuX2lkXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0NyZWF0ZVB5cmFtaWRDdHJsJywgQ3JlYXRlUHlyYW1pZEN0cmwpO1xuXG4gIGZ1bmN0aW9uIENyZWF0ZVB5cmFtaWRDdHJsKCRzdGF0ZSwgdXNlclNlcnZpY2UsIHB5cmFtaWRzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubmV3UHlyYW1pZCA9IHtcbiAgICAgIHBsYXllcnM6IFtdXG4gICAgfTtcbiAgICB2bS5hdmFpbGFibGVQbGF5ZXJzID0gW107XG4gICAgdm0uYWRkZWRQbGF5ZXJzID0gW107XG4gICAgdm0uY3JlYXRlUHlyYW1pZCA9IGNyZWF0ZVB5cmFtaWQ7XG4gICAgdm0ubmV3UHlyYW1pZC5sZXZlbHMgPSA0O1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgdXNlclNlcnZpY2UuZ2V0QWxsVXNlcnMoKS50aGVuKGZ1bmN0aW9uICh1c2Vycykge1xuICAgICAgICB2bS5hdmFpbGFibGVQbGF5ZXJzID0gdXNlcnMuZGF0YTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHZhciBwb3NpdGlvbiA9IDA7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVQeXJhbWlkKHB5cmFtaWQpIHtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaCh2bS5hZGRlZFBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgcG9zaXRpb24gKz0gMTtcbiAgICAgICAgdmFyIGFkZFBsYXllciA9IHtcbiAgICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sXG4gICAgICAgICAgX2lkOiBwbGF5ZXIuX2lkLFxuICAgICAgICAgIGZpcnN0TmFtZTogcGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICBsYXN0TmFtZTogcGxheWVyLmxhc3ROYW1lLFxuICAgICAgICAgIG5pY2tuYW1lOiBwbGF5ZXIubmlja25hbWVcbiAgICAgICAgfTtcbiAgICAgICAgdm0ubmV3UHlyYW1pZC5wbGF5ZXJzLnB1c2goYWRkUGxheWVyKTtcbiAgICAgIH0pO1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmNyZWF0ZVB5cmFtaWQocHlyYW1pZCkudGhlbihmdW5jdGlvbiAobmV3UHlyYW1pZCkge1xuICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLnZpZXcnLCB7XG4gICAgICAgICAgcHlyYW1pZElkOiBuZXdQeXJhbWlkLmRhdGEuX2lkXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ015UHlyYW1pZHNDdHJsJywgTXlQeXJhbWlkc0N0cmwpO1xuXG4gIGZ1bmN0aW9uIE15UHlyYW1pZHNDdHJsKCRzdGF0ZSwgcHlyYW1pZHNTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnB5cmFtaWRzID0gbnVsbDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkc0ZvclVzZXIoaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZHMpIHtcbiAgICAgICAgdm0ucHlyYW1pZHMgPSBweXJhbWlkcy5kYXRhO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1B5cmFtaWRDdHJsJywgUHlyYW1pZEN0cmwpO1xuXG4gIGZ1bmN0aW9uIFB5cmFtaWRDdHJsKCRzdGF0ZVBhcmFtcykge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucHlyYW1pZElkID0gbnVsbDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICgkc3RhdGVQYXJhbXMucHlyYW1pZElkKSB7XG4gICAgICAgIHZtLnB5cmFtaWRJZCA9ICRzdGF0ZVBhcmFtcy5weXJhbWlkSWQ7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1B5cmFtaWRzQ3RybCcsIFB5cmFtaWRzQ3RybCk7XG5cbiAgZnVuY3Rpb24gUHlyYW1pZHNDdHJsKCkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucHlyYW1pZHMgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgXG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgndG9nZ2xlU3VibWVudScsIHRvZ2dsZVN1Ym1lbnUpO1xuXG4gIGZ1bmN0aW9uIHRvZ2dsZVN1Ym1lbnUoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbCkge1xuICAgICAgZWwuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBlbC5uZXh0KCkuc2xpZGVUb2dnbGUoMjAwKTtcbiAgICAgICAgZWwucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ3RvZ2dsZWQnKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ3dhdmVzRWZmZWN0Jywgd2F2ZXNFZmZlY3QpO1xuXG4gIGZ1bmN0aW9uIHdhdmVzRWZmZWN0KCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0MnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCkge1xuICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ2J0bi1pY29uJykgfHwgZWxlbWVudC5oYXNDbGFzcygnYnRuLWZsb2F0JykpIHtcbiAgICAgICAgV2F2ZXMuYXR0YWNoKGVsZW1lbnQsIFsnd2F2ZXMtY2lyY2xlJ10pO1xuICAgICAgfSBlbHNlIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdidG4tbGlnaHQnKSkge1xuICAgICAgICBXYXZlcy5hdHRhY2goZWxlbWVudCwgWyd3YXZlcy1saWdodCddKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFdhdmVzLmF0dGFjaChlbGVtZW50KTtcbiAgICAgIH1cblxuICAgICAgV2F2ZXMuaW5pdCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2ZnTGluZScsIGZnTGluZSk7XG5cbiAgZnVuY3Rpb24gZmdMaW5lKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0MnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCkge1xuICAgICAgdmFyIGlucHV0ID0gZWxlbWVudC5jaGlsZHJlbigpLmZpcnN0KCk7XG4gICAgICB2YXIgaXNGbG9hdExhYmVsID0gZWxlbWVudC5wYXJlbnQoKS5oYXNDbGFzcygnZmctZmxvYXQnKTtcbiAgICAgIGlucHV0LmZvY3VzKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnZmctdG9nZ2xlZCcpO1xuICAgICAgfSk7XG5cbiAgICAgIGlucHV0LmJsdXIoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIWlzRmxvYXRMYWJlbCB8fCAoaXNGbG9hdExhYmVsICYmIGlucHV0LnZhbCgpLmxlbmd0aCA9PT0gMCkpIHtcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdmZy10b2dnbGVkJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
