angular.module("app",["ui.router","ui.bootstrap","ngAnimate","angular-loading-bar","nouislider","localytics.directives","timer"]),function(){"use strict ";function e(){}angular.module("app").config(e)}(),function(){"use strict";function e(e){var t=this;t.$state=e}e.$inject=["$state"],angular.module("app").controller("AppCtrl",e)}(),function(){"use strict";function e(e,i,a){var o={superAdmin:r,admin:t,user:n};a.html5Mode(!0),i.otherwise("/"),i.when("/pyramids/","/pyramids"),e.state("home",{url:"/",views:{content:{controller:"HomeCtrl",controllerAs:"vm",templateUrl:"common/views/home.html"}}}).state("pyramids",{url:"/pyramids",views:{content:{controller:"PyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramids.html"}}}).state("pyramids.myPyramids",{url:"/my-pyramids",views:{"content@":{controller:"MyPyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/my-pyramids.html"}},resolve:{auth:o.user}}).state("pyramids.view",{url:"/view/:pyramidId",views:{"content@":{controller:"PyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramid.html"}}}).state("pyramids.create",{url:"/create",views:{"content@":{controller:"CreatePyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/create-pyramid.html"}},resolve:{auth:o.user}}).state("login",{url:"/login",views:{content:{controller:"LoginCtrl",controllerAs:"vm",templateUrl:"authentication/views/login.html"}}}).state("register",{url:"/register",views:{content:{controller:"RegisterCtrl",controllerAs:"vm",templateUrl:"authentication/views/register.html"}}})}function t(e){return e.authorizeCurrentUserForRoute("admin")}function r(e){return e.authorizeCurrentUserForRoute("super-admin")}function n(e){return e.authenticatedUserForRoute()}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app").config(e),t.$inject=["authService"],r.$inject=["authService"],n.$inject=["authService"]}(),function(){"use strict";function e(e,t,r){e.$on("$stateChangeError",function(e,r,n,i,a,o){"not authorized"===o&&(t.go("login"),t.previous=r)}),e.$on("$stateChangeStart",function(){r.setSidebarStatus(!1)})}e.$inject=["$rootScope","$state","sidebarService"],angular.module("app").run(e)}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"/pyramids/components/pyramid.html",replace:!0,scope:{pyramidId:"@"},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,r,n,i){function a(){t.getPyramid(y.pyramidId).then(function(e){y.pyramid=e.data,g=y.pyramid.players.length,_.find(y.pyramid.players,["_id",i.currentUser._id])&&(y.isPlayerOnPyramid=!0),s(),c(),u(),d(),p(),y.isPlayerOnPyramid&&m()})}function o(e){if(i.isAuthenticated()&&y.isPlayerOnPyramid)if(_.isEmpty(v)&&99!==e.position&&i.isAuthorized("admin"))v=e,v.class="active";else if(v===e&&i.isAuthorized("admin"))v.class="",v={};else if(e.level===v.level||e.level<v.level-1||e.level>v.level+1||99===e.position)n.error("Sorry, thats not allowed!");else{var r=v.position,a=v.level;h=e,v.position=e.position,v.level=e.level,h.position=r,h.level=a,t.swapPositions(y.pyramidId,v,h),v.class="",v={},h={}}else i.isAuthenticated()&&!y.isPlayerOnPyramid&&99===e.position?l():n.error("You can not update this pyramid.<br>You must join the pyramid first.")}function l(){var e={position:g+1,_id:i.currentUser._id,firstName:i.currentUser.firstName,lastName:i.currentUser.lastName,nickname:i.currentUser.nickname};t.addPlayerToPyramid(y.pyramidId,e).then(function(e){y.isPlayerOnPyramid=!0,f()})}function s(){y.pyramid.players=r("orderBy")(y.pyramid.players,"position")}function c(){y.breakPoints=[];for(var e=0;e<y.pyramid.levels;e++)y.breakPoints.push(e*(e+1)/2+1)}function u(){y.numberOfBlocks=0;for(var e=y.pyramid.levels;e>0;e--)y.numberOfBlocks+=e}function d(){for(var e=y.pyramid.players.length;e<y.numberOfBlocks;e++)y.pyramid.players.push({firstName:"Empty",lastName:"Spot",position:99,class:"empty"})}function p(){y.level=0;for(var e=0;e<y.pyramid.players.length;e++)y.breakPoints.indexOf(e+1)>-1&&(y.level+=1),y.pyramid.players[e].level=y.level}function m(){!i.isAuthorized("admin")&&i.isAuthenticated()&&y.isPlayerOnPyramid&&(v=_.find(y.pyramid.players,["_id",i.currentUser._id]),v.class="active")}function f(){t.getPyramid(y.pyramidId).then(function(e){y.pyramid=e.data,s(),d(),p(),m()})}var y=this;y.pyramid={},y.breakPoints=[],y.numberOfBlocks=0,y.level=0,y.updatePyramid=o,y.isPlayerOnPyramid=!1;var v={},h={},g=0;a(),e.$on("ws:match_results",function(e,t){n.info(t),f()})}angular.module("app").directive("_kpPyramid",e),t.$inject=["$scope","pyramidsService","$filter","Notification","identityService"]}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"/pyramids/components/pyramid.html",replace:!0,scope:{competitionId:"@"},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,r,n,i,a){function o(){t.getPyramid(g.competitionId).then(function(e){g.pyramid=e.data,g.levels=[];for(var t=1;t<=e.data.levels;++t)g.levels.push(t);l(),s(),u(),d(),p()})}function l(){g.pyramid.players=r("orderBy")(g.pyramid.players,"position")}function s(){_.forEach(g.pyramid.players,function(e){i.currentUser&&e._id===i.currentUser._id&&(g.isCurrentUserOnPyramid=!0,e.class="current-user",g.currentUserPlayer=e,a.getActiveChallengeByCompetitionByPlayer(g.competitionId,e._id).then(function(e){e.data&&(g.hasActiveChallenge=!0)}))}),a.getActiveChallengesByCompetition(g.competitionId).then(function(e){_.forEach(e.data,function(e){var t=_.find(g.pyramid.players,{_id:e.challenger._id});t.class="unavailable",t.challenge={position:"challenger"};var r=_.find(g.pyramid.players,{_id:e.opponent._id});r.class="unavailable",r.challenge={position:"opponent"};var n=moment().diff(moment(e.created).add(e.timeLimit,"h"),"s")*-1;n>0?r.challenge.expires=n:n<=0&&y(null,!0,t)})})}function c(){g.breakPoints=[];for(var e=0;e<g.pyramid.levels;e++)g.breakPoints.push(e*(e+1)/2+1)}function u(){g.numberOfBlocks=0;for(var e=g.pyramid.levels;e>0;e--)g.numberOfBlocks+=e}function d(){for(var e=g.pyramid.players.length;e<g.numberOfBlocks;e++)g.pyramid.players.push({firstName:"Empty",lastName:"Spot",position:99,class:"empty"})}function p(){var e=0;c();for(var t=0;t<g.pyramid.players.length;t++)g.breakPoints.indexOf(t+1)>-1&&(e+=1),g.pyramid.players[t].level=e}function m(e){e?g.showCreateChallengeOptions=!1:g.showCreateChallengeOptions=!0;var t=g.currentUserPlayer.level>1?g.currentUserPlayer.level-1:null;_.forEach(g.pyramid.players,function(r){r.level===t&&99!==r.position&&"unavailable"!=r.class&&(g.availableChallenges=!0,e?(r.class="",r.available=!1):(r.class="available",r.available=!0))})}function f(e){if(g.showCreateChallengeOptions)if(e.available){g.showCreateChallengeOptions=!1,g.hasActiveChallenge=!0;var t={competitionId:g.competitionId,complete:!1,forfeit:!1,timeLimit:24,challenger:{_id:g.currentUserPlayer._id,firstName:g.currentUserPlayer.firstName,lastName:g.currentUserPlayer.lastName,nickname:g.currentUserPlayer.nickname,position:g.currentUserPlayer.position},opponent:{_id:e._id,firstName:e.firstName,lastName:e.lastName,nickname:e.nickname,position:e.position}};a.createChallenge(t).then(function(){h()})}else n.error("Sorry, that is not a valid challenge.")}function y(e,r,n){var i=n||g.currentUserPlayer;a.getActiveChallengeByCompetitionByPlayer(g.competitionId,i._id).then(function(n){g.hasActiveChallenge=!1,g.showCreateChallengeOptions=!1,g.showCompleteChallengeOptions=!1;var i=!1;r?(n.data.forfeit=!0,n.data.challenger.winner=!0,i=!0):e?n.data.challenger._id===g.currentUserPlayer._id?(n.data.challenger.winner=!0,i=!0):n.data.opponent.winner=!0:n.data.challenger._id===g.currentUserPlayer._id?n.data.opponent.winner=!0:(n.data.challenger.winner=!0,i=!0),a.completeChallenge(n.data).then(function(e){i?t.swapPositions(g.competitionId,e.data.opponent,e.data.challenger).then(h):h()})})}function v(){y(null,!0)}function h(){t.getPyramid(g.competitionId).then(function(e){g.pyramid=e.data,l(),s(),d(),p()})}var g=this;g.pyramid={},g.breakPoints=[],g.numberOfBlocks=0,g.isCurrentUserOnPyramid=!1,g.hasActiveChallenge=!1,g.showCreateChallengeOptions=!1,g.showCompleteChallengeOptions=!1,g.availableChallenges=!1,g.startChallenge=m,g.createChallenge=f,g.completeChallenge=y,g.challengeExpired=v,g.currentUserPlayer={},o(),e.$on("ws:challenge_created",function(e,t){g.competitionId===t.competitionId&&(n.info(t.description),h())}),e.$on("ws:challenge_completed",function(e,t){g.competitionId===t.competitionId&&(n.info(t.description),h())})}t.$inject=["$scope","pyramidsService","$filter","notifyService","identityService","challengesService"],angular.module("app").directive("kpPyramid",e)}(),function(){"use strict";function e(e){function t(t){return e.get("/api/pyramid",{params:{pyramidId:t}})}function r(t){return e.get("/api/pyramids/user",{params:{userId:t}})}function n(t){return e.post("/api/pyramids/create",{pyramid:t})}function i(t,r,n){return e.post("/api/pyramids/swapPositions",{pyramidId:t,challenger:r,opponent:n})}function a(t,r){return e.post("/api/pyramids/addPlayer",{pyramidId:t,player:r})}var o={getPyramid:t,getPyramidsForUser:r,createPyramid:n,swapPositions:i,addPlayerToPyramid:a};return o}e.$inject=["$http"],angular.module("app").factory("pyramidsService",e)}(),function(){"use strict";function e(e,t,r,n){function i(){r.getAllUsers().then(function(e){l.availablePlayers=e.data})}function a(e){s+=1;var t={position:s,_id:e._id,firstName:e.firstName,lastName:e.lastName,nickname:e.nickname};l.newPyramid.players.push(t),_.remove(l.availablePlayers,{_id:e._id})}function o(t){n.createPyramid(t).then(function(t){e.go("pyramids.view",{pyramidId:t.data._id})})}var l=this;l.availablePlayers=[],l.addPlayerToPyramid=a,l.createPyramid=o,i();var s=0}e.$inject=["$state","$stateParams","userService","pyramidsService"],angular.module("app").controller("AddPlayerCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){t.getAllUsers().then(function(e){a.availablePlayers=e.data})}function i(t){angular.forEach(a.addedPlayers,function(e){o+=1;var t={position:o,_id:e._id,firstName:e.firstName,lastName:e.lastName,nickname:e.nickname};a.newPyramid.players.push(t)}),r.createPyramid(t).then(function(t){e.go("pyramids.view",{pyramidId:t.data._id})})}var a=this;a.newPyramid={players:[]},a.availablePlayers=[],a.addedPlayers=[],a.createPyramid=i,a.newPyramid.levels=4,n();var o=0}e.$inject=["$state","userService","pyramidsService"],angular.module("app").controller("CreatePyramidCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){t.getPyramidsForUser(r.currentUser._id).then(function(e){i.pyramids=e.data})}var i=this;i.pyramids=null,n()}e.$inject=["$state","pyramidsService","identityService"],angular.module("app").controller("MyPyramidsCtrl",e)}(),function(){"use strict";function e(e){function t(){e.pyramidId&&(r.pyramidId=e.pyramidId)}var r=this;r.pyramidId=null,t()}e.$inject=["$stateParams"],angular.module("app").controller("PyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}var t=this;t.pyramids=null,e()}angular.module("app").controller("PyramidsCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@"},templateUrl:"/common/components/challenges.html"};return e}function t(e,t){function r(){n()}function n(){t.getActiveChallengesByCompetition(i.competitionId).then(function(e){i.challenges=[],e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){e.expires=moment().diff(moment(e.created).add(e.timeLimit,"h"),"s")*-1}))})}var i=this;i.challenges=[],r(),e.$on("ws:challenge_created",function(e,t){i.competitionId===t.competitionId&&n()}),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&n()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",templateUrl:"/common/components/footer.html"};return e}function t(e,t){function r(){t.logout()}var n=this;n.indentity=e,n.logout=r}t.$inject=["identityService","authService"],angular.module("app").directive("kpFooter",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"headerCtrl",restrict:"A",templateUrl:"/common/components/header.html"};return e}function t(e,t,r){function n(){a.sidebarStatus.left=!a.sidebarStatus.left,e.setSidebarStatus(a.sidebarStatus.left)}function i(){r.logout()}var a=this;a.indentity=t,a.logout=i,a.sidebarStatus=e.getSidebarStatus(),a.toggleSidebar=n}t.$inject=["sidebarService","identityService","authService"],angular.module("app").directive("kpHeader",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"sidebarCtrl",restrict:"A",templateUrl:"/common/components/sidebar.html"};return e}function t(e,t,r){function n(){t.logout()}var i=this;i.indentity=e,i.logout=n,i.sidebarStatus=r.getSidebarStatus()}t.$inject=["identityService","authService","sidebarService"],angular.module("app").directive("kpSidebar",e)}(),function(){"use strict";function e(e){function t(t){return e.post("/api/challenges/create",{challenge:t})}function r(t){return e.post("/api/challenges/complete",{challenge:t})}function n(t){return e.get("/api/challenges/competition",{params:{competitionId:t}})}function i(t){return e.get("/api/challenges/active/competition",{params:{competitionId:t}})}function a(t,r){return e.get("/api/challenges/active/competition/player",{params:{competitionId:t,playerId:r}})}var o={createChallenge:t,completeChallenge:r,getChallengesByCompetition:n,getActiveChallengesByCompetition:i,getActiveChallengeByCompetitionByPlayer:a};return o}e.$inject=["$http"],angular.module("app").factory("challengesService",e)}(),function(){"use strict";function e(e){function t(){return!!this.currentUser}function r(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}var n;null!==e.bootstrappedUserObject&&(n=e.bootstrappedUserObject);var i={currentUser:n,isAuthenticated:t,isAuthorized:r};return i}e.$inject=["$window"],angular.module("app").factory("identityService",e)}(),function(){"use strict";function e(){function e(e,t,r){$.notify({icon:"zmdi zmdi-alert-circle-o",message:e,url:t,target:r},{type:"info"})}function t(e,t,r){$.notify({icon:"zmdi zmdi-check",message:e,url:t,target:r},{type:"success"})}function r(e,t,r){$.notify({icon:"zmdi zmdi-alert-triangle",message:e,url:t,target:r},{type:"warning"})}function n(e,t,r){$.notify({icon:"zmdi zmdi-alert-octagon",message:e,url:t,target:r},{type:"danger"})}function i(e,t,r){$.notify({message:e,url:t,target:r},{type:"inverse"})}var a={info:e,success:t,warning:r,error:n,inverse:i};return $.notifyDefaults({offset:{x:20,y:85}}),a}angular.module("app").factory("notifyService",e)}(),function(){"use strict";function e(){function e(){return r}function t(e){r.left=e}var r={left:!1,right:!1},n={getSidebarStatus:e,setSidebarStatus:t};return n}angular.module("app").factory("sidebarService",e)}(),angular.module("app").service("websocketService",["$rootScope","$window",function(e,t){function r(){return"https:"===t.location.protocol?"wss://"+t.location.host:"ws://"+t.location.host}var n;this.connect=function(){n=new WebSocket(r()),n.onmessage=function(t){var r=JSON.parse(t.data);e.$broadcast("ws:"+r.topic,r.data)}},this.send=function(e,t){var r=JSON.stringify({topic:e,data:t});n.send(r)}}]).run(["websocketService",function(e){e.connect()}]),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("HomeCtrl",e)}(),function(){"use strict";function e(e,t,r,n,i){function a(e,n){var a=r.defer();return t.post("/login",{username:e,password:n}).then(function(e){e.data.success?(i.currentUser=e.data.user,a.resolve(!0)):a.resolve(!1)}),a.promise}function o(e){var n=r.defer();return t.post("/api/users",{userData:e}).then(function(e){e.data?(i.currentUser=e.data,n.resolve(!0)):n.resolve(!1)}),n.promise}function l(){var n=r.defer();return t.post("/logout",{logout:!0}).then(function(){i.currentUser=void 0,n.resolve(),e.go("home")}),n.promise}function s(e){return!!i.isAuthorized(e)||r.reject("not authorized")}function c(){return!!i.isAuthenticated()||r.reject("not authorized")}var u={authenticateUser:a,createUser:o,logout:l,authorizeCurrentUserForRoute:s,authenticatedUserForRoute:c};return u}e.$inject=["$state","$http","$q","userService","identityService"],angular.module("app").factory("authService",e)}(),function(){"use strict";function e(e,t){function r(){return e.get("/api/users").then(function(e){return e})}var n={getAllUsers:r};return n}e.$inject=["$http","identityService"],angular.module("app").factory("userService",e)}(),function(){"use strict";function e(e,t,r){function n(){}function i(n,i){t.authenticateUser(n,i).then(function(t){t?(r.success("Login successful.  Welcome to Knifeplane!"),e.previous?e.go(e.previous):e.go("home")):r.error("Username / password combinaiton incorrect")})}var a=this;a.login=i,n()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("LoginCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){}function i(e){r.createUser(e).then(function(e){t.go("home")})}var a=this;a.register=i,n()}e.$inject=["$scope","$state","authService"],angular.module("app").controller("RegisterCtrl",e)}(),function(){"use strict";function e(){function e(e,t){t.click(function(){t.next().slideToggle(200),t.parent().toggleClass("toggled")})}var t={restrict:"A",link:e};return t}angular.module("app").directive("toggleSubmenu",e)}(),function(){"use strict";function e(){function e(e,t){t.hasClass("btn-icon")||t.hasClass("btn-float")?Waves.attach(t,["waves-circle"]):t.hasClass("btn-light")?Waves.attach(t,["waves-light"]):Waves.attach(t),Waves.init()}var t={restrict:"C",link:e};return t}angular.module("app").directive("wavesEffect",e)}(),function(){"use strict";function e(){function e(e,t){var r=t.children().first(),n=t.parent().hasClass("fg-float");r.focus(function(){t.addClass("fg-toggled")}),r.blur(function(){(!n||n&&0===r.val().length)&&t.removeClass("fg-toggled")})}var t={restrict:"C",link:e};return t}angular.module("app").directive("fgLine",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiYXBwLmNvbnRyb2xsZXIuanMiLCJhcHAucm91dGVzLmpzIiwiYXBwLnJ1bi5qcyIsInB5cmFtaWRzL2NvbXBvbmVudHMvX3B5cmFtaWQuZGlyZWN0aXZlLmpzIiwicHlyYW1pZHMvY29tcG9uZW50cy9weXJhbWlkLmRpcmVjdGl2ZS5qcyIsInB5cmFtaWRzL3NlcnZpY2VzL3B5cmFtaWRzLnNlcnZpY2UuanMiLCJweXJhbWlkcy92aWV3cy9hZGQtcGxheWVyLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy92aWV3cy9jcmVhdGUtcHlyYW1pZC5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvbXktcHlyYW1pZHMuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL3B5cmFtaWQuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL3B5cmFtaWRzLmNvbnRyb2xsZXIuanMiLCJjb21tb24vY29tcG9uZW50cy9jaGFsbGVuZ2VzLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL2Zvb3Rlci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy9oZWFkZXIuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvc2lkZWJhci5kaXJlY3RpdmUuanMiLCJjb21tb24vc2VydmljZXMvY2hhbGxlbmdlcy5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL2luZGVudGl0eS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL25vdGlmeS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3NpZGViYXIuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy93ZWJzb2NrZXQuc2VydmljZS5qcyIsImNvbW1vbi92aWV3cy9ob21lLmNvbnRyb2xsZXIuanMiLCJhdXRoZW50aWNhdGlvbi9zZXJ2aWNlcy9hdXRoLnNlcnZpY2UuanMiLCJhdXRoZW50aWNhdGlvbi9zZXJ2aWNlcy91c2VyLnNlcnZpY2UuanMiLCJhdXRoZW50aWNhdGlvbi92aWV3cy9sb2dpbi5jb250cm9sbGVyLmpzIiwiYXV0aGVudGljYXRpb24vdmlld3MvcmVnaXN0ZXIuY29udHJvbGxlci5qcyIsImNvbW1vbi9jb21wb25lbnRzL3VpL3RvZ2dsZS1zdWJtZW51LmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL3VpL3dhdmVzLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL3VpL2Zvcm1zL2ZnLWxpbmUuZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWd1cmF0aW9uIiwiY29uZmlnIiwiQXBwQ3RybCIsIiRzdGF0ZSIsImFwcEN0cmwiLCJ0aGlzIiwiY29udHJvbGxlciIsImNvbmZpZ3VyZVJvdXRlcyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJyb3V0ZVJvbGVDaGVja3MiLCJzdXBlckFkbWluIiwicmVxdWlyZVN1cGVyQWRtaW4iLCJhZG1pbiIsInJlcXVpcmVBZG1pbiIsInVzZXIiLCJyZXF1aXJlQXV0aCIsImh0bWw1TW9kZSIsIm90aGVyd2lzZSIsIndoZW4iLCJzdGF0ZSIsInVybCIsInZpZXdzIiwiY29udGVudCIsImNvbnRyb2xsZXJBcyIsInRlbXBsYXRlVXJsIiwiY29udGVudEAiLCJyZXNvbHZlIiwiYXV0aCIsImF1dGhTZXJ2aWNlIiwiYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSIsImF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUiLCIkaW5qZWN0IiwiYXBwUnVuIiwiJHJvb3RTY29wZSIsInNpZGViYXJTZXJ2aWNlIiwiJG9uIiwiZXZlbnQiLCJ0b1N0YXRlIiwidG9QYXJhbXMiLCJmcm9tU3RhdGUiLCJmcm9tUGFyYW1zIiwiZXJyb3IiLCJnbyIsInByZXZpb3VzIiwic2V0U2lkZWJhclN0YXR1cyIsInJ1biIsIl9rcFB5cmFtaWQiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInJlcGxhY2UiLCJzY29wZSIsInB5cmFtaWRJZCIsImN0cmxGdW5jIiwiYmluZFRvQ29udHJvbGxlciIsIiRzY29wZSIsInB5cmFtaWRzU2VydmljZSIsIiRmaWx0ZXIiLCJOb3RpZmljYXRpb24iLCJpZGVudGl0eVNlcnZpY2UiLCJhY3RpdmF0ZSIsImdldFB5cmFtaWQiLCJ2bSIsInRoZW4iLCJweXJhbWlkIiwiZGF0YSIsIm51bWJlck9mQWN0dWFsUGxheWVycyIsInBsYXllcnMiLCJsZW5ndGgiLCJfIiwiZmluZCIsImN1cnJlbnRVc2VyIiwiX2lkIiwiaXNQbGF5ZXJPblB5cmFtaWQiLCJvcmRlclBsYXllcnMiLCJjcmVhdGVCcmVha1BvaW50cyIsImNhbGN1bGF0ZVB5cmFtaWRCbG9ja3MiLCJmaWxsSW5FbXB0eUJsb2NrcyIsImFzc2lnbkxldmVsc1RvUGxheWVycyIsImFzc2lnblBsYXllck9uZSIsInVwZGF0ZVB5cmFtaWQiLCJwbGF5ZXIiLCJpc0F1dGhlbnRpY2F0ZWQiLCJpc0VtcHR5IiwicGxheWVyMSIsInBvc2l0aW9uIiwiaXNBdXRob3JpemVkIiwiY2xhc3MiLCJsZXZlbCIsInBsYXllcjFPbGRQb3NpdGlvbiIsInBsYXllcjFPbGRMZXZlbCIsInBsYXllcjIiLCJzd2FwUG9zaXRpb25zIiwiYWRkUGxheWVyVG9QeXJhbWlkIiwibmV3UGxheWVyIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJuaWNrbmFtZSIsInJlc3BvbnNlIiwicmVmcmVzaFB5cmFtaWQiLCJicmVha1BvaW50cyIsImkiLCJsZXZlbHMiLCJwdXNoIiwibnVtYmVyT2ZCbG9ja3MiLCJpbmRleE9mIiwicmVzdWx0IiwiaW5mbyIsImtwUHlyYW1pZCIsImNvbXBldGl0aW9uSWQiLCJub3RpZnlTZXJ2aWNlIiwiY2hhbGxlbmdlc1NlcnZpY2UiLCJnZXRQbGF5ZXJzU3RhdHVzIiwiZm9yRWFjaCIsImlzQ3VycmVudFVzZXJPblB5cmFtaWQiLCJjdXJyZW50VXNlclBsYXllciIsImdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllciIsImNoYWxsZW5nZSIsImhhc0FjdGl2ZUNoYWxsZW5nZSIsImdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uIiwiY2hhbGxlbmdlcyIsImNoYWxsZW5nZXIiLCJvcHBvbmVudCIsInRpbWVUb0V4cGlyZSIsIm1vbWVudCIsImRpZmYiLCJjcmVhdGVkIiwiYWRkIiwidGltZUxpbWl0IiwiZXhwaXJlcyIsImNvbXBsZXRlQ2hhbGxlbmdlIiwic3RhcnRDaGFsbGVuZ2UiLCJjYW5jZWwiLCJzaG93Q3JlYXRlQ2hhbGxlbmdlT3B0aW9ucyIsImxldmVsQWJvdmUiLCJhdmFpbGFibGVDaGFsbGVuZ2VzIiwiYXZhaWxhYmxlIiwiY3JlYXRlQ2hhbGxlbmdlIiwiY29tcGxldGUiLCJmb3JmZWl0Iiwid2lubmVySXNDdXJyZW50VXNlciIsImZvcmZlaXRXaW5uZXIiLCJzaG93Q29tcGxldGVDaGFsbGVuZ2VPcHRpb25zIiwid2lubmVyIiwiY2hhbGxlbmdlRXhwaXJlZCIsImNoYWxsZW5nZURldGFpbHMiLCJkZXNjcmlwdGlvbiIsIiRodHRwIiwiZ2V0IiwicGFyYW1zIiwiZ2V0UHlyYW1pZHNGb3JVc2VyIiwidXNlcklkIiwiY3JlYXRlUHlyYW1pZCIsInBvc3QiLCJzZXJ2aWNlIiwiZmFjdG9yeSIsIkFkZFBsYXllckN0cmwiLCIkc3RhdGVQYXJhbXMiLCJ1c2VyU2VydmljZSIsImdldEFsbFVzZXJzIiwidXNlcnMiLCJhdmFpbGFibGVQbGF5ZXJzIiwiYWRkUGxheWVyIiwibmV3UHlyYW1pZCIsInJlbW92ZSIsIkNyZWF0ZVB5cmFtaWRDdHJsIiwiYWRkZWRQbGF5ZXJzIiwiTXlQeXJhbWlkc0N0cmwiLCJweXJhbWlkcyIsIlB5cmFtaWRDdHJsIiwiUHlyYW1pZHNDdHJsIiwia3BDaGFsbGVuZWdlcyIsImdldEFjdGl2ZUNoYWxsZW5nZXMiLCJrcEZvb3RlciIsImxvZ291dCIsImluZGVudGl0eSIsImtwSGVhZGVyIiwidG9nZ2xlU2lkZWJhciIsInNpZGViYXJTdGF0dXMiLCJsZWZ0IiwiZ2V0U2lkZWJhclN0YXR1cyIsImtwU2lkZWJhciIsImdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uIiwicGxheWVySWQiLCIkd2luZG93Iiwicm9sZSIsInJvbGVzIiwiYm9vdHN0cmFwcGVkVXNlck9iamVjdCIsIm1lc3NhZ2UiLCJ0YXJnZXQiLCIkIiwibm90aWZ5IiwiaWNvbiIsInR5cGUiLCJzdWNjZXNzIiwid2FybmluZyIsImludmVyc2UiLCJub3RpZnlEZWZhdWx0cyIsIm9mZnNldCIsIngiLCJ5Iiwic3RhdHVzIiwicmlnaHQiLCJ3ZWJzb2NrZXRIb3N0IiwibG9jYXRpb24iLCJwcm90b2NvbCIsImhvc3QiLCJjb25uZWN0aW9uIiwiY29ubmVjdCIsIldlYlNvY2tldCIsIm9ubWVzc2FnZSIsImUiLCJwYXlsb2FkIiwiSlNPTiIsInBhcnNlIiwiJGJyb2FkY2FzdCIsInRvcGljIiwic2VuZCIsImpzb24iLCJzdHJpbmdpZnkiLCJ3ZWJzb2NrZXRTZXJ2aWNlIiwiSG9tZUN0cmwiLCIkcSIsImF1dGhlbnRpY2F0ZVVzZXIiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiZGZkIiwiZGVmZXIiLCJwcm9taXNlIiwiY3JlYXRlVXNlciIsInVzZXJEYXRhIiwidW5kZWZpbmVkIiwicmVqZWN0IiwiTG9naW5DdHJsIiwibG9naW4iLCJSZWdpc3RlckN0cmwiLCJyZWdpc3RlciIsIm5ld1VzZXIiLCJ0b2dnbGVTdWJtZW51IiwibGlua0Z1bmMiLCJlbCIsImNsaWNrIiwibmV4dCIsInNsaWRlVG9nZ2xlIiwicGFyZW50IiwidG9nZ2xlQ2xhc3MiLCJsaW5rIiwid2F2ZXNFZmZlY3QiLCJlbGVtZW50IiwiaGFzQ2xhc3MiLCJXYXZlcyIsImF0dGFjaCIsImluaXQiLCJmZ0xpbmUiLCJpbnB1dCIsImNoaWxkcmVuIiwiZmlyc3QiLCJpc0Zsb2F0TGFiZWwiLCJmb2N1cyIsImFkZENsYXNzIiwiYmx1ciIsInZhbCIsInJlbW92ZUNsYXNzIl0sIm1hcHBpbmdzIjoi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TUFBQUMsT0FBQUgsR0FBQSxnQkFFQUUsTUFBQUMsT0FBQUgsR0FHQUUsTUFBQUUsT0FoQkEsR0FBQTVNLElBQ0FDLFNBQUEsSUFDQXFNLEtBQUFQLEVBR0EsT0FBQS9MLEdBVkFuRCxRQUNBQyxPQUFBLE9BQ0FrRCxVQUFBLGNBQUF1TSxNQ0pBLFdBQ0EsWUFLQSxTQUFBTSxLQVFBLFFBQUFkLEdBQUE1TCxFQUFBcU0sR0FDQSxHQUFBTSxHQUFBTixFQUFBTyxXQUFBQyxRQUNBQyxFQUFBVCxFQUFBSixTQUFBSyxTQUFBLFdBQ0FLLEdBQUFJLE1BQUEsV0FDQVYsRUFBQVcsU0FBQSxnQkFHQUwsRUFBQU0sS0FBQSxhQUNBSCxHQUFBQSxHQUFBLElBQUFILEVBQUFPLE1BQUFqTSxTQUNBb0wsRUFBQWMsWUFBQSxnQkFoQkEsR0FBQXROLElBQ0FDLFNBQUEsSUFDQXFNLEtBQUFQLEVBR0EsT0FBQS9MLEdBVkFuRCxRQUNBQyxPQUFBLE9BQ0FrRCxVQUFBLFNBQUE2TSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAndWkucm91dGVyJyxcbiAgJ3VpLmJvb3RzdHJhcCcsXG4gICduZ0FuaW1hdGUnLFxuICAnYW5ndWxhci1sb2FkaW5nLWJhcicsXG4gICdub3Vpc2xpZGVyJyxcbiAgJ2xvY2FseXRpY3MuZGlyZWN0aXZlcycsXG4gICd0aW1lcidcbl0pOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0ICc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb25maWcoY29uZmlndXJhdGlvbik7XG5cbiAgZnVuY3Rpb24gY29uZmlndXJhdGlvbigpIHtcblxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0FwcEN0cmwnLCBBcHBDdHJsKTtcblxuICBmdW5jdGlvbiBBcHBDdHJsKCRzdGF0ZSkge1xuICAgIHZhciBhcHBDdHJsID0gdGhpcztcbiAgICBhcHBDdHJsLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb25maWcoY29uZmlndXJlUm91dGVzKTtcblxuICBmdW5jdGlvbiBjb25maWd1cmVSb3V0ZXMoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICB2YXIgcm91dGVSb2xlQ2hlY2tzID0ge1xuICAgICAgc3VwZXJBZG1pbjogcmVxdWlyZVN1cGVyQWRtaW4sXG4gICAgICBhZG1pbjogcmVxdWlyZUFkbWluLFxuICAgICAgdXNlcjogcmVxdWlyZUF1dGhcbiAgICB9O1xuXG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgLy8gZm9yIGFueSB1bm1hdGNoZWQgdXJsXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLndoZW4oJy9weXJhbWlkcy8nLCAnL3B5cmFtaWRzJyk7XG5cbiAgICAkc3RhdGVQcm92aWRlclxuICAgICAgLnN0YXRlKCdob21lJywge1xuICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbW1vbi92aWV3cy9ob21lLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMnLCB7XG4gICAgICAgIHVybDogJy9weXJhbWlkcycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHlyYW1pZHNDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvcHlyYW1pZHMuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy5teVB5cmFtaWRzJywge1xuICAgICAgICB1cmw6ICcvbXktcHlyYW1pZHMnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNeVB5cmFtaWRzQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL215LXB5cmFtaWRzLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLnZpZXcnLCB7XG4gICAgICAgIHVybDogJy92aWV3LzpweXJhbWlkSWQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQeXJhbWlkQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL3B5cmFtaWQuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy5jcmVhdGUnLCB7XG4gICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDcmVhdGVQeXJhbWlkQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL2NyZWF0ZS1weXJhbWlkLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0xvZ2luQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL2xvZ2luLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncmVnaXN0ZXInLCB7XG4gICAgICAgIHVybDogJy9yZWdpc3RlcicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvcmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgcmVxdWlyZUFkbWluLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZUFkbWluKGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUoJ2FkbWluJyk7XG4gIH1cblxuICByZXF1aXJlU3VwZXJBZG1pbi4kaW5qZWN0ID0gWydhdXRoU2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIHJlcXVpcmVTdXBlckFkbWluKGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUoJ3N1cGVyLWFkbWluJyk7XG4gIH1cblxuICByZXF1aXJlQXV0aC4kaW5qZWN0ID0gWydhdXRoU2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIHJlcXVpcmVBdXRoKGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUoKTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5ydW4oYXBwUnVuKTtcblxuICBmdW5jdGlvbiBhcHBSdW4oJHJvb3RTY29wZSwgJHN0YXRlLCBzaWRlYmFyU2VydmljZSkge1xuICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VFcnJvcicsIGZ1bmN0aW9uIChldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcywgZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvciA9PT0gJ25vdCBhdXRob3JpemVkJykge1xuICAgICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XG4gICAgICAgICRzdGF0ZS5wcmV2aW91cyA9IHRvU3RhdGU7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBzaWRlYmFyU2VydmljZS5zZXRTaWRlYmFyU3RhdHVzKGZhbHNlKTtcbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5kaXJlY3RpdmUoJ19rcFB5cmFtaWQnLCBfa3BQeXJhbWlkKTtcblxuICBmdW5jdGlvbiBfa3BQeXJhbWlkKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvcHlyYW1pZHMvY29tcG9uZW50cy9weXJhbWlkLmh0bWwnLFxuICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHB5cmFtaWRJZDogJ0AnXG4gICAgICB9LFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICBjdHJsRnVuYy4kaW5qZWN0ID0gWyckc2NvcGUnLCAncHlyYW1pZHNTZXJ2aWNlJywgJyRmaWx0ZXInLCAnTm90aWZpY2F0aW9uJywgJ2lkZW50aXR5U2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKCRzY29wZSwgcHlyYW1pZHNTZXJ2aWNlLCAkZmlsdGVyLCBOb3RpZmljYXRpb24sIGlkZW50aXR5U2VydmljZSkge1xuICAgIC8qanNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucHlyYW1pZCA9IHt9O1xuICAgIHZtLmJyZWFrUG9pbnRzID0gW107XG4gICAgdm0ubnVtYmVyT2ZCbG9ja3MgPSAwO1xuICAgIHZtLmxldmVsID0gMDtcbiAgICB2bS51cGRhdGVQeXJhbWlkID0gdXBkYXRlUHlyYW1pZDtcbiAgICB2bS5pc1BsYXllck9uUHlyYW1pZCA9IGZhbHNlO1xuXG4gICAgdmFyIHBsYXllcjEgPSB7fTtcbiAgICB2YXIgcGxheWVyMiA9IHt9O1xuICAgIHZhciBudW1iZXJPZkFjdHVhbFBsYXllcnMgPSAwO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0ucHlyYW1pZElkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgIHZtLnB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICAgIG51bWJlck9mQWN0dWFsUGxheWVycyA9IHZtLnB5cmFtaWQucGxheWVycy5sZW5ndGg7XG5cbiAgICAgICAgaWYgKF8uZmluZCh2bS5weXJhbWlkLnBsYXllcnMsIFsnX2lkJywgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZF0pKSB7XG4gICAgICAgICAgdm0uaXNQbGF5ZXJPblB5cmFtaWQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgb3JkZXJQbGF5ZXJzKCk7XG4gICAgICAgIGNyZWF0ZUJyZWFrUG9pbnRzKCk7XG4gICAgICAgIGNhbGN1bGF0ZVB5cmFtaWRCbG9ja3MoKTtcbiAgICAgICAgZmlsbEluRW1wdHlCbG9ja3MoKTtcbiAgICAgICAgYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCk7XG4gICAgICAgIGlmICh2bS5pc1BsYXllck9uUHlyYW1pZCkge1xuICAgICAgICAgIGFzc2lnblBsYXllck9uZSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVQeXJhbWlkKHBsYXllcikge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSAmJiB2bS5pc1BsYXllck9uUHlyYW1pZCkge1xuICAgICAgICAvLyBBbGxvdyBhZG1pbnMgdG8gc2VsZWN0IHRoZSBmaXJzdCBwbGF5ZXJcbiAgICAgICAgaWYgKF8uaXNFbXB0eShwbGF5ZXIxKSAmJiBwbGF5ZXIucG9zaXRpb24gIT09IDk5ICYmIGlkZW50aXR5U2VydmljZS5pc0F1dGhvcml6ZWQoJ2FkbWluJykpIHtcbiAgICAgICAgICBwbGF5ZXIxID0gcGxheWVyO1xuICAgICAgICAgIHBsYXllcjEuY2xhc3MgPSAnYWN0aXZlJztcbiAgICAgICAgICAvLyBBbGxvdyBhZG1pbnMgdG8gZGVzZWxlY3QgdGhlIGZpcnN0IHBsYXllclxuICAgICAgICB9IGVsc2UgaWYgKHBsYXllcjEgPT09IHBsYXllciAmJiBpZGVudGl0eVNlcnZpY2UuaXNBdXRob3JpemVkKCdhZG1pbicpKSB7XG4gICAgICAgICAgcGxheWVyMS5jbGFzcyA9ICcnO1xuICAgICAgICAgIHBsYXllcjEgPSB7fTtcbiAgICAgICAgICAvLyBPbmx5IGFsbG93IHN3YXBwaW5nIHdpdGggKHJlYWwpIHBsYXllcnMgMSBsZXZlbCBhYm92ZSBvciBiZWxvd1xuICAgICAgICB9IGVsc2UgaWYgKHBsYXllci5sZXZlbCA9PT0gcGxheWVyMS5sZXZlbCB8fCBwbGF5ZXIubGV2ZWwgPCBwbGF5ZXIxLmxldmVsIC0gMSB8fCBwbGF5ZXIubGV2ZWwgPiBwbGF5ZXIxLmxldmVsICsgMSB8fCBwbGF5ZXIucG9zaXRpb24gPT09IDk5KSB7XG4gICAgICAgICAgTm90aWZpY2F0aW9uLmVycm9yKCdTb3JyeSwgdGhhdHMgbm90IGFsbG93ZWQhJyk7XG4gICAgICAgICAgLy8gRG8gdGhlIHN3YXBwaW5nIGFuZCBzYXZlIHRvIHRoZSBkYXRhYmFzZVxuICAgICAgICAgIC8vIFRoZW4gcmVzZXQgdG8gZG8gaXQgYWxsIG92ZXIgYWdhaW5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgcGxheWVyMU9sZFBvc2l0aW9uID0gcGxheWVyMS5wb3NpdGlvbjtcbiAgICAgICAgICB2YXIgcGxheWVyMU9sZExldmVsID0gcGxheWVyMS5sZXZlbDtcbiAgICAgICAgICBwbGF5ZXIyID0gcGxheWVyO1xuXG4gICAgICAgICAgcGxheWVyMS5wb3NpdGlvbiA9IHBsYXllci5wb3NpdGlvbjtcbiAgICAgICAgICBwbGF5ZXIxLmxldmVsID0gcGxheWVyLmxldmVsO1xuXG4gICAgICAgICAgcGxheWVyMi5wb3NpdGlvbiA9IHBsYXllcjFPbGRQb3NpdGlvbjtcbiAgICAgICAgICBwbGF5ZXIyLmxldmVsID0gcGxheWVyMU9sZExldmVsO1xuXG4gICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLnN3YXBQb3NpdGlvbnModm0ucHlyYW1pZElkLCBwbGF5ZXIxLCBwbGF5ZXIyKTtcblxuICAgICAgICAgIHBsYXllcjEuY2xhc3MgPSAnJztcbiAgICAgICAgICBwbGF5ZXIxID0ge307XG4gICAgICAgICAgcGxheWVyMiA9IHt9O1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSAmJiAhdm0uaXNQbGF5ZXJPblB5cmFtaWQgJiYgcGxheWVyLnBvc2l0aW9uID09PSA5OSkge1xuICAgICAgICBhZGRQbGF5ZXJUb1B5cmFtaWQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIE5vdGlmaWNhdGlvbi5lcnJvcignWW91IGNhbiBub3QgdXBkYXRlIHRoaXMgcHlyYW1pZC48YnI+WW91IG11c3Qgam9pbiB0aGUgcHlyYW1pZCBmaXJzdC4nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRQbGF5ZXJUb1B5cmFtaWQoKSB7XG4gICAgICB2YXIgbmV3UGxheWVyID0ge1xuICAgICAgICBwb3NpdGlvbjogbnVtYmVyT2ZBY3R1YWxQbGF5ZXJzICsgMSxcbiAgICAgICAgX2lkOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkLFxuICAgICAgICBmaXJzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5maXJzdE5hbWUsXG4gICAgICAgIGxhc3ROYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIubGFzdE5hbWUsXG4gICAgICAgIG5pY2tuYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIubmlja25hbWVcbiAgICAgIH07XG4gICAgICBweXJhbWlkc1NlcnZpY2UuYWRkUGxheWVyVG9QeXJhbWlkKHZtLnB5cmFtaWRJZCwgbmV3UGxheWVyKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICB2bS5pc1BsYXllck9uUHlyYW1pZCA9IHRydWU7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBPcmRlciB0aGUgcGxheWVycyBieSB0aGUgcG9zaXRpb24gcHJvcGVydHkgb2YgdGhlIHBsYXllcnMgYXJyYXkgaW4gdGhlIHB5cmFtaWQgb2JqZWN0XG4gICAgZnVuY3Rpb24gb3JkZXJQbGF5ZXJzKCkge1xuICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzID0gJGZpbHRlcignb3JkZXJCeScpKHZtLnB5cmFtaWQucGxheWVycywgJ3Bvc2l0aW9uJyk7XG4gICAgfVxuXG4gICAgLy8gRmlndXJlIG91dCB3aGVyZSB0byBzdGFydCBlYWNoIG5ldyByb3cgb24gdGhlIHB5cmFtaWRcbiAgICBmdW5jdGlvbiBjcmVhdGVCcmVha1BvaW50cygpIHtcbiAgICAgIHZtLmJyZWFrUG9pbnRzID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLnB5cmFtaWQubGV2ZWxzOyBpKyspIHtcbiAgICAgICAgdm0uYnJlYWtQb2ludHMucHVzaCgoKChpICogKGkgKyAxKSkgLyAyKSkgKyAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBIb3cgbWFueSB0b3RhbCBibG9ja3MgaW4gdGhpcyBweXJhbWlkXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlUHlyYW1pZEJsb2NrcygpIHtcbiAgICAgIHZtLm51bWJlck9mQmxvY2tzID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSB2bS5weXJhbWlkLmxldmVsczsgaSA+IDA7IGktLSkge1xuICAgICAgICB2bS5udW1iZXJPZkJsb2NrcyArPSBpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZpbGwgb3V0IHRoZSByZW1haW5pbmcgYmxvY2tzIG9mIHRoZSBweXJhbWlkIHdpdGggZW1wdHkgYmxvY2tzXG4gICAgZnVuY3Rpb24gZmlsbEluRW1wdHlCbG9ja3MoKSB7XG4gICAgICBmb3IgKHZhciBpID0gdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDsgaSA8IHZtLm51bWJlck9mQmxvY2tzOyBpKyspIHtcbiAgICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzLnB1c2goe1xuICAgICAgICAgIGZpcnN0TmFtZTogJ0VtcHR5JyxcbiAgICAgICAgICBsYXN0TmFtZTogJ1Nwb3QnLFxuICAgICAgICAgIHBvc2l0aW9uOiA5OSxcbiAgICAgICAgICBjbGFzczogJ2VtcHR5J1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHaXZlIGVhY2ggcGxheWVyIGEgbGV2ZWwgcHJvcGVydHkgYmFzZWQgb24gdGhlIGJyZWFrIHBvaW50c1xuICAgIGZ1bmN0aW9uIGFzc2lnbkxldmVsc1RvUGxheWVycygpIHtcbiAgICAgIHZtLmxldmVsID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh2bS5icmVha1BvaW50cy5pbmRleE9mKGkgKyAxKSA+IC0xKSB7XG4gICAgICAgICAgdm0ubGV2ZWwgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICB2bS5weXJhbWlkLnBsYXllcnNbaV0ubGV2ZWwgPSB2bS5sZXZlbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgY3VycmVudCB1c2VyIGlzIGEgcGxheWVyIG9uIHRoaXMgcHlyYW1pZCBtYWtlIHRoZW0gcGxheWVyIDFcbiAgICBmdW5jdGlvbiBhc3NpZ25QbGF5ZXJPbmUoKSB7XG4gICAgICBpZiAoIWlkZW50aXR5U2VydmljZS5pc0F1dGhvcml6ZWQoJ2FkbWluJykgJiYgaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpICYmIHZtLmlzUGxheWVyT25QeXJhbWlkKSB7XG4gICAgICAgIHBsYXllcjEgPSBfLmZpbmQodm0ucHlyYW1pZC5wbGF5ZXJzLCBbJ19pZCcsIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWRdKTtcbiAgICAgICAgcGxheWVyMS5jbGFzcyA9ICdhY3RpdmUnO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlZnJlc2hQeXJhbWlkKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0ucHlyYW1pZElkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgIHZtLnB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICAgIG9yZGVyUGxheWVycygpO1xuICAgICAgICBmaWxsSW5FbXB0eUJsb2NrcygpO1xuICAgICAgICBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKTtcbiAgICAgICAgYXNzaWduUGxheWVyT25lKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAkc2NvcGUuJG9uKCd3czptYXRjaF9yZXN1bHRzJywgZnVuY3Rpb24gKF8sIHJlc3VsdCkge1xuICAgICAgTm90aWZpY2F0aW9uLmluZm8ocmVzdWx0KTtcbiAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFB5cmFtaWQnLCBrcFB5cmFtaWQpO1xuXG4gIGZ1bmN0aW9uIGtwUHlyYW1pZCgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3B5cmFtaWRzL2NvbXBvbmVudHMvcHlyYW1pZC5odG1sJyxcbiAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCdcbiAgICAgIH0sXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWVcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUsIHB5cmFtaWRzU2VydmljZSwgJGZpbHRlciwgbm90aWZ5U2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucHlyYW1pZCA9IHt9O1xuICAgIHZtLmJyZWFrUG9pbnRzID0gW107XG4gICAgdm0ubnVtYmVyT2ZCbG9ja3MgPSAwO1xuICAgIHZtLmlzQ3VycmVudFVzZXJPblB5cmFtaWQgPSBmYWxzZTtcbiAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcbiAgICB2bS5zaG93Q3JlYXRlQ2hhbGxlbmdlT3B0aW9ucyA9IGZhbHNlO1xuICAgIHZtLnNob3dDb21wbGV0ZUNoYWxsZW5nZU9wdGlvbnMgPSBmYWxzZTtcbiAgICB2bS5hdmFpbGFibGVDaGFsbGVuZ2VzID0gZmFsc2U7XG4gICAgdm0uc3RhcnRDaGFsbGVuZ2UgPSBzdGFydENoYWxsZW5nZTtcbiAgICB2bS5jcmVhdGVDaGFsbGVuZ2UgPSBjcmVhdGVDaGFsbGVuZ2U7XG4gICAgdm0uY29tcGxldGVDaGFsbGVuZ2UgPSBjb21wbGV0ZUNoYWxsZW5nZTtcbiAgICB2bS5jaGFsbGVuZ2VFeHBpcmVkID0gY2hhbGxlbmdlRXhwaXJlZDtcbiAgICB2bS5jdXJyZW50VXNlclBsYXllciA9IHt9O1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuXG4gICAgICAgIHZtLmxldmVscyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSBweXJhbWlkLmRhdGEubGV2ZWxzOyArK2kpIHtcbiAgICAgICAgICB2bS5sZXZlbHMucHVzaChpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG9yZGVyUGxheWVycygpO1xuICAgICAgICBnZXRQbGF5ZXJzU3RhdHVzKCk7XG4gICAgICAgIGNhbGN1bGF0ZVB5cmFtaWRCbG9ja3MoKTtcbiAgICAgICAgZmlsbEluRW1wdHlCbG9ja3MoKTtcbiAgICAgICAgYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPcmRlciB0aGUgcGxheWVycyBieSB0aGUgcG9zaXRpb24gcHJvcGVydHkgb2YgdGhlIHBsYXllcnMgYXJyYXkgaW4gdGhlIHB5cmFtaWQgb2JqZWN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gb3JkZXJQbGF5ZXJzKCkge1xuICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzID0gJGZpbHRlcignb3JkZXJCeScpKHZtLnB5cmFtaWQucGxheWVycywgJ3Bvc2l0aW9uJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlndXJlIG91dCBpZiBlYWNoIHBsYXllciBpcyBhbHJlYWR5IGNoYWxsZW5nZWQgYW5kIHNldCBzb21lIHN0dWZmXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UGxheWVyc1N0YXR1cygpIHtcbiAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcblxuICAgICAgICAvLyBGaW5kIHRoZSBjdXJyZW50IHVzZXIgaWYgdGhleSBhcmUgb24gdGhpcyBweXJhbWlkIGFuZCBzZXQgc29tZSBwcm9wZXJ0aWVzXG4gICAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgJiYgcGxheWVyLl9pZCA9PT0gaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCkge1xuICAgICAgICAgIHZtLmlzQ3VycmVudFVzZXJPblB5cmFtaWQgPSB0cnVlO1xuICAgICAgICAgIHBsYXllci5jbGFzcyA9ICdjdXJyZW50LXVzZXInO1xuICAgICAgICAgIHZtLmN1cnJlbnRVc2VyUGxheWVyID0gcGxheWVyO1xuXG4gICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllci5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgaWYgKGNoYWxsZW5nZS5kYXRhKSB7XG4gICAgICAgICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIF8uZm9yRWFjaChjaGFsbGVuZ2VzLmRhdGEsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcblxuICAgICAgICAgIHZhciBjaGFsbGVuZ2VyID0gXy5maW5kKHZtLnB5cmFtaWQucGxheWVycywgeydfaWQnOiBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWR9KTtcbiAgICAgICAgICBjaGFsbGVuZ2VyLmNsYXNzID0gJ3VuYXZhaWxhYmxlJztcbiAgICAgICAgICBjaGFsbGVuZ2VyLmNoYWxsZW5nZSA9IHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnY2hhbGxlbmdlcidcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgdmFyIG9wcG9uZW50ID0gXy5maW5kKHZtLnB5cmFtaWQucGxheWVycywgeydfaWQnOiBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkfSk7XG4gICAgICAgICAgb3Bwb25lbnQuY2xhc3MgPSAndW5hdmFpbGFibGUnO1xuICAgICAgICAgIG9wcG9uZW50LmNoYWxsZW5nZSA9IHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnb3Bwb25lbnQnXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIC8vIFRyYWNrIHdoZW4gdGhlIGNoYWxsZW5nZSB3aWxsIGV4cGlyZVxuICAgICAgICAgIHZhciB0aW1lVG9FeHBpcmUgPSBtb21lbnQoKS5kaWZmKG1vbWVudChjaGFsbGVuZ2UuY3JlYXRlZCkuYWRkKGNoYWxsZW5nZS50aW1lTGltaXQsICdoJyksICdzJykgKiAtMTtcbiAgICAgICAgICAvLyBJZiB0aGUgY2hhbGxlbmdlIGhhcyBub3QgeWV0IGV4cGlyZWQgZGlzcGxheSBhIGNvdW50ZG93biBvbiB0aGUgb3Bwb25lbnRcbiAgICAgICAgICBpZiAodGltZVRvRXhwaXJlID4gMCkge1xuICAgICAgICAgICAgb3Bwb25lbnQuY2hhbGxlbmdlLmV4cGlyZXMgPSB0aW1lVG9FeHBpcmU7XG4gICAgICAgICAgICAvLyBJZiB0aGUgY2hhbGxlbmdlIGV4cGlyZWQgd2hpbGUgbm8gb25lIHdhcyB2aWV3aW5nIHRoaXMgcHlyYW1pZCBjb21wbGV0ZSB0aGUgY2hhbGxlbmdlIGJ5IGZvcmZlaXRcbiAgICAgICAgICB9IGVsc2UgaWYgKHRpbWVUb0V4cGlyZSA8PSAwKSB7XG4gICAgICAgICAgICBjb21wbGV0ZUNoYWxsZW5nZShudWxsLCB0cnVlLCBjaGFsbGVuZ2VyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlndXJlIG91dCB3aGVyZSB0byBzdGFydCBlYWNoIG5ldyByb3cgb24gdGhlIHB5cmFtaWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVCcmVha1BvaW50cygpIHtcbiAgICAgIHZtLmJyZWFrUG9pbnRzID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLnB5cmFtaWQubGV2ZWxzOyBpKyspIHtcbiAgICAgICAgdm0uYnJlYWtQb2ludHMucHVzaCgoKChpICogKGkgKyAxKSkgLyAyKSkgKyAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBIb3cgbWFueSB0b3RhbCBibG9ja3MgaW4gdGhpcyBweXJhbWlkXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlUHlyYW1pZEJsb2NrcygpIHtcbiAgICAgIHZtLm51bWJlck9mQmxvY2tzID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSB2bS5weXJhbWlkLmxldmVsczsgaSA+IDA7IGktLSkge1xuICAgICAgICB2bS5udW1iZXJPZkJsb2NrcyArPSBpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZpbGwgb3V0IHRoZSByZW1haW5pbmcgYmxvY2tzIG9mIHRoZSBweXJhbWlkIHdpdGggZW1wdHkgYmxvY2tzXG4gICAgZnVuY3Rpb24gZmlsbEluRW1wdHlCbG9ja3MoKSB7XG4gICAgICBmb3IgKHZhciBpID0gdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDsgaSA8IHZtLm51bWJlck9mQmxvY2tzOyBpKyspIHtcbiAgICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzLnB1c2goe1xuICAgICAgICAgIGZpcnN0TmFtZTogJ0VtcHR5JyxcbiAgICAgICAgICBsYXN0TmFtZTogJ1Nwb3QnLFxuICAgICAgICAgIHBvc2l0aW9uOiA5OSxcbiAgICAgICAgICBjbGFzczogJ2VtcHR5J1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHaXZlIGVhY2ggcGxheWVyIGEgbGV2ZWwgcHJvcGVydHkgYmFzZWQgb24gdGhlIGJyZWFrIHBvaW50c1xuICAgIC8vIFRoaXMgd2lsbCBiZSB1c2VkIHRvIGRldGVybWluZSB3aG8gb3RoZXIgcGxheWVycyBjYW4gY2hhbGxlbmdlXG4gICAgZnVuY3Rpb24gYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCkge1xuICAgICAgdmFyIGxldmVsID0gMDtcbiAgICAgIGNyZWF0ZUJyZWFrUG9pbnRzKCk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLnB5cmFtaWQucGxheWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAodm0uYnJlYWtQb2ludHMuaW5kZXhPZihpICsgMSkgPiAtMSkge1xuICAgICAgICAgIGxldmVsICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzW2ldLmxldmVsID0gbGV2ZWw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RhcnRDaGFsbGVuZ2UoY2FuY2VsKSB7XG4gICAgICBpZiAoIWNhbmNlbCkge1xuICAgICAgICB2bS5zaG93Q3JlYXRlQ2hhbGxlbmdlT3B0aW9ucyA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2bS5zaG93Q3JlYXRlQ2hhbGxlbmdlT3B0aW9ucyA9IGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyBGaW5kIHRoZSBwbGF5ZXJzIGF2YWlsYWJsZSB0byBiZSBjaGFsbGVuZ2VkXG4gICAgICB2YXIgbGV2ZWxBYm92ZSA9IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxldmVsID4gMSA/IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxldmVsIC0gMSA6IG51bGw7XG4gICAgICBfLmZvckVhY2godm0ucHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIGlmIChwbGF5ZXIubGV2ZWwgPT09IGxldmVsQWJvdmUgJiYgcGxheWVyLnBvc2l0aW9uICE9PSA5OSAmJiBwbGF5ZXIuY2xhc3MgIT0gJ3VuYXZhaWxhYmxlJykge1xuICAgICAgICAgIHZtLmF2YWlsYWJsZUNoYWxsZW5nZXMgPSB0cnVlO1xuICAgICAgICAgIGlmICghY2FuY2VsKSB7XG4gICAgICAgICAgICBwbGF5ZXIuY2xhc3MgPSAnYXZhaWxhYmxlJztcbiAgICAgICAgICAgIHBsYXllci5hdmFpbGFibGUgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwbGF5ZXIuY2xhc3MgPSAnJztcbiAgICAgICAgICAgIHBsYXllci5hdmFpbGFibGUgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYWxsZW5nZShwbGF5ZXIpIHtcbiAgICAgIGlmICh2bS5zaG93Q3JlYXRlQ2hhbGxlbmdlT3B0aW9ucykge1xuICAgICAgICBpZiAoIXBsYXllci5hdmFpbGFibGUpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdTb3JyeSwgdGhhdCBpcyBub3QgYSB2YWxpZCBjaGFsbGVuZ2UuJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdm0uc2hvd0NyZWF0ZUNoYWxsZW5nZU9wdGlvbnMgPSBmYWxzZTtcbiAgICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSB0cnVlO1xuICAgICAgICAgIHZhciBjaGFsbGVuZ2UgPSB7XG4gICAgICAgICAgICBjb21wZXRpdGlvbklkOiB2bS5jb21wZXRpdGlvbklkLFxuICAgICAgICAgICAgY29tcGxldGU6IGZhbHNlLFxuICAgICAgICAgICAgZm9yZmVpdDogZmFsc2UsXG4gICAgICAgICAgICB0aW1lTGltaXQ6IDI0LFxuICAgICAgICAgICAgY2hhbGxlbmdlcjoge1xuICAgICAgICAgICAgICBfaWQ6IHZtLmN1cnJlbnRVc2VyUGxheWVyLl9pZCxcbiAgICAgICAgICAgICAgZmlyc3ROYW1lOiB2bS5jdXJyZW50VXNlclBsYXllci5maXJzdE5hbWUsXG4gICAgICAgICAgICAgIGxhc3ROYW1lOiB2bS5jdXJyZW50VXNlclBsYXllci5sYXN0TmFtZSxcbiAgICAgICAgICAgICAgbmlja25hbWU6IHZtLmN1cnJlbnRVc2VyUGxheWVyLm5pY2tuYW1lLFxuICAgICAgICAgICAgICBwb3NpdGlvbjogdm0uY3VycmVudFVzZXJQbGF5ZXIucG9zaXRpb25cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvcHBvbmVudDoge1xuICAgICAgICAgICAgICBfaWQ6IHBsYXllci5faWQsXG4gICAgICAgICAgICAgIGZpcnN0TmFtZTogcGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgICAgbGFzdE5hbWU6IHBsYXllci5sYXN0TmFtZSxcbiAgICAgICAgICAgICAgbmlja25hbWU6IHBsYXllci5uaWNrbmFtZSxcbiAgICAgICAgICAgICAgcG9zaXRpb246IHBsYXllci5wb3NpdGlvblxuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY3JlYXRlQ2hhbGxlbmdlKGNoYWxsZW5nZSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbXBsZXRlIGEgY2hhbGxlbmdlIGJ5IGEgdXNlciBpbnRlcmFjdGlvbiBvciBhIGZvcmZlaXRcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSB3aW5uZXJJc0N1cnJlbnRVc2VyXG4gICAgICogQHBhcmFtICB7Ym9vbGVhbn0gZm9yZmVpdFxuICAgICAqIEBwYXJhbSAge29iamVjdH0gZm9yZmVpdFdpbm5lclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbXBsZXRlQ2hhbGxlbmdlKHdpbm5lcklzQ3VycmVudFVzZXIsIGZvcmZlaXQsIGZvcmZlaXRXaW5uZXIpIHtcbiAgICAgIHZhciBwbGF5ZXIgPSBmb3JmZWl0V2lubmVyIHx8IHZtLmN1cnJlbnRVc2VyUGxheWVyO1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllci5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcbiAgICAgICAgdm0uc2hvd0NyZWF0ZUNoYWxsZW5nZU9wdGlvbnMgPSBmYWxzZTtcbiAgICAgICAgdm0uc2hvd0NvbXBsZXRlQ2hhbGxlbmdlT3B0aW9ucyA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBzd2FwUG9zaXRpb25zID0gZmFsc2U7XG5cbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBmb3JmZWl0IHRoYW4gc3dhcCBwb3NpdGlvbiBhbmQgbWFrZSB0aGUgY2hhbGxlbmdlciB0aGUgd2lubmVyXG4gICAgICAgIGlmIChmb3JmZWl0KSB7XG4gICAgICAgICAgY2hhbGxlbmdlLmRhdGEuZm9yZmVpdCA9IHRydWU7XG4gICAgICAgICAgY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci53aW5uZXIgPSB0cnVlO1xuICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIC8vIEZpZ3VyZSBvdXQgd2hvIHRoZSB3aW5uZXIgd2FzIHRvIHN0b3JlIGluIHRoZSBjaGFsbGVuZ2UgcmVjb3JkXG4gICAgICAgIH0gZWxzZSBpZiAod2lubmVySXNDdXJyZW50VXNlcikge1xuICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLl9pZCA9PT0gdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLndpbm5lciA9IHRydWU7XG4gICAgICAgICAgICBzd2FwUG9zaXRpb25zID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEub3Bwb25lbnQud2lubmVyID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIuX2lkID09PSB2bS5jdXJyZW50VXNlclBsYXllci5faWQpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLm9wcG9uZW50Lndpbm5lciA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIud2lubmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1hcmsgdGhlIGNoYWxsZW5nZSBhcyBjb21wbGV0ZSBhbmQgbm90ZSB0aGUgd2lubmVyXG4gICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmNvbXBsZXRlQ2hhbGxlbmdlKGNoYWxsZW5nZS5kYXRhKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICAvLyBJZiB0aGUgY3VycmVudCB1c2VyIGlzIHRoZSB3aW5uZXIgYW5kIHdhcyB0aGUgY2hhbGxlbmdlclxuICAgICAgICAgIC8vIG9yIHRoZSBjdXJyZW50IHVzZXIgaXMgTk9UIHRoZSB3aW5uZXIgYW5kIHdhcyB0aGUgb3Bwb25lbnRcbiAgICAgICAgICAvLyB0aGVuIHN3YXAgcG9zaXRpb25zXG4gICAgICAgICAgaWYgKHN3YXBQb3NpdGlvbnMpIHtcbiAgICAgICAgICAgIHB5cmFtaWRzU2VydmljZS5zd2FwUG9zaXRpb25zKHZtLmNvbXBldGl0aW9uSWQsIGNoYWxsZW5nZS5kYXRhLm9wcG9uZW50LCBjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyKS50aGVuKHJlZnJlc2hQeXJhbWlkKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2hhbGxlbmdlRXhwaXJlZCgpIHtcbiAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlKG51bGwsIHRydWUpO1xuICAgIH1cblxuICAgIC8vIFJlZnJlc2ggdGhlIHB5cmFtaWQgYmVjYXN1ZSBvZiBhbiB1cGRhdGVcbiAgICBmdW5jdGlvbiByZWZyZXNoUHlyYW1pZCgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgb3JkZXJQbGF5ZXJzKCk7XG4gICAgICAgIGdldFBsYXllcnNTdGF0dXMoKTtcbiAgICAgICAgZmlsbEluRW1wdHlCbG9ja3MoKTtcbiAgICAgICAgYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NyZWF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdweXJhbWlkc1NlcnZpY2UnLCBweXJhbWlkc1NlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHB5cmFtaWRzU2VydmljZSgkaHR0cCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0UHlyYW1pZDogZ2V0UHlyYW1pZCxcbiAgICAgIGdldFB5cmFtaWRzRm9yVXNlcjogZ2V0UHlyYW1pZHNGb3JVc2VyLFxuICAgICAgY3JlYXRlUHlyYW1pZDogY3JlYXRlUHlyYW1pZCxcbiAgICAgIHN3YXBQb3NpdGlvbnM6IHN3YXBQb3NpdGlvbnMsXG4gICAgICBhZGRQbGF5ZXJUb1B5cmFtaWQ6IGFkZFBsYXllclRvUHlyYW1pZFxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIC8qKlxuICAgICAqIEdldHMgYSBweXJhbWlkIGZyb20gdGhlIGRhdGFiYXNlIChvciBtZW1vcnkpXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcHlyYW1pZCBpZCBmb3IgdGhlIHJlcXVlc3RlZCBweXJhbWlkXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBweXJhbWlkXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZChweXJhbWlkSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcHlyYW1pZCcsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgcHlyYW1pZElkOiBweXJhbWlkSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhbGwgcHlyYW1pZHMgZnJvbSB0aGUgZGF0YWJhc2UgdGhlIGEgcGFydGljdWxhciB1c2VyIGlzIGluY2x1ZGVkIGluXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3VzZXJJZH0gdGhlIHVzZXIgaWQgZm9yIHRoZSByZXF1ZXN0ZWQgdXNlclxuICAgICAqIEByZXR1cm4ge09iamVjdH0gcHlyYW1pZHNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRQeXJhbWlkc0ZvclVzZXIodXNlcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3B5cmFtaWRzL3VzZXInLCB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHVzZXJJZDogdXNlcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVB5cmFtaWQocHlyYW1pZCkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvY3JlYXRlJywge1xuICAgICAgICBweXJhbWlkOiBweXJhbWlkXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzd2FwUG9zaXRpb25zKHB5cmFtaWRJZCwgY2hhbGxlbmdlciwgb3Bwb25lbnQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL3N3YXBQb3NpdGlvbnMnLCB7XG4gICAgICAgIHB5cmFtaWRJZDogcHlyYW1pZElkLFxuICAgICAgICBjaGFsbGVuZ2VyOiBjaGFsbGVuZ2VyLFxuICAgICAgICBvcHBvbmVudDogb3Bwb25lbnRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFBsYXllclRvUHlyYW1pZChweXJhbWlkSWQsIHBsYXllcikge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvYWRkUGxheWVyJywge1xuICAgICAgICBweXJhbWlkSWQ6IHB5cmFtaWRJZCxcbiAgICAgICAgcGxheWVyOiBwbGF5ZXJcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdBZGRQbGF5ZXJDdHJsJywgQWRkUGxheWVyQ3RybCk7XG5cbiAgZnVuY3Rpb24gQWRkUGxheWVyQ3RybCgkc3RhdGUsICRzdGF0ZVBhcmFtcywgdXNlclNlcnZpY2UsIHB5cmFtaWRzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IFtdO1xuICAgIHZtLmFkZFBsYXllclRvUHlyYW1pZCA9IGFkZFBsYXllclRvUHlyYW1pZDtcbiAgICB2bS5jcmVhdGVQeXJhbWlkID0gY3JlYXRlUHlyYW1pZDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIHVzZXJTZXJ2aWNlLmdldEFsbFVzZXJzKCkudGhlbihmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IHVzZXJzLmRhdGE7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB2YXIgcG9zaXRpb24gPSAwO1xuXG4gICAgZnVuY3Rpb24gYWRkUGxheWVyVG9QeXJhbWlkKHBsYXllcikge1xuICAgICAgLy8gQWRkIHRoZSBzZWxlY3RlZCBwbGF5ZXIgdG8gdGhlIHBsYXllcnMgYXJyYXlcbiAgICAgIHBvc2l0aW9uICs9IDE7XG4gICAgICB2YXIgYWRkUGxheWVyID0ge1xuICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sXG4gICAgICAgIF9pZDogcGxheWVyLl9pZCxcbiAgICAgICAgZmlyc3ROYW1lOiBwbGF5ZXIuZmlyc3ROYW1lLFxuICAgICAgICBsYXN0TmFtZTogcGxheWVyLmxhc3ROYW1lLFxuICAgICAgICBuaWNrbmFtZTogcGxheWVyLm5pY2tuYW1lXG4gICAgICB9O1xuICAgICAgdm0ubmV3UHlyYW1pZC5wbGF5ZXJzLnB1c2goYWRkUGxheWVyKTtcbiAgICAgIC8vIFJlbW92ZSB0aGUgc2VsZWN0ZWQgcGxheWVyIGZyb20gdGhlIGF2YWlsYWJsZSBwbGF5ZXJzXG4gICAgICBfLnJlbW92ZSh2bS5hdmFpbGFibGVQbGF5ZXJzLCB7XG4gICAgICAgIF9pZDogcGxheWVyLl9pZFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlUHlyYW1pZChweXJhbWlkKSB7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuY3JlYXRlUHlyYW1pZChweXJhbWlkKS50aGVuKGZ1bmN0aW9uIChuZXdQeXJhbWlkKSB7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMudmlldycsIHtcbiAgICAgICAgICBweXJhbWlkSWQ6IG5ld1B5cmFtaWQuZGF0YS5faWRcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQ3JlYXRlUHlyYW1pZEN0cmwnLCBDcmVhdGVQeXJhbWlkQ3RybCk7XG5cbiAgZnVuY3Rpb24gQ3JlYXRlUHlyYW1pZEN0cmwoJHN0YXRlLCB1c2VyU2VydmljZSwgcHlyYW1pZHNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5uZXdQeXJhbWlkID0ge1xuICAgICAgcGxheWVyczogW11cbiAgICB9O1xuICAgIHZtLmF2YWlsYWJsZVBsYXllcnMgPSBbXTtcbiAgICB2bS5hZGRlZFBsYXllcnMgPSBbXTtcbiAgICB2bS5jcmVhdGVQeXJhbWlkID0gY3JlYXRlUHlyYW1pZDtcbiAgICB2bS5uZXdQeXJhbWlkLmxldmVscyA9IDQ7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICB1c2VyU2VydmljZS5nZXRBbGxVc2VycygpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIHZtLmF2YWlsYWJsZVBsYXllcnMgPSB1c2Vycy5kYXRhO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmFyIHBvc2l0aW9uID0gMDtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVB5cmFtaWQocHlyYW1pZCkge1xuICAgICAgYW5ndWxhci5mb3JFYWNoKHZtLmFkZGVkUGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICBwb3NpdGlvbiArPSAxO1xuICAgICAgICB2YXIgYWRkUGxheWVyID0ge1xuICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbixcbiAgICAgICAgICBfaWQ6IHBsYXllci5faWQsXG4gICAgICAgICAgZmlyc3ROYW1lOiBwbGF5ZXIuZmlyc3ROYW1lLFxuICAgICAgICAgIGxhc3ROYW1lOiBwbGF5ZXIubGFzdE5hbWUsXG4gICAgICAgICAgbmlja25hbWU6IHBsYXllci5uaWNrbmFtZVxuICAgICAgICB9O1xuICAgICAgICB2bS5uZXdQeXJhbWlkLnBsYXllcnMucHVzaChhZGRQbGF5ZXIpO1xuICAgICAgfSk7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuY3JlYXRlUHlyYW1pZChweXJhbWlkKS50aGVuKGZ1bmN0aW9uIChuZXdQeXJhbWlkKSB7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMudmlldycsIHtcbiAgICAgICAgICBweXJhbWlkSWQ6IG5ld1B5cmFtaWQuZGF0YS5faWRcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTXlQeXJhbWlkc0N0cmwnLCBNeVB5cmFtaWRzQ3RybCk7XG5cbiAgZnVuY3Rpb24gTXlQeXJhbWlkc0N0cmwoJHN0YXRlLCBweXJhbWlkc1NlcnZpY2UsIGlkZW50aXR5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucHlyYW1pZHMgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWRzRm9yVXNlcihpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkcykge1xuICAgICAgICB2bS5weXJhbWlkcyA9IHB5cmFtaWRzLmRhdGE7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUHlyYW1pZEN0cmwnLCBQeXJhbWlkQ3RybCk7XG5cbiAgZnVuY3Rpb24gUHlyYW1pZEN0cmwoJHN0YXRlUGFyYW1zKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5weXJhbWlkSWQgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5weXJhbWlkSWQpIHtcbiAgICAgICAgdm0ucHlyYW1pZElkID0gJHN0YXRlUGFyYW1zLnB5cmFtaWRJZDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUHlyYW1pZHNDdHJsJywgUHlyYW1pZHNDdHJsKTtcblxuICBmdW5jdGlvbiBQeXJhbWlkc0N0cmwoKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5weXJhbWlkcyA9IG51bGw7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twQ2hhbGxlbmVnZXMnLCBrcENoYWxsZW5lZ2VzKTtcblxuICBmdW5jdGlvbiBrcENoYWxsZW5lZ2VzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogJ0AnXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY29tbW9uL2NvbXBvbmVudHMvY2hhbGxlbmdlcy5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUsIGNoYWxsZW5nZXNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jaGFsbGVuZ2VzID0gW107XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlcygpIHtcbiAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZXMpIHtcbiAgICAgICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuICAgICAgICBpZiAoY2hhbGxlbmdlcy5kYXRhLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB2bS5jaGFsbGVuZ2VzID0gY2hhbGxlbmdlcy5kYXRhO1xuICAgICAgICAgIF8uZm9yRWFjaCh2bS5jaGFsbGVuZ2VzLCBmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZXhwaXJlcyA9IChtb21lbnQoKS5kaWZmKG1vbWVudChjaGFsbGVuZ2UuY3JlYXRlZCkuYWRkKGNoYWxsZW5nZS50aW1lTGltaXQsICdoJyksJ3MnKSkgKiAtMTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jcmVhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlcygpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jb21wbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twRm9vdGVyJywga3BGb290ZXIpO1xuXG4gIGZ1bmN0aW9uIGtwRm9vdGVyKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY29tbW9uL2NvbXBvbmVudHMvZm9vdGVyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmluZGVudGl0eSA9IGlkZW50aXR5U2VydmljZTtcbiAgICB2bS5sb2dvdXQgPSBsb2dvdXQ7XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twSGVhZGVyJywga3BIZWFkZXIpO1xuXG4gIGZ1bmN0aW9uIGtwSGVhZGVyKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICdoZWFkZXJDdHJsJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9oZWFkZXIuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoc2lkZWJhclNlcnZpY2UsIGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmluZGVudGl0eSA9IGlkZW50aXR5U2VydmljZTtcbiAgICB2bS5sb2dvdXQgPSBsb2dvdXQ7XG4gICAgdm0uc2lkZWJhclN0YXR1cyA9IHNpZGViYXJTZXJ2aWNlLmdldFNpZGViYXJTdGF0dXMoKTtcbiAgICB2bS50b2dnbGVTaWRlYmFyID0gdG9nZ2xlU2lkZWJhcjtcblxuICAgIGZ1bmN0aW9uIHRvZ2dsZVNpZGViYXIoKSB7XG4gICAgICB2bS5zaWRlYmFyU3RhdHVzLmxlZnQgPSAhdm0uc2lkZWJhclN0YXR1cy5sZWZ0O1xuICAgICAgc2lkZWJhclNlcnZpY2Uuc2V0U2lkZWJhclN0YXR1cyh2bS5zaWRlYmFyU3RhdHVzLmxlZnQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BTaWRlYmFyJywga3BTaWRlYmFyKTtcblxuICBmdW5jdGlvbiBrcFNpZGViYXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3NpZGViYXJDdHJsJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9zaWRlYmFyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UsIHNpZGViYXJTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pbmRlbnRpdHkgPSBpZGVudGl0eVNlcnZpY2U7XG4gICAgdm0ubG9nb3V0ID0gbG9nb3V0O1xuICAgIHZtLnNpZGViYXJTdGF0dXMgPSBzaWRlYmFyU2VydmljZS5nZXRTaWRlYmFyU3RhdHVzKCk7XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnY2hhbGxlbmdlc1NlcnZpY2UnLCBjaGFsbGVuZ2VzU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gY2hhbGxlbmdlc1NlcnZpY2UoJGh0dHApIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGNyZWF0ZUNoYWxsZW5nZTogY3JlYXRlQ2hhbGxlbmdlLFxuICAgICAgY29tcGxldGVDaGFsbGVuZ2U6IGNvbXBsZXRlQ2hhbGxlbmdlLFxuICAgICAgZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyOiBnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXJcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jaGFsbGVuZ2VzL2NyZWF0ZScsIHtcbiAgICAgICAgY2hhbGxlbmdlOiBjaGFsbGVuZ2VcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvbXBsZXRlQ2hhbGxlbmdlKGNoYWxsZW5nZSkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvY2hhbGxlbmdlcy9jb21wbGV0ZScsICB7XG4gICAgICAgIGNoYWxsZW5nZTogY2hhbGxlbmdlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvY29tcGV0aXRpb24nLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9hY3RpdmUvY29tcGV0aXRpb24nLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcihjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2FjdGl2ZS9jb21wZXRpdGlvbi9wbGF5ZXInLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICAgIHBsYXllcklkOiBwbGF5ZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnaWRlbnRpdHlTZXJ2aWNlJywgaWRlbnRpdHlTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBpZGVudGl0eVNlcnZpY2UoJHdpbmRvdykge1xuICAgIHZhciBjdXJyZW50VXNlcjtcbiAgICBpZiAoJHdpbmRvdy5ib290c3RyYXBwZWRVc2VyT2JqZWN0ICE9PSBudWxsKSB7XG4gICAgICBjdXJyZW50VXNlciA9ICR3aW5kb3cuYm9vdHN0cmFwcGVkVXNlck9iamVjdDtcbiAgICB9XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBjdXJyZW50VXNlcjogY3VycmVudFVzZXIsXG4gICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGlzQXV0aGVudGljYXRlZCxcbiAgICAgIGlzQXV0aG9yaXplZDogaXNBdXRob3JpemVkXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZCgpIHtcbiAgICAgIHJldHVybiAhIXRoaXMuY3VycmVudFVzZXI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNBdXRob3JpemVkKHJvbGUpIHtcbiAgICAgIHJldHVybiAhIXRoaXMuY3VycmVudFVzZXIgJiYgdGhpcy5jdXJyZW50VXNlci5yb2xlcy5pbmRleE9mKHJvbGUpID4gLTE7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmZhY3RvcnkoJ25vdGlmeVNlcnZpY2UnLCBub3RpZnlTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBub3RpZnlTZXJ2aWNlKCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgaW5mbzogaW5mbyxcbiAgICAgIHN1Y2Nlc3M6IHN1Y2Nlc3MsXG4gICAgICB3YXJuaW5nOiB3YXJuaW5nLFxuICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgaW52ZXJzZTogaW52ZXJzZVxuICAgIH07XG5cbiAgICAkLm5vdGlmeURlZmF1bHRzKHtcbiAgICAgIG9mZnNldDoge1xuICAgICAgICB4OiAyMCxcbiAgICAgICAgeTogODVcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gaW5mbyhtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIGljb246ICd6bWRpIHptZGktYWxlcnQtY2lyY2xlLW8nLFxuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ2luZm8nXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgaWNvbjogJ3ptZGkgem1kaS1jaGVjaycsXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnc3VjY2VzcydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBpY29uOiAnem1kaSB6bWRpLWFsZXJ0LXRyaWFuZ2xlJyxcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICd3YXJuaW5nJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXJyb3IobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBpY29uOiAnem1kaSB6bWRpLWFsZXJ0LW9jdGFnb24nLFxuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ2RhbmdlcidcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGludmVyc2UobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ2ludmVyc2UnXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnc2lkZWJhclNlcnZpY2UnLCBzaWRlYmFyU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gc2lkZWJhclNlcnZpY2UoKSB7XG4gICAgdmFyIHNpZGViYXJTdGF0dXMgPSB7XG4gICAgICBsZWZ0OiBmYWxzZSxcbiAgICAgIHJpZ2h0OiBmYWxzZVxuICAgIH07XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBnZXRTaWRlYmFyU3RhdHVzOiBnZXRTaWRlYmFyU3RhdHVzLFxuICAgICAgc2V0U2lkZWJhclN0YXR1czogc2V0U2lkZWJhclN0YXR1c1xuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGdldFNpZGViYXJTdGF0dXMoKSB7XG4gICAgICByZXR1cm4gc2lkZWJhclN0YXR1cztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRTaWRlYmFyU3RhdHVzKHN0YXR1cykge1xuICAgICAgc2lkZWJhclN0YXR1cy5sZWZ0ID0gc3RhdHVzO1xuICAgIH1cbiAgfVxufSkoKTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgLnNlcnZpY2UoJ3dlYnNvY2tldFNlcnZpY2UnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHdpbmRvdykge1xuICAgIGZ1bmN0aW9uIHdlYnNvY2tldEhvc3QoKSB7XG4gICAgICBpZiAoJHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHBzOicpIHtcbiAgICAgICAgcmV0dXJuICd3c3M6Ly8nICsgJHdpbmRvdy5sb2NhdGlvbi5ob3N0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICd3czovLycgKyAkd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGNvbm5lY3Rpb247XG4gICAgdGhpcy5jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgY29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQod2Vic29ja2V0SG9zdCgpKTtcblxuICAgICAgY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgcGF5bG9hZCA9IEpTT04ucGFyc2UoZS5kYXRhKTtcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd3czonICsgcGF5bG9hZC50b3BpYywgcGF5bG9hZC5kYXRhKTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIHRoaXMuc2VuZCA9IGZ1bmN0aW9uICh0b3BpYywgZGF0YSkge1xuICAgICAgdmFyIGpzb24gPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIHRvcGljOiB0b3BpYyxcbiAgICAgICAgZGF0YTogZGF0YVxuICAgICAgfSk7XG4gICAgICBjb25uZWN0aW9uLnNlbmQoanNvbik7XG4gICAgfTtcbiAgfSkucnVuKGZ1bmN0aW9uICh3ZWJzb2NrZXRTZXJ2aWNlKSB7XG4gICAgd2Vic29ja2V0U2VydmljZS5jb25uZWN0KCk7XG4gIH0pOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0hvbWVDdHJsJywgSG9tZUN0cmwpO1xuXG4gIGZ1bmN0aW9uIEhvbWVDdHJsKCkge1xuICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ2F1dGhTZXJ2aWNlJywgYXV0aFNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIGF1dGhTZXJ2aWNlKCRzdGF0ZSwgJGh0dHAsICRxLCB1c2VyU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBhdXRoZW50aWNhdGVVc2VyOiBhdXRoZW50aWNhdGVVc2VyLFxuICAgICAgY3JlYXRlVXNlcjogY3JlYXRlVXNlcixcbiAgICAgIGxvZ291dDogbG9nb3V0LFxuICAgICAgYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZTogYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSxcbiAgICAgIGF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGU6IGF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGVcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gYXV0aGVudGljYXRlVXNlcih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xuICAgICAgJGh0dHAucG9zdCgnL2xvZ2luJywge1xuICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3VjY2Vzcykge1xuICAgICAgICAgIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlciA9IHJlc3BvbnNlLmRhdGEudXNlcjtcbiAgICAgICAgICBkZmQucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkZmQucmVzb2x2ZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVVzZXIodXNlckRhdGEpIHtcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xuICAgICAgJGh0dHAucG9zdCgnL2FwaS91c2VycycsIHtcbiAgICAgICAgdXNlckRhdGE6IHVzZXJEYXRhXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAgIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlciA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgZGZkLnJlc29sdmUodHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9sb2dvdXQnLCB7XG4gICAgICAgIGxvZ291dDogdHJ1ZVxuICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgZGZkLnJlc29sdmUoKTtcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlKHJvbGUpIHtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRob3JpemVkKHJvbGUpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICRxLnJlamVjdCgnbm90IGF1dGhvcml6ZWQnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlKCkge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoJ25vdCBhdXRob3JpemVkJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ3VzZXJTZXJ2aWNlJywgdXNlclNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHVzZXJTZXJ2aWNlKCRodHRwLCBpZGVudGl0eVNlcnZpY2UpIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGdldEFsbFVzZXJzOiBnZXRBbGxVc2Vyc1xuICAgIH07XG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBnZXRBbGxVc2VycygpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKS50aGVuKGZ1bmN0aW9uICh1c2Vycykge1xuICAgICAgICByZXR1cm4gdXNlcnM7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTG9naW5DdHJsJywgTG9naW5DdHJsKTtcblxuICBmdW5jdGlvbiBMb2dpbkN0cmwoJHN0YXRlLCBhdXRoU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubG9naW4gPSBsb2dpbjtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmF1dGhlbnRpY2F0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAoIXJlc3BvbnNlKSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignVXNlcm5hbWUgLyBwYXNzd29yZCBjb21iaW5haXRvbiBpbmNvcnJlY3QnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLnN1Y2Nlc3MoJ0xvZ2luIHN1Y2Nlc3NmdWwuICBXZWxjb21lIHRvIEtuaWZlcGxhbmUhJyk7XG4gICAgICAgICAgaWYgKCRzdGF0ZS5wcmV2aW91cykge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCRzdGF0ZS5wcmV2aW91cyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIFJlZ2lzdGVyQ3RybCk7XG5cbiAgZnVuY3Rpb24gUmVnaXN0ZXJDdHJsKCRzY29wZSwgJHN0YXRlLCBhdXRoU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucmVnaXN0ZXIgPSByZWdpc3RlcjtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHt9XG5cbiAgICBmdW5jdGlvbiByZWdpc3RlcihuZXdVc2VyKSB7XG4gICAgICBhdXRoU2VydmljZS5jcmVhdGVVc2VyKG5ld1VzZXIpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgndG9nZ2xlU3VibWVudScsIHRvZ2dsZVN1Ym1lbnUpO1xuXG4gIGZ1bmN0aW9uIHRvZ2dsZVN1Ym1lbnUoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbCkge1xuICAgICAgZWwuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBlbC5uZXh0KCkuc2xpZGVUb2dnbGUoMjAwKTtcbiAgICAgICAgZWwucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ3RvZ2dsZWQnKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ3dhdmVzRWZmZWN0Jywgd2F2ZXNFZmZlY3QpO1xuXG4gIGZ1bmN0aW9uIHdhdmVzRWZmZWN0KCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0MnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCkge1xuICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ2J0bi1pY29uJykgfHwgZWxlbWVudC5oYXNDbGFzcygnYnRuLWZsb2F0JykpIHtcbiAgICAgICAgV2F2ZXMuYXR0YWNoKGVsZW1lbnQsIFsnd2F2ZXMtY2lyY2xlJ10pO1xuICAgICAgfSBlbHNlIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdidG4tbGlnaHQnKSkge1xuICAgICAgICBXYXZlcy5hdHRhY2goZWxlbWVudCwgWyd3YXZlcy1saWdodCddKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFdhdmVzLmF0dGFjaChlbGVtZW50KTtcbiAgICAgIH1cblxuICAgICAgV2F2ZXMuaW5pdCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2ZnTGluZScsIGZnTGluZSk7XG5cbiAgZnVuY3Rpb24gZmdMaW5lKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0MnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCkge1xuICAgICAgdmFyIGlucHV0ID0gZWxlbWVudC5jaGlsZHJlbigpLmZpcnN0KCk7XG4gICAgICB2YXIgaXNGbG9hdExhYmVsID0gZWxlbWVudC5wYXJlbnQoKS5oYXNDbGFzcygnZmctZmxvYXQnKTtcbiAgICAgIGlucHV0LmZvY3VzKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnZmctdG9nZ2xlZCcpO1xuICAgICAgfSk7XG5cbiAgICAgIGlucHV0LmJsdXIoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIWlzRmxvYXRMYWJlbCB8fCAoaXNGbG9hdExhYmVsICYmIGlucHV0LnZhbCgpLmxlbmd0aCA9PT0gMCkpIHtcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdmZy10b2dnbGVkJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
