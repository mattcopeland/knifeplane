angular.module("app",["ui.router","ui.bootstrap","ngAnimate","angular-loading-bar","nouislider","localytics.directives","timer","LocalStorageModule","angular-sortable-view"]),function(){"use strict ";function e(e,t){e.defaults.headers.get||(e.defaults.headers.get={}),e.defaults.headers.get["If-Modified-Since"]="Fri, 01 Jan 2016 05:00:00 GMT",e.defaults.headers.get["Cache-Control"]="no-cache",e.defaults.headers.get.Pragma="no-cache",t.options({appendToBody:!0})}e.$inject=["$httpProvider","$uibTooltipProvider"],angular.module("app").config(e)}(),function(){"use strict";function e(e,t){function n(e){t.set("sidebarLocked",e)}var r=this;r.$state=e,r.lockSidebar=t.get("sidebarLocked"),r.toggleSidebarLocked=n}e.$inject=["$state","localStorageService"],angular.module("app").controller("AppCtrl",e)}(),function(){"use strict";function e(e,i,o){var a={superAdmin:n,admin:t,user:r};o.html5Mode(!0),i.otherwise("/"),i.when("/pyramids/","/pyramids"),e.state("home",{url:"/",views:{content:{controller:"HomeCtrl",controllerAs:"vm",templateUrl:"common/views/home.html"}}}).state("pyramids",{url:"/pyramids",views:{content:{controller:"PyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramids.html"}}}).state("pyramids.myPyramids",{url:"/my-pyramids",views:{"content@":{controller:"MyPyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/my-pyramids.html"}},resolve:{auth:a.user}}).state("pyramids.view",{url:"/view/:competitionId",views:{"content@":{controller:"PyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramid.html"}}}).state("pyramids.stats",{url:"/stats/:competitionId",views:{"content@":{controller:"StatsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/stats.html"}}}).state("pyramids.admin",{url:"/admin/:competitionId",views:{"content@":{controller:"AdminCtrl",controllerAs:"vm",templateUrl:"pyramids/views/admin.html"}},resolve:{auth:a.user}}).state("pyramids.create",{url:"/create",views:{"content@":{controller:"CreatePyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/create-pyramid.html"}},resolve:{auth:a.user}}).state("user",{url:"/user",views:{content:{controller:"UserCtrl",controllerAs:"vm",templateUrl:"users/views/user.html"}},resolve:{auth:a.user}}).state("login",{url:"/login",views:{content:{controller:"LoginCtrl",controllerAs:"vm",templateUrl:"authentication/views/login.html"}}}).state("register",{url:"/register",views:{content:{controller:"RegisterCtrl",controllerAs:"vm",templateUrl:"authentication/views/register.html"}}}).state("verify",{url:"/verification",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}}).state("verification",{url:"/verification/:userId/:verificationToken",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}}).state("password-reset-request",{url:"/password-reset",views:{content:{controller:"PasswordResetCtrl",controllerAs:"vm",templateUrl:"authentication/views/password-reset.html"}}}).state("password-reset",{url:"/password-reset/:userId/:verificationToken",views:{content:{controller:"PasswordResetCtrl",controllerAs:"vm",templateUrl:"authentication/views/password-reset.html"}}})}function t(e){return e.authorizeCurrentUserForRoute("admin")}function n(e){return e.authorizeCurrentUserForRoute("super-admin")}function r(e){return e.authenticatedUserForRoute()}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app").config(e),t.$inject=["authService"],n.$inject=["authService"],r.$inject=["authService"]}(),function(){"use strict";function e(e,t,n){e.$on("$stateChangeError",function(e,n,r,i,o,a){"not authorized"===a&&(t.go("login"),t.previous=n,t.prevParams=r)}),e.$on("$stateChangeStart",function(){n.setSidebarStatus(!1)})}e.$inject=["$rootScope","$state","sidebarService"],angular.module("app").run(e)}(),function(){"use strict";function e(e,t,n,r,i,o){function a(e,r){var o=n.defer();return t.post("/login",{username:e,password:r}).then(function(e){e.data.success?(i.currentUser=e.data.user,o.resolve(!0)):"unverified"===e.data.message?o.resolve("unverified"):o.resolve(!1)}),o.promise}function s(e){var r=n.defer();return t.post("/api/users",{userData:e}).then(function(e){e.data?r.resolve(!0):r.resolve(!1)},function(e){"Error: Duplicate Username"===e.data.reason&&o.error("Sorry, an account already exists with that email address.")}),r.promise}function l(){var r=n.defer();return t.post("/logout",{logout:!0}).then(function(){i.currentUser=void 0,r.resolve(),e.go("home")}),r.promise}function c(e){return!!i.isAuthorized(e)||n.reject("not authorized")}function d(){return!!i.isAuthenticated()||n.reject("not authorized")}var u={authenticateUser:a,createUser:s,logout:l,authorizeCurrentUserForRoute:c,authenticatedUserForRoute:d};return u}e.$inject=["$state","$http","$q","userService","identityService","notifyService"],angular.module("app").factory("authService",e)}(),function(){"use strict";function e(e){function t(){return e.get("/api/users").then(function(e){return e})}function n(t,n){return e.get("/api/user/verification",{params:{userId:t,verificationToken:n}})}function r(t){return e.get("/api/user/password/link",{params:{username:t}})}function i(t,n,r){return e.put("/api/user/password/reset",{userId:t,verificationToken:n,password:r})}var o={getAllUsers:t,verifyUser:n,generatePasswordResetLink:r,resetPassword:i};return o}e.$inject=["$http"],angular.module("app").factory("userService",e)}(),function(){"use strict";function e(e,t,n){function r(){}function i(r,i){t.authenticateUser(r,i).then(function(t){t?"unverified"===t?n.error("You must verify your email before you can login"):e.previous?(e.go(e.previous,e.prevParams),e.previous=null,e.prevParams=null):e.go("home"):n.error("Username / password combinaiton incorrect")})}var o=this;o.login=i,r()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("LoginCtrl",e)}(),function(){"use strict";function e(e,t,n,r,i,o){function a(){o.isAuthenticated()?e.go("home"):t.userId&&t.verificationToken&&n.verifyUser(t.userId,t.verificationToken).then(function(e){e.data&&(c.verified=!0)})}function s(t){n.generatePasswordResetLink(t).then(function(t){t.data?(r.success("Please check your email for a password reset link"),e.go("home")):r.error("Could not find that email address")})}function l(o){o.password!==o.confirmPassword?r.error("Passwords don't match!"):n.resetPassword(t.userId,t.verificationToken,o.password).then(function(t){t.data&&i.authenticateUser(t.data.username,o.password).then(function(t){e.go("home")})})}var c=this;c.username="",c.verified=!1,c.resetPasswordForm={},c.generatePasswordResetLink=s,c.resetPassword=l,a()}e.$inject=["$state","$stateParams","userService","notifyService","authService","identityService"],angular.module("app").controller("PasswordResetCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){}function i(r){r.password!==r.confirmPassword?n.error("Passwords don't match!"):t.createUser(r).then(function(){e.go("verify")})}var o=this;o.register=i,r()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("RegisterCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){t.userId&&t.verificationToken&&(i.verifying=!0,i.verified=null,n.verifyUser(t.userId,t.verificationToken).then(function(e){e.data?i.verified=!0:i.verified=!1}))}var i=this;i.verified=void 0,i.verifying=!1,r()}e.$inject=["$state","$stateParams","userService"],angular.module("app").controller("VerificationCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@"},templateUrl:"/challenges/components/active-challenges.html"};return e}function t(e,t){function n(){r()}function r(){i.challenges=[],t.getActiveChallengesByCompetition(i.competitionId).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){0!==e.timeLimit&&(e.expires=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1)}))})}var i=this;i.challenges=[],n(),e.$on("ws:challenge_created",function(e,t){i.competitionId===t.competitionId&&r()}),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&r()}),e.$on("ws:pyramid_updated",function(e,t){i.competitionId===t.competitionId&&r()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpActiveChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@",allowDelete:"=",limit:"@"},templateUrl:"/challenges/components/completed-challenges.html"};return e}function t(e,t,n,r){function i(){o()}function o(){s.challenges=[],n.getCompletedChallengesByCompetition(s.competitionId,s.limit).then(function(e){e.data.length>0&&(s.challenges=e.data,_.forEach(s.challenges,function(e){e.loser="challenger"===e.winner?"opponent":"challenger",e.whenCompleted=moment(e.completed).calendar(null,{sameDay:"[Today]",nextDay:"[Tomorrow]",nextWeek:"dddd",lastDay:"[Yesterday]",lastWeek:"[Last] dddd",sameElse:"DD/MM/YYYY"})}))})}function a(e,t){n.deleteChallenge(s.competitionId,e).then(function(){s.challenges.splice(t,1)})}var s=this;s.challenges=[],s.deleteChallenge=a,i(),e.$on("ws:challenge_completed",function(e,t){s.competitionId===t.competitionId&&o()}),e.$on("ws:challenge_deleted",function(e,t){s.competitionId===t.competitionId&&(o(),r.info("Challenges Updated"))})}t.$inject=["$scope","$state","challengesService","notifyService"],angular.module("app").directive("kpCompletedChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@",player:"="},templateUrl:"/challenges/components/player-overall-results.html"};return e}function t(e){function t(){n(r.competitionId,r.player._id)}function n(t,n){e.getPlayerResultsByCompetition(t,n).then(function(e){for(var t=[],i=0;i<r.maxLevels;i++)t.push(i*(i+1)/2+1);r.player.level=t.length;for(var o=0;o<t.length;o++)if(r.player.position<t[o+1]){r.player.level=t.indexOf(t[o])+1;break}var a,s=0,l=!0;_.forEach(e.data,function(e){l&&("challenger"===e.winner&&e.challenger._id===n||"opponent"===e.winner&&e.opponent._id===n?"losing"!==a?(s+=1,a="winning"):l=!1:("opponent"===e.winner&&e.challenger._id===n||"challenger"===e.winner&&e.opponent._id===n)&&("winning"!==a?(s+=1,a="losing"):l=!1)),r.streak={type:a,value:s}}),r.wins.asOpponent=_.size(_.filter(e.data,function(e){return e.opponent._id===n&&"opponent"===e.winner})),r.wins.asChallenger=_.size(_.filter(e.data,function(e){return e.challenger._id===n&&"challenger"===e.winner})),r.wins.total=r.wins.asChallenger+r.wins.asOpponent,r.wins.byForfeit=_.size(_.filter(e.data,function(e){return e.forfeit&&(e.challenger._id===n&&"challenger"===e.winner||e.opponent._id===n&&"opponent"===e.winner)})),r.loses.asOpponent=_.size(_.filter(e.data,function(e){return e.opponent._id===n&&"challenger"===e.winner})),r.loses.asChallenger=_.size(_.filter(e.data,function(e){return e.challenger._id===n&&"opponent"===e.winner})),r.loses.total=r.loses.asChallenger+r.loses.asOpponent,r.loses.byForfeit=_.size(_.filter(e.data,function(e){return e.forfeit&&(e.challenger._id===n&&"opponent"===e.winner||e.opponent._id===n&&"challenger"===e.winner)}))})}var r=this;r.maxLevels=10,r.wins={total:0,asChallenger:0,asOpponent:0,byForfeit:0},r.loses={total:0,asChallenger:0,asOpponent:0,byForfeit:0},r.streak={type:null,value:0},t()}t.$inject=["challengesService"],angular.module("app").directive("kpPlayerOverallResults",e)}(),function(){"use strict";function e(e){function t(t){return e.post("/api/challenges/create",{challenge:t})}function n(t){return e.post("/api/challenges/complete",{challenge:t})}function r(t){return e.get("/api/challenges/competition",{params:{competitionId:t}})}function i(t){return e.get("/api/challenges/active/competition",{params:{competitionId:t}})}function o(t,n){return e.get("/api/challenges/active/competition/player",{params:{competitionId:t,playerId:n}})}function a(t,n){return e.get("/api/challenges/completed/competition",{params:{competitionId:t,limit:n}})}function s(t,n){return e.delete("/api/challenges/active/competition/player/delete",{params:{competitionId:t,playerId:n}})}function l(t,n){return e.delete("/api/challenges/delete",{params:{competitionId:t,challengeId:n}})}function c(t,n){return e.get("/api/challenges/results/competition/player",{params:{competitionId:t,playerId:n}})}var d={createChallenge:t,completeChallenge:n,getChallengesByCompetition:r,getActiveChallengesByCompetition:i,getActiveChallengeByCompetitionByPlayer:o,getCompletedChallengesByCompetition:a,deleteActiveChallengeByCompetitionByPlayer:s,deleteChallenge:l,getPlayerResultsByCompetition:c};return d}e.$inject=["$http"],angular.module("app").factory("challengesService",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",templateUrl:"/common/components/footer.html"};return e}function t(e,t){function n(){t.logout()}var r=this;r.indentity=e,r.logout=n}t.$inject=["identityService","authService"],angular.module("app").directive("kpFooter",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"headerCtrl",restrict:"A",templateUrl:"/common/components/header.html"};return e}function t(e,t,n){function r(){o.sidebarStatus.left=!o.sidebarStatus.left,e.setSidebarStatus(o.sidebarStatus.left)}function i(){n.logout()}var o=this;o.indentity=t,o.logout=i,o.sidebarStatus=e.getSidebarStatus(),o.toggleSidebar=r}t.$inject=["sidebarService","identityService","authService"],angular.module("app").directive("kpHeader",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"sidebarCtrl",restrict:"A",templateUrl:"/common/components/sidebar.html"};return e}function t(e,t,n){function r(){t.logout()}var i=this;i.indentity=e,i.logout=r,i.sidebarStatus=n.getSidebarStatus()}t.$inject=["identityService","authService","sidebarService"],angular.module("app").directive("kpSidebar",e)}(),function(){"use strict";function e(){return function(e,t){if(!angular.isObject(e))return e;var n=[];for(var r in e)n.push(e[r]);return n.sort(function(e,n){return e=parseInt(e[t]),n=parseInt(n[t]),e-n}),n}}angular.module("app").filter("orderObjectBy",e)}(),function(){"use strict";function e(e){function t(){return!!this.currentUser}function n(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}var r;null!==e.bootstrappedUserObject&&(r=e.bootstrappedUserObject);var i={currentUser:r,isAuthenticated:t,isAuthorized:n};return i}e.$inject=["$window"],angular.module("app").factory("identityService",e)}(),function(){"use strict";function e(){function e(e,t,n){$.notify({message:e,url:t,target:n},{type:"info"})}function t(e,t,n){$.notify({message:e,url:t,target:n},{type:"success"})}function n(e,t,n){$.notify({message:e,url:t,target:n},{type:"warning"})}function r(e,t,n){$.notify({message:e,url:t,target:n},{type:"danger"})}function i(e,t,n){$.notify({message:e,url:t,target:n},{type:"inverse"})}var o={info:e,success:t,warning:n,error:r,inverse:i};return $.notifyDefaults({newest_on_top:!0,offset:{x:20,y:85}}),o}angular.module("app").factory("notifyService",e)}(),function(){"use strict";function e(){function e(e,t,n,r){$(e).mCustomScrollbar({theme:t,scrollInertia:100,axis:n,mouseWheel:{enable:!0,axis:r,preventDefault:!0}})}var t={malihuScroll:e};return t}angular.module("app").factory("scrollbarService",e)}(),function(){"use strict";function e(){function e(){return n}function t(e){n.left=e}var n={left:!1,right:!1},r={getSidebarStatus:e,setSidebarStatus:t};return r}angular.module("app").factory("sidebarService",e)}(),angular.module("app").service("websocketService",["$rootScope","$window",function(e,t){function n(){return"https:"===t.location.protocol?"wss://"+t.location.host:"ws://"+t.location.host}var r;this.connect=function(){r=new WebSocket(n()),r.onmessage=function(t){var n=JSON.parse(t.data);e.$broadcast("ws:"+n.topic,n.data)}},this.send=function(e,t){var n=JSON.stringify({topic:e,data:t});r.send(n)}}]).run(["websocketService",function(e){e.connect()}]),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("HomeCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{pyramid:"="},templateUrl:"/pyramids/components/pending-players.html"};return e}function t(e){function t(){}function n(t){t.position=i.pyramid.players.length+1,e.approvePendingPlayer(i.pyramid._id,t)}function r(t){e.denyPendingPlayer(i.pyramid._id,t)}var i=this;i.pendingPlayers=[],i.approvePendingPlayer=n,i.denyPendingPlayer=r,t()}t.$inject=["pyramidsService"],angular.module("app").directive("kpPendingPlayers",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{type:"@"},templateUrl:"/pyramids/components/pyramid-compact.html"};return e}function t(e,t){function n(){"user"===r.type?e.getPyramidsForUser(t.currentUser._id).then(function(e){r.pyramids=e.data}):e.getPyramids().then(function(e){r.pyramids=e.data})}var r=this;r.pyramids=null,n()}t.$inject=["pyramidsService","identityService"],angular.module("app").directive("kpPyramidCompact",e)}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"/pyramids/components/pyramid.html",replace:!0,scope:{competitionId:"@"},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,n,r,i,o,a){function s(){n.getPyramid($.competitionId).then(function(e){for(var t=I;t>0;--t)$.maxPlayers+=t;e.data&&($.pyramid=e.data,l(),c(),u(),p(),m())})}function l(){$.pyramid.players=r("orderBy")($.pyramid.players,"position")}function c(){$.currentUserIsOwner=!1,$.currentUserIsPending=!1,o.isAuthenticated()&&($.currentUserIsOwner=_.some($.pyramid.owners,["_id",o.currentUser._id]),$.currentUserIsPending=_.some($.pyramid.pendingPlayers,["_id",o.currentUser._id])),$.currentUserIsOnPyramid=!1,$.hasActiveChallenge=!1,_.forEach($.pyramid.players,function(e){o.isAuthenticated()&&e._id===o.currentUser._id&&($.currentUserIsOnPyramid=!0,e.class="current-user",$.currentUserPlayer=e,a.getActiveChallengeByCompetitionByPlayer($.competitionId,e._id).then(function(t){t.data&&($.hasActiveChallenge=!0,$.activeChallengeOpponent=t.data.challenger._id===e._id?t.data.opponent:t.data.challenger)}))}),a.getActiveChallengesByCompetition($.competitionId).then(function(e){_.forEach(e.data,function(e){var t=_.find($.pyramid.players,{_id:e.challenger._id});t.class="unavailable",t.challenge={position:"challenger"};var n=_.find($.pyramid.players,{_id:e.opponent._id});if(n.class="unavailable",n.challenge={position:"opponent"},0!==e.timeLimit){var r=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1;r>0?n.challenge.expires=r:r<=0&&h(null,!0,n)}}),f()})}function d(){$.breakPoints=[];for(var e=0;e<I;e++)$.breakPoints.push(e*(e+1)/2+1)}function u(){var e=0;$.levels=[],d();for(var t=0;t<$.pyramid.players.length;t++)$.breakPoints.indexOf(t+1)>-1&&(e+=1,$.levels.push(e)),$.pyramid.players[t].level=e}function p(){$.numberOfBlocks=0;for(var e=_.last($.levels);e>0;e--)$.numberOfBlocks+=e}function m(){$.numberOfRealPlayers=$.pyramid.players.length;for(var e=$.pyramid.players.length;e<$.numberOfBlocks;e++)$.pyramid.players.push({firstName:"Empty",lastName:"Spot",position:99,class:"empty"});u()}function f(){var e=$.currentUserPlayer.level>1?$.currentUserPlayer.level-1:null;_.forEach($.pyramid.players,function(t){t.level===e&&99!==t.position&&"unavailable"!==t.class&&($.availableChallenges=!0,t.available=!0)})}function y(e){if(e.available){$.hasActiveChallenge=!0;var t={competitionName:$.pyramid.name,competitionId:$.competitionId,complete:!1,forfeit:!1,timeLimit:$.pyramid.forfeitDays,challenger:{_id:$.currentUserPlayer._id,email:$.currentUserPlayer.email,firstName:$.currentUserPlayer.firstName,lastName:$.currentUserPlayer.lastName,position:$.currentUserPlayer.position},opponent:{_id:e._id,email:e.email,firstName:e.firstName,lastName:e.lastName,position:e.position}};a.createChallenge(t).then(function(){$.pyramidMenuToggle=!1})}else i.error("Sorry, that is not a valid challenge.")}function h(e,t,r){var i=r||$.currentUserPlayer;a.getActiveChallengeByCompetitionByPlayer($.competitionId,i._id).then(function(i){$.hasActiveChallenge=!1;var o=!1;t?(i.data.forfeit=!0,"opponent"===r.challenge.position?(i.data.winner="challenger",o=!0):i.data.winner="opponent"):e?i.data.challenger._id===$.currentUserPlayer._id?(i.data.winner="challenger",o=!0):i.data.winner="opponent":i.data.challenger._id===$.currentUserPlayer._id?i.data.winner="opponent":(i.data.winner="challenger",o=!0),o?n.swapPositions($.competitionId,i.data.opponent,i.data.challenger).then(function(){a.completeChallenge(i.data).then(function(){S&&P()})}):a.completeChallenge(i.data).then(function(){S&&P()}),$.pyramidMenuToggle=!1})}function v(e){h(null,!0,e)}function g(){if(o.isAuthenticated())if($.numberOfRealPlayers<$.maxPlayers){var e={_id:o.currentUser._id,firstName:o.currentUser.firstName,lastName:o.currentUser.lastName,email:o.currentUser.username,position:$.numberOfRealPlayers+1};$.pyramid.open?swal({title:"Join Competition?",text:"You'll be added to the bottom",type:"warning",showCancelButton:!0,confirmButtonText:"Join",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToPyramid($.competitionId,e),swal("Welcome Aboard!","Now start fighting your way to the top","success")}):swal({title:"Send Join Request?",text:"This is a closed competition so the owner must approve your request",type:"warning",showCancelButton:!0,confirmButtonText:"Send Request",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToPyramidRequest($.pyramid,e).then(function(){$.currentUserIsPending=!0}),swal("Request Sent","You will receive an email once the owner processes the request.","success")})}else i.warning("Sorry, this pyramid is full");else t.go("login")}function w(){swal({title:"Leave Pyramid?",text:"You will lose your spot and forfeit any active challenges.",type:"error",showCancelButton:!0,confirmButtonText:"Yes, leave",confirmButtonClass:"btn-danger",cancelButtonText:"No, stay",closeOnConfirm:!1,closeOnCancel:!0},function(){P(),swal("OK, you'r out!","You've been removed from the pyramid.","success")})}function P(){o.isAuthenticated()&&$.currentUserIsOnPyramid&&(S=!0,$.hasActiveChallenge?h(null,!0,$.currentUserPlayer):($.currentUserIsOnPyramid=!1,$.hasActiveChallenge=!1,n.getPyramid($.competitionId).then(function(e){var t=e.data,r=$.currentUserPlayer.position;_.forEach(t.players,function(e){e.position>=r&&(e.position-=1)});for(var i=_.remove(t.players,function(e){return e._id===$.currentUserPlayer._id}),o=[],a=0;a<$.numberOfRealPlayers-1;++a){var s={_id:t.players[a]._id,firstName:t.players[a].firstName,lastName:t.players[a].lastName,position:t.players[a].position};o.push(s)}n.removedPlayerFromPyramid($.competitionId,i[0],o).then(function(){S=!1})})))}function C(){n.getPyramid($.competitionId).then(function(e){$.pyramid=e.data,l(),c(),u(),p(),m()})}var I=10,$=this;$.pyramid={},$.breakPoints=[],$.levels=[],$.numberOfBlocks=0,$.currentUserIsOnPyramid=!1,$.currentUserIsPending=!1,$.currentUserIsOwner=!1,$.hasActiveChallenge=!1,$.activeChallengeOpponent=null,$.availableChallenges=!1,$.createChallenge=y,$.completeChallenge=h,$.challengeExpired=v,$.currentUserPlayer={},$.pyramidMenuToggle=!1,$.addCurrentUserToPyramid=g,$.confirmRemoveCurrentUserFromPyramid=w,$.numberOfRealPlayers=0,$.maxPlayers=0,s();var S=!1;e.$on("ws:challenge_created",function(e,t){$.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:challenge_completed",function(e,t){$.competitionId===t.competitionId&&(i.info(t.description),S||C())}),e.$on("ws:player_added",function(e,t){$.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:player_removed",function(e,t){$.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:pyramid_updated",function(e,t){$.competitionId===t.competitionId&&(i.info(t.description),C())})}t.$inject=["$scope","$state","pyramidsService","$filter","notifyService","identityService","challengesService"],angular.module("app").directive("kpPyramid",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{pyramid:"="},templateUrl:"/pyramids/components/update-players.html"};return e}function t(e,t,n){function r(){}function i(){_.forEach(l,function(e){n.deleteActiveChallengeByCompetitionByPlayer(c.pyramid._id,e._id)}),t.updatePyramid(c.pyramid).then(function(){c.disableSubmit=!0})}function o(){t.getPyramid(c.pyramid._id).then(function(t){t.data.players=e("orderBy")(t.data.players,"position"),c.pyramid=t.data,c.disableSubmit=!0})}function a(){var e=1;_.forEach(c.pyramid.players,function(t){t.position=e,++e}),c.disableSubmit=!1}function s(e,t){l.push(e),c.pyramid.players.splice(t,1),a()}var l=[],c=this;c.updatePyramid=i,c.cancelUpdate=o,c.reorderPlayers=a,c.removePlayer=s,c.disableSubmit=!0,r()}t.$inject=["$filter","pyramidsService","challengesService"],angular.module("app").directive("kpUpdatePlayers",e)}(),function(){"use strict";function e(e){function t(t){return e.get("/api/pyramid",{params:{competitionId:t}})}function n(t){return e.get("/api/pyramids/user",{params:{userId:t}})}function r(){return e.get("/api/pyramids")}function i(t){return e.post("/api/pyramids/create",{pyramid:t})}function o(t){return e.post("/api/pyramids/update",{pyramid:t})}function a(t){return e.delete("/api/pyramids/delete",{params:{competitionId:t}})}function s(t,n,r){return e.post("/api/pyramids/swapPositions",{competitionId:t,challenger:n,opponent:r})}function l(t,n){return e.post("/api/pyramids/addPlayer",{competitionId:t,player:n})}function c(t,n){return e.post("/api/pyramids/addPlayerRequest",{competition:t,player:n})}function d(t,n,r){return e.post("/api/pyramids/removePlayer",{competitionId:t,removedPlayer:n,players:r})}function u(t,n){return e.post("/api/pyramids/approvePlayer",{competitionId:t,player:n})}function p(t,n){return e.post("/api/pyramids/denyPlayer",{competitionId:t,player:n})}var m={getPyramid:t,getPyramidsForUser:n,getPyramids:r,createPyramid:i,updatePyramid:o,deletePyramid:a,swapPositions:s,addPlayerToPyramid:l,addPlayerToPyramidRequest:c,removedPlayerFromPyramid:d,approvePendingPlayer:u,denyPendingPlayer:p};return m}e.$inject=["$http"],angular.module("app").factory("pyramidsService",e)}(),function(){"use strict";function e(e,t,n,r,i,o,a){function s(){n.competitionId?(u.competitionId=n.competitionId,l()):t.go("pyramids.myPyramids")}function l(){i.getPyramid(u.competitionId).then(function(e){e.data&&_.some(e.data.owners,["_id",o.currentUser._id])?(u.isOwner=!0,e.data.players=r("orderBy")(e.data.players,"position"),u.pyramid=e.data):t.go("pyramids.myPyramids")})}function c(){i.getPyramid(u.competitionId).then(function(e){var t=e.data;t.open=u.pyramid.open,i.updatePyramid(t)})}function d(){swal({title:"Delete Competition?",text:"This can not be undone",type:"warning",showCancelButton:!0,confirmButtonText:"Delete",cancelButtonText:"Nevermind",closeOnConfirm:!0,closeOnCancel:!0},function(){i.deletePyramid(u.competitionId).then(function(){t.go("pyramids.myPyramids")})})}var u=this;u.competitionId=null,u.updatePyramidOpenStatus=c,u.deletePyramid=d,s(),e.$on("ws:challenge_completed",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),l())}),e.$on("ws:player_added",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),l())}),e.$on("ws:player_removed",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),l())}),e.$on("ws:pyramid_updated",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),l())}),e.$on("ws:add_player_request",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),l())}),e.$on("ws:add_player_request_denied",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),l())}),e.$on("ws:pyramid_deleted",function(e,n){u.competitionId===n.competitionId&&(a.info("The competition was deleted by the owner"),t.go("pyramids.myPyramids"))})}e.$inject=["$scope","$state","$stateParams","$filter","pyramidsService","identityService","notifyService"],angular.module("app").controller("AdminCtrl",e)}(),function(){"use strict";function e(e,t,n,r){function i(){t.getAllUsers().then(function(e){u.availablePlayers=e.data});for(var e=0;e<d;e++)c.push(e*(e+1)/2+1)}function o(e){e.position=u.addedPlayers.length+1,u.addedPlayers.push(_.remove(u.availablePlayers,{_id:e._id})[0])}function a(e){u.availablePlayers.push(_.remove(u.addedPlayers,{_id:e._id})[0]),s()}function s(){var e=1;_.forEach(u.addedPlayers,function(t){t.position=e,++e})}function l(t){angular.forEach(u.addedPlayers,function(e){p+=1;var n={position:p,_id:e._id,email:e.username,firstName:e.firstName,lastName:e.lastName};t.players.push(n)}),t.owners=[{_id:r.currentUser._id,email:r.currentUser.username,firstName:r.currentUser.firstName,lastName:r.currentUser.lastName}];for(var i=0;i<c.length;i++)if(t.players.length<c[i]){t.levels=i;break}n.createPyramid(t).then(function(t){e.go("pyramids.view",{competitionId:t.data._id})})}var c=[],d=10,u=this;u.newPyramid={players:[],open:!1},u.availablePlayers=[],u.addedPlayers=[],u.createPyramid=l,u.addPlayer=o,u.removePlayer=a,u.reorderPlayers=s,u.newPyramid.forfeitDays=1,i();var p=0}e.$inject=["$state","userService","pyramidsService","identityService"],angular.module("app").controller("CreatePyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("MyPyramidsCtrl",e)}(),function(){"use strict";function e(e,t,n,r,i){function o(){n.competitionId&&(a.competitionId=n.competitionId,r.getPyramid(a.competitionId).then(function(e){e.data?a.pyramid=e.data:t.go("pyramids.myPyramids")}))}var a=this;a.competitionId=null,a.pyramid=null,o(),e.$on("ws:pyramid_deleted",function(e,n){a.competitionId===n.competitionId&&(i.info("The competition was deleted by the owner"),t.go("pyramids.myPyramids"))})}e.$inject=["$scope","$state","$stateParams","pyramidsService","notifyService"],angular.module("app").controller("PyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("PyramidsCtrl",e)}(),function(){"use strict";function e(e,t,n,r,i){function o(){t.competitionId&&(s.competitionId=t.competitionId,a())}function a(){r.getPyramid(s.competitionId).then(function(e){e.data?s.pyramid=e.data:n.go("pyramids.myPyramids")})}var s=this;s.competitionId=null,s.pyramid=null,o(),e.$on("ws:challenge_completed",function(e,t){s.competitionId===t.competitionId&&(i.info(t.description),a())}),e.$on("ws:challenge_deleted",function(e,t){s.competitionId===t.competitionId&&a()}),e.$on("ws:pyramid_updated",function(e,t){s.competitionId===t.competitionId&&(i.info(t.description),a())}),e.$on("ws:pyramid_deleted",function(e,t){s.competitionId===t.competitionId&&(i.info("The competition was deleted by the owner"),n.go("pyramids.myPyramids"))})}e.$inject=["$scope","$stateParams","$state","pyramidsService","notifyService"],angular.module("app").controller("StatsCtrl",e)}(),function(){"use strict";function e(e){function t(){}var n=this;n.indentity=e,t()}e.$inject=["identityService"],angular.module("app").controller("UserCtrl",e)}(),function(){"use strict";function e(e){function t(t,n,r){var i=r.scrollaxis||"y",o=r.theme||"minimal-dark",a=r.mousewheelaxis||"y";$("html").hasClass("ismobile")||e.malihuScroll(n,o,i,a)}var n={restrict:"C",link:t};return n}e.$inject=["scrollbarService"],angular.module("app").directive("cOverflow",e)}(),function(){"use strict";function e(){function e(e,t){t.click(function(){t.next().slideToggle(200),t.parent().toggleClass("toggled")})}var t={restrict:"A",link:e};return t}angular.module("app").directive("toggleSubmenu",e)}(),function(){"use strict";
function e(){function e(e,t){t.hasClass("btn-icon")||t.hasClass("btn-float")?Waves.attach(t,["waves-circle"]):t.hasClass("btn-light")?Waves.attach(t,["waves-light"]):Waves.attach(t),Waves.init()}var t={restrict:"C",link:e};return t}angular.module("app").directive("wavesEffect",e)}(),function(){"use strict";function e(){function e(e,t){var n=t.children().first(),r=t.parent().hasClass("fg-float");n.focus(function(){t.addClass("fg-toggled")}),n.blur(function(){(!r||r&&0===n.val().length)&&t.removeClass("fg-toggled")})}var t={restrict:"C",link:e};return t}angular.module("app").directive("fgLine",e)}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiYXBwLmNvbnRyb2xsZXIuanMiLCJhcHAucm91dGVzLmpzIiwiYXBwLnJ1bi5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL2F1dGguc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL3VzZXIuc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3ZpZXdzL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJhdXRoZW50aWNhdGlvbi92aWV3cy9wYXNzd29yZC1yZXNldC5jb250cm9sbGVyLmpzIiwiYXV0aGVudGljYXRpb24vdmlld3MvcmVnaXN0ZXIuY29udHJvbGxlci5qcyIsImF1dGhlbnRpY2F0aW9uL3ZpZXdzL3ZlcmlmaWNhdGlvbi5jb250cm9sbGVyLmpzIiwiY2hhbGxlbmdlcy9jb21wb25lbnRzL2FjdGl2ZS1jaGFsbGVuZ2VzLmRpcmVjdGl2ZS5qcyIsImNoYWxsZW5nZXMvY29tcG9uZW50cy9jb21wbGV0ZWQtY2hhbGxlbmdlcy5kaXJlY3RpdmUuanMiLCJjaGFsbGVuZ2VzL2NvbXBvbmVudHMvcGxheWVyLW92ZXJhbGwtcmVzdWx0cy5kaXJlY3RpdmUuanMiLCJjaGFsbGVuZ2VzL3NlcnZpY2VzL2NoYWxsZW5nZXMuc2VydmljZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL2Zvb3Rlci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy9oZWFkZXIuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvc2lkZWJhci5kaXJlY3RpdmUuanMiLCJjb21tb24vZmlsdGVycy9vcmRlci1vYmplY3QtYnkuZmlsdGVyLmpzIiwiY29tbW9uL3NlcnZpY2VzL2luZGVudGl0eS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL25vdGlmeS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3Njcm9sbGJhci5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3NpZGViYXIuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy93ZWJzb2NrZXQuc2VydmljZS5qcyIsImNvbW1vbi92aWV3cy9ob21lLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3BlbmRpbmctcGxheWVycy5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQtY29tcGFjdC5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQuZGlyZWN0aXZlLmpzIiwicHlyYW1pZHMvY29tcG9uZW50cy91cGRhdGUtcGxheWVycy5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9zZXJ2aWNlcy9weXJhbWlkcy5zZXJ2aWNlLmpzIiwicHlyYW1pZHMvdmlld3MvYWRtaW4uY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL2NyZWF0ZS1weXJhbWlkLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy92aWV3cy9teS1weXJhbWlkcy5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvcHlyYW1pZC5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvcHlyYW1pZHMuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL3N0YXRzLmNvbnRyb2xsZXIuanMiLCJ1c2Vycy92aWV3cy91c2VyLmNvbnRyb2xsZXIuanMiLCJjb21tb24vY29tcG9uZW50cy91aS9zY3JvbGxiYXIuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvdWkvdG9nZ2xlLXN1Ym1lbnUuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvdWkvd2F2ZXMuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvdWkvZm9ybXMvZmctbGluZS5kaXJlY3RpdmUuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZ3VyYXRpb24iLCIkaHR0cFByb3ZpZGVyIiwiJHVpYlRvb2x0aXBQcm92aWRlciIsImRlZmF1bHRzIiwiaGVhZGVycyIsImdldCIsIm9wdGlvbnMiLCJhcHBlbmRUb0JvZHkiLCJjb25maWciLCJBcHBDdHJsIiwiJHN0YXRlIiwibG9jYWxTdG9yYWdlU2VydmljZSIsInRvZ2dsZVNpZGViYXJMb2NrZWQiLCJsb2NrZWQiLCJzZXQiLCJhcHBDdHJsIiwidGhpcyIsImxvY2tTaWRlYmFyIiwiY29udHJvbGxlciIsImNvbmZpZ3VyZVJvdXRlcyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJyb3V0ZVJvbGVDaGVja3MiLCJzdXBlckFkbWluIiwicmVxdWlyZVN1cGVyQWRtaW4iLCJhZG1pbiIsInJlcXVpcmVBZG1pbiIsInVzZXIiLCJyZXF1aXJlQXV0aCIsImh0bWw1TW9kZSIsIm90aGVyd2lzZSIsIndoZW4iLCJzdGF0ZSIsInVybCIsInZpZXdzIiwiY29udGVudCIsImNvbnRyb2xsZXJBcyIsInRlbXBsYXRlVXJsIiwiY29udGVudEAiLCJyZXNvbHZlIiwiYXV0aCIsImF1dGhTZXJ2aWNlIiwiYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSIsImF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUiLCIkaW5qZWN0IiwiYXBwUnVuIiwiJHJvb3RTY29wZSIsInNpZGViYXJTZXJ2aWNlIiwiJG9uIiwiZXZlbnQiLCJ0b1N0YXRlIiwidG9QYXJhbXMiLCJmcm9tU3RhdGUiLCJmcm9tUGFyYW1zIiwiZXJyb3IiLCJnbyIsInByZXZpb3VzIiwicHJldlBhcmFtcyIsInNldFNpZGViYXJTdGF0dXMiLCJydW4iLCIkaHR0cCIsIiRxIiwidXNlclNlcnZpY2UiLCJpZGVudGl0eVNlcnZpY2UiLCJub3RpZnlTZXJ2aWNlIiwiYXV0aGVudGljYXRlVXNlciIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJkZmQiLCJkZWZlciIsInBvc3QiLCJ0aGVuIiwicmVzcG9uc2UiLCJkYXRhIiwic3VjY2VzcyIsImN1cnJlbnRVc2VyIiwibWVzc2FnZSIsInByb21pc2UiLCJjcmVhdGVVc2VyIiwidXNlckRhdGEiLCJyZWFzb24iLCJsb2dvdXQiLCJ1bmRlZmluZWQiLCJyb2xlIiwiaXNBdXRob3JpemVkIiwicmVqZWN0IiwiaXNBdXRoZW50aWNhdGVkIiwic2VydmljZSIsImZhY3RvcnkiLCJnZXRBbGxVc2VycyIsInVzZXJzIiwidmVyaWZ5VXNlciIsInVzZXJJZCIsInZlcmlmaWNhdGlvblRva2VuIiwicGFyYW1zIiwiZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayIsInJlc2V0UGFzc3dvcmQiLCJwdXQiLCJMb2dpbkN0cmwiLCJhY3RpdmF0ZSIsImxvZ2luIiwidm0iLCJQYXNzd29yZFJlc2V0Q3RybCIsIiRzdGF0ZVBhcmFtcyIsInZlcmlmaWVkIiwicmVzZXRQYXNzd29yZEZvcm0iLCJjb25maXJtUGFzc3dvcmQiLCJSZWdpc3RlckN0cmwiLCJyZWdpc3RlciIsIm5ld1VzZXIiLCJWZXJpZmljYXRpb25DdHJsIiwidmVyaWZ5aW5nIiwia3BBY3RpdmVDaGFsbGVuZWdlcyIsImRpcmVjdGl2ZSIsImJpbmRUb0NvbnRyb2xsZXIiLCJjdHJsRnVuYyIsInJlc3RyaWN0Iiwic2NvcGUiLCJjb21wZXRpdGlvbklkIiwiJHNjb3BlIiwiY2hhbGxlbmdlc1NlcnZpY2UiLCJnZXRBY3RpdmVDaGFsbGVuZ2VzIiwiY2hhbGxlbmdlcyIsImdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uIiwibGVuZ3RoIiwiXyIsImZvckVhY2giLCJjaGFsbGVuZ2UiLCJ0aW1lTGltaXQiLCJleHBpcmVzIiwibW9tZW50IiwiZGlmZiIsImNyZWF0ZWQiLCJhZGQiLCJjaGFsbGVuZ2VEZXRhaWxzIiwia3BDb21wbGV0ZWRDaGFsbGVuZWdlcyIsImFsbG93RGVsZXRlIiwibGltaXQiLCJnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzIiwiZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24iLCJsb3NlciIsIndpbm5lciIsIndoZW5Db21wbGV0ZWQiLCJjb21wbGV0ZWQiLCJjYWxlbmRhciIsInNhbWVEYXkiLCJuZXh0RGF5IiwibmV4dFdlZWsiLCJsYXN0RGF5IiwibGFzdFdlZWsiLCJzYW1lRWxzZSIsImRlbGV0ZUNoYWxsZW5nZSIsImNoYWxsZW5nZUlkIiwiJGluZGV4Iiwic3BsaWNlIiwiaW5mbyIsImtwUGxheWVyT3ZlcmFsbFJlc3VsdHMiLCJwbGF5ZXIiLCJnZXRQbGF5ZXJPdmVyYWxsUmVzdWx0cyIsIl9pZCIsInBsYXllcklkIiwiZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb24iLCJyZXN1bHRzIiwiYnJlYWtQb2ludHMiLCJpIiwibWF4TGV2ZWxzIiwicHVzaCIsImxldmVsIiwiaiIsInBvc2l0aW9uIiwiaW5kZXhPZiIsInN0cmVha1R5cGUiLCJzdHJlYWsiLCJjb250aW51ZVN0cmVhayIsImNoYWxsZW5nZXIiLCJvcHBvbmVudCIsInR5cGUiLCJ2YWx1ZSIsIndpbnMiLCJhc09wcG9uZW50Iiwic2l6ZSIsImZpbHRlciIsImFzQ2hhbGxlbmdlciIsInRvdGFsIiwiYnlGb3JmZWl0IiwiZm9yZmVpdCIsImxvc2VzIiwiY3JlYXRlQ2hhbGxlbmdlIiwiY29tcGxldGVDaGFsbGVuZ2UiLCJnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbiIsImdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllciIsImRlbGV0ZUFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllciIsImRlbGV0ZSIsImtwRm9vdGVyIiwiaW5kZW50aXR5Iiwia3BIZWFkZXIiLCJ0b2dnbGVTaWRlYmFyIiwic2lkZWJhclN0YXR1cyIsImxlZnQiLCJnZXRTaWRlYmFyU3RhdHVzIiwia3BTaWRlYmFyIiwib3JkZXJPYmplY3RCeSIsImlucHV0IiwiYXR0cmlidXRlIiwiaXNPYmplY3QiLCJhcnJheSIsIm9iamVjdEtleSIsInNvcnQiLCJhIiwiYiIsInBhcnNlSW50IiwiJHdpbmRvdyIsInJvbGVzIiwiYm9vdHN0cmFwcGVkVXNlck9iamVjdCIsInRhcmdldCIsIiQiLCJub3RpZnkiLCJ3YXJuaW5nIiwiaW52ZXJzZSIsIm5vdGlmeURlZmF1bHRzIiwibmV3ZXN0X29uX3RvcCIsIm9mZnNldCIsIngiLCJ5Iiwic2Nyb2xsYmFyU2VydmljZSIsIm1hbGlodVNjcm9sbCIsInNlbGVjdG9yIiwidGhlbWUiLCJzY3JvbGxheGlzIiwibW91c2V3aGVlbGF4aXMiLCJtQ3VzdG9tU2Nyb2xsYmFyIiwic2Nyb2xsSW5lcnRpYSIsImF4aXMiLCJtb3VzZVdoZWVsIiwiZW5hYmxlIiwicHJldmVudERlZmF1bHQiLCJzdGF0dXMiLCJyaWdodCIsIndlYnNvY2tldEhvc3QiLCJsb2NhdGlvbiIsInByb3RvY29sIiwiaG9zdCIsImNvbm5lY3Rpb24iLCJjb25uZWN0IiwiV2ViU29ja2V0Iiwib25tZXNzYWdlIiwiZSIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCIkYnJvYWRjYXN0IiwidG9waWMiLCJzZW5kIiwianNvbiIsInN0cmluZ2lmeSIsIndlYnNvY2tldFNlcnZpY2UiLCJIb21lQ3RybCIsImtwUGVuZGluZ1BsYXllcnMiLCJweXJhbWlkIiwicHlyYW1pZHNTZXJ2aWNlIiwiYXBwcm92ZVBlbmRpbmdQbGF5ZXIiLCJwbGF5ZXJzIiwiZGVueVBlbmRpbmdQbGF5ZXIiLCJwZW5kaW5nUGxheWVycyIsImtwUHlyYW1pZENvbXBhY3QiLCJnZXRQeXJhbWlkc0ZvclVzZXIiLCJweXJhbWlkcyIsImdldFB5cmFtaWRzIiwia3BQeXJhbWlkIiwicmVwbGFjZSIsIiRmaWx0ZXIiLCJnZXRQeXJhbWlkIiwibWF4UGxheWVycyIsIm9yZGVyUGxheWVycyIsImdldFBsYXllcnNTdGF0dXMiLCJhc3NpZ25MZXZlbHNUb1BsYXllcnMiLCJjYWxjdWxhdGVQeXJhbWlkQmxvY2tzIiwiZmlsbEluRW1wdHlCbG9ja3MiLCJjdXJyZW50VXNlcklzT3duZXIiLCJjdXJyZW50VXNlcklzUGVuZGluZyIsInNvbWUiLCJvd25lcnMiLCJjdXJyZW50VXNlcklzT25QeXJhbWlkIiwiaGFzQWN0aXZlQ2hhbGxlbmdlIiwiY2xhc3MiLCJjdXJyZW50VXNlclBsYXllciIsImFjdGl2ZUNoYWxsZW5nZU9wcG9uZW50IiwiZmluZCIsInRpbWVUb0V4cGlyZSIsImZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzIiwiY3JlYXRlQnJlYWtQb2ludHMiLCJsZXZlbHMiLCJudW1iZXJPZkJsb2NrcyIsImxhc3QiLCJudW1iZXJPZlJlYWxQbGF5ZXJzIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJsZXZlbEFib3ZlIiwiYXZhaWxhYmxlQ2hhbGxlbmdlcyIsImF2YWlsYWJsZSIsImNvbXBldGl0aW9uTmFtZSIsIm5hbWUiLCJjb21wbGV0ZSIsImZvcmZlaXREYXlzIiwiZW1haWwiLCJweXJhbWlkTWVudVRvZ2dsZSIsIndpbm5lcklzQ3VycmVudFVzZXIiLCJmb3JmZWl0TG9zZXIiLCJzd2FwUG9zaXRpb25zIiwicmVtb3ZpbmdDdXJyZW50VXNlciIsInJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQiLCJjaGFsbGVuZ2VFeHBpcmVkIiwiYWRkQ3VycmVudFVzZXJUb1B5cmFtaWQiLCJvcGVuIiwic3dhbCIsInRpdGxlIiwidGV4dCIsInNob3dDYW5jZWxCdXR0b24iLCJjb25maXJtQnV0dG9uVGV4dCIsImNhbmNlbEJ1dHRvblRleHQiLCJjbG9zZU9uQ29uZmlybSIsImNsb3NlT25DYW5jZWwiLCJhZGRQbGF5ZXJUb1B5cmFtaWQiLCJhZGRQbGF5ZXJUb1B5cmFtaWRSZXF1ZXN0IiwiY29uZmlybVJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQiLCJjb25maXJtQnV0dG9uQ2xhc3MiLCJwIiwib3BlblBvc2l0aW9uIiwicmVtb3ZlZFBsYXllciIsInJlbW92ZSIsInVwZGF0ZWRQbGF5ZXJzIiwidXBkYXRlZFBsYXllciIsInJlbW92ZWRQbGF5ZXJGcm9tUHlyYW1pZCIsInJlZnJlc2hQeXJhbWlkIiwiZGVzY3JpcHRpb24iLCJkZXRhaWxzIiwia3BVcGRhdGVQbGF5ZXJzIiwidXBkYXRlUHlyYW1pZCIsInJlbW92ZWRQbGF5ZXJzIiwiZGlzYWJsZVN1Ym1pdCIsImNhbmNlbFVwZGF0ZSIsInJlb3JkZXJQbGF5ZXJzIiwicmVtb3ZlUGxheWVyIiwicGxheWVySW5kZXgiLCJjcmVhdGVQeXJhbWlkIiwiZGVsZXRlUHlyYW1pZCIsImNvbXBldGl0aW9uIiwiQWRtaW5DdHJsIiwiaXNPd25lciIsInVwZGF0ZVB5cmFtaWRPcGVuU3RhdHVzIiwidXBkYXRlZFB5cmFtaWQiLCJDcmVhdGVQeXJhbWlkQ3RybCIsImF2YWlsYWJsZVBsYXllcnMiLCJhZGRQbGF5ZXIiLCJhZGRlZFBsYXllcnMiLCJuZXdQeXJhbWlkIiwiTXlQeXJhbWlkc0N0cmwiLCJQeXJhbWlkQ3RybCIsIlB5cmFtaWRzQ3RybCIsIlN0YXRzQ3RybCIsIlVzZXJDdHJsIiwiY092ZXJmbG93IiwibGlua0Z1bmMiLCJlbGVtZW50IiwiYXR0cnMiLCJoYXNDbGFzcyIsImxpbmsiLCJ0b2dnbGVTdWJtZW51IiwiZWwiLCJjbGljayIsIm5leHQiLCJzbGlkZVRvZ2dsZSIsInBhcmVudCIsInRvZ2dsZUNsYXNzIiwid2F2ZXNFZmZlY3QiLCJXYXZlcyIsImF0dGFjaCIsImluaXQiLCJmZ0xpbmUiLCJjaGlsZHJlbiIsImZpcnN0IiwiaXNGbG9hdExhYmVsIiwiZm9jdXMiLCJhZGRDbGFzcyIsImJsdXIiLCJ2YWwiLCJyZW1vdmVDbGFzcyJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQUFDLE9BQUEsT0FDQSxZQUNBLGVBQ0EsWUFDQSxzQkFDQSxhQUNBLHdCQUNBLFFBQ0EscUJBQ0EsMEJDVEEsd0JBSUEsU0FBQUMsR0FBQUMsRUFBQUMsR0FFQUQsRUFBQUUsU0FBQUMsUUFBQUMsTUFDQUosRUFBQUUsU0FBQUMsUUFBQUMsUUFHQUosRUFBQUUsU0FBQUMsUUFBQUMsSUFBQSxxQkFBQSxnQ0FFQUosRUFBQUUsU0FBQUMsUUFBQUMsSUFBQSxpQkFBQSxXQUNBSixFQUFBRSxTQUFBQyxRQUFBQyxJQUFBLE9BQUEsV0FFQUgsRUFBQUksU0FBQUMsY0FBQSxzREFiQVQsUUFBQUMsT0FBQSxPQUFBUyxPQUFBUixNQ0ZBLHVCQUlB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U0FBQSxJQUNBMFAsS0FBQUosRUFHQSxPQUFBelAsR0FWQXBILFFBQ0FDLE9BQUEsT0FDQW1ILFVBQUEsU0FBQXlRIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICd1aS5yb3V0ZXInLFxuICAndWkuYm9vdHN0cmFwJyxcbiAgJ25nQW5pbWF0ZScsXG4gICdhbmd1bGFyLWxvYWRpbmctYmFyJyxcbiAgJ25vdWlzbGlkZXInLFxuICAnbG9jYWx5dGljcy5kaXJlY3RpdmVzJyxcbiAgJ3RpbWVyJyxcbiAgJ0xvY2FsU3RvcmFnZU1vZHVsZScsXG4gICdhbmd1bGFyLXNvcnRhYmxlLXZpZXcnXG5dKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCAnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29uZmlnKGNvbmZpZ3VyYXRpb24pO1xuXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyYXRpb24oJGh0dHBQcm92aWRlciwgJHVpYlRvb2x0aXBQcm92aWRlcikge1xuICAgIC8vaW5pdGlhbGl6ZSBnZXQgaWYgbm90IHRoZXJlXG4gICAgaWYgKCEkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0KSB7XG4gICAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0ID0ge307ICAgIFxuICAgIH0gICAgXG4gICAgLy9kaXNhYmxlIElFIGFqYXggcmVxdWVzdCBjYWNoaW5nXG4gICAgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldFsnSWYtTW9kaWZpZWQtU2luY2UnXSA9ICdGcmksIDAxIEphbiAyMDE2IDA1OjAwOjAwIEdNVCc7XG4gICAgLy8gZXh0cmFcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0WydDYWNoZS1Db250cm9sJ10gPSAnbm8tY2FjaGUnO1xuICAgICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXRbJ1ByYWdtYSddID0gJ25vLWNhY2hlJztcblxuICAgICR1aWJUb29sdGlwUHJvdmlkZXIub3B0aW9ucyh7IGFwcGVuZFRvQm9keTogdHJ1ZSB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdBcHBDdHJsJywgQXBwQ3RybCk7XG5cbiAgZnVuY3Rpb24gQXBwQ3RybCgkc3RhdGUsIGxvY2FsU3RvcmFnZVNlcnZpY2UpIHtcbiAgICB2YXIgYXBwQ3RybCA9IHRoaXM7XG4gICAgLy8gVXNlIHRoaXMgZm9yIFNpZGViYXIgbWVudVxuICAgIGFwcEN0cmwuJHN0YXRlID0gJHN0YXRlO1xuICAgIC8vIExvY2sgdGhlIHNpZGViYXIgaW4gdmlld1xuICAgIGFwcEN0cmwubG9ja1NpZGViYXIgPSBsb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldCgnc2lkZWJhckxvY2tlZCcpO1xuICAgIGFwcEN0cmwudG9nZ2xlU2lkZWJhckxvY2tlZCA9IHRvZ2dsZVNpZGViYXJMb2NrZWQ7XG5cbiAgICBmdW5jdGlvbiB0b2dnbGVTaWRlYmFyTG9ja2VkKGxvY2tlZCkge1xuICAgICAgbG9jYWxTdG9yYWdlU2VydmljZS5zZXQoJ3NpZGViYXJMb2NrZWQnLCBsb2NrZWQpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb25maWcoY29uZmlndXJlUm91dGVzKTtcblxuICBmdW5jdGlvbiBjb25maWd1cmVSb3V0ZXMoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICB2YXIgcm91dGVSb2xlQ2hlY2tzID0ge1xuICAgICAgc3VwZXJBZG1pbjogcmVxdWlyZVN1cGVyQWRtaW4sXG4gICAgICBhZG1pbjogcmVxdWlyZUFkbWluLFxuICAgICAgdXNlcjogcmVxdWlyZUF1dGhcbiAgICB9O1xuXG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgLy8gZm9yIGFueSB1bm1hdGNoZWQgdXJsXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLndoZW4oJy9weXJhbWlkcy8nLCAnL3B5cmFtaWRzJyk7XG5cbiAgICAkc3RhdGVQcm92aWRlclxuICAgICAgLnN0YXRlKCdob21lJywge1xuICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbW1vbi92aWV3cy9ob21lLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMnLCB7XG4gICAgICAgIHVybDogJy9weXJhbWlkcycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHlyYW1pZHNDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvcHlyYW1pZHMuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy5teVB5cmFtaWRzJywge1xuICAgICAgICB1cmw6ICcvbXktcHlyYW1pZHMnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNeVB5cmFtaWRzQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL215LXB5cmFtaWRzLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLnZpZXcnLCB7XG4gICAgICAgIHVybDogJy92aWV3Lzpjb21wZXRpdGlvbklkJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHlyYW1pZEN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9weXJhbWlkLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMuc3RhdHMnLCB7XG4gICAgICAgIHVybDogJy9zdGF0cy86Y29tcGV0aXRpb25JZCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1N0YXRzQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL3N0YXRzLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMuYWRtaW4nLCB7XG4gICAgICAgIHVybDogJy9hZG1pbi86Y29tcGV0aXRpb25JZCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0FkbWluQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL2FkbWluLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLmNyZWF0ZScsIHtcbiAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0NyZWF0ZVB5cmFtaWRDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvY3JlYXRlLXB5cmFtaWQuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICBhdXRoOiByb3V0ZVJvbGVDaGVja3MudXNlclxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgndXNlcicsIHtcbiAgICAgICAgdXJsOiAnL3VzZXInLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1VzZXJDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndXNlcnMvdmlld3MvdXNlci5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIGF1dGg6IHJvdXRlUm9sZUNoZWNrcy51c2VyXG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdsb2dpbicsIHtcbiAgICAgICAgdXJsOiAnL2xvZ2luJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy9sb2dpbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3JlZ2lzdGVyJywge1xuICAgICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3JlZ2lzdGVyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgndmVyaWZ5Jywge1xuICAgICAgICB1cmw6ICcvdmVyaWZpY2F0aW9uJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWZXJpZmljYXRpb25DdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvdmVyaWZpY2F0aW9uLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgndmVyaWZpY2F0aW9uJywge1xuICAgICAgICB1cmw6ICcvdmVyaWZpY2F0aW9uLzp1c2VySWQvOnZlcmlmaWNhdGlvblRva2VuJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWZXJpZmljYXRpb25DdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvdmVyaWZpY2F0aW9uLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncGFzc3dvcmQtcmVzZXQtcmVxdWVzdCcsIHtcbiAgICAgICAgdXJsOiAnL3Bhc3N3b3JkLXJlc2V0JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQYXNzd29yZFJlc2V0Q3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3Bhc3N3b3JkLXJlc2V0Lmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncGFzc3dvcmQtcmVzZXQnLCB7XG4gICAgICAgIHVybDogJy9wYXNzd29yZC1yZXNldC86dXNlcklkLzp2ZXJpZmljYXRpb25Ub2tlbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUGFzc3dvcmRSZXNldEN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy9wYXNzd29yZC1yZXNldC5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cblxuICByZXF1aXJlQWRtaW4uJGluamVjdCA9IFsnYXV0aFNlcnZpY2UnXTtcblxuICBmdW5jdGlvbiByZXF1aXJlQWRtaW4oYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSgnYWRtaW4nKTtcbiAgfVxuXG4gIHJlcXVpcmVTdXBlckFkbWluLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZVN1cGVyQWRtaW4oYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSgnc3VwZXItYWRtaW4nKTtcbiAgfVxuXG4gIHJlcXVpcmVBdXRoLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZUF1dGgoYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLnJ1bihhcHBSdW4pO1xuXG4gIGZ1bmN0aW9uIGFwcFJ1bigkcm9vdFNjb3BlLCAkc3RhdGUsIHNpZGViYXJTZXJ2aWNlKSB7XG4gICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZUVycm9yJywgZnVuY3Rpb24gKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCBlcnJvcikge1xuICAgICAgaWYgKGVycm9yID09PSAnbm90IGF1dGhvcml6ZWQnKSB7XG4gICAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcbiAgICAgICAgJHN0YXRlLnByZXZpb3VzID0gdG9TdGF0ZTtcbiAgICAgICAgJHN0YXRlLnByZXZQYXJhbXMgPSB0b1BhcmFtcztcbiAgICAgIH1cbiAgICB9KTtcblxuICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHNpZGViYXJTZXJ2aWNlLnNldFNpZGViYXJTdGF0dXMoZmFsc2UpO1xuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ2F1dGhTZXJ2aWNlJywgYXV0aFNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIGF1dGhTZXJ2aWNlKCRzdGF0ZSwgJGh0dHAsICRxLCB1c2VyU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBhdXRoZW50aWNhdGVVc2VyOiBhdXRoZW50aWNhdGVVc2VyLFxuICAgICAgY3JlYXRlVXNlcjogY3JlYXRlVXNlcixcbiAgICAgIGxvZ291dDogbG9nb3V0LFxuICAgICAgYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZTogYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSxcbiAgICAgIGF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGU6IGF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGVcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gYXV0aGVudGljYXRlVXNlcih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xuICAgICAgJGh0dHAucG9zdCgnL2xvZ2luJywge1xuICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3VjY2Vzcykge1xuICAgICAgICAgIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlciA9IHJlc3BvbnNlLmRhdGEudXNlcjtcbiAgICAgICAgICBkZmQucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UgPT09ICd1bnZlcmlmaWVkJykge1xuICAgICAgICAgIGRmZC5yZXNvbHZlKCd1bnZlcmlmaWVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVVc2VyKHVzZXJEYXRhKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG4gICAgICAgIHVzZXJEYXRhOiB1c2VyRGF0YVxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICBkZmQucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkZmQucmVzb2x2ZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5yZWFzb24gPT09ICdFcnJvcjogRHVwbGljYXRlIFVzZXJuYW1lJykge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1NvcnJ5LCBhbiBhY2NvdW50IGFscmVhZHkgZXhpc3RzIHdpdGggdGhhdCBlbWFpbCBhZGRyZXNzLicpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9sb2dvdXQnLCB7XG4gICAgICAgIGxvZ291dDogdHJ1ZVxuICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgZGZkLnJlc29sdmUoKTtcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlKHJvbGUpIHtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRob3JpemVkKHJvbGUpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICRxLnJlamVjdCgnbm90IGF1dGhvcml6ZWQnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlKCkge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoJ25vdCBhdXRob3JpemVkJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ3VzZXJTZXJ2aWNlJywgdXNlclNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHVzZXJTZXJ2aWNlKCRodHRwKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBnZXRBbGxVc2VyczogZ2V0QWxsVXNlcnMsXG4gICAgICB2ZXJpZnlVc2VyOiB2ZXJpZnlVc2VyLFxuICAgICAgZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluazogZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayxcbiAgICAgIHJlc2V0UGFzc3dvcmQ6IHJlc2V0UGFzc3dvcmRcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gZ2V0QWxsVXNlcnMoKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJykudGhlbihmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJzO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmVyaWZ5VXNlcih1c2VySWQsIHZlcmlmaWNhdGlvblRva2VuKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXIvdmVyaWZpY2F0aW9uJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICB1c2VySWQ6IHVzZXJJZCxcbiAgICAgICAgICB2ZXJpZmljYXRpb25Ub2tlbjogdmVyaWZpY2F0aW9uVG9rZW5cbiAgICAgICAgfVxuICAgICAgfSk7ICBcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZW5lcmF0ZVBhc3N3b3JkUmVzZXRMaW5rKHVzZXJuYW1lKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXIvcGFzc3dvcmQvbGluaycsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lXG4gICAgICAgIH1cbiAgICAgIH0pOyAgXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVzZXRQYXNzd29yZCh1c2VySWQsIHZlcmlmaWNhdGlvblRva2VuLCBwYXNzd29yZCkge1xuICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS91c2VyL3Bhc3N3b3JkL3Jlc2V0Jywge1xuICAgICAgICB1c2VySWQ6IHVzZXJJZCxcbiAgICAgICAgdmVyaWZpY2F0aW9uVG9rZW46IHZlcmlmaWNhdGlvblRva2VuLFxuICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgIH0pOyAgXG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIExvZ2luQ3RybCk7XG5cbiAgZnVuY3Rpb24gTG9naW5DdHJsKCRzdGF0ZSwgYXV0aFNlcnZpY2UsIG5vdGlmeVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmxvZ2luID0gbG9naW47XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICBhdXRoU2VydmljZS5hdXRoZW50aWNhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1VzZXJuYW1lIC8gcGFzc3dvcmQgY29tYmluYWl0b24gaW5jb3JyZWN0Jyk7XG4gICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UgPT09ICd1bnZlcmlmaWVkJykge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1lvdSBtdXN0IHZlcmlmeSB5b3VyIGVtYWlsIGJlZm9yZSB5b3UgY2FuIGxvZ2luJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKCRzdGF0ZS5wcmV2aW91cykge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCRzdGF0ZS5wcmV2aW91cywgJHN0YXRlLnByZXZQYXJhbXMpO1xuICAgICAgICAgICAgJHN0YXRlLnByZXZpb3VzID0gbnVsbDtcbiAgICAgICAgICAgICRzdGF0ZS5wcmV2UGFyYW1zID0gbnVsbDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUGFzc3dvcmRSZXNldEN0cmwnLCBQYXNzd29yZFJlc2V0Q3RybCk7XG5cbiAgZnVuY3Rpb24gUGFzc3dvcmRSZXNldEN0cmwoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIHVzZXJTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlLCBhdXRoU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS51c2VybmFtZSA9ICcnO1xuICAgIHZtLnZlcmlmaWVkID0gZmFsc2U7XG4gICAgdm0ucmVzZXRQYXNzd29yZEZvcm0gPSB7fTtcbiAgICB2bS5nZW5lcmF0ZVBhc3N3b3JkUmVzZXRMaW5rID0gZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluaztcbiAgICB2bS5yZXNldFBhc3N3b3JkID0gcmVzZXRQYXNzd29yZDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICB9IGVsc2UgaWYgKCRzdGF0ZVBhcmFtcy51c2VySWQgJiYgJHN0YXRlUGFyYW1zLnZlcmlmaWNhdGlvblRva2VuKSB7XG4gICAgICAgIHVzZXJTZXJ2aWNlLnZlcmlmeVVzZXIoJHN0YXRlUGFyYW1zLnVzZXJJZCwgJHN0YXRlUGFyYW1zLnZlcmlmaWNhdGlvblRva2VuKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgICB2bS52ZXJpZmllZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZW5lcmF0ZVBhc3N3b3JkUmVzZXRMaW5rKHVzZXJuYW1lKSB7XG4gICAgICB1c2VyU2VydmljZS5nZW5lcmF0ZVBhc3N3b3JkUmVzZXRMaW5rKHVzZXJuYW1lKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAoIXJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdDb3VsZCBub3QgZmluZCB0aGF0IGVtYWlsIGFkZHJlc3MnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLnN1Y2Nlc3MoJ1BsZWFzZSBjaGVjayB5b3VyIGVtYWlsIGZvciBhIHBhc3N3b3JkIHJlc2V0IGxpbmsnKTtcbiAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVzZXRQYXNzd29yZChyZXNldFBhc3N3b3JkRm9ybSkge1xuICAgICAgaWYgKHJlc2V0UGFzc3dvcmRGb3JtLnBhc3N3b3JkICE9PSByZXNldFBhc3N3b3JkRm9ybS5jb25maXJtUGFzc3dvcmQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignUGFzc3dvcmRzIGRvblxcJ3QgbWF0Y2ghJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1c2VyU2VydmljZS5yZXNldFBhc3N3b3JkKCRzdGF0ZVBhcmFtcy51c2VySWQsICRzdGF0ZVBhcmFtcy52ZXJpZmljYXRpb25Ub2tlbiwgcmVzZXRQYXNzd29yZEZvcm0ucGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlLmF1dGhlbnRpY2F0ZVVzZXIocmVzcG9uc2UuZGF0YS51c2VybmFtZSwgcmVzZXRQYXNzd29yZEZvcm0ucGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJywgUmVnaXN0ZXJDdHJsKTtcblxuICBmdW5jdGlvbiBSZWdpc3RlckN0cmwoJHN0YXRlLCBhdXRoU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucmVnaXN0ZXIgPSByZWdpc3RlcjtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHt9XG5cbiAgICBmdW5jdGlvbiByZWdpc3RlcihuZXdVc2VyKSB7XG4gICAgICBpZiAobmV3VXNlci5wYXNzd29yZCAhPT0gbmV3VXNlci5jb25maXJtUGFzc3dvcmQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignUGFzc3dvcmRzIGRvblxcJ3QgbWF0Y2ghJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhdXRoU2VydmljZS5jcmVhdGVVc2VyKG5ld1VzZXIpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICRzdGF0ZS5nbygndmVyaWZ5Jyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdWZXJpZmljYXRpb25DdHJsJywgVmVyaWZpY2F0aW9uQ3RybCk7XG5cbiAgZnVuY3Rpb24gVmVyaWZpY2F0aW9uQ3RybCgkc3RhdGUsICRzdGF0ZVBhcmFtcywgdXNlclNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnZlcmlmaWVkID0gdW5kZWZpbmVkO1xuICAgIHZtLnZlcmlmeWluZyA9IGZhbHNlO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy51c2VySWQgJiYgJHN0YXRlUGFyYW1zLnZlcmlmaWNhdGlvblRva2VuKSB7XG4gICAgICAgIHZtLnZlcmlmeWluZyA9IHRydWU7XG4gICAgICAgIHZtLnZlcmlmaWVkID0gbnVsbDtcbiAgICAgICAgdXNlclNlcnZpY2UudmVyaWZ5VXNlcigkc3RhdGVQYXJhbXMudXNlcklkLCAkc3RhdGVQYXJhbXMudmVyaWZpY2F0aW9uVG9rZW4pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICAgIHZtLnZlcmlmaWVkID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdm0udmVyaWZpZWQgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BBY3RpdmVDaGFsbGVuZWdlcycsIGtwQWN0aXZlQ2hhbGxlbmVnZXMpO1xuXG4gIGZ1bmN0aW9uIGtwQWN0aXZlQ2hhbGxlbmVnZXMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jaGFsbGVuZ2VzL2NvbXBvbmVudHMvYWN0aXZlLWNoYWxsZW5nZXMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlcygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZXMoKSB7XG4gICAgICB2bS5jaGFsbGVuZ2VzID0gW107XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIGlmIChjaGFsbGVuZ2VzLmRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZtLmNoYWxsZW5nZXMgPSBjaGFsbGVuZ2VzLmRhdGE7XG4gICAgICAgICAgXy5mb3JFYWNoKHZtLmNoYWxsZW5nZXMsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICAgIGlmIChjaGFsbGVuZ2UudGltZUxpbWl0ICE9PSAwKSB7XG4gICAgICAgICAgICAgIGNoYWxsZW5nZS5leHBpcmVzID0gKG1vbWVudCgpLmRpZmYobW9tZW50KGNoYWxsZW5nZS5jcmVhdGVkKS5hZGQoY2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2QnKSwncycpKSAqIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NyZWF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIGdldEFjdGl2ZUNoYWxsZW5nZXMoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpweXJhbWlkX3VwZGF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twQ29tcGxldGVkQ2hhbGxlbmVnZXMnLCBrcENvbXBsZXRlZENoYWxsZW5lZ2VzKTtcblxuICBmdW5jdGlvbiBrcENvbXBsZXRlZENoYWxsZW5lZ2VzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogJ0AnLFxuICAgICAgICBhbGxvd0RlbGV0ZTogJz0nLFxuICAgICAgICBsaW1pdDogJ0AnXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY2hhbGxlbmdlcy9jb21wb25lbnRzL2NvbXBsZXRlZC1jaGFsbGVuZ2VzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKCRzY29wZSwgJHN0YXRlLCBjaGFsbGVuZ2VzU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuICAgIHZtLmRlbGV0ZUNoYWxsZW5nZSA9IGRlbGV0ZUNoYWxsZW5nZTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGdldENvbXBsZXRlZENoYWxsZW5nZXMoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzKCkge1xuICAgICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCwgdm0ubGltaXQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZXMpIHtcbiAgICAgICAgaWYgKGNoYWxsZW5nZXMuZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdm0uY2hhbGxlbmdlcyA9IGNoYWxsZW5nZXMuZGF0YTtcbiAgICAgICAgICBfLmZvckVhY2godm0uY2hhbGxlbmdlcywgZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmxvc2VyID0gY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInID8gJ29wcG9uZW50JyA6ICdjaGFsbGVuZ2VyJztcbiAgICAgICAgICAgIGNoYWxsZW5nZS53aGVuQ29tcGxldGVkID0gbW9tZW50KGNoYWxsZW5nZS5jb21wbGV0ZWQpLmNhbGVuZGFyKG51bGwsIHtcbiAgICAgICAgICAgICAgc2FtZURheTogJ1tUb2RheV0nLFxuICAgICAgICAgICAgICBuZXh0RGF5OiAnW1RvbW9ycm93XScsXG4gICAgICAgICAgICAgIG5leHRXZWVrOiAnZGRkZCcsXG4gICAgICAgICAgICAgIGxhc3REYXk6ICdbWWVzdGVyZGF5XScsXG4gICAgICAgICAgICAgIGxhc3RXZWVrOiAnW0xhc3RdIGRkZGQnLFxuICAgICAgICAgICAgICBzYW1lRWxzZTogJ0REL01NL1lZWVknXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsZXRlQ2hhbGxlbmdlKGNoYWxsZW5nZUlkLCAkaW5kZXgpIHtcbiAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmRlbGV0ZUNoYWxsZW5nZSh2bS5jb21wZXRpdGlvbklkLCBjaGFsbGVuZ2VJZCkudGhlbiAoZnVuY3Rpb24gKCkge1xuICAgICAgICB2bS5jaGFsbGVuZ2VzLnNwbGljZSgkaW5kZXgsIDEpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jb21wbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2RlbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzKCk7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbygnQ2hhbGxlbmdlcyBVcGRhdGVkJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twUGxheWVyT3ZlcmFsbFJlc3VsdHMnLCBrcFBsYXllck92ZXJhbGxSZXN1bHRzKTtcblxuICBmdW5jdGlvbiBrcFBsYXllck92ZXJhbGxSZXN1bHRzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogJ0AnLFxuICAgICAgICBwbGF5ZXI6ICc9J1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NoYWxsZW5nZXMvY29tcG9uZW50cy9wbGF5ZXItb3ZlcmFsbC1yZXN1bHRzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGNoYWxsZW5nZXNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5tYXhMZXZlbHMgPSAxMDtcbiAgICB2bS53aW5zID0ge1xuICAgICAgdG90YWw6IDAsXG4gICAgICBhc0NoYWxsZW5nZXI6IDAsXG4gICAgICBhc09wcG9uZW50OiAwLFxuICAgICAgYnlGb3JmZWl0OiAwXG4gICAgfTtcbiAgICB2bS5sb3NlcyA9IHtcbiAgICAgIHRvdGFsOiAwLFxuICAgICAgYXNDaGFsbGVuZ2VyOiAwLFxuICAgICAgYXNPcHBvbmVudDogMCxcbiAgICAgIGJ5Rm9yZmVpdDogMFxuICAgIH07XG4gICAgdm0uc3RyZWFrID0ge1xuICAgICAgdHlwZTogbnVsbCxcbiAgICAgIHZhbHVlOiAwXG4gICAgfTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGdldFBsYXllck92ZXJhbGxSZXN1bHRzKHZtLmNvbXBldGl0aW9uSWQsIHZtLnBsYXllci5faWQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFBsYXllck92ZXJhbGxSZXN1bHRzKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRQbGF5ZXJSZXN1bHRzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkudGhlbihmdW5jdGlvbiAocmVzdWx0cykge1xuXG4gICAgICAgIC8vIERldGVybWluZSBhbGwgdGhlIGJyZWFrIHBvaW50cyB0byBmaWd1cmUgb3V0IGxldmVsc1xuICAgICAgICB2YXIgYnJlYWtQb2ludHMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2bS5tYXhMZXZlbHM7IGkrKykge1xuICAgICAgICAgIGJyZWFrUG9pbnRzLnB1c2goKCgoaSAqIChpICsgMSkpIC8gMikpICsgMSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZhdWx0IGFsbCBwbGF5ZXJzIHRvIHRoZSBsb3dlc3QgbGV2ZWxcbiAgICAgICAgdm0ucGxheWVyLmxldmVsID0gYnJlYWtQb2ludHMubGVuZ3RoO1xuICAgICAgICAvLyBOb3cgY2hlY2sgdG8gc2VlIGlmIHRoZSBwbGF5ZXIgaXMgYXQgYSBoaWdoZXIgbGV2ZWxcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBicmVha1BvaW50cy5sZW5ndGg7IGorKykge1xuICAgICAgICAgIGlmICh2bS5wbGF5ZXIucG9zaXRpb24gPCBicmVha1BvaW50c1tqICsgMV0pIHtcbiAgICAgICAgICAgIHZtLnBsYXllci5sZXZlbCA9IGJyZWFrUG9pbnRzLmluZGV4T2YoYnJlYWtQb2ludHNbal0pICsgMTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIHBsYXllcidzIGN1cnJlbnQgc3RyZWFrXG4gICAgICAgIHZhciBzdHJlYWsgPSAwO1xuICAgICAgICB2YXIgY29udGludWVTdHJlYWsgPSB0cnVlO1xuICAgICAgICB2YXIgc3RyZWFrVHlwZTtcbiAgICAgICAgXy5mb3JFYWNoKHJlc3VsdHMuZGF0YSwgZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgIGlmIChjb250aW51ZVN0cmVhaykge1xuICAgICAgICAgICAgLy8gV2lubmluZyBTdHJlYWtcbiAgICAgICAgICAgIGlmICgoY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInICYmIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVySWQpIHx8XG4gICAgICAgICAgICAgIChjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnICYmIGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkKSkge1xuICAgICAgICAgICAgICAvLyBJZiB0aGV5IGFyZSBub3QgYWxyZWFkeSBvbiBhIGxvc2luZyBzdHJlYWsgYW5kIDEgdG8gdGhlaXIgd2lubmluZyBzdHJlYWtcbiAgICAgICAgICAgICAgaWYgKHN0cmVha1R5cGUgIT09ICdsb3NpbmcnKSB7XG4gICAgICAgICAgICAgICAgc3RyZWFrICs9IDE7XG4gICAgICAgICAgICAgICAgc3RyZWFrVHlwZSA9ICd3aW5uaW5nJztcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZVN0cmVhayA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBMb3NpbmcgU3RyZWFrXG4gICAgICAgICAgICB9IGVsc2UgaWYgKChjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnICYmIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVySWQpIHx8XG4gICAgICAgICAgICAgIChjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcicgJiYgY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVySWQpKSB7XG4gICAgICAgICAgICAgIC8vIElmIHRoZXkgYXJlIG5vdCBhbHJlYWR5IG9uIGEgd2lubmluZyBzdHJlYWsgYW5kIDEgdG8gdGhlaXIgbG9zaW5nIHN0cmVha1xuICAgICAgICAgICAgICBpZiAoc3RyZWFrVHlwZSAhPT0gJ3dpbm5pbmcnKSB7XG4gICAgICAgICAgICAgICAgc3RyZWFrICs9IDE7XG4gICAgICAgICAgICAgICAgc3RyZWFrVHlwZSA9ICdsb3NpbmcnO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlU3RyZWFrID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdm0uc3RyZWFrID0ge1xuICAgICAgICAgICAgdHlwZTogc3RyZWFrVHlwZSxcbiAgICAgICAgICAgIHZhbHVlOiBzdHJlYWtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBGaWd1cmUgb3V0IHdpbnMgYW5kIGxvc2VzXG4gICAgICAgIHZtLndpbnMuYXNPcHBvbmVudCA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVySWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50J1xuICAgICAgICAgICk7XG4gICAgICAgIH0pKTtcblxuICAgICAgICB2bS53aW5zLmFzQ2hhbGxlbmdlciA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcidcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgdm0ud2lucy50b3RhbCA9IHZtLndpbnMuYXNDaGFsbGVuZ2VyICsgdm0ud2lucy5hc09wcG9uZW50O1xuXG4gICAgICAgIHZtLndpbnMuYnlGb3JmZWl0ID0gXy5zaXplKF8uZmlsdGVyKHJlc3VsdHMuZGF0YSwgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBjaGFsbGVuZ2UuZm9yZmVpdCAmJiAoKGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVySWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInKSB8fFxuICAgICAgICAgICAgKGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCcpKVxuICAgICAgICAgICk7XG4gICAgICAgIH0pKTtcblxuICAgICAgICB2bS5sb3Nlcy5hc09wcG9uZW50ID0gXy5zaXplKF8uZmlsdGVyKHJlc3VsdHMuZGF0YSwgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcidcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgdm0ubG9zZXMuYXNDaGFsbGVuZ2VyID0gXy5zaXplKF8uZmlsdGVyKHJlc3VsdHMuZGF0YSwgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCdcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgdm0ubG9zZXMudG90YWwgPSB2bS5sb3Nlcy5hc0NoYWxsZW5nZXIgKyB2bS5sb3Nlcy5hc09wcG9uZW50O1xuXG4gICAgICAgIHZtLmxvc2VzLmJ5Rm9yZmVpdCA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLmZvcmZlaXQgJiYgKChjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCcpIHx8XG4gICAgICAgICAgICAoY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVySWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInKSlcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnY2hhbGxlbmdlc1NlcnZpY2UnLCBjaGFsbGVuZ2VzU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gY2hhbGxlbmdlc1NlcnZpY2UoJGh0dHApIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGNyZWF0ZUNoYWxsZW5nZTogY3JlYXRlQ2hhbGxlbmdlLFxuICAgICAgY29tcGxldGVDaGFsbGVuZ2U6IGNvbXBsZXRlQ2hhbGxlbmdlLFxuICAgICAgZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyOiBnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIsXG4gICAgICBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbjogZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24sXG4gICAgICBkZWxldGVBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXI6IGRlbGV0ZUFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcixcbiAgICAgIGRlbGV0ZUNoYWxsZW5nZTogZGVsZXRlQ2hhbGxlbmdlLFxuICAgICAgZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb246IGdldFBsYXllclJlc3VsdHNCeUNvbXBldGl0aW9uXG4gICAgfTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gY3JlYXRlQ2hhbGxlbmdlKGNoYWxsZW5nZSkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvY2hhbGxlbmdlcy9jcmVhdGUnLCB7XG4gICAgICAgIGNoYWxsZW5nZTogY2hhbGxlbmdlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb21wbGV0ZUNoYWxsZW5nZShjaGFsbGVuZ2UpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NoYWxsZW5nZXMvY29tcGxldGUnLCAge1xuICAgICAgICBjaGFsbGVuZ2U6IGNoYWxsZW5nZVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2NvbXBldGl0aW9uJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvYWN0aXZlL2NvbXBldGl0aW9uJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIoY29tcGV0aXRpb25JZCwgcGxheWVySWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9hY3RpdmUvY29tcGV0aXRpb24vcGxheWVyJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBwbGF5ZXJJZDogcGxheWVySWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCwgbGltaXQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9jb21wbGV0ZWQvY29tcGV0aXRpb24nLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICAgIGxpbWl0OiBsaW1pdFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIoY29tcGV0aXRpb25JZCwgcGxheWVySWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5kZWxldGUoJy9hcGkvY2hhbGxlbmdlcy9hY3RpdmUvY29tcGV0aXRpb24vcGxheWVyL2RlbGV0ZScsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgcGxheWVySWQ6IHBsYXllcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbGV0ZUNoYWxsZW5nZShjb21wZXRpdGlvbklkLCBjaGFsbGVuZ2VJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS9jaGFsbGVuZ2VzL2RlbGV0ZScsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgY2hhbGxlbmdlSWQ6IGNoYWxsZW5nZUlkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFBsYXllclJlc3VsdHNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvcmVzdWx0cy9jb21wZXRpdGlvbi9wbGF5ZXInLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICAgIHBsYXllcklkOiBwbGF5ZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twRm9vdGVyJywga3BGb290ZXIpO1xuXG4gIGZ1bmN0aW9uIGtwRm9vdGVyKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY29tbW9uL2NvbXBvbmVudHMvZm9vdGVyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmluZGVudGl0eSA9IGlkZW50aXR5U2VydmljZTtcbiAgICB2bS5sb2dvdXQgPSBsb2dvdXQ7XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twSGVhZGVyJywga3BIZWFkZXIpO1xuXG4gIGZ1bmN0aW9uIGtwSGVhZGVyKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICdoZWFkZXJDdHJsJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9oZWFkZXIuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoc2lkZWJhclNlcnZpY2UsIGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmluZGVudGl0eSA9IGlkZW50aXR5U2VydmljZTtcbiAgICB2bS5sb2dvdXQgPSBsb2dvdXQ7XG4gICAgdm0uc2lkZWJhclN0YXR1cyA9IHNpZGViYXJTZXJ2aWNlLmdldFNpZGViYXJTdGF0dXMoKTtcbiAgICB2bS50b2dnbGVTaWRlYmFyID0gdG9nZ2xlU2lkZWJhcjtcblxuICAgIGZ1bmN0aW9uIHRvZ2dsZVNpZGViYXIoKSB7XG4gICAgICB2bS5zaWRlYmFyU3RhdHVzLmxlZnQgPSAhdm0uc2lkZWJhclN0YXR1cy5sZWZ0O1xuICAgICAgc2lkZWJhclNlcnZpY2Uuc2V0U2lkZWJhclN0YXR1cyh2bS5zaWRlYmFyU3RhdHVzLmxlZnQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BTaWRlYmFyJywga3BTaWRlYmFyKTtcblxuICBmdW5jdGlvbiBrcFNpZGViYXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3NpZGViYXJDdHJsJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9zaWRlYmFyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UsIHNpZGViYXJTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pbmRlbnRpdHkgPSBpZGVudGl0eVNlcnZpY2U7XG4gICAgdm0ubG9nb3V0ID0gbG9nb3V0O1xuICAgIHZtLnNpZGViYXJTdGF0dXMgPSBzaWRlYmFyU2VydmljZS5nZXRTaWRlYmFyU3RhdHVzKCk7XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmlsdGVyKCdvcmRlck9iamVjdEJ5Jywgb3JkZXJPYmplY3RCeSk7XG5cbiAgZnVuY3Rpb24gb3JkZXJPYmplY3RCeSgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGlucHV0LCBhdHRyaWJ1dGUpIHtcbiAgICAgIGlmICghYW5ndWxhci5pc09iamVjdChpbnB1dCkpIHJldHVybiBpbnB1dDtcblxuICAgICAgdmFyIGFycmF5ID0gW107XG4gICAgICBmb3IgKHZhciBvYmplY3RLZXkgaW4gaW5wdXQpIHtcbiAgICAgICAgYXJyYXkucHVzaChpbnB1dFtvYmplY3RLZXldKTtcbiAgICAgIH1cblxuICAgICAgYXJyYXkuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICBhID0gcGFyc2VJbnQoYVthdHRyaWJ1dGVdKTtcbiAgICAgICAgYiA9IHBhcnNlSW50KGJbYXR0cmlidXRlXSk7XG4gICAgICAgIHJldHVybiBhIC0gYjtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH07XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnaWRlbnRpdHlTZXJ2aWNlJywgaWRlbnRpdHlTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBpZGVudGl0eVNlcnZpY2UoJHdpbmRvdykge1xuICAgIHZhciBjdXJyZW50VXNlcjtcbiAgICBpZiAoJHdpbmRvdy5ib290c3RyYXBwZWRVc2VyT2JqZWN0ICE9PSBudWxsKSB7XG4gICAgICBjdXJyZW50VXNlciA9ICR3aW5kb3cuYm9vdHN0cmFwcGVkVXNlck9iamVjdDtcbiAgICB9XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBjdXJyZW50VXNlcjogY3VycmVudFVzZXIsXG4gICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGlzQXV0aGVudGljYXRlZCxcbiAgICAgIGlzQXV0aG9yaXplZDogaXNBdXRob3JpemVkXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZCgpIHtcbiAgICAgIHJldHVybiAhIXRoaXMuY3VycmVudFVzZXI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNBdXRob3JpemVkKHJvbGUpIHtcbiAgICAgIHJldHVybiAhIXRoaXMuY3VycmVudFVzZXIgJiYgdGhpcy5jdXJyZW50VXNlci5yb2xlcy5pbmRleE9mKHJvbGUpID4gLTE7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmZhY3RvcnkoJ25vdGlmeVNlcnZpY2UnLCBub3RpZnlTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBub3RpZnlTZXJ2aWNlKCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgaW5mbzogaW5mbyxcbiAgICAgIHN1Y2Nlc3M6IHN1Y2Nlc3MsXG4gICAgICB3YXJuaW5nOiB3YXJuaW5nLFxuICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgaW52ZXJzZTogaW52ZXJzZVxuICAgIH07XG5cbiAgICAkLm5vdGlmeURlZmF1bHRzKHtcbiAgICAgIG5ld2VzdF9vbl90b3A6IHRydWUsXG4gICAgICBvZmZzZXQ6IHtcbiAgICAgICAgeDogMjAsXG4gICAgICAgIHk6IDg1XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGluZm8obWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ2luZm8nXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdzdWNjZXNzJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd2FybmluZyhtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnd2FybmluZydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdkYW5nZXInXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnZlcnNlKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdpbnZlcnNlJ1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmZhY3RvcnkoJ3Njcm9sbGJhclNlcnZpY2UnLCBzY3JvbGxiYXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBzY3JvbGxiYXJTZXJ2aWNlKCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgbWFsaWh1U2Nyb2xsOiBtYWxpaHVTY3JvbGxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBtYWxpaHVTY3JvbGwoc2VsZWN0b3IsIHRoZW1lLCBzY3JvbGxheGlzLCBtb3VzZXdoZWVsYXhpcykge1xuICAgICAgJChzZWxlY3RvcikubUN1c3RvbVNjcm9sbGJhcih7XG4gICAgICAgIHRoZW1lOiB0aGVtZSxcbiAgICAgICAgc2Nyb2xsSW5lcnRpYTogMTAwLFxuICAgICAgICBheGlzOiBzY3JvbGxheGlzLFxuICAgICAgICBtb3VzZVdoZWVsOiB7XG4gICAgICAgICAgZW5hYmxlOiB0cnVlLFxuICAgICAgICAgIGF4aXM6IG1vdXNld2hlZWxheGlzLFxuICAgICAgICAgIHByZXZlbnREZWZhdWx0OiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdzaWRlYmFyU2VydmljZScsIHNpZGViYXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBzaWRlYmFyU2VydmljZSgpIHtcbiAgICB2YXIgc2lkZWJhclN0YXR1cyA9IHtcbiAgICAgIGxlZnQ6IGZhbHNlLFxuICAgICAgcmlnaHQ6IGZhbHNlXG4gICAgfTtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGdldFNpZGViYXJTdGF0dXM6IGdldFNpZGViYXJTdGF0dXMsXG4gICAgICBzZXRTaWRlYmFyU3RhdHVzOiBzZXRTaWRlYmFyU3RhdHVzXG4gICAgfTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gZ2V0U2lkZWJhclN0YXR1cygpIHtcbiAgICAgIHJldHVybiBzaWRlYmFyU3RhdHVzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFNpZGViYXJTdGF0dXMoc3RhdHVzKSB7XG4gICAgICBzaWRlYmFyU3RhdHVzLmxlZnQgPSBzdGF0dXM7XG4gICAgfVxuICB9XG59KSgpOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAuc2VydmljZSgnd2Vic29ja2V0U2VydmljZScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkd2luZG93KSB7XG4gICAgZnVuY3Rpb24gd2Vic29ja2V0SG9zdCgpIHtcbiAgICAgIGlmICgkd2luZG93LmxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cHM6Jykge1xuICAgICAgICByZXR1cm4gJ3dzczovLycgKyAkd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJ3dzOi8vJyArICR3aW5kb3cubG9jYXRpb24uaG9zdDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgY29ubmVjdGlvbjtcbiAgICB0aGlzLmNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh3ZWJzb2NrZXRIb3N0KCkpO1xuXG4gICAgICBjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpO1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3dzOicgKyBwYXlsb2FkLnRvcGljLCBwYXlsb2FkLmRhdGEpO1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgdGhpcy5zZW5kID0gZnVuY3Rpb24gKHRvcGljLCBkYXRhKSB7XG4gICAgICB2YXIganNvbiA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgdG9waWM6IHRvcGljLFxuICAgICAgICBkYXRhOiBkYXRhXG4gICAgICB9KTtcbiAgICAgIGNvbm5lY3Rpb24uc2VuZChqc29uKTtcbiAgICB9O1xuICB9KS5ydW4oZnVuY3Rpb24gKHdlYnNvY2tldFNlcnZpY2UpIHtcbiAgICB3ZWJzb2NrZXRTZXJ2aWNlLmNvbm5lY3QoKTtcbiAgfSk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignSG9tZUN0cmwnLCBIb21lQ3RybCk7XG5cbiAgZnVuY3Rpb24gSG9tZUN0cmwoKSB7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFBlbmRpbmdQbGF5ZXJzJywga3BQZW5kaW5nUGxheWVycyk7XG5cbiAgZnVuY3Rpb24ga3BQZW5kaW5nUGxheWVycygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHB5cmFtaWQ6ICc9J1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3B5cmFtaWRzL2NvbXBvbmVudHMvcGVuZGluZy1wbGF5ZXJzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKHB5cmFtaWRzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucGVuZGluZ1BsYXllcnMgPSBbXTtcbiAgICB2bS5hcHByb3ZlUGVuZGluZ1BsYXllciA9IGFwcHJvdmVQZW5kaW5nUGxheWVyO1xuICAgIHZtLmRlbnlQZW5kaW5nUGxheWVyID0gZGVueVBlbmRpbmdQbGF5ZXI7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuXG4gICAgZnVuY3Rpb24gYXBwcm92ZVBlbmRpbmdQbGF5ZXIocGxheWVyKSB7XG4gICAgICBwbGF5ZXIucG9zaXRpb24gPSB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoICsgMTtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5hcHByb3ZlUGVuZGluZ1BsYXllcih2bS5weXJhbWlkLl9pZCwgcGxheWVyKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZW55UGVuZGluZ1BsYXllcihwbGF5ZXIpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5kZW55UGVuZGluZ1BsYXllcih2bS5weXJhbWlkLl9pZCwgcGxheWVyKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twUHlyYW1pZENvbXBhY3QnLCBrcFB5cmFtaWRDb21wYWN0KTtcblxuICBmdW5jdGlvbiBrcFB5cmFtaWRDb21wYWN0KCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgdHlwZTogJ0AnLFxuXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvcHlyYW1pZHMvY29tcG9uZW50cy9weXJhbWlkLWNvbXBhY3QuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMocHlyYW1pZHNTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnB5cmFtaWRzID0gbnVsbDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICh2bS50eXBlID09PSAndXNlcicpIHtcbiAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWRzRm9yVXNlcihpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkcykge1xuICAgICAgICAgIHZtLnB5cmFtaWRzID0gcHlyYW1pZHMuZGF0YTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZHMoKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkcykge1xuICAgICAgICAgIHZtLnB5cmFtaWRzID0gcHlyYW1pZHMuZGF0YTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BQeXJhbWlkJywga3BQeXJhbWlkKTtcblxuICBmdW5jdGlvbiBrcFB5cmFtaWQoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9weXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQuaHRtbCcsXG4gICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogJ0AnXG4gICAgICB9LFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCAkc3RhdGUsIHB5cmFtaWRzU2VydmljZSwgJGZpbHRlciwgbm90aWZ5U2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciBtYXhMZXZlbHMgPSAxMDtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnB5cmFtaWQgPSB7fTtcbiAgICB2bS5icmVha1BvaW50cyA9IFtdO1xuICAgIHZtLmxldmVscyA9IFtdO1xuICAgIHZtLm51bWJlck9mQmxvY2tzID0gMDtcbiAgICB2bS5jdXJyZW50VXNlcklzT25QeXJhbWlkID0gZmFsc2U7XG4gICAgdm0uY3VycmVudFVzZXJJc1BlbmRpbmcgPSBmYWxzZTtcbiAgICB2bS5jdXJyZW50VXNlcklzT3duZXIgPSBmYWxzZTtcbiAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcbiAgICB2bS5hY3RpdmVDaGFsbGVuZ2VPcHBvbmVudCA9IG51bGw7XG4gICAgdm0uYXZhaWxhYmxlQ2hhbGxlbmdlcyA9IGZhbHNlO1xuICAgIHZtLmNyZWF0ZUNoYWxsZW5nZSA9IGNyZWF0ZUNoYWxsZW5nZTtcbiAgICB2bS5jb21wbGV0ZUNoYWxsZW5nZSA9IGNvbXBsZXRlQ2hhbGxlbmdlO1xuICAgIHZtLmNoYWxsZW5nZUV4cGlyZWQgPSBjaGFsbGVuZ2VFeHBpcmVkO1xuICAgIHZtLmN1cnJlbnRVc2VyUGxheWVyID0ge307XG4gICAgdm0ucHlyYW1pZE1lbnVUb2dnbGUgPSBmYWxzZTtcbiAgICB2bS5hZGRDdXJyZW50VXNlclRvUHlyYW1pZCA9IGFkZEN1cnJlbnRVc2VyVG9QeXJhbWlkO1xuICAgIHZtLmNvbmZpcm1SZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkID0gY29uZmlybVJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQ7XG4gICAgdm0ubnVtYmVyT2ZSZWFsUGxheWVycyA9IDA7XG4gICAgdm0ubWF4UGxheWVycyA9IDA7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgIC8vIERldGVybWluZSB0aGUgbWF4aW11bSBudW1iZXIgb2YgcGxheWVycyBiYXNlZCBvbiB0aGUgbWF4aW11bSBudW1iZXIgb2YgbGV2ZWxzXG4gICAgICAgIGZvciAodmFyIGkgPSBtYXhMZXZlbHM7IGkgPiAwOyAtLWkpIHtcbiAgICAgICAgICB2bS5tYXhQbGF5ZXJzICs9IGk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocHlyYW1pZC5kYXRhKSB7XG4gICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcblxuICAgICAgICAgIG9yZGVyUGxheWVycygpO1xuICAgICAgICAgIGdldFBsYXllcnNTdGF0dXMoKTtcbiAgICAgICAgICBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKTtcbiAgICAgICAgICBjYWxjdWxhdGVQeXJhbWlkQmxvY2tzKCk7XG4gICAgICAgICAgZmlsbEluRW1wdHlCbG9ja3MoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3JkZXIgdGhlIHBsYXllcnMgYnkgdGhlIHBvc2l0aW9uIHByb3BlcnR5IG9mIHRoZSBwbGF5ZXJzIGFycmF5IGluIHRoZSBweXJhbWlkIG9iamVjdFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9yZGVyUGxheWVycygpIHtcbiAgICAgIHZtLnB5cmFtaWQucGxheWVycyA9ICRmaWx0ZXIoJ29yZGVyQnknKSh2bS5weXJhbWlkLnBsYXllcnMsICdwb3NpdGlvbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpZ3VyZSBvdXQgaWYgZWFjaCBwbGF5ZXIgaXMgYWxyZWFkeSBjaGFsbGVuZ2VkIGFuZCBzZXQgc29tZSBzdHVmZlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFBsYXllcnNTdGF0dXMoKSB7XG4gICAgICBcbiAgICAgIHZtLmN1cnJlbnRVc2VySXNPd25lciA9IGZhbHNlO1xuICAgICAgdm0uY3VycmVudFVzZXJJc1BlbmRpbmcgPSBmYWxzZTtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHRoZSBjdXJyZW50IHVzZXIgaXMgYW4gb3duZXIgb2YgdGhpcyBweXJhbWlkXG4gICAgICAgIHZtLmN1cnJlbnRVc2VySXNPd25lciA9IF8uc29tZSh2bS5weXJhbWlkLm93bmVycywgWydfaWQnLCBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkXSk7XG4gICAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBhIHBlbmRpbmcgcmVxdWVzdCB0byBqb2luXG4gICAgICAgIHZtLmN1cnJlbnRVc2VySXNQZW5kaW5nID0gXy5zb21lKHZtLnB5cmFtaWQucGVuZGluZ1BsYXllcnMsIFsnX2lkJywgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZF0pO1xuICAgICAgfVxuXG4gICAgICB2bS5jdXJyZW50VXNlcklzT25QeXJhbWlkID0gZmFsc2U7XG4gICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcbiAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgLy8gRmluZCB0aGUgY3VycmVudCB1c2VyIGlmIHRoZXkgYXJlIG9uIHRoaXMgcHlyYW1pZCBhbmQgc2V0IHNvbWUgcHJvcGVydGllc1xuICAgICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpICYmIHBsYXllci5faWQgPT09IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQpIHtcbiAgICAgICAgICB2bS5jdXJyZW50VXNlcklzT25QeXJhbWlkID0gdHJ1ZTtcbiAgICAgICAgICBwbGF5ZXIuY2xhc3MgPSAnY3VycmVudC11c2VyJztcbiAgICAgICAgICB2bS5jdXJyZW50VXNlclBsYXllciA9IHBsYXllcjtcblxuICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIGFuIGFjdGl2ZSBjaGFsbGVuZ2VcbiAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIodm0uY29tcGV0aXRpb25JZCwgcGxheWVyLl9pZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEpIHtcbiAgICAgICAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgdm0uYWN0aXZlQ2hhbGxlbmdlT3Bwb25lbnQgPSBjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVyLl9pZCA/IGNoYWxsZW5nZS5kYXRhLm9wcG9uZW50IDogY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZXMpIHtcbiAgICAgICAgXy5mb3JFYWNoKGNoYWxsZW5nZXMuZGF0YSwgZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuXG4gICAgICAgICAgdmFyIGNoYWxsZW5nZXIgPSBfLmZpbmQodm0ucHlyYW1pZC5wbGF5ZXJzLCB7ICdfaWQnOiBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgfSk7XG4gICAgICAgICAgY2hhbGxlbmdlci5jbGFzcyA9ICd1bmF2YWlsYWJsZSc7XG4gICAgICAgICAgY2hhbGxlbmdlci5jaGFsbGVuZ2UgPSB7XG4gICAgICAgICAgICBwb3NpdGlvbjogJ2NoYWxsZW5nZXInXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHZhciBvcHBvbmVudCA9IF8uZmluZCh2bS5weXJhbWlkLnBsYXllcnMsIHsgJ19pZCc6IGNoYWxsZW5nZS5vcHBvbmVudC5faWQgfSk7XG4gICAgICAgICAgb3Bwb25lbnQuY2xhc3MgPSAndW5hdmFpbGFibGUnO1xuICAgICAgICAgIG9wcG9uZW50LmNoYWxsZW5nZSA9IHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnb3Bwb25lbnQnXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIC8vIFRyYWNrIHdoZW4gdGhlIGNoYWxsZW5nZSB3aWxsIGV4cGlyZVxuICAgICAgICAgIGlmIChjaGFsbGVuZ2UudGltZUxpbWl0ICE9PSAwKSB7XG4gICAgICAgICAgICB2YXIgdGltZVRvRXhwaXJlID0gbW9tZW50KCkuZGlmZihtb21lbnQoY2hhbGxlbmdlLmNyZWF0ZWQpLmFkZChjaGFsbGVuZ2UudGltZUxpbWl0LCAnZCcpLCAncycpICogLTE7XG4gICAgICAgICAgICAvLyBJZiB0aGUgY2hhbGxlbmdlIGhhcyBub3QgeWV0IGV4cGlyZWQgZGlzcGxheSBhIGNvdW50ZG93biBvbiB0aGUgb3Bwb25lbnRcbiAgICAgICAgICAgIGlmICh0aW1lVG9FeHBpcmUgPiAwKSB7XG4gICAgICAgICAgICAgIG9wcG9uZW50LmNoYWxsZW5nZS5leHBpcmVzID0gdGltZVRvRXhwaXJlO1xuICAgICAgICAgICAgICAvLyBJZiB0aGUgY2hhbGxlbmdlIGV4cGlyZWQgd2hpbGUgbm8gb25lIHdhcyB2aWV3aW5nIHRoaXMgcHlyYW1pZCBjb21wbGV0ZSB0aGUgY2hhbGxlbmdlIGJ5IGZvcmZlaXRcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGltZVRvRXhwaXJlIDw9IDApIHtcbiAgICAgICAgICAgICAgY29tcGxldGVDaGFsbGVuZ2UobnVsbCwgdHJ1ZSwgb3Bwb25lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIE5vdyB0aGF0IHdlIGtub3cgd2hpY2ggcGxheWVycyBhcmUgaW4gY2hhbGxlbmdlcyBhbmQgd2hpY2ggYXJlbid0XG4gICAgICAgIC8vIGZpbmQgdGhlIGF2YWlsYWJsZSBjaGFsbGVuZ2VzIGZvciB0aGlzIHVzZXJcbiAgICAgICAgZmluZEF2YWlsYWJsZUNoYWxsZW5nZXMoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpZ3VyZSBvdXQgd2hlcmUgdG8gc3RhcnQgZWFjaCBuZXcgcm93IG9uIHRoZSBweXJhbWlkXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlQnJlYWtQb2ludHMoKSB7XG4gICAgICB2bS5icmVha1BvaW50cyA9IFtdO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXhMZXZlbHM7IGkrKykge1xuICAgICAgICB2bS5icmVha1BvaW50cy5wdXNoKCgoKGkgKiAoaSArIDEpKSAvIDIpKSArIDEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdpdmUgZWFjaCBwbGF5ZXIgYSBsZXZlbCBwcm9wZXJ0eSBiYXNlZCBvbiB0aGUgYnJlYWsgcG9pbnRzXG4gICAgLy8gVGhpcyB3aWxsIGJlIHVzZWQgdG8gZGV0ZXJtaW5lIHdobyBvdGhlciBwbGF5ZXJzIGNhbiBjaGFsbGVuZ2VcbiAgICBmdW5jdGlvbiBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKSB7XG4gICAgICB2YXIgbGV2ZWwgPSAwO1xuICAgICAgdm0ubGV2ZWxzID0gW107XG4gICAgICBjcmVhdGVCcmVha1BvaW50cygpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHZtLmJyZWFrUG9pbnRzLmluZGV4T2YoaSArIDEpID4gLTEpIHtcbiAgICAgICAgICBsZXZlbCArPSAxO1xuICAgICAgICAgIC8vIFNldCB0aGUgbnVtYmVyIG9mIHRvdGFsIGxldmVsc1xuICAgICAgICAgIHZtLmxldmVscy5wdXNoKGxldmVsKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBHaXZlIGVhY2ggcGxheWVyIGEgbGV2ZWxcbiAgICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzW2ldLmxldmVsID0gbGV2ZWw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSG93IG1hbnkgdG90YWwgYmxvY2tzIGluIHRoaXMgcHlyYW1pZFxuICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVB5cmFtaWRCbG9ja3MoKSB7XG4gICAgICB2bS5udW1iZXJPZkJsb2NrcyA9IDA7XG4gICAgICBmb3IgKHZhciBpID0gXy5sYXN0KHZtLmxldmVscyk7IGkgPiAwOyBpLS0pIHtcbiAgICAgICAgdm0ubnVtYmVyT2ZCbG9ja3MgKz0gaTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGaWxsIG91dCB0aGUgcmVtYWluaW5nIGJsb2NrcyBvZiB0aGUgcHlyYW1pZCB3aXRoIGVtcHR5IGJsb2Nrc1xuICAgIGZ1bmN0aW9uIGZpbGxJbkVtcHR5QmxvY2tzKCkge1xuICAgICAgdm0ubnVtYmVyT2ZSZWFsUGxheWVycyA9IHZtLnB5cmFtaWQucGxheWVycy5sZW5ndGg7XG4gICAgICBmb3IgKHZhciBpID0gdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDsgaSA8IHZtLm51bWJlck9mQmxvY2tzOyBpKyspIHtcbiAgICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzLnB1c2goe1xuICAgICAgICAgIGZpcnN0TmFtZTogJ0VtcHR5JyxcbiAgICAgICAgICBsYXN0TmFtZTogJ1Nwb3QnLFxuICAgICAgICAgIHBvc2l0aW9uOiA5OSxcbiAgICAgICAgICBjbGFzczogJ2VtcHR5J1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIC8vIFdlIGhhdmUgdG8gZ2l2ZSBsZXZlbHMgdG8gdGhlIG5ldyBlbXB0eSBzcG90c1xuICAgICAgYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCk7XG4gICAgfVxuXG4gICAgLy8gRmluZCBhbGwgdGhlIHBsYXllcnMgdGhhdCBhcmUgYXZhaWxhYmxlIHRvIGJlIGNoYWxsZW5nZWQgYnkgdGhpcyB1c2VyXG4gICAgZnVuY3Rpb24gZmluZEF2YWlsYWJsZUNoYWxsZW5nZXMoKSB7XG4gICAgICB2YXIgbGV2ZWxBYm92ZSA9IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxldmVsID4gMSA/IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxldmVsIC0gMSA6IG51bGw7XG4gICAgICBfLmZvckVhY2godm0ucHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIGlmIChwbGF5ZXIubGV2ZWwgPT09IGxldmVsQWJvdmUgJiYgcGxheWVyLnBvc2l0aW9uICE9PSA5OSAmJiBwbGF5ZXIuY2xhc3MgIT09ICd1bmF2YWlsYWJsZScpIHtcbiAgICAgICAgICB2bS5hdmFpbGFibGVDaGFsbGVuZ2VzID0gdHJ1ZTtcbiAgICAgICAgICBwbGF5ZXIuYXZhaWxhYmxlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlQ2hhbGxlbmdlKHBsYXllcikge1xuICAgICAgaWYgKCFwbGF5ZXIuYXZhaWxhYmxlKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1NvcnJ5LCB0aGF0IGlzIG5vdCBhIHZhbGlkIGNoYWxsZW5nZS4nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IHRydWU7XG4gICAgICAgIHZhciBjaGFsbGVuZ2UgPSB7XG4gICAgICAgICAgY29tcGV0aXRpb25OYW1lOiB2bS5weXJhbWlkLm5hbWUsXG4gICAgICAgICAgY29tcGV0aXRpb25JZDogdm0uY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBjb21wbGV0ZTogZmFsc2UsXG4gICAgICAgICAgZm9yZmVpdDogZmFsc2UsXG4gICAgICAgICAgdGltZUxpbWl0OiB2bS5weXJhbWlkLmZvcmZlaXREYXlzLFxuICAgICAgICAgIGNoYWxsZW5nZXI6IHtcbiAgICAgICAgICAgIF9pZDogdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkLFxuICAgICAgICAgICAgZW1haWw6IHZtLmN1cnJlbnRVc2VyUGxheWVyLmVtYWlsLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiB2bS5jdXJyZW50VXNlclBsYXllci5maXJzdE5hbWUsXG4gICAgICAgICAgICBsYXN0TmFtZTogdm0uY3VycmVudFVzZXJQbGF5ZXIubGFzdE5hbWUsXG4gICAgICAgICAgICBwb3NpdGlvbjogdm0uY3VycmVudFVzZXJQbGF5ZXIucG9zaXRpb25cbiAgICAgICAgICB9LFxuICAgICAgICAgIG9wcG9uZW50OiB7XG4gICAgICAgICAgICBfaWQ6IHBsYXllci5faWQsXG4gICAgICAgICAgICBlbWFpbDogcGxheWVyLmVtYWlsLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiBwbGF5ZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgbGFzdE5hbWU6IHBsYXllci5sYXN0TmFtZSxcbiAgICAgICAgICAgIHBvc2l0aW9uOiBwbGF5ZXIucG9zaXRpb25cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIENyZWF0ZSB0aGUgY2hhbGxlbmdlXG4gICAgICAgIC8vIFdlYnNvY2tldCBldmVudCB3aWxsIHJlZnJlc2ggdGhlIHB5cmFtaWRcbiAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY3JlYXRlQ2hhbGxlbmdlKGNoYWxsZW5nZSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdm0ucHlyYW1pZE1lbnVUb2dnbGUgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbXBsZXRlIGEgY2hhbGxlbmdlIGJ5IGEgdXNlciBpbnRlcmFjdGlvbiBvciBhIGZvcmZlaXRcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSB3aW5uZXJJc0N1cnJlbnRVc2VyXG4gICAgICogQHBhcmFtICB7Ym9vbGVhbn0gZm9yZmVpdFxuICAgICAqIEBwYXJhbSAge29iamVjdH0gZm9yZmVpdExvc2VyXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29tcGxldGVDaGFsbGVuZ2Uod2lubmVySXNDdXJyZW50VXNlciwgZm9yZmVpdCwgZm9yZmVpdExvc2VyKSB7XG4gICAgICB2YXIgcGxheWVyID0gZm9yZmVpdExvc2VyIHx8IHZtLmN1cnJlbnRVc2VyUGxheWVyO1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllci5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcblxuICAgICAgICB2YXIgc3dhcFBvc2l0aW9ucyA9IGZhbHNlO1xuXG4gICAgICAgIC8vIElmIHRoZXJlIGlzIGEgZm9yZmVpdFxuICAgICAgICBpZiAoZm9yZmVpdCkge1xuICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLmZvcmZlaXQgPSB0cnVlO1xuICAgICAgICAgIGlmIChmb3JmZWl0TG9zZXIuY2hhbGxlbmdlLnBvc2l0aW9uID09PSAnb3Bwb25lbnQnKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnY2hhbGxlbmdlcic7XG4gICAgICAgICAgICBzd2FwUG9zaXRpb25zID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ29wcG9uZW50JztcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gRmlndXJlIG91dCB3aG8gdGhlIHdpbm5lciB3YXMgdG8gc3RvcmUgaW4gdGhlIGNoYWxsZW5nZSByZWNvcmRcbiAgICAgICAgfSBlbHNlIGlmICh3aW5uZXJJc0N1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgaWYgKGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIuX2lkID09PSB2bS5jdXJyZW50VXNlclBsYXllci5faWQpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdjaGFsbGVuZ2VyJztcbiAgICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnb3Bwb25lbnQnO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci5faWQgPT09IHZtLmN1cnJlbnRVc2VyUGxheWVyLl9pZCkge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ29wcG9uZW50JztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ2NoYWxsZW5nZXInO1xuICAgICAgICAgICAgc3dhcFBvc2l0aW9ucyA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3dhcCBwb3NpdGlvbnMgYW5kIHRoZW4gY29tcGxldGUgdGhlIGNoYWxsZW5nZSBvciBqdXN0IGNvbXBsZXRlIHRoZSBjaGFsbGVuZ2VcbiAgICAgICAgLy8gV2Vic29ja2V0IGV2ZW50IHdpbGwgcmVmcmVzaCB0aGUgcHlyYW1pZFxuICAgICAgICBpZiAoc3dhcFBvc2l0aW9ucykge1xuICAgICAgICAgIHB5cmFtaWRzU2VydmljZS5zd2FwUG9zaXRpb25zKHZtLmNvbXBldGl0aW9uSWQsIGNoYWxsZW5nZS5kYXRhLm9wcG9uZW50LCBjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmNvbXBsZXRlQ2hhbGxlbmdlKGNoYWxsZW5nZS5kYXRhKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgaWYgKHJlbW92aW5nQ3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgICByZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmNvbXBsZXRlQ2hhbGxlbmdlKGNoYWxsZW5nZS5kYXRhKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChyZW1vdmluZ0N1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICAgIHJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLnB5cmFtaWRNZW51VG9nZ2xlID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbHMgdGhlIGNvbXBsZXRlIGNoYWxsbmdlIGZ1bmN0aW9uIHdpdGggdGhlIGZvcmZlaXRpbmcgcGxheWVyXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBwbGF5ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjaGFsbGVuZ2VFeHBpcmVkKHBsYXllcikge1xuICAgICAgY29tcGxldGVDaGFsbGVuZ2UobnVsbCwgdHJ1ZSwgcGxheWVyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyB0aGUgY3VycmVudCB1c2VyIHRoZSBweXJhbWlkIFxuICAgICAqIGlmIHRoZXkncmUgbm90IGFscmVhZHkgb24gaXQgYW5kIHRoZXJlJ3Mgc3BhY2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhZGRDdXJyZW50VXNlclRvUHlyYW1pZCgpIHtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgaWYgKHZtLm51bWJlck9mUmVhbFBsYXllcnMgPCB2bS5tYXhQbGF5ZXJzKSB7XG4gICAgICAgICAgdmFyIHBsYXllciA9IHtcbiAgICAgICAgICAgIF9pZDogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCxcbiAgICAgICAgICAgIGZpcnN0TmFtZTogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIubGFzdE5hbWUsXG4gICAgICAgICAgICBlbWFpbDogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLnVzZXJuYW1lLFxuICAgICAgICAgICAgcG9zaXRpb246IHZtLm51bWJlck9mUmVhbFBsYXllcnMgKyAxXG4gICAgICAgICAgfTtcbiAgICAgICAgICBpZiAodm0ucHlyYW1pZC5vcGVuKSB7XG4gICAgICAgICAgICBzd2FsKHtcbiAgICAgICAgICAgICAgdGl0bGU6ICdKb2luIENvbXBldGl0aW9uPycsXG4gICAgICAgICAgICAgIHRleHQ6ICdZb3VcXCdsbCBiZSBhZGRlZCB0byB0aGUgYm90dG9tJyxcbiAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnLFxuICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLFxuICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ0pvaW4nLFxuICAgICAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAnTmV2ZXJtaW5kJyxcbiAgICAgICAgICAgICAgY2xvc2VPbkNvbmZpcm06IGZhbHNlLFxuICAgICAgICAgICAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHB5cmFtaWRzU2VydmljZS5hZGRQbGF5ZXJUb1B5cmFtaWQodm0uY29tcGV0aXRpb25JZCwgcGxheWVyKTtcbiAgICAgICAgICAgICAgc3dhbCgnV2VsY29tZSBBYm9hcmQhJywgJ05vdyBzdGFydCBmaWdodGluZyB5b3VyIHdheSB0byB0aGUgdG9wJywgJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgIH0pOyAgXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN3YWwoe1xuICAgICAgICAgICAgICB0aXRsZTogJ1NlbmQgSm9pbiBSZXF1ZXN0PycsXG4gICAgICAgICAgICAgIHRleHQ6ICdUaGlzIGlzIGEgY2xvc2VkIGNvbXBldGl0aW9uIHNvIHRoZSBvd25lciBtdXN0IGFwcHJvdmUgeW91ciByZXF1ZXN0JyxcbiAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnLFxuICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLFxuICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ1NlbmQgUmVxdWVzdCcsXG4gICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICdOZXZlcm1pbmQnLFxuICAgICAgICAgICAgICBjbG9zZU9uQ29uZmlybTogZmFsc2UsXG4gICAgICAgICAgICAgIGNsb3NlT25DYW5jZWw6IHRydWVcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmFkZFBsYXllclRvUHlyYW1pZFJlcXVlc3Qodm0ucHlyYW1pZCwgcGxheWVyKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2bS5jdXJyZW50VXNlcklzUGVuZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBzd2FsKCdSZXF1ZXN0IFNlbnQnLCAnWW91IHdpbGwgcmVjZWl2ZSBhbiBlbWFpbCBvbmNlIHRoZSBvd25lciBwcm9jZXNzZXMgdGhlIHJlcXVlc3QuJywgJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLndhcm5pbmcoJ1NvcnJ5LCB0aGlzIHB5cmFtaWQgaXMgZnVsbCcpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29uZmlybVJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQoKSB7XG4gICAgICBzd2FsKHtcbiAgICAgICAgdGl0bGU6ICdMZWF2ZSBQeXJhbWlkPycsXG4gICAgICAgIHRleHQ6ICdZb3Ugd2lsbCBsb3NlIHlvdXIgc3BvdCBhbmQgZm9yZmVpdCBhbnkgYWN0aXZlIGNoYWxsZW5nZXMuJyxcbiAgICAgICAgdHlwZTogJ2Vycm9yJyxcbiAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICdZZXMsIGxlYXZlJyxcbiAgICAgICAgY29uZmlybUJ1dHRvbkNsYXNzOiAnYnRuLWRhbmdlcicsXG4gICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICdObywgc3RheScsXG4gICAgICAgIGNsb3NlT25Db25maXJtOiBmYWxzZSxcbiAgICAgICAgY2xvc2VPbkNhbmNlbDogdHJ1ZVxuICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkKCk7XG4gICAgICAgIHN3YWwoJ09LLCB5b3VcXCdyIG91dCEnLCAnWW91XFwndmUgYmVlbiByZW1vdmVkIGZyb20gdGhlIHB5cmFtaWQuJywgJ3N1Y2Nlc3MnKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFVzZSB0aGlzIHRvIGVuZm9yY2Ugb3JkZXIgb2Ygb3BlcmF0aW9ucyB3aGVuIHRoZSBwbGF5ZXIgdG8gYmUgcmVtb3ZlZCBoYWQgYW4gYWN0aXZlIGNoYWxsZW5nZVxuICAgIHZhciByZW1vdmluZ0N1cnJlbnRVc2VyID0gZmFsc2U7XG5cbiAgICBmdW5jdGlvbiByZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkKCkge1xuICAgICAgLy8gTWFrZSBzdXJlIHRoZSB1c2VyIGlzIGxvZ2dlZCBpbiBhbmQgaXMgb24gdGhpcyBweXJhbWlkXG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpICYmIHZtLmN1cnJlbnRVc2VySXNPblB5cmFtaWQpIHtcbiAgICAgICAgcmVtb3ZpbmdDdXJyZW50VXNlciA9IHRydWU7XG4gICAgICAgIC8vIEZvcmZlaXQgaWYgdGhleSBoYXZlIGFuIGFjdGl2ZSBjaGFsbGVuZ2VcbiAgICAgICAgaWYgKHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSkge1xuICAgICAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlKG51bGwsIHRydWUsIHZtLmN1cnJlbnRVc2VyUGxheWVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBTaW5jZSB3ZSBhcmUgcmVtb3ZpbmcgdGhlbSAuLi5cbiAgICAgICAgICB2bS5jdXJyZW50VXNlcklzT25QeXJhbWlkID0gZmFsc2U7XG4gICAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gZmFsc2U7XG5cbiAgICAgICAgICAvLyBHZXQgYW4gdXBkYXRlZCBjb3B5IG9mIHRoZSBweXJhbWlkIGluY2FzZSBhIGZvcmZlaXQgaGFwcGVuZWRcbiAgICAgICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChwKSB7XG4gICAgICAgICAgICAvLyBTdG9yZSB0aGUgdXBkYXRlZCBjb3B5IGxvY2FsbHkgc28gYXMgbm90IHRvIGRpc3RydXB0IHRoZSBweXJhbWlkXG4gICAgICAgICAgICAvLyB1bnRpbCB0aGUgcGxheWVyIGhhcyBiZWVuIHJlbW92ZWRcbiAgICAgICAgICAgIHZhciBweXJhbWlkID0gcC5kYXRhO1xuXG4gICAgICAgICAgICAvLyBLZWVwIHRyYWNrIG9mIHRoZSBzcG90IHRoZXkgd2VyZSBpbiBvbiB0aGUgcHlyYW1pZFxuICAgICAgICAgICAgdmFyIG9wZW5Qb3NpdGlvbiA9IHZtLmN1cnJlbnRVc2VyUGxheWVyLnBvc2l0aW9uO1xuXG4gICAgICAgICAgICAvLyBNb3ZlIGFsbCB0aGUgcGxheWVycyB1cCAxIHBvc2l0aW9uIHRoYXQgd2VyZSBiZWhpbmQgdGhlIHJlbW92ZWQgcGxheWVyXG4gICAgICAgICAgICBfLmZvckVhY2gocHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgICAgICAgIGlmIChwbGF5ZXIucG9zaXRpb24gPj0gb3BlblBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgcGxheWVyLnBvc2l0aW9uIC09IDE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBSZW1vdmVkIHRoZSBwbGF5ZXIgZnJvbSB0aGUgcHlyYW1pZFxuICAgICAgICAgICAgdmFyIHJlbW92ZWRQbGF5ZXIgPSBfLnJlbW92ZShweXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHBsYXllci5faWQgPT09IHZtLmN1cnJlbnRVc2VyUGxheWVyLl9pZDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBNYWtlIGEgbmV3IGFycmF5IG9mIGFsbCB0aGUgcGxheWVycyBzdGlsbCBvbiB0aGUgcHlyYW1pZFxuICAgICAgICAgICAgLy8gb25seSB1c2UgdGhlIHByb3BlcnRpZXMgd2Ugd2FudCB0byBzdG9yZSBpbiB0aGUgcHlyYW1pZCBkb2N1bWVudFxuICAgICAgICAgICAgdmFyIHVwZGF0ZWRQbGF5ZXJzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLm51bWJlck9mUmVhbFBsYXllcnMgLSAxOyArK2kpIHtcbiAgICAgICAgICAgICAgdmFyIHVwZGF0ZWRQbGF5ZXIgPSB7XG4gICAgICAgICAgICAgICAgX2lkOiBweXJhbWlkLnBsYXllcnNbaV0uX2lkLFxuICAgICAgICAgICAgICAgIGZpcnN0TmFtZTogcHlyYW1pZC5wbGF5ZXJzW2ldLmZpcnN0TmFtZSxcbiAgICAgICAgICAgICAgICBsYXN0TmFtZTogcHlyYW1pZC5wbGF5ZXJzW2ldLmxhc3ROYW1lLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBweXJhbWlkLnBsYXllcnNbaV0ucG9zaXRpb25cbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICB1cGRhdGVkUGxheWVycy5wdXNoKHVwZGF0ZWRQbGF5ZXIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDYWxsIHNlcnZpY2UgdG8gcmVtb3ZlIHRoZSBwbGF5ZXJcbiAgICAgICAgICAgIHB5cmFtaWRzU2VydmljZS5yZW1vdmVkUGxheWVyRnJvbVB5cmFtaWQodm0uY29tcGV0aXRpb25JZCwgcmVtb3ZlZFBsYXllclswXSwgdXBkYXRlZFBsYXllcnMpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICByZW1vdmluZ0N1cnJlbnRVc2VyID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZnJlc2ggdGhlIHB5cmFtaWQgYmVjYXN1ZSBvZiBhbiB1cGRhdGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZWZyZXNoUHlyYW1pZCgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgb3JkZXJQbGF5ZXJzKCk7XG4gICAgICAgIGdldFBsYXllcnNTdGF0dXMoKTtcbiAgICAgICAgYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCk7XG4gICAgICAgIGNhbGN1bGF0ZVB5cmFtaWRCbG9ja3MoKTtcbiAgICAgICAgZmlsbEluRW1wdHlCbG9ja3MoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjaGFsbGVuZ2VfY3JlYXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjaGFsbGVuZ2VfY29tcGxldGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICBpZiAoIXJlbW92aW5nQ3VycmVudFVzZXIpIHtcbiAgICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cGxheWVyX2FkZGVkJywgZnVuY3Rpb24gKF8sIGRldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBkZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGRldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOnBsYXllcl9yZW1vdmVkJywgZnVuY3Rpb24gKF8sIGRldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBkZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGRldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOnB5cmFtaWRfdXBkYXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BVcGRhdGVQbGF5ZXJzJywga3BVcGRhdGVQbGF5ZXJzKTtcblxuICBmdW5jdGlvbiBrcFVwZGF0ZVBsYXllcnMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBweXJhbWlkOiAnPSdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9weXJhbWlkcy9jb21wb25lbnRzL3VwZGF0ZS1wbGF5ZXJzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKCRmaWx0ZXIsIHB5cmFtaWRzU2VydmljZSwgY2hhbGxlbmdlc1NlcnZpY2UpIHtcbiAgICB2YXIgcmVtb3ZlZFBsYXllcnMgPSBbXTtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnVwZGF0ZVB5cmFtaWQgPSB1cGRhdGVQeXJhbWlkO1xuICAgIHZtLmNhbmNlbFVwZGF0ZSA9IGNhbmNlbFVwZGF0ZTtcbiAgICB2bS5yZW9yZGVyUGxheWVycyA9IHJlb3JkZXJQbGF5ZXJzO1xuICAgIHZtLnJlbW92ZVBsYXllciA9IHJlbW92ZVBsYXllcjtcbiAgICB2bS5kaXNhYmxlU3VibWl0ID0gdHJ1ZTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHt9XG5cbiAgICAvLyBQZXJmb3JtIHRoZSB1cGRhdGVzIHRoYXQgd2VyZSByZXF1c3RlZFxuICAgIGZ1bmN0aW9uIHVwZGF0ZVB5cmFtaWQoKSB7XG4gICAgICBfLmZvckVhY2gocmVtb3ZlZFBsYXllcnMsIGZ1bmN0aW9uKHBsYXllcikge1xuICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5kZWxldGVBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIodm0ucHlyYW1pZC5faWQsIHBsYXllci5faWQpO1xuICAgICAgfSk7XG4gICAgICBweXJhbWlkc1NlcnZpY2UudXBkYXRlUHlyYW1pZCh2bS5weXJhbWlkKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdm0uZGlzYWJsZVN1Ym1pdCA9IHRydWU7XG4gICAgICB9KTsgICBcbiAgICB9XG5cbiAgICAvLyBDYW5jZWwgdGhlIHVwZGF0ZSBhbmQgcHV0IGV2ZXJ5dGhpbmcgYmFjayB0byB0aGUgb3JnaW5hbFxuICAgIGZ1bmN0aW9uIGNhbmNlbFVwZGF0ZSgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLnB5cmFtaWQuX2lkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgIHB5cmFtaWQuZGF0YS5wbGF5ZXJzID0gJGZpbHRlcignb3JkZXJCeScpKHB5cmFtaWQuZGF0YS5wbGF5ZXJzLCAncG9zaXRpb24nKTtcbiAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgdm0uZGlzYWJsZVN1Ym1pdCA9IHRydWU7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBSZW9yZGVyIHRoZSBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBkcmFnLWRyb3BcbiAgICBmdW5jdGlvbiByZW9yZGVyUGxheWVycygpIHtcbiAgICAgIHZhciBpID0gMTtcbiAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgcGxheWVyLnBvc2l0aW9uID0gaTtcbiAgICAgICAgKytpO1xuICAgICAgfSk7XG4gICAgICB2bS5kaXNhYmxlU3VibWl0ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gUXVldWUgdXAgdGhlIHBsYXllcnMgdG8gYmUgcmVtb3ZlZCBhbmQgcmVtb3ZlIHRoZW0gZnJvbSB0aGUgZGlzcGxheVxuICAgIGZ1bmN0aW9uIHJlbW92ZVBsYXllcihwbGF5ZXIsIHBsYXllckluZGV4KSB7XG4gICAgICByZW1vdmVkUGxheWVycy5wdXNoKHBsYXllcik7XG4gICAgICB2bS5weXJhbWlkLnBsYXllcnMuc3BsaWNlKHBsYXllckluZGV4LCAxKTtcbiAgICAgIHJlb3JkZXJQbGF5ZXJzKCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ3B5cmFtaWRzU2VydmljZScsIHB5cmFtaWRzU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gcHlyYW1pZHNTZXJ2aWNlKCRodHRwKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBnZXRQeXJhbWlkOiBnZXRQeXJhbWlkLFxuICAgICAgZ2V0UHlyYW1pZHNGb3JVc2VyOiBnZXRQeXJhbWlkc0ZvclVzZXIsXG4gICAgICBnZXRQeXJhbWlkczogZ2V0UHlyYW1pZHMsXG4gICAgICBjcmVhdGVQeXJhbWlkOiBjcmVhdGVQeXJhbWlkLFxuICAgICAgdXBkYXRlUHlyYW1pZDogdXBkYXRlUHlyYW1pZCxcbiAgICAgIGRlbGV0ZVB5cmFtaWQ6IGRlbGV0ZVB5cmFtaWQsXG4gICAgICBzd2FwUG9zaXRpb25zOiBzd2FwUG9zaXRpb25zLFxuICAgICAgYWRkUGxheWVyVG9QeXJhbWlkOiBhZGRQbGF5ZXJUb1B5cmFtaWQsXG4gICAgICBhZGRQbGF5ZXJUb1B5cmFtaWRSZXF1ZXN0OiBhZGRQbGF5ZXJUb1B5cmFtaWRSZXF1ZXN0LFxuICAgICAgcmVtb3ZlZFBsYXllckZyb21QeXJhbWlkOiByZW1vdmVkUGxheWVyRnJvbVB5cmFtaWQsXG4gICAgICBhcHByb3ZlUGVuZGluZ1BsYXllcjogYXBwcm92ZVBlbmRpbmdQbGF5ZXIsXG4gICAgICBkZW55UGVuZGluZ1BsYXllcjogZGVueVBlbmRpbmdQbGF5ZXJcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGEgcHlyYW1pZCBmcm9tIHRoZSBkYXRhYmFzZSAob3IgbWVtb3J5KVxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHB5cmFtaWQgaWQgZm9yIHRoZSByZXF1ZXN0ZWQgcHlyYW1pZFxuICAgICAqIEByZXR1cm4ge09iamVjdH0gcHlyYW1pZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFB5cmFtaWQoY29tcGV0aXRpb25JZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9weXJhbWlkJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYWxsIHB5cmFtaWRzIGZyb20gdGhlIGRhdGFiYXNlIHRoYXQgYSBwYXJ0aWN1bGFyIHVzZXIgaXMgaW5jbHVkZWQgaW5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7dXNlcklkfSB0aGUgdXNlciBpZCBmb3IgdGhlIHJlcXVlc3RlZCB1c2VyXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBweXJhbWlkc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFB5cmFtaWRzRm9yVXNlcih1c2VySWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcHlyYW1pZHMvdXNlcicsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgdXNlcklkOiB1c2VySWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhbGwgYWN0aXZlIHB5cmFtaWRzIGZyb20gdGhlIGRhdGFiYXNlXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IHB5cmFtaWRzXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZHMoKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3B5cmFtaWRzJyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlUHlyYW1pZChweXJhbWlkKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9jcmVhdGUnLCB7XG4gICAgICAgIHB5cmFtaWQ6IHB5cmFtaWRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZVB5cmFtaWQocHlyYW1pZCkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvdXBkYXRlJywge1xuICAgICAgICBweXJhbWlkOiBweXJhbWlkXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVQeXJhbWlkKGNvbXBldGl0aW9uSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5kZWxldGUoJy9hcGkvcHlyYW1pZHMvZGVsZXRlJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzd2FwUG9zaXRpb25zKGNvbXBldGl0aW9uSWQsIGNoYWxsZW5nZXIsIG9wcG9uZW50KSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9zd2FwUG9zaXRpb25zJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICBjaGFsbGVuZ2VyOiBjaGFsbGVuZ2VyLFxuICAgICAgICBvcHBvbmVudDogb3Bwb25lbnRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFBsYXllclRvUHlyYW1pZChjb21wZXRpdGlvbklkLCBwbGF5ZXIpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2FkZFBsYXllcicsIHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgcGxheWVyOiBwbGF5ZXJcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFBsYXllclRvUHlyYW1pZFJlcXVlc3QoY29tcGV0aXRpb24sIHBsYXllcikge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvYWRkUGxheWVyUmVxdWVzdCcsIHtcbiAgICAgICAgY29tcGV0aXRpb246IGNvbXBldGl0aW9uLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVtb3ZlZFBsYXllckZyb21QeXJhbWlkKGNvbXBldGl0aW9uSWQsIHJlbW92ZWRQbGF5ZXIsIHBsYXllcnMpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL3JlbW92ZVBsYXllcicsIHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgcmVtb3ZlZFBsYXllcjogcmVtb3ZlZFBsYXllcixcbiAgICAgICAgcGxheWVyczogcGxheWVyc1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXBwcm92ZVBlbmRpbmdQbGF5ZXIoY29tcGV0aXRpb25JZCwgcGxheWVyKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9hcHByb3ZlUGxheWVyJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVueVBlbmRpbmdQbGF5ZXIoY29tcGV0aXRpb25JZCwgcGxheWVyKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9kZW55UGxheWVyJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0FkbWluQ3RybCcsIEFkbWluQ3RybCk7XG5cbiAgZnVuY3Rpb24gQWRtaW5DdHJsKCRzY29wZSwgJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRmaWx0ZXIsIHB5cmFtaWRzU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jb21wZXRpdGlvbklkID0gbnVsbDtcbiAgICB2bS51cGRhdGVQeXJhbWlkT3BlblN0YXR1cyA9IHVwZGF0ZVB5cmFtaWRPcGVuU3RhdHVzO1xuICAgIHZtLmRlbGV0ZVB5cmFtaWQgPSBkZWxldGVQeXJhbWlkO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMubXlQeXJhbWlkcycpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlZnJlc2hQeXJhbWlkKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhpcyB1c2VyIGlzIGFuIG93bmVyIG9mIHRoaXMgY29tcGV0aXRpb25cbiAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSAmJiBfLnNvbWUocHlyYW1pZC5kYXRhLm93bmVycywgWydfaWQnLCBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkXSkpIHtcbiAgICAgICAgICB2bS5pc093bmVyID0gdHJ1ZTtcbiAgICAgICAgICAvLyBEaXNwbGF5IHRoZSBwbGF5ZXJzIGluIHRoZSBwcm9wZXIgb3JkZXJcbiAgICAgICAgICBweXJhbWlkLmRhdGEucGxheWVycyA9ICRmaWx0ZXIoJ29yZGVyQnknKShweXJhbWlkLmRhdGEucGxheWVycywgJ3Bvc2l0aW9uJyk7XG4gICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLm15UHlyYW1pZHMnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUGVyZm9ybSB0aGUgdXBkYXRlcyB0aGF0IHdlcmUgcmVxdXN0ZWRcbiAgICBmdW5jdGlvbiB1cGRhdGVQeXJhbWlkT3BlblN0YXR1cygpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgdmFyIHVwZGF0ZWRQeXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuICAgICAgICB1cGRhdGVkUHlyYW1pZC5vcGVuID0gdm0ucHlyYW1pZC5vcGVuO1xuICAgICAgICBweXJhbWlkc1NlcnZpY2UudXBkYXRlUHlyYW1pZCh1cGRhdGVkUHlyYW1pZCk7XG4gICAgICB9KTsgICAgICBcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVQeXJhbWlkKCkge1xuICAgICAgc3dhbCh7XG4gICAgICAgIHRpdGxlOiAnRGVsZXRlIENvbXBldGl0aW9uPycsXG4gICAgICAgIHRleHQ6ICdUaGlzIGNhbiBub3QgYmUgdW5kb25lJyxcbiAgICAgICAgdHlwZTogJ3dhcm5pbmcnLFxuICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLFxuICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ0RlbGV0ZScsXG4gICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICdOZXZlcm1pbmQnLFxuICAgICAgICBjbG9zZU9uQ29uZmlybTogdHJ1ZSxcbiAgICAgICAgY2xvc2VPbkNhbmNlbDogdHJ1ZVxuICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICBweXJhbWlkc1NlcnZpY2UuZGVsZXRlUHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLm15UHlyYW1pZHMnKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpwbGF5ZXJfYWRkZWQnLCBmdW5jdGlvbiAoXywgZGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGRldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oZGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cGxheWVyX3JlbW92ZWQnLCBmdW5jdGlvbiAoXywgZGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGRldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oZGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cHlyYW1pZF91cGRhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmFkZF9wbGF5ZXJfcmVxdWVzdCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czphZGRfcGxheWVyX3JlcXVlc3RfZGVuaWVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOnB5cmFtaWRfZGVsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbygnVGhlIGNvbXBldGl0aW9uIHdhcyBkZWxldGVkIGJ5IHRoZSBvd25lcicpO1xuICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLm15UHlyYW1pZHMnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIvKipcbiAqIENyZWF0ZXMgYSBweXJhbWlkXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0NyZWF0ZVB5cmFtaWRDdHJsJywgQ3JlYXRlUHlyYW1pZEN0cmwpO1xuXG4gIGZ1bmN0aW9uIENyZWF0ZVB5cmFtaWRDdHJsKCRzdGF0ZSwgdXNlclNlcnZpY2UsIHB5cmFtaWRzU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlKSB7XG4gICAgdmFyIGJyZWFrUG9pbnRzID0gW107XG4gICAgdmFyIG1heExldmVscyA9IDEwO1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubmV3UHlyYW1pZCA9IHtcbiAgICAgIHBsYXllcnM6IFtdLFxuICAgICAgb3BlbjogZmFsc2VcbiAgICB9O1xuICAgIHZtLmF2YWlsYWJsZVBsYXllcnMgPSBbXTtcbiAgICB2bS5hZGRlZFBsYXllcnMgPSBbXTtcbiAgICB2bS5jcmVhdGVQeXJhbWlkID0gY3JlYXRlUHlyYW1pZDtcbiAgICB2bS5hZGRQbGF5ZXIgPSBhZGRQbGF5ZXI7XG4gICAgdm0ucmVtb3ZlUGxheWVyID0gcmVtb3ZlUGxheWVyO1xuICAgIHZtLnJlb3JkZXJQbGF5ZXJzID0gcmVvcmRlclBsYXllcnM7XG4gICAgdm0ubmV3UHlyYW1pZC5mb3JmZWl0RGF5cyA9IDE7XG5cbiAgICBhY3RpdmF0ZSgpO1xuICAgIFxuICAgIC8qKlxuICAgICAqIFJ1bnMgb24gY29udHJvbGxlciBpbnN0YW50aWF0aW9uXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICB1c2VyU2VydmljZS5nZXRBbGxVc2VycygpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIHZtLmF2YWlsYWJsZVBsYXllcnMgPSB1c2Vycy5kYXRhO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENyZWF0ZSBicmVhayBwb2ludHMgYXJyYXlcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4TGV2ZWxzOyBpKyspIHtcbiAgICAgICAgYnJlYWtQb2ludHMucHVzaCgoKChpICogKGkgKyAxKSkgLyAyKSkgKyAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgcGxheWVyIHRvIHRoZSBuZXcgcHlyYW1pZFxuICAgICAqIENoZWNrcyB0byBtYWtlIHN1cmUgeW91IGFyZSBub3QgYWRkaW5nIHRvbyBtYW55IHBsYXllcnNcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHBsYXllclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZFBsYXllcihwbGF5ZXIpIHtcbiAgICAgIHBsYXllci5wb3NpdGlvbiA9IHZtLmFkZGVkUGxheWVycy5sZW5ndGggKyAxO1xuICAgICAgdm0uYWRkZWRQbGF5ZXJzLnB1c2goXy5yZW1vdmUodm0uYXZhaWxhYmxlUGxheWVycywge19pZDogcGxheWVyLl9pZH0pWzBdKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGEgcHJldml1b3NseSBhZGRlZCBwbGF5ZXIgZnJvbSB0aGUgcHlyYW1pZFxuICAgICAqIEBwYXJhbSAge29iamVjdH0gcGxheWVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVtb3ZlUGxheWVyKHBsYXllcikge1xuICAgICAgdm0uYXZhaWxhYmxlUGxheWVycy5wdXNoKF8ucmVtb3ZlKHZtLmFkZGVkUGxheWVycywge19pZDogcGxheWVyLl9pZH0pWzBdKTtcbiAgICAgIHJlb3JkZXJQbGF5ZXJzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVvcmRlciB0aGUgcGxheWVycyBiYXNlZCBvbiB0aGUgZHJhZy1kcm9wXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVvcmRlclBsYXllcnMoKSB7XG4gICAgICB2YXIgaSA9IDE7XG4gICAgICBfLmZvckVhY2godm0uYWRkZWRQbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIHBsYXllci5wb3NpdGlvbiA9IGk7XG4gICAgICAgICsraTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFVzZWQgdG8ga2VlcCB0cmFjayBvZiBwb3NpdGlvbiBvbiB0aGUgcHlyYW1pZCBiYXNlZCBvbiB3aGVuIHRoZSBwbGF5ZXIgd2FzIGFkZGVkXG4gICAgdmFyIHBvc2l0aW9uID0gMDtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSB0aGUgcHlyYW1pZFxuICAgICAqIEBwYXJhbSAge29iamVjdH0gcHlyYW1pZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZVB5cmFtaWQocHlyYW1pZCkge1xuICAgICAgYW5ndWxhci5mb3JFYWNoKHZtLmFkZGVkUGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICBwb3NpdGlvbiArPSAxO1xuICAgICAgICB2YXIgYWRkUGxheWVyID0ge1xuICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbixcbiAgICAgICAgICBfaWQ6IHBsYXllci5faWQsXG4gICAgICAgICAgZW1haWw6IHBsYXllci51c2VybmFtZSxcbiAgICAgICAgICBmaXJzdE5hbWU6IHBsYXllci5maXJzdE5hbWUsXG4gICAgICAgICAgbGFzdE5hbWU6IHBsYXllci5sYXN0TmFtZVxuICAgICAgICB9O1xuICAgICAgICBweXJhbWlkLnBsYXllcnMucHVzaChhZGRQbGF5ZXIpO1xuICAgICAgfSk7XG4gICAgICBweXJhbWlkLm93bmVycyA9IFt7XG4gICAgICAgIF9pZDogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCxcbiAgICAgICAgZW1haWw6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci51c2VybmFtZSxcbiAgICAgICAgZmlyc3ROYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuZmlyc3ROYW1lLFxuICAgICAgICBsYXN0TmFtZTogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmxhc3ROYW1lXG4gICAgICB9XTtcblxuICAgICAgLy8gRmlndXJlIG91dCB0aGUgbnVtYmVyIG9mIGxldmVscyBiYXNlZCBvbiB0aGUgbnVtYmVyIG9mIHBsYXllcnNcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnJlYWtQb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHB5cmFtaWQucGxheWVycy5sZW5ndGggPCBicmVha1BvaW50c1tpXSkge1xuICAgICAgICAgIHB5cmFtaWQubGV2ZWxzID0gaTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBweXJhbWlkc1NlcnZpY2UuY3JlYXRlUHlyYW1pZChweXJhbWlkKS50aGVuKGZ1bmN0aW9uIChuZXdQeXJhbWlkKSB7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMudmlldycsIHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBuZXdQeXJhbWlkLmRhdGEuX2lkXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ015UHlyYW1pZHNDdHJsJywgTXlQeXJhbWlkc0N0cmwpO1xuXG4gIGZ1bmN0aW9uIE15UHlyYW1pZHNDdHJsKCkge1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge31cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdQeXJhbWlkQ3RybCcsIFB5cmFtaWRDdHJsKTtcblxuICBmdW5jdGlvbiBQeXJhbWlkQ3RybCgkc2NvcGUsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBweXJhbWlkc1NlcnZpY2UsIG5vdGlmeVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNvbXBldGl0aW9uSWQgPSBudWxsO1xuICAgIHZtLnB5cmFtaWQgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcblxuICAgICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSkge1xuICAgICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy5teVB5cmFtaWRzJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cHlyYW1pZF9kZWxldGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKCdUaGUgY29tcGV0aXRpb24gd2FzIGRlbGV0ZWQgYnkgdGhlIG93bmVyJyk7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMubXlQeXJhbWlkcycpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1B5cmFtaWRzQ3RybCcsIFB5cmFtaWRzQ3RybCk7XG5cbiAgZnVuY3Rpb24gUHlyYW1pZHNDdHJsKCkge1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge31cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdTdGF0c0N0cmwnLCBTdGF0c0N0cmwpO1xuXG4gIGZ1bmN0aW9uIFN0YXRzQ3RybCgkc2NvcGUsICRzdGF0ZVBhcmFtcywgJHN0YXRlLCBweXJhbWlkc1NlcnZpY2UsIG5vdGlmeVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNvbXBldGl0aW9uSWQgPSBudWxsO1xuICAgIHZtLnB5cmFtaWQgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWZyZXNoUHlyYW1pZCgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSkge1xuICAgICAgICAgIHZtLnB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy5teVB5cmFtaWRzJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjaGFsbGVuZ2VfY29tcGxldGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9kZWxldGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpweXJhbWlkX3VwZGF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cHlyYW1pZF9kZWxldGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKCdUaGUgY29tcGV0aXRpb24gd2FzIGRlbGV0ZWQgYnkgdGhlIG93bmVyJyk7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMubXlQeXJhbWlkcycpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1VzZXJDdHJsJywgVXNlckN0cmwpO1xuXG4gIGZ1bmN0aW9uIFVzZXJDdHJsKGlkZW50aXR5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge31cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2NPdmVyZmxvdycsIGNPdmVyZmxvdyk7XG5cbiAgZnVuY3Rpb24gY092ZXJmbG93KHNjcm9sbGJhclNlcnZpY2UpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICB2YXIgc2Nyb2xsYXhpcyA9IGF0dHJzLnNjcm9sbGF4aXMgfHwgJ3knO1xuICAgICAgdmFyIHRoZW1lID0gYXR0cnMudGhlbWUgfHwgJ21pbmltYWwtZGFyayc7XG4gICAgICB2YXIgbW91c2V3aGVlbGF4aXMgPSBhdHRycy5tb3VzZXdoZWVsYXhpcyB8fCAneSc7XG4gICAgICBpZiAoISQoJ2h0bWwnKS5oYXNDbGFzcygnaXNtb2JpbGUnKSkge1xuICAgICAgICBzY3JvbGxiYXJTZXJ2aWNlLm1hbGlodVNjcm9sbChlbGVtZW50LCB0aGVtZSwgc2Nyb2xsYXhpcywgbW91c2V3aGVlbGF4aXMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ3RvZ2dsZVN1Ym1lbnUnLCB0b2dnbGVTdWJtZW51KTtcblxuICBmdW5jdGlvbiB0b2dnbGVTdWJtZW51KCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWwpIHtcbiAgICAgIGVsLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZWwubmV4dCgpLnNsaWRlVG9nZ2xlKDIwMCk7XG4gICAgICAgIGVsLnBhcmVudCgpLnRvZ2dsZUNsYXNzKCd0b2dnbGVkJyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCd3YXZlc0VmZmVjdCcsIHdhdmVzRWZmZWN0KTtcblxuICBmdW5jdGlvbiB3YXZlc0VmZmVjdCgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdidG4taWNvbicpIHx8IGVsZW1lbnQuaGFzQ2xhc3MoJ2J0bi1mbG9hdCcpKSB7XG4gICAgICAgIFdhdmVzLmF0dGFjaChlbGVtZW50LCBbJ3dhdmVzLWNpcmNsZSddKTtcbiAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5oYXNDbGFzcygnYnRuLWxpZ2h0JykpIHtcbiAgICAgICAgV2F2ZXMuYXR0YWNoKGVsZW1lbnQsIFsnd2F2ZXMtbGlnaHQnXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBXYXZlcy5hdHRhY2goZWxlbWVudCk7XG4gICAgICB9XG5cbiAgICAgIFdhdmVzLmluaXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdmZ0xpbmUnLCBmZ0xpbmUpO1xuXG4gIGZ1bmN0aW9uIGZnTGluZSgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgIHZhciBpbnB1dCA9IGVsZW1lbnQuY2hpbGRyZW4oKS5maXJzdCgpO1xuICAgICAgdmFyIGlzRmxvYXRMYWJlbCA9IGVsZW1lbnQucGFyZW50KCkuaGFzQ2xhc3MoJ2ZnLWZsb2F0Jyk7XG4gICAgICBpbnB1dC5mb2N1cyhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ2ZnLXRvZ2dsZWQnKTtcbiAgICAgIH0pO1xuXG4gICAgICBpbnB1dC5ibHVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFpc0Zsb2F0TGFiZWwgfHwgKGlzRmxvYXRMYWJlbCAmJiBpbnB1dC52YWwoKS5sZW5ndGggPT09IDApKSB7XG4gICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnZmctdG9nZ2xlZCcpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7Il19
