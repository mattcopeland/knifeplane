angular.module("app",["ui.router","ngAnimate","angular-loading-bar","nouislider","localytics.directives","timer"]),function(){"use strict ";function e(){}angular.module("app").config(e)}(),function(){"use strict";function e(e){function t(){r.sidebarToggle.left=!r.sidebarToggle.left}var r=this;r.toggleSidebar=t,r.$state=e,r.sidebarToggle={left:!1,right:!1}}e.$inject=["$state"],angular.module("app").controller("AppCtrl",e)}(),function(){"use strict";function e(e,i,a){var o={superAdmin:r,admin:t,user:n};a.html5Mode(!0),i.otherwise("/"),i.when("/pyramids/","/pyramids"),e.state("home",{url:"/",views:{content:{controller:"HomeCtrl",controllerAs:"vm",templateUrl:"common/views/home.html"},header:{controller:"HeaderCtrl",controllerAs:"vm",templateUrl:"common/views/header.html"},sidebar:{controller:"SidebarCtrl",controllerAs:"vm",templateUrl:"common/views/sidebar.html"}}}).state("pyramids",{url:"/pyramids",views:{content:{controller:"PyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramids.html"},header:{controller:"HeaderCtrl",controllerAs:"vm",templateUrl:"common/views/header.html"}}}).state("pyramids.myPyramids",{url:"/my-pyramids",views:{"content@":{controller:"MyPyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/my-pyramids.html"}},resolve:{auth:o.user}}).state("pyramids.view",{url:"/view/:pyramidId",views:{"content@":{controller:"PyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramid.html"}}}).state("pyramids.create",{url:"/create",views:{"content@":{controller:"CreatePyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/create-pyramid.html"}},resolve:{auth:o.user}}).state("login",{url:"/login",views:{content:{controller:"LoginCtrl",controllerAs:"vm",templateUrl:"authentication/views/login.html"},header:{controller:"HeaderCtrl",controllerAs:"vm",templateUrl:"common/views/header.html"},sidebar:{controller:"SidebarCtrl",controllerAs:"vm",templateUrl:"common/views/sidebar.html"}}}).state("register",{url:"/register",views:{content:{controller:"RegisterCtrl",controllerAs:"vm",templateUrl:"authentication/views/register.html"},header:{controller:"HeaderCtrl",controllerAs:"vm",templateUrl:"common/views/header.html"},sidebar:{controller:"SidebarCtrl",controllerAs:"vm",templateUrl:"common/views/sidebar.html"}}})}function t(e){return e.authorizeCurrentUserForRoute("admin")}function r(e){return e.authorizeCurrentUserForRoute("super-admin")}function n(e){return e.authenticatedUserForRoute()}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app").config(e),t.$inject=["authService"],r.$inject=["authService"],n.$inject=["authService"]}(),function(){"use strict";function e(e,t){e.$on("$stateChangeError",function(e,r,n,i,a,o){"not authorized"===o&&(t.go("login"),t.previous=r)})}e.$inject=["$rootScope","$state"],angular.module("app").run(e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@"},templateUrl:"/common/components/challenges.html"};return e}function t(e,t){function r(){n()}function n(){t.getActiveChallengesByCompetition(i.competitionId).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){e.expires=moment().diff(moment(e.created).add(e.timeLimit,"h"),"s")*-1}))})}var i=this;i.challenges=[],r(),e.$on("ws:challenge_created",function(e,t){i.competitionId===t.competitionId&&n()}),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&n()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",templateUrl:"/common/components/footer.html"};return e}function t(e,t){function r(){t.logout()}var n=this;n.indentity=e,n.logout=r}t.$inject=["identityService","authService"],angular.module("app").directive("kpFooter",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",templateUrl:"/common/components/sidebar.html"};return e}function t(e,t){function r(){t.logout()}var n=this;n.indentity=e,n.logout=r}t.$inject=["identityService","authService"],angular.module("app").directive("kpSidebar",e)}(),function(){"use strict";function e(e){function t(t){return e.post("/api/challenges/create",{challenge:t})}function r(t){return e.post("/api/challenges/complete",{challenge:t})}function n(t){return e.get("/api/challenges/competition",{params:{competitionId:t}})}function i(t){return e.get("/api/challenges/competition",{params:{competitionId:t}})}function a(t,r){return e.get("/api/challenges/active/competition/player",{params:{competitionId:t,playerId:r}})}var o={createChallenge:t,completeChallenge:r,getChallengesByCompetition:n,getActiveChallengesByCompetition:i,getActiveChallengeByCompetitionByPlayer:a};return o}e.$inject=["$http"],angular.module("app").factory("challengesService",e)}(),function(){"use strict";function e(e){function t(){return!!this.currentUser}function r(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}var n;null!==e.bootstrappedUserObject&&(n=e.bootstrappedUserObject);var i={currentUser:n,isAuthenticated:t,isAuthorized:r};return i}e.$inject=["$window"],angular.module("app").factory("identityService",e)}(),function(){"use strict";function e(){function e(e,t,r){$.notify({icon:"zmdi zmdi-alert-circle-o",message:e,url:t,target:r},{type:"info"})}function t(e,t,r){$.notify({icon:"zmdi zmdi-check",message:e,url:t,target:r},{type:"success"})}function r(e,t,r){$.notify({icon:"zmdi zmdi-alert-triangle",message:e,url:t,target:r},{type:"warning"})}function n(e,t,r){$.notify({icon:"zmdi zmdi-alert-octagon",message:e,url:t,target:r},{type:"danger"})}function i(e,t,r){$.notify({message:e,url:t,target:r},{type:"inverse"})}var a={info:e,success:t,warning:r,error:n,inverse:i};return $.notifyDefaults({offset:{x:20,y:85}}),a}angular.module("app").factory("notifyService",e)}(),angular.module("app").service("websocketService",["$rootScope","$window",function(e,t){function r(){return"https:"===t.location.protocol?"wss://"+t.location.host:"ws://"+t.location.host}var n;this.connect=function(){n=new WebSocket(r()),n.onmessage=function(t){var r=JSON.parse(t.data);e.$broadcast("ws:"+r.topic,r.data)}},this.send=function(e,t){var r=JSON.stringify({topic:e,data:t});n.send(r)}}]).run(["websocketService",function(e){e.connect()}]),function(){"use strict";function e(e,t){function r(){t.logout()}var n=this;n.indentity=e,n.logout=r}e.$inject=["identityService","authService"],angular.module("app").controller("HeaderCtrl",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("HomeCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){console.log(e.previous)}function i(n,i){t.authenticateUser(n,i).then(function(t){t?(r.success("Login successful.  Welcome to Knifeplane!"),e.previous?e.go(e.previous):e.go("home")):r.error("Username / password combinaiton incorrect")})}var a=this;a.login=i,n()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("LoginCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){}function i(e){r.createUser(e).then(function(e){t.go("home")})}var a=this;a.register=i,n()}e.$inject=["$scope","$state","authService"],angular.module("app").controller("RegisterCtrl",e)}(),function(){"use strict";function e(e,t,r,n,i){function a(e,n){var a=r.defer();return t.post("/login",{username:e,password:n}).then(function(e){e.data.success?(i.currentUser=e.data.user,a.resolve(!0)):a.resolve(!1)}),a.promise}function o(e){var n=r.defer();return t.post("/api/users",{userData:e}).then(function(e){e.data?(i.currentUser=e.data,n.resolve(!0)):n.resolve(!1)}),n.promise}function l(){var n=r.defer();return t.post("/logout",{logout:!0}).then(function(){i.currentUser=void 0,n.resolve(),e.go("home")}),n.promise}function s(e){return!!i.isAuthorized(e)||r.reject("not authorized")}function c(){return!!i.isAuthenticated()||r.reject("not authorized")}var u={authenticateUser:a,createUser:o,logout:l,authorizeCurrentUserForRoute:s,authenticatedUserForRoute:c};return u}e.$inject=["$state","$http","$q","userService","identityService"],angular.module("app").factory("authService",e)}(),function(){"use strict";function e(e,t){function r(){return e.get("/api/users").then(function(e){return e})}var n={getAllUsers:r};return n}e.$inject=["$http","identityService"],angular.module("app").factory("userService",e)}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"/pyramids/components/pyramid.html",replace:!0,scope:{competitionId:"@"},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,r,n,i,a){function o(){t.getPyramid(g.competitionId).then(function(e){g.pyramid=e.data,g.levels=[];for(var t=1;t<=e.data.levels;++t)g.levels.push(t);l(),s(),u(),d(),m()})}function l(){g.pyramid.players=r("orderBy")(g.pyramid.players,"position")}function s(){_.forEach(g.pyramid.players,function(e){i.currentUser&&e._id===i.currentUser._id&&(g.isCurrentUserOnPyramid=!0,e.class="current-user",g.currentUserPlayer=e),a.getActiveChallengeByCompetitionByPlayer(g.competitionId,e._id).then(function(t){if(t.data){e.challenge={},e._id===t.data.challenger._id?e.challenge.position="challenger":e.challenge.position="opponent";var r=moment().diff(moment(t.data.created).add(t.data.timeLimit,"h"),"s")*-1;r>0?e.challenge.expires=r:r<=0&&!t.data.complete&&"challenger"===e.challenge.position&&y(null,!0,e),g.isCurrentUserOnPyramid&&e._id===i.currentUser._id?g.hasActiveChallenge=!0:e.class="unavailable"}})})}function c(){g.breakPoints=[];for(var e=0;e<g.pyramid.levels;e++)g.breakPoints.push(e*(e+1)/2+1)}function u(){g.numberOfBlocks=0;for(var e=g.pyramid.levels;e>0;e--)g.numberOfBlocks+=e}function d(){for(var e=g.pyramid.players.length;e<g.numberOfBlocks;e++)g.pyramid.players.push({firstName:"Empty",lastName:"Spot",position:99,class:"empty"})}function m(){var e=0;c();for(var t=0;t<g.pyramid.players.length;t++)g.breakPoints.indexOf(t+1)>-1&&(e+=1),g.pyramid.players[t].level=e}function p(e){e?g.showCreateChallengeOptions=!1:g.showCreateChallengeOptions=!0;var t=g.currentUserPlayer.level>1?g.currentUserPlayer.level-1:null;_.forEach(g.pyramid.players,function(r){r.level===t&&99!==r.position&&"unavailable"!=r.class&&(g.availableChallenges=!0,e?(r.class="",r.available=!1):(r.class="available",r.available=!0))})}function f(e){if(g.showCreateChallengeOptions)if(e.available){g.showCreateChallengeOptions=!1,g.hasActiveChallenge=!0;var t={competitionId:g.competitionId,complete:!1,forfeit:!1,timeLimit:24,challenger:{_id:g.currentUserPlayer._id,firstName:g.currentUserPlayer.firstName,lastName:g.currentUserPlayer.lastName,nickname:g.currentUserPlayer.nickname,position:g.currentUserPlayer.position},opponent:{_id:e._id,firstName:e.firstName,lastName:e.lastName,nickname:e.nickname,position:e.position}};a.createChallenge(t).then(function(){v()})}else n.error("Sorry, that is not a valid challenge.")}function y(e,r,n){var i=n||g.currentUserPlayer;a.getActiveChallengeByCompetitionByPlayer(g.competitionId,i._id).then(function(n){g.hasActiveChallenge=!1,g.showCreateChallengeOptions=!1,g.showCompleteChallengeOptions=!1;var i=!1;r?(n.data.forfeit=!0,n.data.challenger.winner=!0,i=!0):e?n.data.challenger._id===g.currentUserPlayer._id?(n.data.challenger.winner=!0,i=!0):n.data.opponent.winner=!0:n.data.challenger._id===g.currentUserPlayer._id?n.data.opponent.winner=!0:(n.data.challenger.winner=!0,i=!0),a.completeChallenge(n.data).then(function(e){i?t.swapPositions(g.competitionId,e.data.opponent,e.data.challenger).then(v):v()})})}function h(){y(null,!0)}function v(){t.getPyramid(g.competitionId).then(function(e){g.pyramid=e.data,l(),s(),d(),m()})}var g=this;g.pyramid={},g.breakPoints=[],g.numberOfBlocks=0,g.isCurrentUserOnPyramid=!1,g.hasActiveChallenge=!1,g.showCreateChallengeOptions=!1,g.showCompleteChallengeOptions=!1,g.availableChallenges=!1,g.startChallenge=p,g.createChallenge=f,g.completeChallenge=y,g.challengeExpired=h,g.currentUserPlayer={},o(),e.$on("ws:challenge_created",function(e,t){g.competitionId===t.competitionId&&(n.info(t.description),v())}),e.$on("ws:challenge_completed",function(e,t){g.competitionId===t.competitionId&&(n.info(t.description),v())})}t.$inject=["$scope","pyramidsService","$filter","notifyService","identityService","challengesService"],angular.module("app").directive("kpPyramid",e)}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"/pyramids/components/pyramid.html",replace:!0,scope:{pyramidId:"@"},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,r,n,i){function a(){t.getPyramid(y.pyramidId).then(function(e){y.pyramid=e.data,g=y.pyramid.players.length,_.find(y.pyramid.players,["_id",i.currentUser._id])&&(y.isPlayerOnPyramid=!0),s(),c(),u(),d(),m(),y.isPlayerOnPyramid&&p()})}function o(e){if(i.isAuthenticated()&&y.isPlayerOnPyramid)if(_.isEmpty(h)&&99!==e.position&&i.isAuthorized("admin"))h=e,h.class="active";else if(h===e&&i.isAuthorized("admin"))h.class="",h={};else if(e.level===h.level||e.level<h.level-1||e.level>h.level+1||99===e.position)n.error("Sorry, thats not allowed!");else{var r=h.position,a=h.level;v=e,h.position=e.position,h.level=e.level,v.position=r,v.level=a,t.swapPositions(y.pyramidId,h,v),h.class="",h={},v={}}else i.isAuthenticated()&&!y.isPlayerOnPyramid&&99===e.position?l():n.error("You can not update this pyramid.<br>You must join the pyramid first.")}function l(){var e={position:g+1,_id:i.currentUser._id,firstName:i.currentUser.firstName,lastName:i.currentUser.lastName,nickname:i.currentUser.nickname};t.addPlayerToPyramid(y.pyramidId,e).then(function(e){y.isPlayerOnPyramid=!0,f()})}function s(){y.pyramid.players=r("orderBy")(y.pyramid.players,"position")}function c(){y.breakPoints=[];for(var e=0;e<y.pyramid.levels;e++)y.breakPoints.push(e*(e+1)/2+1)}function u(){y.numberOfBlocks=0;for(var e=y.pyramid.levels;e>0;e--)y.numberOfBlocks+=e}function d(){for(var e=y.pyramid.players.length;e<y.numberOfBlocks;e++)y.pyramid.players.push({firstName:"Empty",lastName:"Spot",position:99,class:"empty"})}function m(){y.level=0;for(var e=0;e<y.pyramid.players.length;e++)y.breakPoints.indexOf(e+1)>-1&&(y.level+=1),y.pyramid.players[e].level=y.level}function p(){!i.isAuthorized("admin")&&i.isAuthenticated()&&y.isPlayerOnPyramid&&(h=_.find(y.pyramid.players,["_id",i.currentUser._id]),h.class="active")}function f(){t.getPyramid(y.pyramidId).then(function(e){y.pyramid=e.data,s(),d(),m(),p()})}var y=this;y.pyramid={},y.breakPoints=[],y.numberOfBlocks=0,y.level=0,y.updatePyramid=o,y.isPlayerOnPyramid=!1;var h={},v={},g=0;a(),e.$on("ws:match_results",function(e,t){n.info(t),f()})}angular.module("app").directive("_kpPyramid",e),t.$inject=["$scope","pyramidsService","$filter","Notification","identityService"]}(),function(){"use strict";function e(e){function t(t){return e.get("/api/pyramid",{params:{pyramidId:t}})}function r(t){return e.get("/api/pyramids/user",{params:{userId:t}})}function n(t){return e.post("/api/pyramids/create",{pyramid:t})}function i(t,r,n){return e.post("/api/pyramids/swapPositions",{pyramidId:t,challenger:r,opponent:n})}function a(t,r){return e.post("/api/pyramids/addPlayer",{pyramidId:t,player:r})}var o={getPyramid:t,getPyramidsForUser:r,createPyramid:n,swapPositions:i,addPlayerToPyramid:a};return o}e.$inject=["$http"],angular.module("app").factory("pyramidsService",e)}(),function(){"use strict";function e(e,t,r,n){function i(){r.getAllUsers().then(function(e){l.availablePlayers=e.data})}function a(e){s+=1;var t={position:s,_id:e._id,firstName:e.firstName,lastName:e.lastName,nickname:e.nickname};l.newPyramid.players.push(t),_.remove(l.availablePlayers,{_id:e._id})}function o(t){n.createPyramid(t).then(function(t){e.go("pyramids.view",{pyramidId:t.data._id})})}var l=this;l.availablePlayers=[],l.addPlayerToPyramid=a,l.createPyramid=o,i();var s=0}e.$inject=["$state","$stateParams","userService","pyramidsService"],angular.module("app").controller("AddPlayerCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){t.getAllUsers().then(function(e){a.availablePlayers=e.data})}function i(t){angular.forEach(a.addedPlayers,function(e){o+=1;var t={position:o,_id:e._id,firstName:e.firstName,lastName:e.lastName,nickname:e.nickname};a.newPyramid.players.push(t)}),r.createPyramid(t).then(function(t){e.go("pyramids.view",{pyramidId:t.data._id})})}var a=this;a.newPyramid={players:[]},a.availablePlayers=[],a.addedPlayers=[],a.createPyramid=i,a.newPyramid.levels=4,n();var o=0}e.$inject=["$state","userService","pyramidsService"],angular.module("app").controller("CreatePyramidCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){t.getPyramidsForUser(r.currentUser._id).then(function(e){i.pyramids=e.data})}var i=this;i.pyramids=null,n()}e.$inject=["$state","pyramidsService","identityService"],angular.module("app").controller("MyPyramidsCtrl",e)}(),function(){"use strict";function e(e){function t(){e.pyramidId&&(r.pyramidId=e.pyramidId)}var r=this;r.pyramidId=null,t()}e.$inject=["$stateParams"],angular.module("app").controller("PyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}var t=this;t.pyramids=null,e()}angular.module("app").controller("PyramidsCtrl",e)}(),function(){"use strict";function e(){function e(e,t){t.click(function(){t.next().slideToggle(200),t.parent().toggleClass("toggled")})}var t={restrict:"A",link:e};return t}angular.module("app").directive("toggleSubmenu",e)}(),function(){"use strict";function e(){function e(e,t){t.hasClass("btn-icon")||t.hasClass("btn-float")?Waves.attach(t,["waves-circle"]):t.hasClass("btn-light")?Waves.attach(t,["waves-light"]):Waves.attach(t),Waves.init()}var t={restrict:"C",link:e};return t}angular.module("app").directive("wavesEffect",e)}(),function(){"use strict";function e(){function e(e,t){var r=t.children().first(),n=t.parent().hasClass("fg-float");r.focus(function(){t.addClass("fg-toggled")}),r.blur(function(){(!n||n&&0===r.val().length)&&t.removeClass("fg-toggled")})}var t={restrict:"C",link:e};return t}angular.module("app").directive("fgLine",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiYXBwLmNvbnRyb2xsZXIuanMiLCJhcHAucm91dGVzLmpzIiwiYXBwLnJ1bi5qcyIsImNvbW1vbi9jb21wb25lbnRzL2NoYWxsZW5nZXMuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvZm9vdGVyLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL3NpZGViYXIuZGlyZWN0aXZlLmpzIiwiY29tbW9uL3NlcnZpY2VzL2NoYWxsZW5nZXMuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy9pbmRlbnRpdHkuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy9ub3RpZnkuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy93ZWJzb2NrZXQuc2VydmljZS5qcyIsImNvbW1vbi92aWV3cy9oZWFkZXIuY29udHJvbGxlci5qcyIsImNvbW1vbi92aWV3cy9ob21lLmNvbnRyb2xsZXIuanMiLCJhdXRoZW50aWNhdGlvbi92aWV3cy9sb2dpbi5jb250cm9sbGVyLmpzIiwiYXV0aGVudGljYXRpb24vdmlld3MvcmVnaXN0ZXIuY29udHJvbGxlci5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL2F1dGguc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL3VzZXIuc2VydmljZS5qcyIsInB5cmFtaWRzL2NvbXBvbmVudHMvcHlyYW1pZC5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL19weXJhbWlkLmRpcmVjdGl2ZS5qcyIsInB5cmFtaWRzL3NlcnZpY2VzL3B5cmFtaWRzLnNlcnZpY2UuanMiLCJweXJhbWlkcy92aWV3cy9hZGQtcGxheWVyLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy92aWV3cy9jcmVhdGUtcHlyYW1pZC5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvbXktcHlyYW1pZHMuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL3B5cmFtaWQuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL3B5cmFtaWRzLmNvbnRyb2xsZXIuanMiLCJjb21tb24vY29tcG9uZW50cy91aS90b2dnbGUtc3VibWVudS5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS93YXZlcy5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS9mb3Jtcy9mZy1saW5lLmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlndXJhdGlvbiIsImNvbmZpZyIsIkFwcEN0cmwiLCIkc3RhdGUiLCJ0b2dnbGVTaWRlYmFyIiwiYXBwQ3RybCIsInNpZGViYXJUb2dnbGUiLCJsZWZ0IiwidGhpcyIsInJpZ2h0IiwiY29udHJvbGxlciIsImNvbmZpZ3VyZVJvdXRlcyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJyb3V0ZVJvbGVDaGVja3MiLCJzdXBlckFkbWluIiwicmVxdWlyZVN1cGVyQWRtaW4iLCJhZG1pbiIsInJlcXVpcmVBZG1pbiIsInVzZXIiLCJyZXF1aXJlQXV0aCIsImh0bWw1TW9kZSIsIm90aGVyd2lzZSIsIndoZW4iLCJzdGF0ZSIsInVybCIsInZpZXdzIiwiY29udGVudCIsImNvbnRyb2xsZXJBcyIsInRlbXBsYXRlVXJsIiwiaGVhZGVyIiwic2lkZWJhciIsImNvbnRlbnRAIiwicmVzb2x2ZSIsImF1dGgiLCJhdXRoU2VydmljZSIsImF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUiLCJhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlIiwiJGluamVjdCIsImFwcFJ1biIsIiRyb290U2NvcGUiLCIkb24iLCJldmVudCIsInRvU3RhdGUiLCJ0b1BhcmFtcyIsImZyb21TdGF0ZSIsImZyb21QYXJhbXMiLCJlcnJvciIsImdvIiwicHJldmlvdXMiLCJydW4iLCJrcENoYWxsZW5lZ2VzIiwiZGlyZWN0aXZlIiwiYmluZFRvQ29udHJvbGxlciIsImN0cmxGdW5jIiwicmVzdHJpY3QiLCJzY29wZSIsImNvbXBldGl0aW9uSWQiLCIkc2NvcGUiLCJjaGFsbGVuZ2VzU2VydmljZSIsImFjdGl2YXRlIiwiZ2V0QWN0aXZlQ2hhbGxlbmdlcyIsImdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uIiwidm0iLCJ0aGVuIiwiY2hhbGxlbmdlcyIsImRhdGEiLCJsZW5ndGgiLCJfIiwiZm9yRWFjaCIsImNoYWxsZW5nZSIsImV4cGlyZXMiLCJtb21lbnQiLCJkaWZmIiwiY3JlYXRlZCIsImFkZCIsInRpbWVMaW1pdCIsImNoYWxsZW5nZURldGFpbHMiLCJrcEZvb3RlciIsImlkZW50aXR5U2VydmljZSIsImxvZ291dCIsImluZGVudGl0eSIsImtwU2lkZWJhciIsIiRodHRwIiwiY3JlYXRlQ2hhbGxlbmdlIiwicG9zdCIsImNvbXBsZXRlQ2hhbGxlbmdlIiwiZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb24iLCJnZXQiLCJwYXJhbXMiLCJnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIiLCJwbGF5ZXJJZCIsInNlcnZpY2UiLCJmYWN0b3J5IiwiJHdpbmRvdyIsImlzQXV0aGVudGljYXRlZCIsImN1cnJlbnRVc2VyIiwiaXNBdXRob3JpemVkIiwicm9sZSIsInJvbGVzIiwiaW5kZXhPZiIsImJvb3RzdHJhcHBlZFVzZXJPYmplY3QiLCJub3RpZnlTZXJ2aWNlIiwiaW5mbyIsIm1lc3NhZ2UiLCJ0YXJnZXQiLCIkIiwibm90aWZ5IiwiaWNvbiIsInR5cGUiLCJzdWNjZXNzIiwid2FybmluZyIsImludmVyc2UiLCJub3RpZnlEZWZhdWx0cyIsIm9mZnNldCIsIngiLCJ5Iiwid2Vic29ja2V0SG9zdCIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJob3N0IiwiY29ubmVjdGlvbiIsImNvbm5lY3QiLCJXZWJTb2NrZXQiLCJvbm1lc3NhZ2UiLCJlIiwicGF5bG9hZCIsIkpTT04iLCJwYXJzZSIsIiRicm9hZGNhc3QiLCJ0b3BpYyIsInNlbmQiLCJqc29uIiwic3RyaW5naWZ5Iiwid2Vic29ja2V0U2VydmljZSIsIkhlYWRlckN0cmwiLCJIb21lQ3RybCIsIkxvZ2luQ3RybCIsImNvbnNvbGUiLCJsb2ciLCJsb2dpbiIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJhdXRoZW50aWNhdGVVc2VyIiwicmVzcG9uc2UiLCJSZWdpc3RlckN0cmwiLCJyZWdpc3RlciIsIm5ld1VzZXIiLCJjcmVhdGVVc2VyIiwiJHEiLCJ1c2VyU2VydmljZSIsImRmZCIsImRlZmVyIiwicHJvbWlzZSIsInVzZXJEYXRhIiwidW5kZWZpbmVkIiwicmVqZWN0IiwiZ2V0QWxsVXNlcnMiLCJ1c2VycyIsImtwUHlyYW1pZCIsInJlcGxhY2UiLCJweXJhbWlkc1NlcnZpY2UiLCIkZmlsdGVyIiwiZ2V0UHlyYW1pZCIsInB5cmFtaWQiLCJsZXZlbHMiLCJpIiwicHVzaCIsIm9yZGVyUGxheWVycyIsImdldFBsYXllcnNTdGF0dXMiLCJjYWxjdWxhdGVQeXJhbWlkQmxvY2tzIiwiZmlsbEluRW1wdHlCbG9ja3MiLCJhc3NpZ25MZXZlbHNUb1BsYXllcnMiLCJwbGF5ZXJzIiwicGxheWVyIiwiX2lkIiwiaXNDdXJyZW50VXNlck9uUHlyYW1pZCIsImNsYXNzIiwiY3VycmVudFVzZXJQbGF5ZXIiLCJjaGFsbGVuZ2VyIiwicG9zaXRpb24iLCJ0aW1lVG9FeHBpcmUiLCJjb21wbGV0ZSIsImhhc0FjdGl2ZUNoYWxsZW5nZSIsImNyZWF0ZUJyZWFrUG9pbnRzIiwiYnJlYWtQb2ludHMiLCJudW1iZXJPZkJsb2NrcyIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwibGV2ZWwiLCJzdGFydENoYWxsZW5nZSIsImNhbmNlbCIsInNob3dDcmVhdGVDaGFsbGVuZ2VPcHRpb25zIiwibGV2ZWxBYm92ZSIsImF2YWlsYWJsZUNoYWxsZW5nZXMiLCJhdmFpbGFibGUiLCJmb3JmZWl0Iiwibmlja25hbWUiLCJvcHBvbmVudCIsInJlZnJlc2hQeXJhbWlkIiwid2lubmVySXNDdXJyZW50VXNlciIsImZvcmZlaXRXaW5uZXIiLCJzaG93Q29tcGxldGVDaGFsbGVuZ2VPcHRpb25zIiwic3dhcFBvc2l0aW9ucyIsIndpbm5lciIsImNoYWxsZW5nZUV4cGlyZWQiLCJkZXNjcmlwdGlvbiIsIl9rcFB5cmFtaWQiLCJweXJhbWlkSWQiLCJOb3RpZmljYXRpb24iLCJudW1iZXJPZkFjdHVhbFBsYXllcnMiLCJmaW5kIiwiaXNQbGF5ZXJPblB5cmFtaWQiLCJhc3NpZ25QbGF5ZXJPbmUiLCJ1cGRhdGVQeXJhbWlkIiwiaXNFbXB0eSIsInBsYXllcjEiLCJwbGF5ZXIxT2xkUG9zaXRpb24iLCJwbGF5ZXIxT2xkTGV2ZWwiLCJwbGF5ZXIyIiwiYWRkUGxheWVyVG9QeXJhbWlkIiwibmV3UGxheWVyIiwicmVzdWx0IiwiZ2V0UHlyYW1pZHNGb3JVc2VyIiwidXNlcklkIiwiY3JlYXRlUHlyYW1pZCIsIkFkZFBsYXllckN0cmwiLCIkc3RhdGVQYXJhbXMiLCJhdmFpbGFibGVQbGF5ZXJzIiwiYWRkUGxheWVyIiwibmV3UHlyYW1pZCIsInJlbW92ZSIsIkNyZWF0ZVB5cmFtaWRDdHJsIiwiYWRkZWRQbGF5ZXJzIiwiTXlQeXJhbWlkc0N0cmwiLCJweXJhbWlkcyIsIlB5cmFtaWRDdHJsIiwiUHlyYW1pZHNDdHJsIiwidG9nZ2xlU3VibWVudSIsImxpbmtGdW5jIiwiZWwiLCJjbGljayIsIm5leHQiLCJzbGlkZVRvZ2dsZSIsInBhcmVudCIsInRvZ2dsZUNsYXNzIiwibGluayIsIndhdmVzRWZmZWN0IiwiZWxlbWVudCIsImhhc0NsYXNzIiwiV2F2ZXMiLCJhdHRhY2giLCJpbml0IiwiZmdMaW5lIiwiaW5wdXQiLCJjaGlsZHJlbiIsImZpcnN0IiwiaXNGbG9hdExhYmVsIiwiZm9jdXMiLCJhZGRDbGFzcyIsImJsdXIiLCJ2YWwiLCJyZW1vdmVDbGFzcyJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQUFDLE9BQUEsT0FDQSxZQUNBLFlBQ0Esc0JBQ0EsYUFDQSx3QkFDQSxVQ05BLFdBQ0EsYUFHQSxTQUFB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Z00sR0FDQSxHQUFBTSxHQUFBTixFQUFBTyxXQUFBQyxRQUNBQyxFQUFBVCxFQUFBSixTQUFBSyxTQUFBLFdBQ0FLLEdBQUFJLE1BQUEsV0FDQVYsRUFBQVcsU0FBQSxnQkFHQUwsRUFBQU0sS0FBQSxhQUNBSCxHQUFBQSxHQUFBLElBQUFILEVBQUFPLE1BQUFsTSxTQUNBcUwsRUFBQWMsWUFBQSxnQkFoQkEsR0FBQWxOLElBQ0FHLFNBQUEsSUFDQStMLEtBQUFQLEVBR0EsT0FBQTNMLEdBVkF2RCxRQUNBQyxPQUFBLE9BQ0FzRCxVQUFBLFNBQUF5TSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAndWkucm91dGVyJyxcbiAgJ25nQW5pbWF0ZScsXG4gICdhbmd1bGFyLWxvYWRpbmctYmFyJyxcbiAgJ25vdWlzbGlkZXInLFxuICAnbG9jYWx5dGljcy5kaXJlY3RpdmVzJyxcbiAgJ3RpbWVyJ1xuXSk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QgJztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbmZpZyhjb25maWd1cmF0aW9uKTtcblxuICBmdW5jdGlvbiBjb25maWd1cmF0aW9uKCkge1xuXG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQXBwQ3RybCcsIEFwcEN0cmwpO1xuXG4gIGZ1bmN0aW9uIEFwcEN0cmwoJHN0YXRlKSB7XG4gICAgdmFyIGFwcEN0cmwgPSB0aGlzO1xuICAgIGFwcEN0cmwudG9nZ2xlU2lkZWJhciA9IHRvZ2dsZVNpZGViYXI7XG4gICAgYXBwQ3RybC4kc3RhdGUgPSAkc3RhdGU7XG4gICAgLy8gQnkgZGVmYXVsdCBTaWRiYXJzIGFyZSBoaWRkZW4gaW4gYm94ZWQgbGF5b3V0IGFuZCBpbiB3aWRlIGxheW91dCBvbmx5IHRoZSByaWdodCBzaWRlYmFyIGlzIGhpZGRlbi5cbiAgICBhcHBDdHJsLnNpZGViYXJUb2dnbGUgPSB7XG4gICAgICBsZWZ0OiBmYWxzZSxcbiAgICAgIHJpZ2h0OiBmYWxzZVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiB0b2dnbGVTaWRlYmFyKCkge1xuICAgICAgYXBwQ3RybC5zaWRlYmFyVG9nZ2xlLmxlZnQgPSAhYXBwQ3RybC5zaWRlYmFyVG9nZ2xlLmxlZnQ7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbmZpZyhjb25maWd1cmVSb3V0ZXMpO1xuXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyZVJvdXRlcygkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgIHZhciByb3V0ZVJvbGVDaGVja3MgPSB7XG4gICAgICBzdXBlckFkbWluOiByZXF1aXJlU3VwZXJBZG1pbixcbiAgICAgIGFkbWluOiByZXF1aXJlQWRtaW4sXG4gICAgICB1c2VyOiByZXF1aXJlQXV0aFxuICAgIH07XG5cbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG5cbiAgICAvLyBmb3IgYW55IHVubWF0Y2hlZCB1cmxcbiAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG5cbiAgICAkdXJsUm91dGVyUHJvdmlkZXIud2hlbignL3B5cmFtaWRzLycsICcvcHlyYW1pZHMnKTtcblxuICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAuc3RhdGUoJ2hvbWUnLCB7XG4gICAgICAgIHVybDogJy8nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tbW9uL3ZpZXdzL2hvbWUuaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICAgICdoZWFkZXInOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSGVhZGVyQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbW1vbi92aWV3cy9oZWFkZXIuaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICAgICdzaWRlYmFyJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1NpZGViYXJDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tbW9uL3ZpZXdzL3NpZGViYXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcycsIHtcbiAgICAgICAgdXJsOiAnL3B5cmFtaWRzJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQeXJhbWlkc0N0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9weXJhbWlkcy5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2hlYWRlcic6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIZWFkZXJDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tbW9uL3ZpZXdzL2hlYWRlci5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLm15UHlyYW1pZHMnLCB7XG4gICAgICAgIHVybDogJy9teS1weXJhbWlkcycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ015UHlyYW1pZHNDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvbXktcHlyYW1pZHMuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICBhdXRoOiByb3V0ZVJvbGVDaGVja3MudXNlclxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMudmlldycsIHtcbiAgICAgICAgdXJsOiAnL3ZpZXcvOnB5cmFtaWRJZCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1B5cmFtaWRDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvcHlyYW1pZC5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLmNyZWF0ZScsIHtcbiAgICAgICAgdXJsOiAnL2NyZWF0ZScsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0NyZWF0ZVB5cmFtaWRDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvY3JlYXRlLXB5cmFtaWQuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICBhdXRoOiByb3V0ZVJvbGVDaGVja3MudXNlclxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvbG9naW4uaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICAgICdoZWFkZXInOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSGVhZGVyQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbW1vbi92aWV3cy9oZWFkZXIuaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICAgICdzaWRlYmFyJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1NpZGViYXJDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tbW9uL3ZpZXdzL3NpZGViYXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdyZWdpc3RlcicsIHtcbiAgICAgICAgdXJsOiAnL3JlZ2lzdGVyJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy9yZWdpc3Rlci5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2hlYWRlcic6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIZWFkZXJDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tbW9uL3ZpZXdzL2hlYWRlci5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ3NpZGViYXInOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2lkZWJhckN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21tb24vdmlld3Mvc2lkZWJhci5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cblxuICByZXF1aXJlQWRtaW4uJGluamVjdCA9IFsnYXV0aFNlcnZpY2UnXTtcblxuICBmdW5jdGlvbiByZXF1aXJlQWRtaW4oYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSgnYWRtaW4nKTtcbiAgfVxuXG4gIHJlcXVpcmVTdXBlckFkbWluLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZVN1cGVyQWRtaW4oYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSgnc3VwZXItYWRtaW4nKTtcbiAgfVxuXG4gIHJlcXVpcmVBdXRoLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZUF1dGgoYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLnJ1bihhcHBSdW4pO1xuXG4gIGZ1bmN0aW9uIGFwcFJ1bigkcm9vdFNjb3BlLCAkc3RhdGUpIHtcbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlRXJyb3InLCBmdW5jdGlvbiAoZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMsIGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgPT09ICdub3QgYXV0aG9yaXplZCcpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgICAkc3RhdGUucHJldmlvdXMgPSB0b1N0YXRlO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcENoYWxsZW5lZ2VzJywga3BDaGFsbGVuZWdlcyk7XG5cbiAgZnVuY3Rpb24ga3BDaGFsbGVuZWdlcygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6ICdAJ1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbW1vbi9jb21wb25lbnRzL2NoYWxsZW5nZXMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlcygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZXMoKSB7XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIGlmIChjaGFsbGVuZ2VzLmRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZtLmNoYWxsZW5nZXMgPSBjaGFsbGVuZ2VzLmRhdGE7XG4gICAgICAgICAgXy5mb3JFYWNoKHZtLmNoYWxsZW5nZXMsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5leHBpcmVzID0gKG1vbWVudCgpLmRpZmYobW9tZW50KGNoYWxsZW5nZS5jcmVhdGVkKS5hZGQoY2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2gnKSwncycpKSAqIC0xO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NyZWF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIGdldEFjdGl2ZUNoYWxsZW5nZXMoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BGb290ZXInLCBrcEZvb3Rlcik7XG5cbiAgZnVuY3Rpb24ga3BGb290ZXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9mb290ZXIuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoaWRlbnRpdHlTZXJ2aWNlLCBhdXRoU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgIHZtLmxvZ291dCA9IGxvZ291dDtcblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BTaWRlYmFyJywga3BTaWRlYmFyKTtcblxuICBmdW5jdGlvbiBrcFNpZGViYXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9zaWRlYmFyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmluZGVudGl0eSA9IGlkZW50aXR5U2VydmljZTtcbiAgICB2bS5sb2dvdXQgPSBsb2dvdXQ7XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnY2hhbGxlbmdlc1NlcnZpY2UnLCBjaGFsbGVuZ2VzU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gY2hhbGxlbmdlc1NlcnZpY2UoJGh0dHApIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGNyZWF0ZUNoYWxsZW5nZTogY3JlYXRlQ2hhbGxlbmdlLFxuICAgICAgY29tcGxldGVDaGFsbGVuZ2U6IGNvbXBsZXRlQ2hhbGxlbmdlLFxuICAgICAgZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyOiBnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXJcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jaGFsbGVuZ2VzL2NyZWF0ZScsIHtcbiAgICAgICAgY2hhbGxlbmdlOiBjaGFsbGVuZ2VcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvbXBsZXRlQ2hhbGxlbmdlKGNoYWxsZW5nZSkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvY2hhbGxlbmdlcy9jb21wbGV0ZScsICB7XG4gICAgICAgIGNoYWxsZW5nZTogY2hhbGxlbmdlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvY29tcGV0aXRpb24nLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvYWN0aXZlL2NvbXBldGl0aW9uL3BsYXllcicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgcGxheWVySWQ6IHBsYXllcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdpZGVudGl0eVNlcnZpY2UnLCBpZGVudGl0eVNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIGlkZW50aXR5U2VydmljZSgkd2luZG93KSB7XG4gICAgdmFyIGN1cnJlbnRVc2VyO1xuICAgIGlmICgkd2luZG93LmJvb3RzdHJhcHBlZFVzZXJPYmplY3QgIT09IG51bGwpIHtcbiAgICAgIGN1cnJlbnRVc2VyID0gJHdpbmRvdy5ib290c3RyYXBwZWRVc2VyT2JqZWN0O1xuICAgIH1cbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGN1cnJlbnRVc2VyOiBjdXJyZW50VXNlcixcbiAgICAgIGlzQXV0aGVudGljYXRlZDogaXNBdXRoZW50aWNhdGVkLFxuICAgICAgaXNBdXRob3JpemVkOiBpc0F1dGhvcml6ZWRcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gaXNBdXRoZW50aWNhdGVkKCkge1xuICAgICAgcmV0dXJuICEhdGhpcy5jdXJyZW50VXNlcjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0F1dGhvcml6ZWQocm9sZSkge1xuICAgICAgcmV0dXJuICEhdGhpcy5jdXJyZW50VXNlciAmJiB0aGlzLmN1cnJlbnRVc2VyLnJvbGVzLmluZGV4T2Yocm9sZSkgPiAtMTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnbm90aWZ5U2VydmljZScsIG5vdGlmeVNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIG5vdGlmeVNlcnZpY2UoKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBpbmZvOiBpbmZvLFxuICAgICAgc3VjY2Vzczogc3VjY2VzcyxcbiAgICAgIHdhcm5pbmc6IHdhcm5pbmcsXG4gICAgICBlcnJvcjogZXJyb3IsXG4gICAgICBpbnZlcnNlOiBpbnZlcnNlXG4gICAgfTtcblxuICAgICQubm90aWZ5RGVmYXVsdHMoe1xuICAgICAgb2Zmc2V0OiB7XG4gICAgICAgIHg6IDIwLFxuICAgICAgICB5OiA4NVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBpbmZvKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgaWNvbjogJ3ptZGkgem1kaS1hbGVydC1jaXJjbGUtbycsXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnaW5mbydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Y2Nlc3MobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBpY29uOiAnem1kaSB6bWRpLWNoZWNrJyxcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdzdWNjZXNzJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd2FybmluZyhtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIGljb246ICd6bWRpIHptZGktYWxlcnQtdHJpYW5nbGUnLFxuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ3dhcm5pbmcnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIGljb246ICd6bWRpIHptZGktYWxlcnQtb2N0YWdvbicsXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnZGFuZ2VyJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW52ZXJzZShtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnaW52ZXJzZSdcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgLnNlcnZpY2UoJ3dlYnNvY2tldFNlcnZpY2UnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHdpbmRvdykge1xuICAgIGZ1bmN0aW9uIHdlYnNvY2tldEhvc3QoKSB7XG4gICAgICBpZiAoJHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHBzOicpIHtcbiAgICAgICAgcmV0dXJuICd3c3M6Ly8nICsgJHdpbmRvdy5sb2NhdGlvbi5ob3N0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICd3czovLycgKyAkd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGNvbm5lY3Rpb247XG4gICAgdGhpcy5jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgY29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQod2Vic29ja2V0SG9zdCgpKTtcblxuICAgICAgY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgcGF5bG9hZCA9IEpTT04ucGFyc2UoZS5kYXRhKTtcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd3czonICsgcGF5bG9hZC50b3BpYywgcGF5bG9hZC5kYXRhKTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIHRoaXMuc2VuZCA9IGZ1bmN0aW9uICh0b3BpYywgZGF0YSkge1xuICAgICAgdmFyIGpzb24gPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIHRvcGljOiB0b3BpYyxcbiAgICAgICAgZGF0YTogZGF0YVxuICAgICAgfSk7XG4gICAgICBjb25uZWN0aW9uLnNlbmQoanNvbik7XG4gICAgfTtcbiAgfSkucnVuKGZ1bmN0aW9uICh3ZWJzb2NrZXRTZXJ2aWNlKSB7XG4gICAgd2Vic29ja2V0U2VydmljZS5jb25uZWN0KCk7XG4gIH0pOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0hlYWRlckN0cmwnLCBIZWFkZXJDdHJsKTtcblxuICBmdW5jdGlvbiBIZWFkZXJDdHJsKGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmluZGVudGl0eSA9IGlkZW50aXR5U2VydmljZTtcbiAgICB2bS5sb2dvdXQgPSBsb2dvdXQ7XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignSG9tZUN0cmwnLCBIb21lQ3RybCk7XG5cbiAgZnVuY3Rpb24gSG9tZUN0cmwoKSB7XG4gICAgdmFyIHZtID0gdGhpcztcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHt9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTG9naW5DdHJsJywgTG9naW5DdHJsKTtcblxuICBmdW5jdGlvbiBMb2dpbkN0cmwoJHN0YXRlLCBhdXRoU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubG9naW4gPSBsb2dpbjtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGNvbnNvbGUubG9nKCRzdGF0ZS5wcmV2aW91cyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICBhdXRoU2VydmljZS5hdXRoZW50aWNhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1VzZXJuYW1lIC8gcGFzc3dvcmQgY29tYmluYWl0b24gaW5jb3JyZWN0Jyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS5zdWNjZXNzKCdMb2dpbiBzdWNjZXNzZnVsLiAgV2VsY29tZSB0byBLbmlmZXBsYW5lIScpO1xuICAgICAgICAgIGlmICgkc3RhdGUucHJldmlvdXMpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygkc3RhdGUucHJldmlvdXMpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBSZWdpc3RlckN0cmwpO1xuXG4gIGZ1bmN0aW9uIFJlZ2lzdGVyQ3RybCgkc2NvcGUsICRzdGF0ZSwgYXV0aFNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnJlZ2lzdGVyID0gcmVnaXN0ZXI7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXIobmV3VXNlcikge1xuICAgICAgYXV0aFNlcnZpY2UuY3JlYXRlVXNlcihuZXdVc2VyKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdhdXRoU2VydmljZScsIGF1dGhTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBhdXRoU2VydmljZSgkc3RhdGUsICRodHRwLCAkcSwgdXNlclNlcnZpY2UsIGlkZW50aXR5U2VydmljZSkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgYXV0aGVudGljYXRlVXNlcjogYXV0aGVudGljYXRlVXNlcixcbiAgICAgIGNyZWF0ZVVzZXI6IGNyZWF0ZVVzZXIsXG4gICAgICBsb2dvdXQ6IGxvZ291dCxcbiAgICAgIGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGU6IGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUsXG4gICAgICBhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlOiBhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9sb2dpbicsIHtcbiAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSByZXNwb25zZS5kYXRhLnVzZXI7XG4gICAgICAgICAgZGZkLnJlc29sdmUodHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVVc2VyKHVzZXJEYXRhKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG4gICAgICAgIHVzZXJEYXRhOiB1c2VyRGF0YVxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgIGRmZC5yZXNvbHZlKHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRmZC5yZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5wb3N0KCcvbG9nb3V0Jywge1xuICAgICAgICBsb2dvdXQ6IHRydWVcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIGRmZC5yZXNvbHZlKCk7XG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZShyb2xlKSB7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aG9yaXplZChyb2xlKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoJ25vdCBhdXRob3JpemVkJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpIHtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJHEucmVqZWN0KCdub3QgYXV0aG9yaXplZCcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCd1c2VyU2VydmljZScsIHVzZXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiB1c2VyU2VydmljZSgkaHR0cCwgaWRlbnRpdHlTZXJ2aWNlKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBnZXRBbGxVc2VyczogZ2V0QWxsVXNlcnNcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gZ2V0QWxsVXNlcnMoKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJykudGhlbihmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJzO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BQeXJhbWlkJywga3BQeXJhbWlkKTtcblxuICBmdW5jdGlvbiBrcFB5cmFtaWQoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9weXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQuaHRtbCcsXG4gICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogJ0AnXG4gICAgICB9LFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBweXJhbWlkc1NlcnZpY2UsICRmaWx0ZXIsIG5vdGlmeVNlcnZpY2UsIGlkZW50aXR5U2VydmljZSwgY2hhbGxlbmdlc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnB5cmFtaWQgPSB7fTtcbiAgICB2bS5icmVha1BvaW50cyA9IFtdO1xuICAgIHZtLm51bWJlck9mQmxvY2tzID0gMDtcbiAgICB2bS5pc0N1cnJlbnRVc2VyT25QeXJhbWlkID0gZmFsc2U7XG4gICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gZmFsc2U7XG4gICAgdm0uc2hvd0NyZWF0ZUNoYWxsZW5nZU9wdGlvbnMgPSBmYWxzZTtcbiAgICB2bS5zaG93Q29tcGxldGVDaGFsbGVuZ2VPcHRpb25zID0gZmFsc2U7XG4gICAgdm0uYXZhaWxhYmxlQ2hhbGxlbmdlcyA9IGZhbHNlO1xuICAgIHZtLnN0YXJ0Q2hhbGxlbmdlID0gc3RhcnRDaGFsbGVuZ2U7XG4gICAgdm0uY3JlYXRlQ2hhbGxlbmdlID0gY3JlYXRlQ2hhbGxlbmdlO1xuICAgIHZtLmNvbXBsZXRlQ2hhbGxlbmdlID0gY29tcGxldGVDaGFsbGVuZ2U7XG4gICAgdm0uY2hhbGxlbmdlRXhwaXJlZCA9IGNoYWxsZW5nZUV4cGlyZWQ7XG4gICAgdm0uY3VycmVudFVzZXJQbGF5ZXIgPSB7fTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcblxuICAgICAgICB2bS5sZXZlbHMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gcHlyYW1pZC5kYXRhLmxldmVsczsgKytpKSB7XG4gICAgICAgICAgdm0ubGV2ZWxzLnB1c2goaSk7XG4gICAgICAgIH1cblxuICAgICAgICBvcmRlclBsYXllcnMoKTtcbiAgICAgICAgZ2V0UGxheWVyc1N0YXR1cygpO1xuICAgICAgICBjYWxjdWxhdGVQeXJhbWlkQmxvY2tzKCk7XG4gICAgICAgIGZpbGxJbkVtcHR5QmxvY2tzKCk7XG4gICAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3JkZXIgdGhlIHBsYXllcnMgYnkgdGhlIHBvc2l0aW9uIHByb3BlcnR5IG9mIHRoZSBwbGF5ZXJzIGFycmF5IGluIHRoZSBweXJhbWlkIG9iamVjdFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9yZGVyUGxheWVycygpIHtcbiAgICAgIHZtLnB5cmFtaWQucGxheWVycyA9ICRmaWx0ZXIoJ29yZGVyQnknKSh2bS5weXJhbWlkLnBsYXllcnMsICdwb3NpdGlvbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpZ3VyZSBvdXQgaWYgZWFjaCBwbGF5ZXIgaXMgYWxyZWFkeSBjaGFsbGVuZ2VkIGFuZCBzZXQgc29tZSBzdHVmZlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFBsYXllcnNTdGF0dXMoKSB7XG4gICAgICBfLmZvckVhY2godm0ucHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG5cbiAgICAgICAgLy8gRmluZCB0aGUgY3VycmVudCB1c2VyIGlmIHRoZXkgYXJlIG9uIHRoaXMgcHlyYW1pZCBhbmQgc2V0IHNvbWUgcHJvcGVydGllc1xuICAgICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyICYmIHBsYXllci5faWQgPT09IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQpIHtcbiAgICAgICAgICB2bS5pc0N1cnJlbnRVc2VyT25QeXJhbWlkID0gdHJ1ZTtcbiAgICAgICAgICBwbGF5ZXIuY2xhc3MgPSAnY3VycmVudC11c2VyJztcbiAgICAgICAgICB2bS5jdXJyZW50VXNlclBsYXllciA9IHBsYXllcjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEdldCB0aGUgYWN0aXZlIGNoYWxsZW5nZXMgZm9yIGVhY2ggcGxheWVyIGFuZCBkbyBzb21lIHN0dWZmXG4gICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcih2bS5jb21wZXRpdGlvbklkLCBwbGF5ZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICAvLyBJZiB0aGlzIHBsYXllciBpcyBpbnZvbGVkIGluIGFuIGFjdGl2ZSBjaGFsbGFuZ2VcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEpIHtcbiAgICAgICAgICAgIC8vIEluaXQgYSBjaGFsbGVuZ2Ugb2JqZWN0IG9uIHRoaXMgcGxheWVyXG4gICAgICAgICAgICBwbGF5ZXIuY2hhbGxlbmdlID0ge307XG4gICAgICAgICAgICAvLyBDYXB0dXJlIGlmIHRoZXkgYXJlIHRoZSBjaGFsbGVuZ2VyIG9yIHRoZSBvcHBvbmVudFxuICAgICAgICAgICAgaWYgKHBsYXllci5faWQgPT09IGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIuX2lkKSB7XG4gICAgICAgICAgICAgIHBsYXllci5jaGFsbGVuZ2UucG9zaXRpb24gPSAnY2hhbGxlbmdlcic7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBwbGF5ZXIuY2hhbGxlbmdlLnBvc2l0aW9uID0gJ29wcG9uZW50JztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVHJhY2sgd2hlbiB0aGUgY2hhbGxlbmdlIHdpbGwgZXhwaXJlXG4gICAgICAgICAgICB2YXIgdGltZVRvRXhwaXJlID0gbW9tZW50KCkuZGlmZihtb21lbnQoY2hhbGxlbmdlLmRhdGEuY3JlYXRlZCkuYWRkKGNoYWxsZW5nZS5kYXRhLnRpbWVMaW1pdCwgJ2gnKSwgJ3MnKSAqIC0xO1xuICAgICAgICAgICAgLy90aW1lVG9FeHBpcmUgPSAwO1xuICAgICAgICAgICAgLy8gSWYgdGhlIGNoYWxsZW5nZSBoYXMgbm90IHlldCBleHBpcmVkIGRpc3BsYXkgYSBjb3VudGRvd25cbiAgICAgICAgICAgIGlmICh0aW1lVG9FeHBpcmUgPiAwKSB7XG4gICAgICAgICAgICAgIHBsYXllci5jaGFsbGVuZ2UuZXhwaXJlcyA9IHRpbWVUb0V4cGlyZTtcbiAgICAgICAgICAgICAgLy8gSWYgdGhleSBjaGFsbGVuZ2UgZXhwaXJlZCB3aGlsZSBubyBvbmUgd2FzIHZpZXdpbmcgdGhpcyBweXJhbWlkLCBjb21wbGV0ZSB0aGUgY2hhbGxlbmdlIGJ5IGZvcmZlaXRcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGltZVRvRXhwaXJlIDw9IDAgJiYgIWNoYWxsZW5nZS5kYXRhLmNvbXBsZXRlICYmIHBsYXllci5jaGFsbGVuZ2UucG9zaXRpb24gPT09ICdjaGFsbGVuZ2VyJykge1xuICAgICAgICAgICAgICBjb21wbGV0ZUNoYWxsZW5nZShudWxsLCB0cnVlLCBwbGF5ZXIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJZiB0aGlzIGlzIHRoZSBjdXJyZW50bHkgbG9nZ2VkIGluIHVzZXIgc2V0IHNvbWUgcHJvcGVydGllcyBmb3IgdXNlXG4gICAgICAgICAgICBpZiAodm0uaXNDdXJyZW50VXNlck9uUHlyYW1pZCAmJiBwbGF5ZXIuX2lkID09PSBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkKSB7XG4gICAgICAgICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IHRydWU7XG4gICAgICAgICAgICAgIC8vIElmIHRoaXMgaXMgbm90IHRoZSBjdXJyZW50bHkgbG9nZ2VkIGluIHVzZXIgbWFyayB0aGVtIGFzIHVuYXZhaWxhYmxlXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBwbGF5ZXIuY2xhc3MgPSAndW5hdmFpbGFibGUnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaWd1cmUgb3V0IHdoZXJlIHRvIHN0YXJ0IGVhY2ggbmV3IHJvdyBvbiB0aGUgcHlyYW1pZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZUJyZWFrUG9pbnRzKCkge1xuICAgICAgdm0uYnJlYWtQb2ludHMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ucHlyYW1pZC5sZXZlbHM7IGkrKykge1xuICAgICAgICB2bS5icmVha1BvaW50cy5wdXNoKCgoKGkgKiAoaSArIDEpKSAvIDIpKSArIDEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhvdyBtYW55IHRvdGFsIGJsb2NrcyBpbiB0aGlzIHB5cmFtaWRcbiAgICBmdW5jdGlvbiBjYWxjdWxhdGVQeXJhbWlkQmxvY2tzKCkge1xuICAgICAgdm0ubnVtYmVyT2ZCbG9ja3MgPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IHZtLnB5cmFtaWQubGV2ZWxzOyBpID4gMDsgaS0tKSB7XG4gICAgICAgIHZtLm51bWJlck9mQmxvY2tzICs9IGk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmlsbCBvdXQgdGhlIHJlbWFpbmluZyBibG9ja3Mgb2YgdGhlIHB5cmFtaWQgd2l0aCBlbXB0eSBibG9ja3NcbiAgICBmdW5jdGlvbiBmaWxsSW5FbXB0eUJsb2NrcygpIHtcbiAgICAgIGZvciAodmFyIGkgPSB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoOyBpIDwgdm0ubnVtYmVyT2ZCbG9ja3M7IGkrKykge1xuICAgICAgICB2bS5weXJhbWlkLnBsYXllcnMucHVzaCh7XG4gICAgICAgICAgZmlyc3ROYW1lOiAnRW1wdHknLFxuICAgICAgICAgIGxhc3ROYW1lOiAnU3BvdCcsXG4gICAgICAgICAgcG9zaXRpb246IDk5LFxuICAgICAgICAgIGNsYXNzOiAnZW1wdHknXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdpdmUgZWFjaCBwbGF5ZXIgYSBsZXZlbCBwcm9wZXJ0eSBiYXNlZCBvbiB0aGUgYnJlYWsgcG9pbnRzXG4gICAgLy8gVGhpcyB3aWxsIGJlIHVzZWQgdG8gZGV0ZXJtaW5lIHdobyBvdGhlciBwbGF5ZXJzIGNhbiBjaGFsbGVuZ2VcbiAgICBmdW5jdGlvbiBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKSB7XG4gICAgICB2YXIgbGV2ZWwgPSAwO1xuICAgICAgY3JlYXRlQnJlYWtQb2ludHMoKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh2bS5icmVha1BvaW50cy5pbmRleE9mKGkgKyAxKSA+IC0xKSB7XG4gICAgICAgICAgbGV2ZWwgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICB2bS5weXJhbWlkLnBsYXllcnNbaV0ubGV2ZWwgPSBsZXZlbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdGFydENoYWxsZW5nZShjYW5jZWwpIHtcbiAgICAgIGlmICghY2FuY2VsKSB7XG4gICAgICAgIHZtLnNob3dDcmVhdGVDaGFsbGVuZ2VPcHRpb25zID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZtLnNob3dDcmVhdGVDaGFsbGVuZ2VPcHRpb25zID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIC8vIEZpbmQgdGhlIHBsYXllcnMgYXZhaWxhYmxlIHRvIGJlIGNoYWxsZW5nZWRcbiAgICAgIHZhciBsZXZlbEFib3ZlID0gdm0uY3VycmVudFVzZXJQbGF5ZXIubGV2ZWwgPiAxID8gdm0uY3VycmVudFVzZXJQbGF5ZXIubGV2ZWwgLSAxIDogbnVsbDtcbiAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgaWYgKHBsYXllci5sZXZlbCA9PT0gbGV2ZWxBYm92ZSAmJiBwbGF5ZXIucG9zaXRpb24gIT09IDk5ICYmIHBsYXllci5jbGFzcyAhPSAndW5hdmFpbGFibGUnKSB7XG4gICAgICAgICAgdm0uYXZhaWxhYmxlQ2hhbGxlbmdlcyA9IHRydWU7XG4gICAgICAgICAgaWYgKCFjYW5jZWwpIHtcbiAgICAgICAgICAgIHBsYXllci5jbGFzcyA9ICdhdmFpbGFibGUnO1xuICAgICAgICAgICAgcGxheWVyLmF2YWlsYWJsZSA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBsYXllci5jbGFzcyA9ICcnO1xuICAgICAgICAgICAgcGxheWVyLmF2YWlsYWJsZSA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlQ2hhbGxlbmdlKHBsYXllcikge1xuICAgICAgaWYgKHZtLnNob3dDcmVhdGVDaGFsbGVuZ2VPcHRpb25zKSB7XG4gICAgICAgIGlmICghcGxheWVyLmF2YWlsYWJsZSkge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1NvcnJ5LCB0aGF0IGlzIG5vdCBhIHZhbGlkIGNoYWxsZW5nZS4nKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2bS5zaG93Q3JlYXRlQ2hhbGxlbmdlT3B0aW9ucyA9IGZhbHNlO1xuICAgICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IHRydWU7XG4gICAgICAgICAgdmFyIGNoYWxsZW5nZSA9IHtcbiAgICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IHZtLmNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgICBjb21wbGV0ZTogZmFsc2UsXG4gICAgICAgICAgICBmb3JmZWl0OiBmYWxzZSxcbiAgICAgICAgICAgIHRpbWVMaW1pdDogMjQsXG4gICAgICAgICAgICBjaGFsbGVuZ2VyOiB7XG4gICAgICAgICAgICAgIF9pZDogdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkLFxuICAgICAgICAgICAgICBmaXJzdE5hbWU6IHZtLmN1cnJlbnRVc2VyUGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgICAgbGFzdE5hbWU6IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxhc3ROYW1lLFxuICAgICAgICAgICAgICBuaWNrbmFtZTogdm0uY3VycmVudFVzZXJQbGF5ZXIubmlja25hbWUsXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiB2bS5jdXJyZW50VXNlclBsYXllci5wb3NpdGlvblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9wcG9uZW50OiB7XG4gICAgICAgICAgICAgIF9pZDogcGxheWVyLl9pZCxcbiAgICAgICAgICAgICAgZmlyc3ROYW1lOiBwbGF5ZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgICBsYXN0TmFtZTogcGxheWVyLmxhc3ROYW1lLFxuICAgICAgICAgICAgICBuaWNrbmFtZTogcGxheWVyLm5pY2tuYW1lLFxuICAgICAgICAgICAgICBwb3NpdGlvbjogcGxheWVyLnBvc2l0aW9uXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jcmVhdGVDaGFsbGVuZ2UoY2hhbGxlbmdlKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tcGxldGUgYSBjaGFsbGVuZ2UgYnkgYSB1c2VyIGludGVyYWN0aW9uIG9yIGEgZm9yZmVpdFxuICAgICAqIFxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IHdpbm5lcklzQ3VycmVudFVzZXJcbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSBmb3JmZWl0XG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBmb3JmZWl0V2lubmVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29tcGxldGVDaGFsbGVuZ2Uod2lubmVySXNDdXJyZW50VXNlciwgZm9yZmVpdCwgZm9yZmVpdFdpbm5lcikge1xuICAgICAgdmFyIHBsYXllciA9IGZvcmZlaXRXaW5uZXIgfHwgdm0uY3VycmVudFVzZXJQbGF5ZXI7XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIodm0uY29tcGV0aXRpb25JZCwgcGxheWVyLl9pZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IGZhbHNlO1xuICAgICAgICB2bS5zaG93Q3JlYXRlQ2hhbGxlbmdlT3B0aW9ucyA9IGZhbHNlO1xuICAgICAgICB2bS5zaG93Q29tcGxldGVDaGFsbGVuZ2VPcHRpb25zID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIHN3YXBQb3NpdGlvbnMgPSBmYWxzZTtcblxuICAgICAgICAvLyBJZiB0aGVyZSBpcyBhIGZvcmZlaXQgdGhhbiBzd2FwIHBvc2l0aW9uIGFuZCBtYWtlIHRoZSBjaGFsbGVuZ2VyIHRoZSB3aW5uZXJcbiAgICAgICAgaWYgKGZvcmZlaXQpIHtcbiAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS5mb3JmZWl0ID0gdHJ1ZTtcbiAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLndpbm5lciA9IHRydWU7XG4gICAgICAgICAgc3dhcFBvc2l0aW9ucyA9IHRydWU7XG4gICAgICAgICAgLy8gRmlndXJlIG91dCB3aG8gdGhlIHdpbm5lciB3YXMgdG8gc3RvcmUgaW4gdGhlIGNoYWxsZW5nZSByZWNvcmRcbiAgICAgICAgfSBlbHNlIGlmICh3aW5uZXJJc0N1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgaWYgKGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIuX2lkID09PSB2bS5jdXJyZW50VXNlclBsYXllci5faWQpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIud2lubmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS5vcHBvbmVudC53aW5uZXIgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci5faWQgPT09IHZtLmN1cnJlbnRVc2VyUGxheWVyLl9pZCkge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEub3Bwb25lbnQud2lubmVyID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci53aW5uZXIgPSB0cnVlO1xuICAgICAgICAgICAgc3dhcFBvc2l0aW9ucyA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWFyayB0aGUgY2hhbGxlbmdlIGFzIGNvbXBsZXRlIGFuZCBub3RlIHRoZSB3aW5uZXJcbiAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgIC8vIElmIHRoZSBjdXJyZW50IHVzZXIgaXMgdGhlIHdpbm5lciBhbmQgd2FzIHRoZSBjaGFsbGVuZ2VyXG4gICAgICAgICAgLy8gb3IgdGhlIGN1cnJlbnQgdXNlciBpcyBOT1QgdGhlIHdpbm5lciBhbmQgd2FzIHRoZSBvcHBvbmVudFxuICAgICAgICAgIC8vIHRoZW4gc3dhcCBwb3NpdGlvbnNcbiAgICAgICAgICBpZiAoc3dhcFBvc2l0aW9ucykge1xuICAgICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLnN3YXBQb3NpdGlvbnModm0uY29tcGV0aXRpb25JZCwgY2hhbGxlbmdlLmRhdGEub3Bwb25lbnQsIGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIpLnRoZW4ocmVmcmVzaFB5cmFtaWQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjaGFsbGVuZ2VFeHBpcmVkKCkge1xuICAgICAgY29tcGxldGVDaGFsbGVuZ2UobnVsbCwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgLy8gUmVmcmVzaCB0aGUgcHlyYW1pZCBiZWNhc3VlIG9mIGFuIHVwZGF0ZVxuICAgIGZ1bmN0aW9uIHJlZnJlc2hQeXJhbWlkKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuICAgICAgICBvcmRlclBsYXllcnMoKTtcbiAgICAgICAgZ2V0UGxheWVyc1N0YXR1cygpO1xuICAgICAgICBmaWxsSW5FbXB0eUJsb2NrcygpO1xuICAgICAgICBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjaGFsbGVuZ2VfY3JlYXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjaGFsbGVuZ2VfY29tcGxldGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmRpcmVjdGl2ZSgnX2twUHlyYW1pZCcsIF9rcFB5cmFtaWQpO1xuXG4gIGZ1bmN0aW9uIF9rcFB5cmFtaWQoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9weXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQuaHRtbCcsXG4gICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcHlyYW1pZElkOiAnQCdcbiAgICAgIH0sXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWVcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIGN0cmxGdW5jLiRpbmplY3QgPSBbJyRzY29wZScsICdweXJhbWlkc1NlcnZpY2UnLCAnJGZpbHRlcicsICdOb3RpZmljYXRpb24nLCAnaWRlbnRpdHlTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBweXJhbWlkc1NlcnZpY2UsICRmaWx0ZXIsIE5vdGlmaWNhdGlvbiwgaWRlbnRpdHlTZXJ2aWNlKSB7XG4gICAgLypqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5weXJhbWlkID0ge307XG4gICAgdm0uYnJlYWtQb2ludHMgPSBbXTtcbiAgICB2bS5udW1iZXJPZkJsb2NrcyA9IDA7XG4gICAgdm0ubGV2ZWwgPSAwO1xuICAgIHZtLnVwZGF0ZVB5cmFtaWQgPSB1cGRhdGVQeXJhbWlkO1xuICAgIHZtLmlzUGxheWVyT25QeXJhbWlkID0gZmFsc2U7XG5cbiAgICB2YXIgcGxheWVyMSA9IHt9O1xuICAgIHZhciBwbGF5ZXIyID0ge307XG4gICAgdmFyIG51bWJlck9mQWN0dWFsUGxheWVycyA9IDA7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5weXJhbWlkSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgbnVtYmVyT2ZBY3R1YWxQbGF5ZXJzID0gdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDtcblxuICAgICAgICBpZiAoXy5maW5kKHZtLnB5cmFtaWQucGxheWVycywgWydfaWQnLCBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkXSkpIHtcbiAgICAgICAgICB2bS5pc1BsYXllck9uUHlyYW1pZCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBvcmRlclBsYXllcnMoKTtcbiAgICAgICAgY3JlYXRlQnJlYWtQb2ludHMoKTtcbiAgICAgICAgY2FsY3VsYXRlUHlyYW1pZEJsb2NrcygpO1xuICAgICAgICBmaWxsSW5FbXB0eUJsb2NrcygpO1xuICAgICAgICBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKTtcbiAgICAgICAgaWYgKHZtLmlzUGxheWVyT25QeXJhbWlkKSB7XG4gICAgICAgICAgYXNzaWduUGxheWVyT25lKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZVB5cmFtaWQocGxheWVyKSB7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpICYmIHZtLmlzUGxheWVyT25QeXJhbWlkKSB7XG4gICAgICAgIC8vIEFsbG93IGFkbWlucyB0byBzZWxlY3QgdGhlIGZpcnN0IHBsYXllclxuICAgICAgICBpZiAoXy5pc0VtcHR5KHBsYXllcjEpICYmIHBsYXllci5wb3NpdGlvbiAhPT0gOTkgJiYgaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aG9yaXplZCgnYWRtaW4nKSkge1xuICAgICAgICAgIHBsYXllcjEgPSBwbGF5ZXI7XG4gICAgICAgICAgcGxheWVyMS5jbGFzcyA9ICdhY3RpdmUnO1xuICAgICAgICAgIC8vIEFsbG93IGFkbWlucyB0byBkZXNlbGVjdCB0aGUgZmlyc3QgcGxheWVyXG4gICAgICAgIH0gZWxzZSBpZiAocGxheWVyMSA9PT0gcGxheWVyICYmIGlkZW50aXR5U2VydmljZS5pc0F1dGhvcml6ZWQoJ2FkbWluJykpIHtcbiAgICAgICAgICBwbGF5ZXIxLmNsYXNzID0gJyc7XG4gICAgICAgICAgcGxheWVyMSA9IHt9O1xuICAgICAgICAgIC8vIE9ubHkgYWxsb3cgc3dhcHBpbmcgd2l0aCAocmVhbCkgcGxheWVycyAxIGxldmVsIGFib3ZlIG9yIGJlbG93XG4gICAgICAgIH0gZWxzZSBpZiAocGxheWVyLmxldmVsID09PSBwbGF5ZXIxLmxldmVsIHx8IHBsYXllci5sZXZlbCA8IHBsYXllcjEubGV2ZWwgLSAxIHx8IHBsYXllci5sZXZlbCA+IHBsYXllcjEubGV2ZWwgKyAxIHx8IHBsYXllci5wb3NpdGlvbiA9PT0gOTkpIHtcbiAgICAgICAgICBOb3RpZmljYXRpb24uZXJyb3IoJ1NvcnJ5LCB0aGF0cyBub3QgYWxsb3dlZCEnKTtcbiAgICAgICAgICAvLyBEbyB0aGUgc3dhcHBpbmcgYW5kIHNhdmUgdG8gdGhlIGRhdGFiYXNlXG4gICAgICAgICAgLy8gVGhlbiByZXNldCB0byBkbyBpdCBhbGwgb3ZlciBhZ2FpblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBwbGF5ZXIxT2xkUG9zaXRpb24gPSBwbGF5ZXIxLnBvc2l0aW9uO1xuICAgICAgICAgIHZhciBwbGF5ZXIxT2xkTGV2ZWwgPSBwbGF5ZXIxLmxldmVsO1xuICAgICAgICAgIHBsYXllcjIgPSBwbGF5ZXI7XG5cbiAgICAgICAgICBwbGF5ZXIxLnBvc2l0aW9uID0gcGxheWVyLnBvc2l0aW9uO1xuICAgICAgICAgIHBsYXllcjEubGV2ZWwgPSBwbGF5ZXIubGV2ZWw7XG5cbiAgICAgICAgICBwbGF5ZXIyLnBvc2l0aW9uID0gcGxheWVyMU9sZFBvc2l0aW9uO1xuICAgICAgICAgIHBsYXllcjIubGV2ZWwgPSBwbGF5ZXIxT2xkTGV2ZWw7XG5cbiAgICAgICAgICBweXJhbWlkc1NlcnZpY2Uuc3dhcFBvc2l0aW9ucyh2bS5weXJhbWlkSWQsIHBsYXllcjEsIHBsYXllcjIpO1xuXG4gICAgICAgICAgcGxheWVyMS5jbGFzcyA9ICcnO1xuICAgICAgICAgIHBsYXllcjEgPSB7fTtcbiAgICAgICAgICBwbGF5ZXIyID0ge307XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpICYmICF2bS5pc1BsYXllck9uUHlyYW1pZCAmJiBwbGF5ZXIucG9zaXRpb24gPT09IDk5KSB7XG4gICAgICAgIGFkZFBsYXllclRvUHlyYW1pZCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgTm90aWZpY2F0aW9uLmVycm9yKCdZb3UgY2FuIG5vdCB1cGRhdGUgdGhpcyBweXJhbWlkLjxicj5Zb3UgbXVzdCBqb2luIHRoZSBweXJhbWlkIGZpcnN0LicpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFBsYXllclRvUHlyYW1pZCgpIHtcbiAgICAgIHZhciBuZXdQbGF5ZXIgPSB7XG4gICAgICAgIHBvc2l0aW9uOiBudW1iZXJPZkFjdHVhbFBsYXllcnMgKyAxLFxuICAgICAgICBfaWQ6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQsXG4gICAgICAgIGZpcnN0TmFtZTogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmZpcnN0TmFtZSxcbiAgICAgICAgbGFzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5sYXN0TmFtZSxcbiAgICAgICAgbmlja25hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5uaWNrbmFtZVxuICAgICAgfTtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5hZGRQbGF5ZXJUb1B5cmFtaWQodm0ucHlyYW1pZElkLCBuZXdQbGF5ZXIpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIHZtLmlzUGxheWVyT25QeXJhbWlkID0gdHJ1ZTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIE9yZGVyIHRoZSBwbGF5ZXJzIGJ5IHRoZSBwb3NpdGlvbiBwcm9wZXJ0eSBvZiB0aGUgcGxheWVycyBhcnJheSBpbiB0aGUgcHlyYW1pZCBvYmplY3RcbiAgICBmdW5jdGlvbiBvcmRlclBsYXllcnMoKSB7XG4gICAgICB2bS5weXJhbWlkLnBsYXllcnMgPSAkZmlsdGVyKCdvcmRlckJ5Jykodm0ucHlyYW1pZC5wbGF5ZXJzLCAncG9zaXRpb24nKTtcbiAgICB9XG5cbiAgICAvLyBGaWd1cmUgb3V0IHdoZXJlIHRvIHN0YXJ0IGVhY2ggbmV3IHJvdyBvbiB0aGUgcHlyYW1pZFxuICAgIGZ1bmN0aW9uIGNyZWF0ZUJyZWFrUG9pbnRzKCkge1xuICAgICAgdm0uYnJlYWtQb2ludHMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ucHlyYW1pZC5sZXZlbHM7IGkrKykge1xuICAgICAgICB2bS5icmVha1BvaW50cy5wdXNoKCgoKGkgKiAoaSArIDEpKSAvIDIpKSArIDEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhvdyBtYW55IHRvdGFsIGJsb2NrcyBpbiB0aGlzIHB5cmFtaWRcbiAgICBmdW5jdGlvbiBjYWxjdWxhdGVQeXJhbWlkQmxvY2tzKCkge1xuICAgICAgdm0ubnVtYmVyT2ZCbG9ja3MgPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IHZtLnB5cmFtaWQubGV2ZWxzOyBpID4gMDsgaS0tKSB7XG4gICAgICAgIHZtLm51bWJlck9mQmxvY2tzICs9IGk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmlsbCBvdXQgdGhlIHJlbWFpbmluZyBibG9ja3Mgb2YgdGhlIHB5cmFtaWQgd2l0aCBlbXB0eSBibG9ja3NcbiAgICBmdW5jdGlvbiBmaWxsSW5FbXB0eUJsb2NrcygpIHtcbiAgICAgIGZvciAodmFyIGkgPSB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoOyBpIDwgdm0ubnVtYmVyT2ZCbG9ja3M7IGkrKykge1xuICAgICAgICB2bS5weXJhbWlkLnBsYXllcnMucHVzaCh7XG4gICAgICAgICAgZmlyc3ROYW1lOiAnRW1wdHknLFxuICAgICAgICAgIGxhc3ROYW1lOiAnU3BvdCcsXG4gICAgICAgICAgcG9zaXRpb246IDk5LFxuICAgICAgICAgIGNsYXNzOiAnZW1wdHknXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdpdmUgZWFjaCBwbGF5ZXIgYSBsZXZlbCBwcm9wZXJ0eSBiYXNlZCBvbiB0aGUgYnJlYWsgcG9pbnRzXG4gICAgZnVuY3Rpb24gYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCkge1xuICAgICAgdm0ubGV2ZWwgPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHZtLmJyZWFrUG9pbnRzLmluZGV4T2YoaSArIDEpID4gLTEpIHtcbiAgICAgICAgICB2bS5sZXZlbCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHZtLnB5cmFtaWQucGxheWVyc1tpXS5sZXZlbCA9IHZtLmxldmVsO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIHRoZSBjdXJyZW50IHVzZXIgaXMgYSBwbGF5ZXIgb24gdGhpcyBweXJhbWlkIG1ha2UgdGhlbSBwbGF5ZXIgMVxuICAgIGZ1bmN0aW9uIGFzc2lnblBsYXllck9uZSgpIHtcbiAgICAgIGlmICghaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aG9yaXplZCgnYWRtaW4nKSAmJiBpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkgJiYgdm0uaXNQbGF5ZXJPblB5cmFtaWQpIHtcbiAgICAgICAgcGxheWVyMSA9IF8uZmluZCh2bS5weXJhbWlkLnBsYXllcnMsIFsnX2lkJywgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZF0pO1xuICAgICAgICBwbGF5ZXIxLmNsYXNzID0gJ2FjdGl2ZSc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVmcmVzaFB5cmFtaWQoKSB7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5weXJhbWlkSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgb3JkZXJQbGF5ZXJzKCk7XG4gICAgICAgIGZpbGxJbkVtcHR5QmxvY2tzKCk7XG4gICAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgICAgICBhc3NpZ25QbGF5ZXJPbmUoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgICRzY29wZS4kb24oJ3dzOm1hdGNoX3Jlc3VsdHMnLCBmdW5jdGlvbiAoXywgcmVzdWx0KSB7XG4gICAgICBOb3RpZmljYXRpb24uaW5mbyhyZXN1bHQpO1xuICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdweXJhbWlkc1NlcnZpY2UnLCBweXJhbWlkc1NlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHB5cmFtaWRzU2VydmljZSgkaHR0cCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0UHlyYW1pZDogZ2V0UHlyYW1pZCxcbiAgICAgIGdldFB5cmFtaWRzRm9yVXNlcjogZ2V0UHlyYW1pZHNGb3JVc2VyLFxuICAgICAgY3JlYXRlUHlyYW1pZDogY3JlYXRlUHlyYW1pZCxcbiAgICAgIHN3YXBQb3NpdGlvbnM6IHN3YXBQb3NpdGlvbnMsXG4gICAgICBhZGRQbGF5ZXJUb1B5cmFtaWQ6IGFkZFBsYXllclRvUHlyYW1pZFxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIC8qKlxuICAgICAqIEdldHMgYSBweXJhbWlkIGZyb20gdGhlIGRhdGFiYXNlIChvciBtZW1vcnkpXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcHlyYW1pZCBpZCBmb3IgdGhlIHJlcXVlc3RlZCBweXJhbWlkXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBweXJhbWlkXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZChweXJhbWlkSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcHlyYW1pZCcsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgcHlyYW1pZElkOiBweXJhbWlkSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhbGwgcHlyYW1pZHMgZnJvbSB0aGUgZGF0YWJhc2UgdGhlIGEgcGFydGljdWxhciB1c2VyIGlzIGluY2x1ZGVkIGluXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3VzZXJJZH0gdGhlIHVzZXIgaWQgZm9yIHRoZSByZXF1ZXN0ZWQgdXNlclxuICAgICAqIEByZXR1cm4ge09iamVjdH0gcHlyYW1pZHNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRQeXJhbWlkc0ZvclVzZXIodXNlcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3B5cmFtaWRzL3VzZXInLCB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHVzZXJJZDogdXNlcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVB5cmFtaWQocHlyYW1pZCkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvY3JlYXRlJywge1xuICAgICAgICBweXJhbWlkOiBweXJhbWlkXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzd2FwUG9zaXRpb25zKHB5cmFtaWRJZCwgY2hhbGxlbmdlciwgb3Bwb25lbnQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL3N3YXBQb3NpdGlvbnMnLCB7XG4gICAgICAgIHB5cmFtaWRJZDogcHlyYW1pZElkLFxuICAgICAgICBjaGFsbGVuZ2VyOiBjaGFsbGVuZ2VyLFxuICAgICAgICBvcHBvbmVudDogb3Bwb25lbnRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFBsYXllclRvUHlyYW1pZChweXJhbWlkSWQsIHBsYXllcikge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvYWRkUGxheWVyJywge1xuICAgICAgICBweXJhbWlkSWQ6IHB5cmFtaWRJZCxcbiAgICAgICAgcGxheWVyOiBwbGF5ZXJcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdBZGRQbGF5ZXJDdHJsJywgQWRkUGxheWVyQ3RybCk7XG5cbiAgZnVuY3Rpb24gQWRkUGxheWVyQ3RybCgkc3RhdGUsICRzdGF0ZVBhcmFtcywgdXNlclNlcnZpY2UsIHB5cmFtaWRzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IFtdO1xuICAgIHZtLmFkZFBsYXllclRvUHlyYW1pZCA9IGFkZFBsYXllclRvUHlyYW1pZDtcbiAgICB2bS5jcmVhdGVQeXJhbWlkID0gY3JlYXRlUHlyYW1pZDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIHVzZXJTZXJ2aWNlLmdldEFsbFVzZXJzKCkudGhlbihmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IHVzZXJzLmRhdGE7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB2YXIgcG9zaXRpb24gPSAwO1xuXG4gICAgZnVuY3Rpb24gYWRkUGxheWVyVG9QeXJhbWlkKHBsYXllcikge1xuICAgICAgLy8gQWRkIHRoZSBzZWxlY3RlZCBwbGF5ZXIgdG8gdGhlIHBsYXllcnMgYXJyYXlcbiAgICAgIHBvc2l0aW9uICs9IDE7XG4gICAgICB2YXIgYWRkUGxheWVyID0ge1xuICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sXG4gICAgICAgIF9pZDogcGxheWVyLl9pZCxcbiAgICAgICAgZmlyc3ROYW1lOiBwbGF5ZXIuZmlyc3ROYW1lLFxuICAgICAgICBsYXN0TmFtZTogcGxheWVyLmxhc3ROYW1lLFxuICAgICAgICBuaWNrbmFtZTogcGxheWVyLm5pY2tuYW1lXG4gICAgICB9O1xuICAgICAgdm0ubmV3UHlyYW1pZC5wbGF5ZXJzLnB1c2goYWRkUGxheWVyKTtcbiAgICAgIC8vIFJlbW92ZSB0aGUgc2VsZWN0ZWQgcGxheWVyIGZyb20gdGhlIGF2YWlsYWJsZSBwbGF5ZXJzXG4gICAgICBfLnJlbW92ZSh2bS5hdmFpbGFibGVQbGF5ZXJzLCB7XG4gICAgICAgIF9pZDogcGxheWVyLl9pZFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlUHlyYW1pZChweXJhbWlkKSB7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuY3JlYXRlUHlyYW1pZChweXJhbWlkKS50aGVuKGZ1bmN0aW9uIChuZXdQeXJhbWlkKSB7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMudmlldycsIHtcbiAgICAgICAgICBweXJhbWlkSWQ6IG5ld1B5cmFtaWQuZGF0YS5faWRcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQ3JlYXRlUHlyYW1pZEN0cmwnLCBDcmVhdGVQeXJhbWlkQ3RybCk7XG5cbiAgZnVuY3Rpb24gQ3JlYXRlUHlyYW1pZEN0cmwoJHN0YXRlLCB1c2VyU2VydmljZSwgcHlyYW1pZHNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5uZXdQeXJhbWlkID0ge1xuICAgICAgcGxheWVyczogW11cbiAgICB9O1xuICAgIHZtLmF2YWlsYWJsZVBsYXllcnMgPSBbXTtcbiAgICB2bS5hZGRlZFBsYXllcnMgPSBbXTtcbiAgICB2bS5jcmVhdGVQeXJhbWlkID0gY3JlYXRlUHlyYW1pZDtcbiAgICB2bS5uZXdQeXJhbWlkLmxldmVscyA9IDQ7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICB1c2VyU2VydmljZS5nZXRBbGxVc2VycygpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIHZtLmF2YWlsYWJsZVBsYXllcnMgPSB1c2Vycy5kYXRhO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmFyIHBvc2l0aW9uID0gMDtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVB5cmFtaWQocHlyYW1pZCkge1xuICAgICAgYW5ndWxhci5mb3JFYWNoKHZtLmFkZGVkUGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICBwb3NpdGlvbiArPSAxO1xuICAgICAgICB2YXIgYWRkUGxheWVyID0ge1xuICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbixcbiAgICAgICAgICBfaWQ6IHBsYXllci5faWQsXG4gICAgICAgICAgZmlyc3ROYW1lOiBwbGF5ZXIuZmlyc3ROYW1lLFxuICAgICAgICAgIGxhc3ROYW1lOiBwbGF5ZXIubGFzdE5hbWUsXG4gICAgICAgICAgbmlja25hbWU6IHBsYXllci5uaWNrbmFtZVxuICAgICAgICB9O1xuICAgICAgICB2bS5uZXdQeXJhbWlkLnBsYXllcnMucHVzaChhZGRQbGF5ZXIpO1xuICAgICAgfSk7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuY3JlYXRlUHlyYW1pZChweXJhbWlkKS50aGVuKGZ1bmN0aW9uIChuZXdQeXJhbWlkKSB7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMudmlldycsIHtcbiAgICAgICAgICBweXJhbWlkSWQ6IG5ld1B5cmFtaWQuZGF0YS5faWRcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTXlQeXJhbWlkc0N0cmwnLCBNeVB5cmFtaWRzQ3RybCk7XG5cbiAgZnVuY3Rpb24gTXlQeXJhbWlkc0N0cmwoJHN0YXRlLCBweXJhbWlkc1NlcnZpY2UsIGlkZW50aXR5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucHlyYW1pZHMgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWRzRm9yVXNlcihpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkcykge1xuICAgICAgICB2bS5weXJhbWlkcyA9IHB5cmFtaWRzLmRhdGE7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUHlyYW1pZEN0cmwnLCBQeXJhbWlkQ3RybCk7XG5cbiAgZnVuY3Rpb24gUHlyYW1pZEN0cmwoJHN0YXRlUGFyYW1zKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5weXJhbWlkSWQgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5weXJhbWlkSWQpIHtcbiAgICAgICAgdm0ucHlyYW1pZElkID0gJHN0YXRlUGFyYW1zLnB5cmFtaWRJZDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUHlyYW1pZHNDdHJsJywgUHlyYW1pZHNDdHJsKTtcblxuICBmdW5jdGlvbiBQeXJhbWlkc0N0cmwoKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5weXJhbWlkcyA9IG51bGw7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCd0b2dnbGVTdWJtZW51JywgdG9nZ2xlU3VibWVudSk7XG5cbiAgZnVuY3Rpb24gdG9nZ2xlU3VibWVudSgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsKSB7XG4gICAgICBlbC5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVsLm5leHQoKS5zbGlkZVRvZ2dsZSgyMDApO1xuICAgICAgICBlbC5wYXJlbnQoKS50b2dnbGVDbGFzcygndG9nZ2xlZCcpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnd2F2ZXNFZmZlY3QnLCB3YXZlc0VmZmVjdCk7XG5cbiAgZnVuY3Rpb24gd2F2ZXNFZmZlY3QoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQycsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICBpZiAoZWxlbWVudC5oYXNDbGFzcygnYnRuLWljb24nKSB8fCBlbGVtZW50Lmhhc0NsYXNzKCdidG4tZmxvYXQnKSkge1xuICAgICAgICBXYXZlcy5hdHRhY2goZWxlbWVudCwgWyd3YXZlcy1jaXJjbGUnXSk7XG4gICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ2J0bi1saWdodCcpKSB7XG4gICAgICAgIFdhdmVzLmF0dGFjaChlbGVtZW50LCBbJ3dhdmVzLWxpZ2h0J10pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgV2F2ZXMuYXR0YWNoKGVsZW1lbnQpO1xuICAgICAgfVxuXG4gICAgICBXYXZlcy5pbml0KCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnZmdMaW5lJywgZmdMaW5lKTtcblxuICBmdW5jdGlvbiBmZ0xpbmUoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQycsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICB2YXIgaW5wdXQgPSBlbGVtZW50LmNoaWxkcmVuKCkuZmlyc3QoKTtcbiAgICAgIHZhciBpc0Zsb2F0TGFiZWwgPSBlbGVtZW50LnBhcmVudCgpLmhhc0NsYXNzKCdmZy1mbG9hdCcpO1xuICAgICAgaW5wdXQuZm9jdXMoZnVuY3Rpb24gKCkge1xuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdmZy10b2dnbGVkJyk7XG4gICAgICB9KTtcblxuICAgICAgaW5wdXQuYmx1cihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghaXNGbG9hdExhYmVsIHx8IChpc0Zsb2F0TGFiZWwgJiYgaW5wdXQudmFsKCkubGVuZ3RoID09PSAwKSkge1xuICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2ZnLXRvZ2dsZWQnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
