angular.module("app",["ui.router","ui.bootstrap","ngAnimate","angular-loading-bar","nouislider","localytics.directives","timer","LocalStorageModule","angular-sortable-view","angular.vertilize","ngTable"]),function(){"use strict ";function e(e,t,n){e.defaults.headers.get||(e.defaults.headers.get={}),e.defaults.headers.get["If-Modified-Since"]="Fri, 01 Jan 2016 05:00:00 GMT",e.defaults.headers.get["Cache-Control"]="no-cache",e.defaults.headers.get.Pragma="no-cache",t.options({appendToBody:!0}),n.errorOnUnhandledRejections(!1)}e.$inject=["$httpProvider","$uibTooltipProvider","$qProvider"],angular.module("app").config(e)}(),function(){"use strict";function e(e,t){function n(e){t.set("sidebarLocked",e)}var i=this;i.$state=e,i.lockSidebar=t.get("sidebarLocked"),i.toggleSidebarLocked=n}e.$inject=["$state","localStorageService"],angular.module("app").controller("AppCtrl",e)}(),function(){"use strict";function e(e,o,r){var a={superAdmin:n,admin:t,user:i};r.html5Mode(!0),o.otherwise("/"),o.when("/competitions/","/competitions"),o.when("/admin/","/admin"),e.state("home",{url:"/",views:{content:{controller:"HomeCtrl",controllerAs:"vm",templateUrl:"common/views/home.html"}}}).state("competitions",{url:"/competitions",views:{content:{controller:"CompetitionsCtrl",controllerAs:"vm",templateUrl:"competitions/views/competitions.html"}}}).state("competitions.myCompetitions",{url:"/my-competitions",views:{"content@":{controller:"MyCompetitionsCtrl",controllerAs:"vm",templateUrl:"competitions/views/my-competitions.html"}},resolve:{auth:a.user}}).state("competitions.view",{url:"/view/:competitionId",views:{"content@":{controller:"CompetitionCtrl",controllerAs:"vm",templateUrl:"competitions/views/competition.html"}}}).state("competitions.stats",{url:"/stats/:competitionId",views:{"content@":{controller:"CompetitionStatsCtrl",controllerAs:"vm",templateUrl:"competitions/views/competition-stats.html"}}}).state("competitions.admin",{url:"/admin/:competitionId",views:{"content@":{controller:"CompetitionAdminCtrl",controllerAs:"vm",templateUrl:"competitions/views/competition-admin.html"}},resolve:{auth:a.user}}).state("competitions.create",{url:"/create",views:{"content@":{controller:"CreateCompetitionCtrl",controllerAs:"vm",templateUrl:"competitions/views/create-competition.html"}},resolve:{auth:a.user}}).state("user",{url:"/user",views:{content:{controller:"UserCtrl",controllerAs:"vm",templateUrl:"users/views/user.html"}},resolve:{auth:a.user}}).state("login",{url:"/login",views:{content:{controller:"LoginCtrl",controllerAs:"vm",templateUrl:"authentication/views/login.html"}}}).state("register",{url:"/register",views:{content:{controller:"RegisterCtrl",controllerAs:"vm",templateUrl:"authentication/views/register.html"}}}).state("verify",{url:"/verification",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}}).state("verification",{url:"/verification/:userId/:verificationToken",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}}).state("password-reset-request",{url:"/password-reset",views:{content:{controller:"PasswordResetCtrl",controllerAs:"vm",templateUrl:"authentication/views/password-reset.html"}}}).state("password-reset",{url:"/password-reset/:userId/:verificationToken",views:{content:{controller:"PasswordResetCtrl",controllerAs:"vm",templateUrl:"authentication/views/password-reset.html"}}}).state("admin",{url:"/admin",views:{content:{controller:"LoginCtrl",controllerAs:"vm",templateUrl:"authentication/views/login.html"}}}).state("admin.users",{url:"/users",views:{"content@":{controller:"EditUserAdminCtrl",controllerAs:"vm",templateUrl:"/admin/views/edit-user-admin.html"}},resolve:{auth:a.superAdmin}})}function t(e){return e.authorizeCurrentUserForRoute("admin")}function n(e){return e.authorizeCurrentUserForRoute("super-admin")}function i(e){return e.authenticatedUserForRoute()}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app").config(e),t.$inject=["authService"],n.$inject=["authService"],i.$inject=["authService"]}(),function(){"use strict";function e(e,t,n,i){e.$on("$stateChangeError",function(e,n,i,o,r,a){"not authorized"===a&&(t.go("login"),t.previous=n,t.prevParams=i)}),e.$on("$stateChangeStart",function(){i.setSidebarStatus(!1),n[0].body.scrollTop=n[0].documentElement.scrollTop=0})}e.$inject=["$rootScope","$state","$document","sidebarService"],angular.module("app").run(e)}(),function(){"use strict";function e(e,t,n){function i(){o()}function o(){t.getAllUsers().then(function(e){c.users=e.data,l=_.cloneDeep(c.users)})}function r(e){c.selectedUser=e,s=_.cloneDeep(e)}function a(e){var i=[];if(_.forEach(l,function(e){i.push(e.displayName.toLowerCase())}),e.firstName.length<1||e.lastName.length<1||e.displayName.length<1)n.error("Don't leave names blank!  How will people know who you are?");else if(e.displayName!==s.displayName&&_.indexOf(i,e.displayName.toLowerCase())>-1)n.error("Sorry, someone else is already using that display name");else{var a={_id:e._id,firstName:e.firstName,lastName:e.lastName,displayName:e.displayName};t.updateUser(a).then(function(){n.success("User information has been updated"),r(),o()})}}var l=[],s=null,c=this;c.users=null,c.selectedUser=null,c.selectUser=r,c.updateUser=a,c.userForm={},i()}e.$inject=["identityService","userService","notifyService"],angular.module("app").controller("EditUserAdminCtrl",e)}(),function(){"use strict";function e(e,t,n){function i(){}function o(i,o){t.authenticateUser(i,o).then(function(t){t?"unverified"===t?n.error("You must verify your email before you can login"):e.previous?(e.go(e.previous,e.prevParams),e.previous=null,e.prevParams=null):e.go("competitions.myCompetitions"):n.error("Username / password combinaiton incorrect")})}var r=this;r.login=o,i()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("LoginCtrl",e)}(),function(){"use strict";function e(e,t,n,i,o,r){function a(){r.isAuthenticated()?e.go("home"):t.userId&&t.verificationToken&&n.verifyUser(t.userId,t.verificationToken).then(function(e){e.data&&(c.verified=!0)})}function l(t){n.generatePasswordResetLink(t).then(function(t){t.data?(i.success("Please check your email for a password reset link"),e.go("home")):i.error("Could not find that email address")})}function s(r){r.password!==r.confirmPassword?i.error("Passwords don't match!"):n.resetPassword(t.userId,t.verificationToken,r.password).then(function(t){t.data&&o.authenticateUser(t.data.username,r.password).then(function(t){e.go("home")})})}var c=this;c.username="",c.verified=!1,c.resetPasswordForm={},c.generatePasswordResetLink=l,c.resetPassword=s,a()}e.$inject=["$state","$stateParams","userService","notifyService","authService","identityService"],angular.module("app").controller("PasswordResetCtrl",e)}(),function(){"use strict";function e(e,t,n){function i(){}function o(i){i.password!==i.confirmPassword?n.error("Passwords don't match!"):(i.displayName||(i.displayName=i.firstName+" "+i.lastName),t.createUser(i).then(function(){e.go("verify")}))}var r=this;r.register=o,i()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("RegisterCtrl",e)}(),function(){"use strict";function e(e,t,n){function i(){t.userId&&t.verificationToken&&(o.verifying=!0,o.verified=null,n.verifyUser(t.userId,t.verificationToken).then(function(e){e.data?o.verified=!0:o.verified=!1}))}var o=this;o.verified=void 0,o.verifying=!1,i()}e.$inject=["$state","$stateParams","userService"],angular.module("app").controller("VerificationCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competition:"=",allowDelete:"=",numberOfChallenges:"@",challengesPerPage:"@"},templateUrl:"/challenges/components/active-challenges.html"};return e}function t(e,t,n){function i(){e.$watch("vm.competition",function(){a.competition&&o()})}function o(){t.getActiveChallengesByCompetition(a.competition._id).then(function(e){a.challenges=e.data,e.data.length>0&&(a.tableData=new n({page:1,count:a.challengesPerPage||5},{counts:[],total:a.challenges.length,getData:function(e,t){e.resolve(a.challenges.slice((t.page()-1)*t.count(),t.page()*t.count()))}}),_.forEach(a.challenges,function(e){if("versus"===e.type&&(a.competition.players.length>2?(e.challenger.displayName="Team "+e.challenger.team,e.opponent.displayName="Team "+e.opponent.team):(e.challenger.displayName=_.find(a.competition.players,{position:e.challenger.team}).displayName,e.opponent.displayName=_.find(a.competition.players,{position:e.opponent.team}).displayName)),0!==e.timeLimit){var t=moment().diff(moment(e.created).add(e.timeLimit,"d"))*-1;e.expires=moment.duration(t).asHours()}}))})}function r(e,n){swal({title:"Delete Challenge Result?",text:"It'll be like it never happened",type:"error",showCancelButton:!0,confirmButtonText:"Delete",cancelButtonText:"Nevermind",closeOnConfirm:!0,closeOnCancel:!0},function(){t.deleteChallenge(a.competition._id,e).then(function(){a.challenges.splice(n,1)})})}var a=this;a.challenges=null,a.deleteChallenge=r,i()}t.$inject=["$scope","challengesService","ngTableParams"],angular.module("app").directive("wpmActiveChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competition:"=",allowDelete:"=",numberOfChallenges:"@",challengesPerPage:"@"},templateUrl:"/challenges/components/completed-challenges.html"};return e}function t(e,t,n,i){function o(){e.$watch("vm.competition",function(){l.competition&&r()})}function r(){n.getCompletedChallengesByCompetition(l.competition._id,l.numberOfChallenges).then(function(e){l.challenges=e.data,e.data.length>0&&(l.tableData=new i({page:1,count:l.challengesPerPage||5},{counts:[],total:l.challenges.length,getData:function(e,t){e.resolve(l.challenges.slice((t.page()-1)*t.count(),t.page()*t.count()))}}),_.forEach(l.challenges,function(e){e.loser="challenger"===e.winner?"opponent":"challenger","versus"===e.type&&(l.competition.players.length>2?(e.challenger.displayName="Team "+e.challenger.team,e.opponent.displayName="Team "+e.opponent.team):(e.challenger.displayName=_.find(l.competition.players,{position:e.challenger.team}).displayName,e.opponent.displayName=_.find(l.competition.players,{position:e.opponent.team}).displayName)),e.whenCompleted=moment(e.completed).calendar(null,{sameDay:"[Today]",nextDay:"[Tomorrow]",nextWeek:"dddd",lastDay:"[Yesterday]",lastWeek:"[Last] dddd",sameElse:"MMM DD, YYYY"})}))})}function a(e,t){swal({title:"Delete Challenge Result?",text:"You'll still need to reorder the players on your own",type:"error",showCancelButton:!0,confirmButtonText:"Delete",cancelButtonText:"Nevermind",closeOnConfirm:!0,closeOnCancel:!0},function(){n.deleteChallenge(l.competition._id,e).then(function(){l.challenges.splice(t,1)})})}var l=this;l.challenges=null,l.deleteChallenge=a,o()}t.$inject=["$scope","$state","challengesService","ngTableParams"],angular.module("app").directive("wpmCompletedChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{player:"="},templateUrl:"/challenges/components/player-overall-results.html"};return e}function t(e){function t(){e.$watch("vm.player.results",function(){r.player&&(n(r.player),i(r.player),o(r.player))})}function n(e){for(var t=[],n=0;n<r.maxLevels;n++)t.push(n*(n+1)/2+1);e.level=t.length;for(var i=0;i<t.length;i++)if(e.position<t[i+1]){e.level=t.indexOf(t[i])+1;break}}function i(e){var t,n=0,i=!0;_.forEach(e.results,function(o){i&&("challenger"===o.winner&&o.challenger._id===e._id||"opponent"===o.winner&&o.opponent._id===e._id?"losing"!==t?(n+=1,t="winning"):i=!1:("opponent"===o.winner&&o.challenger._id===e._id||"challenger"===o.winner&&o.opponent._id===e._id)&&("winning"!==t?(n+=1,t="losing"):i=!1)),r.streak={type:t,value:n}})}function o(e){r.wins.asOpponent=_.size(_.filter(e.results,function(t){return t.opponent._id===e._id&&"opponent"===t.winner})),r.wins.asChallenger=_.size(_.filter(e.results,function(t){return t.challenger._id===e._id&&"challenger"===t.winner})),r.wins.total=r.wins.asChallenger+r.wins.asOpponent,r.wins.byForfeit=_.size(_.filter(e.results,function(t){return t.forfeit&&(t.challenger._id===e._id&&"challenger"===t.winner||t.opponent._id===e._id&&"opponent"===t.winner)})),r.loses.asOpponent=_.size(_.filter(e.results,function(t){return t.opponent._id===e._id&&"challenger"===t.winner})),r.loses.asChallenger=_.size(_.filter(e.results,function(t){return t.challenger._id===e._id&&"opponent"===t.winner})),r.loses.total=r.loses.asChallenger+r.loses.asOpponent,r.loses.byForfeit=_.size(_.filter(e.results,function(t){return t.forfeit&&(t.challenger._id===e._id&&"opponent"===t.winner||t.opponent._id===e._id&&"challenger"===t.winner)}))}var r=this;r.maxLevels=7,r.wins={total:0,asChallenger:0,asOpponent:0,byForfeit:0},r.loses={total:0,asChallenger:0,asOpponent:0,byForfeit:0},r.streak={type:null,value:0},t()}t.$inject=["$scope"],angular.module("app").directive("wpmPlayerOverallResults",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competition:"=",team:"=",challenges:"="},templateUrl:"/challenges/components/team-overall-results.html"};return e}function t(e){function t(){e.$watch("vm.challenges",function(){o.challenges&&o.challenges.length>0&&o.competition&&(n(o.team,o.challenges),i(o.team,o.challenges),2===o.competition.players.length&&(o.singlePlayerTeams=!0,o.displayName=_.find(o.competition.players,{position:o.team}).displayName,o.playerName=_.find(o.competition.players,{position:o.team}).firstName+" "+_.find(o.competition.players,{position:o.team}).lastName))})}function n(e,t){var n,i=0,r=!0;_.forEach(t,function(t){r&&("challenger"===t.winner&&t.challenger.team===e||"opponent"===t.winner&&t.opponent.team===e?"losing"!==n?(i+=1,n="winning"):r=!1:("opponent"===t.winner&&t.challenger.team===e||"challenger"===t.winner&&t.opponent.team===e)&&("winning"!==n?(i+=1,n="losing"):r=!1)),o.streak={type:n,value:i}})}function i(e,t){o.wins.asOpponent=_.size(_.filter(t,function(t){return t.opponent.team===e&&"opponent"===t.winner})),o.wins.asChallenger=_.size(_.filter(t,function(t){return t.challenger.team===e&&"challenger"===t.winner})),o.wins.total=o.wins.asChallenger+o.wins.asOpponent,o.wins.byForfeit=_.size(_.filter(t,function(t){return t.forfeit&&(t.challenger.team===e&&"challenger"===t.winner||t.opponent.team===e&&"opponent"===t.winner)})),o.loses.asOpponent=_.size(_.filter(t,function(t){return t.opponent.team===e&&"challenger"===t.winner})),o.loses.asChallenger=_.size(_.filter(t,function(t){return t.challenger.team===e&&"opponent"===t.winner})),o.loses.total=o.loses.asChallenger+o.loses.asOpponent,o.loses.byForfeit=_.size(_.filter(t,function(t){return t.forfeit&&(t.challenger.team===e&&"opponent"===t.winner||t.opponent.team===e&&"challenger"===t.winner)}))}var o=this;o.wins={total:0,asChallenger:0,asOpponent:0,byForfeit:0},o.loses={total:0,asChallenger:0,asOpponent:0,byForfeit:0},o.streak={type:null,value:0},o.singlePlayerTeams=!1,t()}t.$inject=["$scope"],angular.module("app").directive("wpmTeamOverallResults",e)}(),function(){"use strict";function e(e){function t(t){return e.post("/api/challenges/pyramid/create",{challenge:t})}function n(t){return e.put("/api/challenges/pyramid/cancel",{challenge:t})}function i(t){return e.post("/api/challenges/versus/create",{challenge:t})}function o(t){return e.post("/api/challenges/pyramid/complete",{challenge:t})}function r(t){return e.post("/api/challenges/versus/complete",{challenge:t})}function a(t){return e.get("/api/challenges/competition",{params:{competitionId:t}})}function l(t){return e.get("/api/challenges/active/competition",{params:{competitionId:t}})}function s(t,n){return e.get("/api/challenges/active/competition/player",{params:{competitionId:t,playerId:n}})}function c(t,n){return e.get("/api/challenges/completed/competition",{params:{competitionId:t,limit:n}})}function p(t,n){return e.delete("/api/challenges/active/competition/player/delete",{params:{competitionId:t,playerId:n}})}function u(t,n){return e.delete("/api/challenges/delete",{params:{competitionId:t,challengeId:n}})}function m(t,n){return e.get("/api/challenges/results/competition/player",{params:{competitionId:t,playerId:n}})}var d={createPyramidChallenge:t,createVersusChallenge:i,cancelPyramidChallenge:n,completePyramidChallenge:o,completeVersusChallenge:r,getChallengesByCompetition:a,getActiveChallengesByCompetition:l,getActiveChallengeByCompetitionByPlayer:s,getCompletedChallengesByCompetition:c,deleteActiveChallengeByCompetitionByPlayer:p,deleteChallenge:u,getPlayerResultsByCompetition:m};return d}e.$inject=["$http"],angular.module("app").factory("challengesService",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",templateUrl:"/common/components/footer.html"};return e}function t(e,t){function n(){t.logout()}var i=this;i.indentity=e,i.logout=n}t.$inject=["identityService","authService"],angular.module("app").directive("wpmFooter",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"headerCtrl",restrict:"A",templateUrl:"/common/components/header.html"};return e}function t(e,t,n,i,o){function r(){a(),e.$watch("headerCtrl.indentity.currentUser",function(){n.isAuthenticated()&&a()})}function a(){u.alerts=[],n.isAuthenticated()&&o.getActiveAlertsByPlayer(n.currentUser._id).then(function(e){u.alerts=e.data})}function l(e,t){o.clearAlert(e).then(function(){u.alerts.splice(t,1)})}function s(){o.clearAllAlertsByPlayer(n.currentUser._id).then(function(){u.alerts=[]})}function c(){t.setSidebarStatus(!u.sidebarStatus.left)}function p(){i.logout()}var u=this;u.indentity=n,u.logout=p,u.sidebarStatus=t.getSidebarStatus(),u.toggleSidebar=c,u.clearAlert=l,u.clearAllAlerts=s,u.alerts=[],r(),e.$on("ws:update_alerts",function(e,t){n.isAuthenticated()&&_.some(t,["userId",n.currentUser._id])&&a()})}t.$inject=["$scope","sidebarService","identityService","authService","alertsService"],angular.module("app").directive("wpmHeader",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"sidebarCtrl",restrict:"A",templateUrl:"/common/components/sidebar.html"};return e}function t(e,t,n){function i(){t.logout()}var o=this;o.indentity=e,o.logout=i,o.sidebarStatus=n.getSidebarStatus()}t.$inject=["identityService","authService","sidebarService"],angular.module("app").directive("wpmSidebar",e)}(),function(){"use strict";function e(){return function(e,t){if(!angular.isObject(e))return e;var n=[];for(var i in e)n.push(e[i]);return n.sort(function(e,n){return e=parseInt(e[t]),n=parseInt(n[t]),e-n}),n}}angular.module("app").filter("orderObjectBy",e)}(),function(){"use strict";function e(e){function t(t){return e.get("/api/alerts/",{params:{userId:t}})}function n(t){return e.put("/api/alert/clear",{alertId:t})}function i(t){return e.put("/api/alerts/clear",{userId:t})}var o={getActiveAlertsByPlayer:t,clearAlert:n,clearAllAlertsByPlayer:i};return o}e.$inject=["$http"],angular.module("app").factory("alertsService",e)}(),function(){"use strict";function e(e){function t(){return!!this.currentUser}function n(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}var i;null!==e.bootstrappedUserObject&&(i=e.bootstrappedUserObject);var o={currentUser:i,isAuthenticated:t,isAuthorized:n};return o}e.$inject=["$window"],angular.module("app").factory("identityService",e)}(),function(){"use strict";function e(){function e(e,t,n){$.notify({message:e,url:t,target:n},{type:"info"})}function t(e,t,n){$.notify({message:e,url:t,target:n},{type:"success"})}function n(e,t,n){$.notify({message:e,url:t,target:n},{type:"warning"})}function i(e,t,n){$.notify({message:e,url:t,target:n},{type:"danger"})}function o(e,t,n){$.notify({message:e,url:t,target:n},{type:"inverse"})}var r={info:e,success:t,warning:n,error:i,inverse:o};return $.notifyDefaults({newest_on_top:!0,offset:{x:20,y:85},delay:5e3}),r}angular.module("app").factory("notifyService",e)}(),function(){"use strict";function e(){function e(e,t,n,i){$(e).mCustomScrollbar({theme:t,scrollInertia:100,axis:n,mouseWheel:{enable:!0,axis:i,preventDefault:!0}})}var t={malihuScroll:e};return t}angular.module("app").factory("scrollbarService",e)}(),function(){"use strict";function e(){function e(){return n}function t(e){n.left=e}var n={left:!1,right:!1},i={getSidebarStatus:e,setSidebarStatus:t};return i}angular.module("app").factory("sidebarService",e)}(),function(){"use strict";function e(e,t,n){function i(){return"https:"===t.location.protocol?"wss://"+t.location.host:"ws://"+t.location.host}function o(){a=new WebSocket(i()),a.onmessage=function(t){s=0;var n=JSON.parse(t.data);e.$broadcast("ws:"+n.topic,n.data)},a.onclose=function(){s<l.length?(console.log("WebSocket closed. Reconnecting..."),n(o,1e3*l[s]),s+=1):console.log("Giving up on WebSocket")}}function r(e,t){var n=JSON.stringify({topic:e,data:t});a.send(n)}var a,l=[3,10,100,1e3],s=0,c={connect:o,send:r};return c}e.$inject=["$rootScope","$window","$timeout"],angular.module("app").factory("websocketService",e).run(["websocketService",function(e){e.connect()}])}(),function(){"use strict";function e(e,t){function n(){e.getPublicCompetitions().then(function(e){i.publicCompetitions=e.data}),t.isAuthorized("super-admin")&&e.getPrivateCompetitions().then(function(e){i.privateCompetitions=e.data})}var i=this;i.publicCompetitions=[],i.privateCompetitions=[],n()}e.$inject=["competitionsService","identityService"],angular.module("app").controller("HomeCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competition:"="},templateUrl:"/competitions/components/competition-compact.html"};return e}function t(){function e(){}e()}angular.module("app").directive("wpmCompetitionCompact",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competition:"="},templateUrl:"/competitions/components/pending-players.html"};return e}function t(e){function t(){}function n(t){t.position=o.competition.players.length+1,e.approvePendingPlayer(o.competition._id,t)}function i(t){e.denyPendingPlayer(o.competition._id,t)}var o=this;o.pendingPlayers=[],o.approvePendingPlayer=n,o.denyPendingPlayer=i,t()}t.$inject=["competitionsService"],angular.module("app").directive("wpmPendingPlayers",e)}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"/competitions/components/pyramid.html",replace:!0,scope:{competition:"="},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,n,i,o,r,a){function l(){for(var t=A;t>0;--t)S.maxPlayers+=t;e.$watch("vm.competition",function(){S.competition&&(S.competitionId=S.competition._id,s(),c(),u(),m(),d())})}function s(){S.competition.players=i("orderBy")(S.competition.players,"position")}function c(){a.getActiveChallengesByCompetition(S.competitionId).then(function(e){_.forEach(e.data,function(e){var t=_.find(S.competition.players,{_id:e.challenger._id});t.class="unavailable",t.available=!1,t.challenge={position:"challenger",opponent:_.find(S.competition.players,{_id:e.opponent._id}).displayName};var n=_.find(S.competition.players,{_id:e.opponent._id});if(n.class="unavailable",n.available=!1,n.challenge={position:"opponent"},0!==e.timeLimit){var i=moment().diff(moment(e.created).add(e.timeLimit,"d"))*-1,o=moment.duration(i).asHours();i>0?n.challenge.expires=o:i<=0&&v(null,!0,n)}}),S.currentUserIsAdmin=!1,S.currentUserIsPending=!1,r.isAuthenticated()&&(S.currentUserIsAdmin=_.some(S.competition.admins,["_id",r.currentUser._id]),S.currentUserIsPending=_.some(S.competition.pendingPlayers,["_id",r.currentUser._id])),S.currentUserIsOnCompetition=!1,S.hasActiveChallenge=!1,_.forEach(S.competition.players,function(e){r.isAuthenticated()&&e._id===r.currentUser._id&&(S.currentUserIsOnCompetition=!0,e.class=e.class?e.class+" current-user":"current-user",S.currentUserPlayer=e,a.getActiveChallengeByCompetitionByPlayer(S.competitionId,e._id).then(function(t){if(t.data){S.hasActiveChallenge=!0,S.activeChallengeOpponent=t.data.challenger._id===e._id?t.data.opponent:t.data.challenger;var n=_.find(S.competition.players,{_id:S.activeChallengeOpponent._id});n.class=n.class?n.class+" current-opponent":"current-opponent"}else f()}))})})}function p(){S.breakPoints=[];for(var e=0;e<A;e++)S.breakPoints.push(e*(e+1)/2+1)}function u(){var e=0;S.levels=[],p();for(var t=0;t<S.competition.players.length;t++)S.breakPoints.indexOf(t+1)>-1&&(e+=1,S.levels.push(e)),S.competition.players[t].level=e}function m(){S.numberOfBlocks=0;for(var e=_.last(S.levels);e>0;e--)S.numberOfBlocks+=e}function d(){S.numberOfRealPlayers=S.competition.players.length;for(var e=S.competition.players.length;e<S.numberOfBlocks;e++)S.competition.players.push({firstName:"Empty",lastName:"Spot",displayName:"Empty Spot",position:99,class:"empty"});u()}function f(){if(S.availableChallenges=!1,S.currentUserIsOnCompetition&&!S.hasActiveChallenge){var e=S.currentUserPlayer.level>1?S.currentUserPlayer.level-1:null;_.forEach(S.competition.players,function(t){var n=null;t.level===e&&99!==t.position&&"unavailable"!==t.class&&t.available!==!1&&(n=_.find(S.currentUserPlayer.waitingPeriods,{player:t._id}),n&&moment().isBefore(n.expires)?(t.class="waiting",t.waitUntil=moment(n.expires).format("MMM Do  LT")):(S.availableChallenges=!0,t.available=!0,t.class="available"))})}}function h(e){if(e.available){S.hasActiveChallenge=!0;var t={type:S.competition.type,competitionName:S.competition.name,competitionId:S.competitionId,complete:!1,forfeit:!1,timeLimit:S.competition.forfeitDays,challenger:{_id:S.currentUserPlayer._id,email:S.currentUserPlayer.email,firstName:S.currentUserPlayer.firstName,lastName:S.currentUserPlayer.lastName,displayName:S.currentUserPlayer.displayName,position:S.currentUserPlayer.position},opponent:{_id:e._id,email:e.email,firstName:e.firstName,lastName:e.lastName,displayName:e.displayName,position:e.position}};a.createPyramidChallenge(t).then(function(){S.competitionMenuToggle=!1})}else o.error("Sorry, that is not a valid challenge.")}function g(){a.getActiveChallengeByCompetitionByPlayer(S.competitionId,S.currentUserPlayer._id).then(function(e){e.data&&e.data.challenger._id===S.currentUserPlayer._id&&a.cancelPyramidChallenge(e.data).then(function(){S.hasActiveChallenge=!1})})}function v(e,t,i){var o=i||S.currentUserPlayer;a.getActiveChallengeByCompetitionByPlayer(S.competitionId,o._id).then(function(o){S.hasActiveChallenge=!1;var r=!1;t?(o.data.forfeit=!0,"opponent"===i.challenge.position?(o.data.winner="challenger",r=!0):o.data.winner="opponent"):e?o.data.challenger._id===S.currentUserPlayer._id?(o.data.winner="challenger",r=!0):o.data.winner="opponent":o.data.challenger._id===S.currentUserPlayer._id?o.data.winner="opponent":(o.data.winner="challenger",r=!0);var l,s=null;"opponent"===o.data.winner?(s=o.data.opponent,l=o.data.challenger):(s=o.data.challenger,l=o.data.opponent),n.createWaitingPeriod(S.competitionId,l._id,s._id,S.competition.waitingPeriodDays),r?n.swapPositions(S.competitionId,o.data.opponent,o.data.challenger).then(function(){a.completePyramidChallenge(o.data).then(function(){N&&P()})}):a.completePyramidChallenge(o.data).then(function(){N&&P()}),S.competitionMenuToggle=!1})}function y(e){v(null,!0,e)}function C(){if(r.isAuthenticated())if(S.numberOfRealPlayers<S.maxPlayers){var e={_id:r.currentUser._id,firstName:r.currentUser.firstName,lastName:r.currentUser.lastName,displayName:r.currentUser.displayName,email:r.currentUser.username,position:S.numberOfRealPlayers+1};S.competition.restrictJoins?swal({title:"Send Join Request?",text:"This is a closed competition so an admin must approve your request",type:"warning",showCancelButton:!0,confirmButtonText:"Send Request",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToCompetitionRequest(S.competition,e).then(function(){S.currentUserIsPending=!0}),swal("Request Sent","You will receive an email once an admin processes the request.","success")}):swal({title:"Join Competition?",text:"You'll be added to the bottom",type:"warning",showCancelButton:!0,confirmButtonText:"Join",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToCompetition(S.competitionId,e),swal("Welcome Aboard!","Now start fighting your way to the top","success")})}else o.warning("Sorry, this competition is full");else o.warning("Please login to join a competition"),t.previous="competitions.view",t.prevParams={competitionId:S.competitionId},t.go("login")}function w(){swal({title:"Leave Competition?",text:"You will lose your spot and forfeit any active challenges.",type:"error",showCancelButton:!0,confirmButtonText:"Yes, leave",confirmButtonClass:"btn-danger",cancelButtonText:"No, stay",closeOnConfirm:!1,closeOnCancel:!0},function(){P(),swal("OK, you'r out!","You've been removed from the competition.","success")})}function P(){r.isAuthenticated()&&S.currentUserIsOnCompetition&&(N=!0,S.hasActiveChallenge?v(null,!0,S.currentUserPlayer):(S.currentUserIsOnCompetition=!1,S.hasActiveChallenge=!1,n.getCompetition(S.competitionId).then(function(e){var t=e.data,i=S.currentUserPlayer.position;_.forEach(t.players,function(e){e.position>=i&&(e.position-=1)});for(var o=_.remove(t.players,function(e){return e._id===S.currentUserPlayer._id}),r=[],a=0;a<S.numberOfRealPlayers-1;++a){var l={_id:t.players[a]._id,firstName:t.players[a].firstName,lastName:t.players[a].lastName,displayName:t.players[a].displayName,position:t.players[a].position};r.push(l)}n.removedPlayerFromCompetition(S.competitionId,o[0],r).then(function(){N=!1})})))}function b(e){99!==e.position||S.currentUserIsOnCompetition?e.showChallengeModal=!e.showChallengeModal:C()}function U(){n.getCompetition(S.competitionId).then(function(e){S.competition=e.data})}var A=7,S=this;S.competitionId=null,S.breakPoints=[],S.levels=[],S.numberOfBlocks=0,S.currentUserIsOnCompetition=!1,S.currentUserIsPending=!1,S.currentUserIsAdmin=!1,S.hasActiveChallenge=!1,S.activeChallengeOpponent=null,S.availableChallenges=!1,S.createChallenge=h,S.cancelChallenge=g,S.completeChallenge=v,S.forfeitChallenge=y,S.currentUserPlayer={},S.competitionMenuToggle=!1,S.addCurrentUserToCompetition=C,S.confirmRemoveCurrentUserFromCompetition=w,S.playerClick=b,S.numberOfRealPlayers=0,S.maxPlayers=0,l();var N=!1;e.$on("ws:competition_updated",function(e,t){S.competitionId===t.competitionId&&(o.info(t.description),U())})}t.$inject=["$scope","$state","competitionsService","$filter","notifyService","identityService","challengesService"],angular.module("app").directive("wpmPyramid",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competition:"="},templateUrl:"/competitions/components/update-admins.html"};return e}function t(e,t,n,i,o){function r(){e.$watch("vm.competition",function(){d.competition&&(d.addedAdmins=_.cloneDeep(d.competition.admins),d.disableSubmit=!0,d.userIsPrimaryAdmin=_.find(d.competition.admins,{primary:!0})._id===o.currentUser._id,a())})}function a(){d.availableAdmins=[],u=[],i.getVerifiedUsers().then(function(e){_.forEach(d.competition.admins,function(t){_.remove(e.data,function(e){return t._id===e._id})}),_.forEach(e.data,function(e){d.availableAdmins.push({firstName:e.firstName,lastName:e.lastName,displayName:e.displayName,email:e.username,_id:e._id})}),m=_.cloneDeep(d.availableAdmins)})}function l(){d.competition.admins=d.addedAdmins,t.updateCompetition(d.competition).then(function(){d.disableSubmit=!0})}function s(){u=[],d.addedAdmins=_.cloneDeep(d.competition.admins),d.availableAdmins=_.cloneDeep(m)}function c(e){u.push(e),d.availableAdmins.push(_.remove(d.addedAdmins,{
_id:e._id})[0]),d.disableSubmit=!1}function p(e){d.addedAdmins.push(_.remove(d.availableAdmins,{_id:e._id})[0]),d.disableSubmit=!1}var u=[],m=[],d=this;d.availableAdmins=[],d.addedAdmins=[],d.userIsPrimaryAdmin=!1,d.updateCompetition=l,d.cancelUpdate=s,d.removeAdmin=c,d.addAdmin=p,d.disableSubmit=!0,r()}t.$inject=["$scope","competitionsService","challengesService","userService","identityService"],angular.module("app").directive("wpmUpdateAdmins",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competition:"="},templateUrl:"/competitions/components/update-players.html"};return e}function t(e,t,n,i,o){function r(){for(var t=g;t>0;--t)v+=t;e.$watch("vm.competition",function(){y.competition&&(y.addedPlayers=_.cloneDeep(y.competition.players),y.disableSubmit=!0,a())})}function a(){y.availablePlayers=[],f=[],i.getVerifiedUsers().then(function(e){_.forEach(y.competition.players,function(t){_.remove(e.data,function(e){return t._id===e._id})}),_.forEach(e.data,function(e){y.availablePlayers.push({firstName:e.firstName,lastName:e.lastName,displayName:e.displayName,email:e.username,_id:e._id})}),h=_.cloneDeep(y.availablePlayers)})}function l(){"versus"===y.competition.type&&y.addedPlayers.length%2>0?o.error("A Versus competition must have an even number of players"):y.addedPlayers.length>v?o.error("A competition can have a maximum of "+v+" players"):(_.forEach(f,function(e){n.deleteActiveChallengeByCompetitionByPlayer(y.competition._id,e._id)}),y.competition.players=y.addedPlayers,t.updateCompetition(y.competition).then(function(){y.disableSubmit=!0}))}function s(){f=[],y.addedPlayers=_.cloneDeep(y.competition.players),y.availablePlayers=_.cloneDeep(h)}function c(){"versus"===y.competition.type?u():"pyramid"===y.competition.type&&p(),y.disableSubmit=!1}function p(){var e=1;_.forEach(y.addedPlayers,function(t){t.position=e,++e})}function u(){_.forEach(y.addedPlayers,function(e){e.position=2});for(var e=0;e<y.addedPlayers.length/2;e++)y.addedPlayers[e].position=1}function m(e){f.push(e),y.availablePlayers.push(_.remove(y.addedPlayers,{_id:e._id})[0]),c()}function d(e){y.addedPlayers.push(_.remove(y.availablePlayers,{_id:e._id})[0]),c(),y.disableSubmit=!1}var f=[],h=[],g=7,v=null,y=this;y.availablePlayers=[],y.addedPlayers=[],y.updateCompetition=l,y.cancelUpdate=s,y.reorderPlayers=c,y.removePlayer=m,y.addPlayer=d,y.disableSubmit=!0,r()}t.$inject=["$scope","competitionsService","challengesService","userService","notifyService"],angular.module("app").directive("wpmUpdatePlayers",e)}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"/competitions/components/versus.html",replace:!0,scope:{competition:"="},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,n,i,o){function r(){e.$watch("vm.competition",function(){m.competition&&(m.competitionId=m.competition._id,m.showControls=!1,m.showChallengeModal=!1,a(),l())})}function a(){m.competition.teams=[{players:_.filter(m.competition.players,["position",1])},{players:_.filter(m.competition.players,["position",2])}],2===m.competition.players.length&&(m.singlePlayerTeams=!0)}function l(){m.currentUserIsAdmin=!1,m.currentUserIsPending=!1,n.isAuthenticated()&&(m.currentUserIsAdmin=_.some(m.competition.admins,["_id",n.currentUser._id]),m.currentUserIsPending=_.some(m.competition.pendingPlayers,["_id",n.currentUser._id])),m.currentUserIsOnCompetition=!1,m.hasActiveChallenge=!1,_.forEach(m.competition.players,function(e){n.isAuthenticated()&&e._id===n.currentUser._id&&(m.currentUserIsOnCompetition=!0,e.class="current-user",m.currentUserPlayer=e,m.competition.teams[e.position-1].class="current-user-team",m.competition.class="current-user-on-competition")}),i.getActiveChallengesByCompetition(m.competitionId).then(function(e){if(e.data.length>0&&(m.activeChallenge=e.data[0],m.hasActiveChallenge=!0,0!==m.activeChallenge.timeLimit)){var t=moment().diff(moment(m.activeChallenge.created).add(m.activeChallenge.timeLimit,"d"))*-1,n=moment.duration(t).asHours();t>0?m.challengeExpireTime=n:t<=0&&p(null,!0)}})}function s(){m.hasActiveChallenge&&m.currentUserIsOnCompetition&&(m.showControls=!m.showControls)}function c(e){if(m.showChallengeModal=!1,m.hasActiveChallenge)o.error("Sorry, you are already in an active challenge.");else{m.hasActiveChallenge=!0;var t={type:m.competition.type,competitionName:m.competition.name,competitionId:m.competitionId,complete:!1,forfeit:!1,timeLimit:m.competition.forfeitDays,challenger:{team:m.currentUserPlayer.position,_id:m.currentUserPlayer._id},opponent:{team:e}};i.createVersusChallenge(t).then(function(){m.competitionMenuToggle=!1})}}function p(e,t){m.hasActiveChallenge=!1;var n=m.activeChallenge;t?(n.forfeit=!0,n.winner="challenger"):m.activeChallenge.challenger.team===e?n.winner="challenger":n.winner="opponent",i.completeVersusChallenge(n),m.competitionMenuToggle=!1}function u(){t.getCompetition(m.competitionId).then(function(e){m.competition=e.data})}var m=this;m.competitionId=null,m.currentUserIsAdmin=!1,m.currentUserIsPending=!1,m.currentUserIsOnCompetition=!1,m.activeChallenge=null,m.hasActiveChallenge=!1,m.currentUserPlayer=null,m.createChallenge=c,m.completeChallenge=p,m.challengeExpireTime=null,m.showControls=!1,m.showChallengeModal=!1,m.toggleControls=s,m.singlePlayerTeams=!1,r(),e.$on("ws:competition_updated",function(e,t){m.competitionId===t.competitionId&&(o.info(t.description),u())})}t.$inject=["$scope","competitionsService","identityService","challengesService","notifyService"],angular.module("app").directive("wpmVersus",e)}(),function(){"use strict";function e(e){function t(t){return e.get("/api/competition",{params:{competitionId:t}})}function n(t){return e.get("/api/competitions/user",{params:{userId:t}})}function i(){return e.get("/api/competitions/public")}function o(){return e.get("/api/competitions/private")}function r(t){return e.post("/api/competitions/create",{competition:t})}function a(t){return e.post("/api/competitions/update",{competition:t})}function l(t){return e.delete("/api/competitions/delete",{params:{competitionId:t}})}function s(t,n,i,o){return e.put("/api/competitions/createWaitingPeriod",{competitionId:t,loserId:n,winnerId:i,waitingPeriod:o})}function c(t,n,i){return e.post("/api/competitions/swapPositions",{competitionId:t,challenger:n,opponent:i})}function p(t,n){return e.post("/api/competitions/addPlayer",{competitionId:t,player:n})}function u(t,n){return e.post("/api/competitions/addPlayerRequest",{competition:t,player:n})}function m(t,n,i){return e.post("/api/competitions/removePlayer",{competitionId:t,removedPlayer:n,players:i})}function d(t,n){return e.post("/api/competitions/approvePlayer",{competitionId:t,player:n})}function f(t,n){return e.post("/api/competitions/denyPlayer",{competitionId:t,player:n})}var h={getCompetition:t,getCompetitionsForUser:n,getPublicCompetitions:i,getPrivateCompetitions:o,createCompetition:r,updateCompetition:a,deleteCompetition:l,createWaitingPeriod:s,swapPositions:c,addPlayerToCompetition:p,addPlayerToCompetitionRequest:u,removedPlayerFromCompetition:m,approvePendingPlayer:d,denyPendingPlayer:f};return h}e.$inject=["$http"],angular.module("app").factory("competitionsService",e)}(),function(){"use strict";function e(e,t,n,i,o,r,a,l){function s(){n.competitionId?(d.competitionId=n.competitionId,c()):t.go("competitions.myCompetitions")}function c(){o.getCompetition(d.competitionId).then(function(e){e.data&&_.some(e.data.admins,["_id",r.currentUser._id])?(d.isAdmin=!0,e.data.players=i("orderBy")(e.data.players,"position"),d.competition=e.data):t.go("competitions.myCompetitions")}),l.getCompletedChallengesByCompetition(d.competitionId).then(function(e){d.challenges=e.data})}function p(){o.getCompetition(d.competitionId).then(function(e){var t=e.data;t.restrictJoins=d.competition.restrictJoins,o.updateCompetition(t)})}function u(){o.getCompetition(d.competitionId).then(function(e){var t=e.data;t.private=d.competition.private,o.updateCompetition(t)})}function m(){swal({title:"Delete Competition?",text:"This can not be undone",type:"error",showCancelButton:!0,confirmButtonText:"Delete",cancelButtonText:"Nevermind",closeOnConfirm:!0,closeOnCancel:!0},function(){o.deleteCompetition(d.competitionId).then(function(){t.go("competitions.myCompetitions")})})}var d=this;d.competitionId=null,d.updateCompetitionRestrictJoins=p,d.updateCompetitionPrivate=u,d.deleteCompetition=m,s(),e.$on("ws:competition_updated",function(e,t){d.competitionId===t.competitionId&&(a.info(t.description),c())}),e.$on("ws:competition_deleted",function(e,n){d.competitionId===n.competitionId&&(a.info(n.description),t.go("competitions.myCompetitions"))})}e.$inject=["$scope","$state","$stateParams","$filter","competitionsService","identityService","notifyService","challengesService"],angular.module("app").controller("CompetitionAdminCtrl",e)}(),function(){"use strict";function e(e,t,n,i,o,r){function a(){t.competitionId&&(s.competitionId=t.competitionId,l())}function l(){i.getCompetition(s.competitionId).then(function(e){e.data?(s.competition=e.data,"pyramid"===s.competition.type?_.forEach(s.competition.players,function(e){r.getPlayerResultsByCompetition(s.competitionId,e._id).then(function(t){e.results=t.data})}):"versus"===s.competition.type&&(s.teams=[{number:1},{number:2}])):n.go("competitions.myCompetitions")}),r.getCompletedChallengesByCompetition(s.competitionId).then(function(e){s.challenges=e.data})}var s=this;s.competitionId=null,s.competition={},s.playersResults=[],s.challenges=[],a(),e.$on("ws:competition_updated",function(e,t){s.competitionId===t.competitionId&&(o.info(t.description),l())}),e.$on("ws:competition_deleted",function(e,t){s.competitionId===t.competitionId&&(o.info(t.description),n.go("competitions.myCompetitions"))})}e.$inject=["$scope","$stateParams","$state","competitionsService","notifyService","challengesService"],angular.module("app").controller("CompetitionStatsCtrl",e)}(),function(){"use strict";function e(e,t,n,i,o,r){function a(){n.competitionId&&(s.competitionId=n.competitionId,l())}function l(){i.getCompetition(s.competitionId).then(function(e){e.data?s.competition=e.data:t.go("competitions.myCompetitions")})}var s=this;s.competitionId=null,s.competition=null,a(),e.$on("ws:competition_deleted",function(e,n){s.competitionId===n.competitionId&&(r.info(n.description),t.go("competitions.myCompetitions"))})}e.$inject=["$scope","$state","$stateParams","competitionsService","challengesService","notifyService"],angular.module("app").controller("CompetitionCtrl",e)}(),function(){"use strict";function e(e){function t(){e.getPublicCompetitions().then(function(e){n.competitions=e.data})}var n=this;n.competitions=[],t()}e.$inject=["competitionsService"],angular.module("app").controller("CompetitionsCtrl",e)}(),function(){"use strict";function e(e,t,n,i,o){function r(){t.getVerifiedUsers().then(function(e){h.availablePlayers=e.data});for(var e=d;e>0;--e)f+=e;for(e=0;e<d;e++)m.push(e*(e+1)/2+1)}function a(e){h.addedPlayers.push(_.remove(h.availablePlayers,{_id:e._id})[0]),s()}function l(e){h.availablePlayers.push(_.remove(h.addedPlayers,{_id:e._id})[0]),s()}function s(){"versus"===h.newCompetition.type?p():"pyramid"===h.newCompetition.type&&c()}function c(){var e=1;_.forEach(h.addedPlayers,function(t){t.position=e,++e})}function p(){_.forEach(h.addedPlayers,function(e){e.position=2});for(var e=0;e<h.addedPlayers.length/2;e++)h.addedPlayers[e].position=1}function u(t){if("versus"===t.type&&h.addedPlayers.length%2>0)o.error("A Versus competition must have an even number of players");else if(h.addedPlayers.length>f)o.error("A competition can have a maximum of "+f+" players");else{angular.forEach(h.addedPlayers,function(e){var n={_id:e._id,email:e.username,firstName:e.firstName,lastName:e.lastName,displayName:e.displayName,position:e.position};t.players.push(n)}),t.admins=[{_id:i.currentUser._id,email:i.currentUser.username,firstName:i.currentUser.firstName,lastName:i.currentUser.lastName,displayName:i.currentUser.displayName,primary:!0}];for(var r=0;r<m.length;r++)if(t.players.length<m[r]){t.levels=r;break}n.createCompetition(t).then(function(t){e.go("competitions.view",{competitionId:t.data._id})})}}var m=[],d=7,f=null,h=this;h.newCompetition={players:[],restrictJoins:!1,private:!1},h.availablePlayers=[],h.addedPlayers=[],h.createCompetition=u,h.addPlayer=a,h.removePlayer=l,h.reorderPlayers=s,h.newCompetition.forfeitDays=1,h.newCompetition.waitingPeriodDays=1,h.competitionTypes=["pyramid","versus"],r()}e.$inject=["$state","userService","competitionsService","identityService","notifyService"],angular.module("app").controller("CreateCompetitionCtrl",e)}(),function(){"use strict";function e(e,t,n,i,o){function r(){a()}function a(){l=[],s.activeChallenge=null,i.isAuthenticated()&&t.getCompetitionsForUser(i.currentUser._id).then(function(e){s.competitions=e.data,_.forEach(s.competitions,function(e){l.push(e._id),"pyramid"===e.type?n.getActiveChallengeByCompetitionByPlayer(e._id,i.currentUser._id).then(function(t){t.data&&(e.activeChallenge=t.data,0!==e.activeChallenge.timeLimit&&(e.activeChallenge.expires=moment().diff(moment(e.activeChallenge.created).add(e.activeChallenge.timeLimit,"d"),"s")*-1))}):"versus"===e.type&&n.getActiveChallengesByCompetition(e._id).then(function(t){t.data.length>0&&(e.activeChallenge=t.data[0],0!==e.activeChallenge.timeLimit&&(e.activeChallenge.expires=moment().diff(moment(e.activeChallenge.created).add(e.activeChallenge.timeLimit,"d"),"s")*-1))})})})}var l=[],s=this;s.activeChallenge=null,r(),e.$on("ws:competition_updated",function(e,t){l.indexOf(t.competitionId)>=0&&(o.info(t.description),a())})}e.$inject=["$scope","competitionsService","challengesService","identityService","notifyService"],angular.module("app").controller("MyCompetitionsCtrl",e)}(),function(){"use strict";function e(e,t,n){function i(){e.currentUser.displayName||(a.user.displayName=e.currentUser.firstName+" "+e.currentUser.lastName),r=_.cloneDeep(a.user)}function o(i){var o=[];t.getAllUsers().then(function(l){if(_.forEach(l.data,function(e){o.push(e.displayName.toLowerCase())}),i.password!==i.confirmPassword)n.error("Passwords don't match!");else if(i.firstName.length<1||i.lastName.length<1||i.displayName.length<1)n.error("Don't leave names blank!  How will people know who you are?");else if(r.displayName!==i.displayName&&_.indexOf(o,i.displayName.toLowerCase())>-1)n.error("Sorry, someone else is already using that display name");else if(!e.isAuthorized("super-admin")&&i.displayName.toLowerCase().indexOf("maestro")>-1)n.error("Sorry, there's only one Maestro");else{var s={_id:i._id};(i.firstName!==e.currentUser.firstName&&i.firstName.length>0||i.lastName!==e.currentUser.lastName&&i.lastName.length>0||i.displayName!==e.currentUser.displayName&&i.displayName.length>0)&&(s.firstName=i.firstName,s.lastName=i.lastName,s.displayName=i.displayName),i.password&&i.password.lentgh>0&&(s.password=i.password),t.updateUser(s).then(function(){n.success("Your information has been updated"),a.userForm.$setPristine();var t=angular.copy(e.currentUser);angular.extend(t,s),e.currentUser=t,a.user.confirmPassword=a.user.password=""})}})}var r=null,a=this;a.user={_id:e.currentUser._id,firstName:e.currentUser.firstName,lastName:e.currentUser.lastName,displayName:e.currentUser.displayName},a.updateUser=o,a.userForm={},i()}e.$inject=["identityService","userService","notifyService"],angular.module("app").controller("UserCtrl",e)}(),function(){"use strict";function e(e,t,n,i,o,r){function a(e,i){var r=n.defer();return t.post("/login",{username:e,password:i}).then(function(e){e.data.success?(o.currentUser=e.data.user,r.resolve(!0)):"unverified"===e.data.message?r.resolve("unverified"):r.resolve(!1)}),r.promise}function l(e){var i=n.defer();return t.post("/api/users",{userData:e}).then(function(e){e.data?i.resolve(!0):i.resolve(!1)},function(e){"Error: Email already in use"===e.data.reason&&r.error("Sorry, an account already exists with that email address.")}),i.promise}function s(){var i=n.defer();return t.post("/logout",{logout:!0}).then(function(){o.currentUser=void 0,i.resolve(),e.go("home")}),i.promise}function c(e){return!!o.isAuthorized(e)||n.reject("not authorized")}function p(){return!!o.isAuthenticated()||n.reject("not authorized")}var u={authenticateUser:a,createUser:l,logout:s,authorizeCurrentUserForRoute:c,authenticatedUserForRoute:p};return u}e.$inject=["$state","$http","$q","userService","identityService","notifyService"],angular.module("app").factory("authService",e)}(),function(){"use strict";function e(e){function t(){return e.get("/api/users").then(function(e){return e})}function n(){return e.get("/api/users/verified").then(function(e){return _.forEach(e.data,function(e){e.displayName||(e.displayName=e.firstName+" "+e.lastName)}),e})}function i(t,n){return e.get("/api/user/verification",{params:{userId:t,verificationToken:n}})}function o(t){return e.get("/api/user/password/link",{params:{username:t}})}function r(t,n,i){return e.put("/api/user/password/reset",{userId:t,verificationToken:n,password:i})}function a(t){return e.put("/api/user",{user:t})}var l={getAllUsers:t,getVerifiedUsers:n,verifyUser:i,generatePasswordResetLink:o,resetPassword:r,updateUser:a};return l}e.$inject=["$http"],angular.module("app").factory("userService",e)}(),function(){"use strict";function e(e){function t(t,n,i){var o=i.scrollaxis||"y",r=i.theme||"minimal-dark",a=i.mousewheelaxis||"y";$("html").hasClass("ismobile")||e.malihuScroll(n,r,o,a)}var n={restrict:"C",link:t};return n}e.$inject=["scrollbarService"],angular.module("app").directive("cOverflow",e)}(),function(){"use strict";function e(){function e(e,t){t.click(function(){t.next().slideToggle(200),t.parent().toggleClass("toggled")})}var t={restrict:"A",link:e};return t}angular.module("app").directive("toggleSubmenu",e)}(),function(){"use strict";function e(){function e(e,t){t.hasClass("btn-icon")||t.hasClass("btn-float")?Waves.attach(t,["waves-circle"]):t.hasClass("btn-light")?Waves.attach(t,["waves-light"]):Waves.attach(t),Waves.init()}var t={restrict:"C",link:e};return t}angular.module("app").directive("wavesEffect",e)}(),function(){"use strict";function e(){function e(e,t){var n=t.children().first(),i=t.parent().hasClass("fg-float");n.focus(function(){t.addClass("fg-toggled")}),n.blur(function(){(!i||i&&0===n.val().length)&&t.removeClass("fg-toggled")})}var t={restrict:"C",link:e};return t}angular.module("app").directive("fgLine",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiYXBwLmNvbnRyb2xsZXIuanMiLCJhcHAucm91dGVzLmpzIiwiYXBwLnJ1bi5qcyIsImFkbWluL3ZpZXdzL2VkaXQtdXNlci1hZG1pbi5jb250cm9sbGVyLmpzIiwiYXV0aGVudGljYXRpb24vdmlld3MvbG9naW4uY29udHJvbGxlci5qcyIsImF1dGhlbnRpY2F0aW9uL3ZpZXdzL3Bhc3N3b3JkLXJlc2V0LmNvbnRyb2xsZXIuanMiLCJhdXRoZW50aWNhdGlvbi92aWV3cy9yZWdpc3Rlci5jb250cm9sbGVyLmpzIiwiYXV0aGVudGljYXRpb24vdmlld3MvdmVyaWZpY2F0aW9uLmNvbnRyb2xsZXIuanMiLCJjaGFsbGVuZ2VzL2NvbXBvbmVudHMvYWN0aXZlLWNoYWxsZW5nZXMuZGlyZWN0aXZlLmpzIiwiY2hhbGxlbmdlcy9jb21wb25lbnRzL2NvbXBsZXRlZC1jaGFsbGVuZ2VzLmRpcmVjdGl2ZS5qcyIsImNoYWxsZW5nZXMvY29tcG9uZW50cy9wbGF5ZXItb3ZlcmFsbC1yZXN1bHRzLmRpcmVjdGl2ZS5qcyIsImNoYWxsZW5nZXMvY29tcG9uZW50cy90ZWFtLW92ZXJhbGwtcmVzdWx0cy5kaXJlY3RpdmUuanMiLCJjaGFsbGVuZ2VzL3NlcnZpY2VzL2NoYWxsZW5nZXMuc2VydmljZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL2Zvb3Rlci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy9oZWFkZXIuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvc2lkZWJhci5kaXJlY3RpdmUuanMiLCJjb21tb24vZmlsdGVycy9vcmRlci1vYmplY3QtYnkuZmlsdGVyLmpzIiwiY29tbW9uL3NlcnZpY2VzL2FsZXJ0cy5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL2luZGVudGl0eS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL25vdGlmeS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3Njcm9sbGJhci5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3NpZGViYXIuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy93ZWJzb2NrZXQuc2VydmljZS5qcyIsImNvbW1vbi92aWV3cy9ob21lLmNvbnRyb2xsZXIuanMiLCJjb21wZXRpdGlvbnMvY29tcG9uZW50cy9jb21wZXRpdGlvbi1jb21wYWN0LmRpcmVjdGl2ZS5qcyIsImNvbXBldGl0aW9ucy9jb21wb25lbnRzL3BlbmRpbmctcGxheWVycy5kaXJlY3RpdmUuanMiLCJjb21wZXRpdGlvbnMvY29tcG9uZW50cy9weXJhbWlkLmRpcmVjdGl2ZS5qcyIsImNvbXBldGl0aW9ucy9jb21wb25lbnRzL3VwZGF0ZS1hZG1pbnMuZGlyZWN0aXZlLmpzIiwiY29tcGV0aXRpb25zL2NvbXBvbmVudHMvdXBkYXRlLXBsYXllcnMuZGlyZWN0aXZlLmpzIiwiY29tcGV0aXRpb25zL2NvbXBvbmVudHMvdmVyc3VzLmRpcmVjdGl2ZS5qcyIsImNvbXBldGl0aW9ucy9zZXJ2aWNlcy9jb21wZXRpdGlvbnMuc2VydmljZS5qcyIsImNvbXBldGl0aW9ucy92aWV3cy9jb21wZXRpdGlvbi1hZG1pbi5jb250cm9sbGVyLmpzIiwiY29tcGV0aXRpb25zL3ZpZXdzL2NvbXBldGl0aW9uLXN0YXRzLmNvbnRyb2xsZXIuanMiLCJjb21wZXRpdGlvbnMvdmlld3MvY29tcGV0aXRpb24uY29udHJvbGxlci5qcyIsImNvbXBldGl0aW9ucy92aWV3cy9jb21wZXRpdGlvbnMuY29udHJvbGxlci5qcyIsImNvbXBldGl0aW9ucy92aWV3cy9jcmVhdGUtY29tcGV0aXRpb24uY29udHJvbGxlci5qcyIsImNvbXBldGl0aW9ucy92aWV3cy9teS1jb21wZXRpdGlvbnMuY29udHJvbGxlci5qcyIsInVzZXJzL3ZpZXdzL3VzZXIuY29udHJvbGxlci5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL2F1dGguc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL3VzZXIuc2VydmljZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL3VpL3Njcm9sbGJhci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS90b2dnbGUtc3VibWVudS5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS93YXZlcy5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS9mb3Jtcy9mZy1saW5lLmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlndXJhdGlvbiIsIiRodHRwUHJvdmlkZXIiLCIkdWliVG9vbHRpcFByb3ZpZGVyIiwiJHFQcm92aWRlciIsImRlZmF1bHRzIiwiaGVhZGVycyIsImdldCIsIm9wdGlvbnMiLCJhcHBlbmRUb0JvZHkiLCJlcnJvck9uVW5oYW5kbGVkUmVqZWN0aW9ucyIsImNvbmZpZyIsIkFwcEN0cmwiLCIkc3RhdGUiLCJsb2NhbFN0b3JhZ2VTZXJ2aWNlIiwidG9nZ2xlU2lkZWJhckxvY2tlZCIsImxvY2tlZCIsInNldCIsImFwcEN0cmwiLCJ0aGlzIiwibG9ja1NpZGViYXIiLCJjb250cm9sbGVyIiwiY29uZmlndXJlUm91dGVzIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsInJvdXRlUm9sZUNoZWNrcyIsInN1cGVyQWRtaW4iLCJyZXF1aXJlU3VwZXJBZG1pbiIsImFkbWluIiwicmVxdWlyZUFkbWluIiwidXNlciIsInJlcXVpcmVBdXRoIiwiaHRtbDVNb2RlIiwib3RoZXJ3aXNlIiwid2hlbiIsInN0YXRlIiwidXJsIiwidmlld3MiLCJjb250ZW50IiwiY29udHJvbGxlckFzIiwidGVtcGxhdGVVcmwiLCJjb250ZW50QCIsInJlc29sdmUiLCJhdXRoIiwiYXV0aFNlcnZpY2UiLCJhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlIiwiYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSIsIiRpbmplY3QiLCJhcHBSdW4iLCIkcm9vdFNjb3BlIiwiJGRvY3VtZW50Iiwic2lkZWJhclNlcnZpY2UiLCIkb24iLCJldmVudCIsInRvU3RhdGUiLCJ0b1BhcmFtcyIsImZyb21TdGF0ZSIsImZyb21QYXJhbXMiLCJlcnJvciIsImdvIiwicHJldmlvdXMiLCJwcmV2UGFyYW1zIiwic2V0U2lkZWJhclN0YXR1cyIsImJvZHkiLCJzY3JvbGxUb3AiLCJkb2N1bWVudEVsZW1lbnQiLCJydW4iLCJFZGl0VXNlckFkbWluQ3RybCIsImlkZW50aXR5U2VydmljZSIsInVzZXJTZXJ2aWNlIiwibm90aWZ5U2VydmljZSIsImFjdGl2YXRlIiwicmVmcmVzaFVzZXJMaXN0IiwiZ2V0QWxsVXNlcnMiLCJ0aGVuIiwidXNlcnMiLCJ2bSIsImRhdGEiLCJvcmlnaW5hbFVzZXJzIiwiXyIsImNsb25lRGVlcCIsInNlbGVjdFVzZXIiLCJzZWxlY3RlZFVzZXIiLCJvcmdpbmFsU2VsZWN0ZWRVc2VyIiwidXBkYXRlVXNlciIsImRpc3BsYXlOYW1lcyIsImZvckVhY2giLCJwdXNoIiwiZGlzcGxheU5hbWUiLCJ0b0xvd2VyQ2FzZSIsImZpcnN0TmFtZSIsImxlbmd0aCIsImxhc3ROYW1lIiwiaW5kZXhPZiIsInVzZXJVcGRhdGVzIiwiX2lkIiwic3VjY2VzcyIsInVzZXJGb3JtIiwiTG9naW5DdHJsIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiYXV0aGVudGljYXRlVXNlciIsInJlc3BvbnNlIiwiUGFzc3dvcmRSZXNldEN0cmwiLCIkc3RhdGVQYXJhbXMiLCJpc0F1dGhlbnRpY2F0ZWQiLCJ1c2VySWQiLCJ2ZXJpZmljYXRpb25Ub2tlbiIsInZlcmlmeVVzZXIiLCJ2ZXJpZmllZCIsImdlbmVyYXRlUGFzc3dvcmRSZXNldExpbmsiLCJyZXNldFBhc3N3b3JkIiwicmVzZXRQYXNzd29yZEZvcm0iLCJjb25maXJtUGFzc3dvcmQiLCJSZWdpc3RlckN0cmwiLCJyZWdpc3RlciIsIm5ld1VzZXIiLCJjcmVhdGVVc2VyIiwiVmVyaWZpY2F0aW9uQ3RybCIsInZlcmlmeWluZyIsInVuZGVmaW5lZCIsIndwbUFjdGl2ZUNoYWxsZW5lZ2VzIiwiZGlyZWN0aXZlIiwiYmluZFRvQ29udHJvbGxlciIsImN0cmxGdW5jIiwicmVzdHJpY3QiLCJzY29wZSIsImNvbXBldGl0aW9uIiwiYWxsb3dEZWxldGUiLCJudW1iZXJPZkNoYWxsZW5nZXMiLCJjaGFsbGVuZ2VzUGVyUGFnZSIsIiRzY29wZSIsImNoYWxsZW5nZXNTZXJ2aWNlIiwibmdUYWJsZVBhcmFtcyIsIiR3YXRjaCIsImdldEFjdGl2ZUNoYWxsZW5nZXMiLCJnZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbiIsImNoYWxsZW5nZXMiLCJ0YWJsZURhdGEiLCJwYWdlIiwiY291bnQiLCJjb3VudHMiLCJ0b3RhbCIsImdldERhdGEiLCIkZGVmZXIiLCJwYXJhbXMiLCJzbGljZSIsImNoYWxsZW5nZSIsInR5cGUiLCJwbGF5ZXJzIiwiY2hhbGxlbmdlciIsInRlYW0iLCJvcHBvbmVudCIsImZpbmQiLCJwb3NpdGlvbiIsInRpbWVMaW1pdCIsInRpbWVUb0V4cGlyZSIsIm1vbWVudCIsImRpZmYiLCJjcmVhdGVkIiwiYWRkIiwiZXhwaXJlcyIsImR1cmF0aW9uIiwiYXNIb3VycyIsImRlbGV0ZUNoYWxsZW5nZSIsImNoYWxsZW5nZUlkIiwiJGluZGV4Iiwic3dhbCIsInRpdGxlIiwidGV4dCIsInNob3dDYW5jZWxCdXR0b24iLCJjb25maXJtQnV0dG9uVGV4dCIsImNhbmNlbEJ1dHRvblRleHQiLCJjbG9zZU9uQ29uZmlybSIsImNsb3NlT25DYW5jZWwiLCJzcGxpY2UiLCJ3cG1Db21wbGV0ZWRDaGFsbGVuZWdlcyIsImdldENvbXBsZXRlZENoYWxsZW5nZXMiLCJnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbiIsImxvc2VyIiwid2lubmVyIiwid2hlbkNvbXBsZXRlZCIsImNvbXBsZXRlZCIsImNhbGVuZGFyIiwic2FtZURheSIsIm5leHREYXkiLCJuZXh0V2VlayIsImxhc3REYXkiLCJsYXN0V2VlayIsInNhbWVFbHNlIiwid3BtUGxheWVyT3ZlcmFsbFJlc3VsdHMiLCJwbGF5ZXIiLCJhc3NpZ25wbGF5ZXJzVG9MZXZlbHMiLCJjYWxjdWxhdGVTdHJlYWsiLCJjYWxjdWF0ZVdpbkFuZExvc2VzIiwiYnJlYWtQb2ludHMiLCJpIiwibWF4TGV2ZWxzIiwibGV2ZWwiLCJqIiwic3RyZWFrVHlwZSIsInN0cmVhayIsImNvbnRpbnVlU3RyZWFrIiwicmVzdWx0cyIsInZhbHVlIiwid2lucyIsImFzT3Bwb25lbnQiLCJzaXplIiwiZmlsdGVyIiwiYXNDaGFsbGVuZ2VyIiwiYnlGb3JmZWl0IiwiZm9yZmVpdCIsImxvc2VzIiwid3BtVGVhbU92ZXJhbGxSZXN1bHRzIiwic2luZ2xlUGxheWVyVGVhbXMiLCJwbGF5ZXJOYW1lIiwiJGh0dHAiLCJjcmVhdGVQeXJhbWlkQ2hhbGxlbmdlIiwicG9zdCIsImNhbmNlbFB5cmFtaWRDaGFsbGVuZ2UiLCJwdXQiLCJjcmVhdGVWZXJzdXNDaGFsbGVuZ2UiLCJjb21wbGV0ZVB5cmFtaWRDaGFsbGVuZ2UiLCJjb21wbGV0ZVZlcnN1c0NoYWxsZW5nZSIsImdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uIiwiY29tcGV0aXRpb25JZCIsImdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllciIsInBsYXllcklkIiwibGltaXQiLCJkZWxldGVBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIiLCJkZWxldGUiLCJnZXRQbGF5ZXJSZXN1bHRzQnlDb21wZXRpdGlvbiIsInNlcnZpY2UiLCJmYWN0b3J5Iiwid3BtRm9vdGVyIiwibG9nb3V0IiwiaW5kZW50aXR5Iiwid3BtSGVhZGVyIiwiYWxlcnRzU2VydmljZSIsImdldEFjdGl2ZUFsZXJ0cyIsImhlYWRlckN0cmwiLCJhbGVydHMiLCJnZXRBY3RpdmVBbGVydHNCeVBsYXllciIsImN1cnJlbnRVc2VyIiwiY2xlYXJBbGVydCIsImluZGV4IiwiY2xlYXJBbGxBbGVydHMiLCJjbGVhckFsbEFsZXJ0c0J5UGxheWVyIiwidG9nZ2xlU2lkZWJhciIsInNpZGViYXJTdGF0dXMiLCJsZWZ0IiwiZ2V0U2lkZWJhclN0YXR1cyIsImUiLCJzb21lIiwid3BtU2lkZWJhciIsIm9yZGVyT2JqZWN0QnkiLCJpbnB1dCIsImF0dHJpYnV0ZSIsImlzT2JqZWN0IiwiYXJyYXkiLCJvYmplY3RLZXkiLCJzb3J0IiwiYSIsImIiLCJwYXJzZUludCIsImFsZXJ0SWQiLCIkd2luZG93IiwiaXNBdXRob3JpemVkIiwicm9sZSIsInJvbGVzIiwiYm9vdHN0cmFwcGVkVXNlck9iamVjdCIsImluZm8iLCJtZXNzYWdlIiwidGFyZ2V0IiwiJCIsIm5vdGlmeSIsIndhcm5pbmciLCJpbnZlcnNlIiwibm90aWZ5RGVmYXVsdHMiLCJuZXdlc3Rfb25fdG9wIiwib2Zmc2V0IiwieCIsInkiLCJkZWxheSIsInNjcm9sbGJhclNlcnZpY2UiLCJtYWxpaHVTY3JvbGwiLCJzZWxlY3RvciIsInRoZW1lIiwic2Nyb2xsYXhpcyIsIm1vdXNld2hlZWxheGlzIiwibUN1c3RvbVNjcm9sbGJhciIsInNjcm9sbEluZXJ0aWEiLCJheGlzIiwibW91c2VXaGVlbCIsImVuYWJsZSIsInByZXZlbnREZWZhdWx0Iiwic3RhdHVzIiwicmlnaHQiLCJ3ZWJzb2NrZXRTZXJ2aWNlIiwiJHRpbWVvdXQiLCJ3ZWJzb2NrZXRIb3N0IiwibG9jYXRpb24iLCJwcm90b2NvbCIsImhvc3QiLCJjb25uZWN0IiwiY29ubmVjdGlvbiIsIldlYlNvY2tldCIsIm9ubWVzc2FnZSIsInJldHJ5IiwicGF5bG9hZCIsIkpTT04iLCJwYXJzZSIsIiRicm9hZGNhc3QiLCJ0b3BpYyIsIm9uY2xvc2UiLCJyZXRyeVNlY29uZHMiLCJjb25zb2xlIiwibG9nIiwic2VuZCIsImpzb24iLCJzdHJpbmdpZnkiLCJIb21lQ3RybCIsImNvbXBldGl0aW9uc1NlcnZpY2UiLCJnZXRQdWJsaWNDb21wZXRpdGlvbnMiLCJjb21wZXRpdGlvbnMiLCJwdWJsaWNDb21wZXRpdGlvbnMiLCJnZXRQcml2YXRlQ29tcGV0aXRpb25zIiwicHJpdmF0ZUNvbXBldGl0aW9ucyIsIndwbUNvbXBldGl0aW9uQ29tcGFjdCIsIndwbVBlbmRpbmdQbGF5ZXJzIiwiYXBwcm92ZVBlbmRpbmdQbGF5ZXIiLCJkZW55UGVuZGluZ1BsYXllciIsInBlbmRpbmdQbGF5ZXJzIiwid3BtUHlyYW1pZCIsInJlcGxhY2UiLCIkZmlsdGVyIiwibWF4UGxheWVycyIsIm9yZGVyUGxheWVycyIsImdldFBsYXllcnNTdGF0dXMiLCJhc3NpZ25MZXZlbHNUb1BsYXllcnMiLCJjYWxjdWxhdGVDb21wZXRpdGlvbkJsb2NrcyIsImZpbGxJbkVtcHR5QmxvY2tzIiwiY2xhc3MiLCJhdmFpbGFibGUiLCJob3Vyc1RvRXhwaXJlIiwiY29tcGxldGVDaGFsbGVuZ2UiLCJjdXJyZW50VXNlcklzQWRtaW4iLCJjdXJyZW50VXNlcklzUGVuZGluZyIsImFkbWlucyIsImN1cnJlbnRVc2VySXNPbkNvbXBldGl0aW9uIiwiaGFzQWN0aXZlQ2hhbGxlbmdlIiwiY3VycmVudFVzZXJQbGF5ZXIiLCJhY3RpdmVDaGFsbGVuZ2VPcHBvbmVudCIsImN1cnJlbnRPcHBvbmVudCIsImZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzIiwiY3JlYXRlQnJlYWtQb2ludHMiLCJsZXZlbHMiLCJudW1iZXJPZkJsb2NrcyIsImxhc3QiLCJudW1iZXJPZlJlYWxQbGF5ZXJzIiwiYXZhaWxhYmxlQ2hhbGxlbmdlcyIsImxldmVsQWJvdmUiLCJ3YWl0aW5nRm9yUGxheWVyIiwid2FpdGluZ1BlcmlvZHMiLCJpc0JlZm9yZSIsIndhaXRVbnRpbCIsImZvcm1hdCIsImNyZWF0ZUNoYWxsZW5nZSIsImNvbXBldGl0aW9uTmFtZSIsIm5hbWUiLCJjb21wbGV0ZSIsImZvcmZlaXREYXlzIiwiZW1haWwiLCJjb21wZXRpdGlvbk1lbnVUb2dnbGUiLCJjYW5jZWxDaGFsbGVuZ2UiLCJ3aW5uZXJJc0N1cnJlbnRVc2VyIiwiZm9yZmVpdExvc2VyIiwic3dhcFBvc2l0aW9ucyIsImNyZWF0ZVdhaXRpbmdQZXJpb2QiLCJ3YWl0aW5nUGVyaW9kRGF5cyIsInJlbW92aW5nQ3VycmVudFVzZXIiLCJyZW1vdmVDdXJyZW50VXNlckZyb21Db21wZXRpdGlvbiIsImZvcmZlaXRDaGFsbGVuZ2UiLCJhZGRDdXJyZW50VXNlclRvQ29tcGV0aXRpb24iLCJyZXN0cmljdEpvaW5zIiwiYWRkUGxheWVyVG9Db21wZXRpdGlvblJlcXVlc3QiLCJhZGRQbGF5ZXJUb0NvbXBldGl0aW9uIiwiY29uZmlybVJlbW92ZUN1cnJlbnRVc2VyRnJvbUNvbXBldGl0aW9uIiwiY29uZmlybUJ1dHRvbkNsYXNzIiwiZ2V0Q29tcGV0aXRpb24iLCJwIiwib3BlblBvc2l0aW9uIiwicmVtb3ZlZFBsYXllciIsInJlbW92ZSIsInVwZGF0ZWRQbGF5ZXJzIiwidXBkYXRlZFBsYXllciIsInJlbW92ZWRQbGF5ZXJGcm9tQ29tcGV0aXRpb24iLCJwbGF5ZXJDbGljayIsInNob3dDaGFsbGVuZ2VNb2RhbCIsInJlZnJlc2hDb21wZXRpdGlvbiIsImNoYWxsZW5nZURldGFpbHMiLCJkZXNjcmlwdGlvbiIsIndwbVVwZGF0ZUFkbWlucyIsImFkZGVkQWRtaW5zIiwiZGlzYWJsZVN1Ym1pdCIsInVzZXJJc1ByaW1hcnlBZG1pbiIsInByaW1hcnkiLCJnZXRBdmFpbGFibGVBZG1pbnMiLCJhdmFpbGFibGVBZG1pbnMiLCJyZW1vdmVkQWRtaW5zIiwiZ2V0VmVyaWZpZWRVc2VycyIsImNvbXBldGl0aW9uQWRtaW4iLCJhdmFpbGFibGVBZG1pbiIsIm9yaWdpbmFsQXZhaWxhYmxlQWRtaW5zIiwidXBkYXRlQ29tcGV0aXRpb24iLCJjYW5jZWxVcGRhdGUiLCJyZW1vdmVBZG1pbiIsImFkZEFkbWluIiwid3BtVXBkYXRlUGxheWVycyIsImFkZGVkUGxheWVycyIsImdldEF2YWlsYWJsZVBsYXllcnMiLCJhdmFpbGFibGVQbGF5ZXJzIiwicmVtb3ZlZFBsYXllcnMiLCJjb21wZXRpdGlvblBsYXllciIsImF2YWlsYWJsZVBsYXllciIsIm9yaWdpbmFsQXZhaWxhYmxlUGxheWVycyIsInJlb3JkZXJQbGF5ZXJzIiwicmVvcmRlclZlcnN1c1BsYXllcnMiLCJyZW9yZGVyUHlyYW1pZFBsYXllcnMiLCJyZW1vdmVQbGF5ZXIiLCJhZGRQbGF5ZXIiLCJ3cG1WZXJzdXMiLCJzaG93Q29udHJvbHMiLCJncm91cFBsYXllcnMiLCJnZXRDdXJyZW50VXNlclN0YXR1cyIsInRlYW1zIiwiYWN0aXZlQ2hhbGxlbmdlIiwiY2hhbGxlbmdlRXhwaXJlVGltZSIsInRvZ2dsZUNvbnRyb2xzIiwid2lubmluZ1RlYW0iLCJnZXRDb21wZXRpdGlvbnNGb3JVc2VyIiwiY3JlYXRlQ29tcGV0aXRpb24iLCJkZWxldGVDb21wZXRpdGlvbiIsImxvc2VySWQiLCJ3aW5uZXJJZCIsIndhaXRpbmdQZXJpb2QiLCJDb21wZXRpdGlvbkFkbWluQ3RybCIsImlzQWRtaW4iLCJ1cGRhdGVDb21wZXRpdGlvblJlc3RyaWN0Sm9pbnMiLCJ1cGRhdGVkQ29tcGV0aXRpb24iLCJ1cGRhdGVDb21wZXRpdGlvblByaXZhdGUiLCJwcml2YXRlIiwiY29tcGV0aXRpb25EZXRhaWxzIiwiQ29tcGV0aXRpb25TdGF0c0N0cmwiLCJudW1iZXIiLCJwbGF5ZXJzUmVzdWx0cyIsIkNvbXBldGl0aW9uQ3RybCIsIkNvbXBldGl0aW9uc0N0cmwiLCJDcmVhdGVDb21wZXRpdGlvbkN0cmwiLCJuZXdDb21wZXRpdGlvbiIsImNvbXBldGl0aW9uVHlwZXMiLCJNeUNvbXBldGl0aW9uc0N0cmwiLCJteUNvbXBldGl0aW9ucyIsIlVzZXJDdHJsIiwib3JpZ2luYWxVc2VyIiwibGVudGdoIiwiJHNldFByaXN0aW5lIiwiY3VycmVudFVzZXJDbG9uZSIsImNvcHkiLCJleHRlbmQiLCIkcSIsImRmZCIsImRlZmVyIiwicHJvbWlzZSIsInVzZXJEYXRhIiwicmVhc29uIiwicmVqZWN0IiwiY092ZXJmbG93IiwibGlua0Z1bmMiLCJlbGVtZW50IiwiYXR0cnMiLCJoYXNDbGFzcyIsImxpbmsiLCJ0b2dnbGVTdWJtZW51IiwiZWwiLCJjbGljayIsIm5leHQiLCJzbGlkZVRvZ2dsZSIsInBhcmVudCIsInRvZ2dsZUNsYXNzIiwid2F2ZXNFZmZlY3QiLCJXYXZlcyIsImF0dGFjaCIsImluaXQiLCJmZ0xpbmUiLCJjaGlsZHJlbiIsImZpcnN0IiwiaXNGbG9hdExhYmVsIiwiZm9jdXMiLCJhZGRDbGFzcyIsImJsdXIiLCJ2YWwiLCJyZW1vdmVDbGFzcyJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQUFDLE9BQUEsT0FDQSxZQUNBLGVBQ0EsWUFDQSxzQkFDQSxhQUNBLHdCQUNBLFFBQ0EscUJBQ0Esd0JBQ0Esb0JBQ0EsWUNYQSx3QkFJQSxTQUFBQyxHQUFBQyxFQUFBQyxFQUFBQyxHQUVBRixFQUFBRyxTQUFBQyxRQUFBQyxNQUNBTCxFQUFBRyxTQUFBQyxRQUFBQyxRQUdBTCxFQUFBRyxTQUFBQyxRQUFBQyxJQUFBLHFCQUFBLGdDQUVBTCxFQUFBRyxTQUFBQyxRQUFBQyxJQUFBLGlCQUFBLFdBQ0FMLEVBQUFHLFNBQUFDLFFBQUFDLElBQUEsT0FBQSxXQUVBSixFQUFBSyxTQUFBQyxjQUFBLElBQ0FMLEVBQUFNLDRCQUFBLGtFQWRBWCxRQUFBQyxPQUFBLE9BQUFXLE9BQUFWLE1DRkEsdUJBSUEsU0FBQVcsR0FBQUMsRUFBQUMsR0FRQSxRQUFBQyxHQUFBQyxHQUNBRixFQUFBRyxJQUFBLGdCQUFBRCxHQVJBLEdBQUFFLEdBQUFDLElBRUFELEdBQUFMLE9BQUFBLEVBRUFLLEVBQUFFLFlBQUFOLEVBQUFQLElBQUEsaUJBQ0FXLEVBQUFILG9CQUFBQSw2Q0FSQWhCLFFBQUFDLE9BQUEsT0FBQXFCLFdBQUEsVUFBQVQsTUNGQSx1QkFJQSxTQUFBVSxHQUFBQyxFQUFBQyxFQUFBQyxHQUNBLEdBQUFDLElBQ0FDLFdBQUFDLEVBQ0FDLE1BQUFDLEVBQ0FDLEtBQUFDLEVBR0FQLEdBQUFRLFdBQUEsR0FHQVQsRUFBQVUsVUFBQSxLQUVBVixFQUFBVyxLQUFBLGlCQUFBLGlCQUNBWCxFQUFBVyxLQUFBLFVBQUEsVUFFQVosRUFDQWEsTUFBQSxRQUNBQyxJQUFBLElBQ0FDLE9BQ0FDLFNBQ0FsQixXQUFBLFdBQ0FtQixhQUFBLEtBQ0FDLFlBQUEsNkJBR0FMLE1BQUEsZ0JBQ0FDLElBQUEsZ0JBQ0FDLE9BQ0FDLFNBQ0FsQixXQUFBLG1CQUNBbUIsYUFBQSxLQUNBQyxZQUFBLDJDQUdBTCxNQUFBLCtCQUNBQyxJQUFBLG1CQUNBQyxPQUNBSSxZQUNBckIsV0FBQSxxQkFDQW1CLGFBQUEsS0FDQUMsWUFBQSw0Q0FHQUUsU0FDQUMsS0FBQWxCLEVBQUFLLFFBRUFLLE1BQUEscUJBQ0FDLElBQUEsdUJBQ0FDLE9BQ0FJLFlBQ0FyQixXQUFBLGtCQUNBbUIsYUFBQSxLQUNBQyxZQUFBLDBDQUdBTCxNQUFBLHNCQUNBQyxJQUFBLHdCQUNBQyxPQUNBSSxZQUNBckIsV0FBQSx1QkFDQW1CLGFBQUEsS0FDQUMsWUFBQSxnREFHQUwsTUFBQSxzQkFDQUMsSUFBQSx3QkFDQUMsT0FDQUksWUFDQXJCLFdBQUEsdUJBQ0FtQixhQUFBLEtBQ0FDLFlBQUEsOENBR0FFLFNBQ0FDLEtBQUFsQixFQUFBSyxRQUVBSyxNQUFBLHVCQUNBQyxJQUFBLFVBQ0FDLE9BQ0FJLFlBQ0FyQixXQUFBLHdCQUNBbUIsYUFBQSxLQUNBQyxZQUFBLCtDQUdBRSxTQUNBQyxLQUFBbEIsRUFBQUssUUFFQUssTUFBQSxRQUNBQyxJQUFBLFFBQ0FDLE9BQ0FDLFNBQ0FsQixXQUFBLFdBQ0FtQixhQUFBLEtBQ0FDLFlBQUEsMEJBR0FFLFNBQ0FDLEtBQUFsQixFQUFBSyxRQUVBSyxNQUFBLFNBQ0FDLElBQUEsU0FDQUMsT0FDQUMsU0FDQWxCLFdBQUEsWUFDQW1CLGFBQUEsS0FDQUMsWUFBQSxzQ0FHQUwsTUFBQSxZQUNBQyxJQUFBLFlBQ0FDLE9BQ0FDLFNBQ0FsQixXQUFBLGVBQ0FtQixhQUFBLEtBQ0FDLFlBQUEseUNBR0FMLE1BQUEsVUFDQUMsSUFBQSxnQkFDQUMsT0FDQUMsU0FDQWxCLFdBQUEsbUJBQ0FtQixhQUFBLEtBQ0FDLFlBQUEsNkNBR0FMLE1BQUEsZ0JBQ0FDLElBQUEsMkNBQ0FDLE9BQ0FDLFNBQ0FsQixXQUFBLG1CQUNBbUIsYUFBQSxLQUNBQyxZQUFBLDZDQUdBTCxNQUFBLDBCQUNBQyxJQUFBLGtCQUNBQyxPQUNBQyxTQUNBbEIsV0FBQSxvQkFDQW1CLGFBQUEsS0FDQUMsWUFBQSwrQ0FHQUwsTUFBQSxrQkFDQUMsSUFBQSw2Q0FDQUMsT0FDQUMsU0FDQWxCLFdBQUEsb0JBQ0FtQixhQUFBLEtBQ0FDLFlBQUEsK0NBR0FMLE1BQUEsU0FDQUMsSUFBQSxTQUNBQyxPQUNBQyxTQUNBbEIsV0FBQSxZQUNBbUIsYUFBQSxLQUNBQyxZQUFBLHNDQUdBTCxNQUFBLGVBQ0FDLElBQUEsU0FDQUMsT0FDQUksWUFDQXJCLFdBQUEsb0JBQ0FtQixhQUFBLEtBQ0FDLFlBQUEsc0NBR0FFLFNBQ0FDLEtBQUFsQixFQUFBQyxjQU9BLFFBQUFHLEdBQUFlLEdBQ0EsTUFBQUEsR0FBQUMsNkJBQUEsU0FLQSxRQUFBbEIsR0FBQWlCLEdBQ0EsTUFBQUEsR0FBQUMsNkJBQUEsZUFLQSxRQUFBZCxHQUFBYSxHQUNBLE1BQUFBLEdBQUFFLGtHQW5NQWhELFFBQUFDLE9BQUEsT0FBQVcsT0FBQVcsR0FvTEFRLEVBQUFrQixTQUFBLGVBTUFwQixFQUFBb0IsU0FBQSxlQU1BaEIsRUFBQWdCLFNBQUEsa0JDbE1BLHVCQUlBLFNBQUFDLEdBQUFDLEVBQUFyQyxFQUFBc0MsRUFBQUMsR0FDQUYsRUFBQUcsSUFBQSxvQkFBQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBLG1CQUFBQSxJQUNBOUMsRUFBQStDLEdBQUEsU0FDQS9DLEVBQUFnRCxTQUFBTixFQUNBMUMsRUFBQWlELFdBQUFOLEtBSUFOLEVBQUFHLElBQUEsb0JBQUEsV0FDQUQsRUFBQVcsa0JBQUEsR0FFQVosRUFBQSxHQUFBYSxLQUFBQyxVQUFBZCxFQUFBLEdBQUFlLGdCQUFBRCxVQUFBLG1FQWRBbEUsUUFBQUMsT0FBQSxPQUFBbUUsSUFBQWxCLE1DRkEsdUJBSUEsU0FBQW1CLEdBQUFDLEVBQUFDLEVBQUFDLEdBWUEsUUFBQUMsS0FDQUMsSUFHQSxRQUFBQSxLQUNBSCxFQUFBSSxjQUFBQyxLQUFBLFNBQUFDLEdBQ0FDLEVBQUFELE1BQUFBLEVBQUFFLEtBQ0FDLEVBQUFDLEVBQUFDLFVBQUFKLEVBQUFELFNBSUEsUUFBQU0sR0FBQW5ELEdBQ0E4QyxFQUFBTSxhQUFBcEQsRUFDQXFELEVBQUFKLEVBQUFDLFVBQUFsRCxHQUdBLFFBQUFzRCxHQUFBdEQsR0FFQSxHQUFBdUQsS0FLQSxJQUpBTixFQUFBTyxRQUFBUixFQUFBLFNBQUFoRCxHQUNBdUQsRUFBQUUsS0FBQXpELEVBQUEwRCxZQUFBQyxpQkFHQTNELEVBQUE0RCxVQUFBQyxPQUFBLEdBQUE3RCxFQUFBOEQsU0FBQUQsT0FBQSxHQUFBN0QsRUFBQTBELFlBQUFHLE9BQUEsRUFDQXJCLEVBQUFaLE1BQUEsbUVBQ0EsSUFBQTVCLEVBQUEwRCxjQUFBTCxFQUFBSyxhQUFBVCxFQUFBYyxRQUFBUixFQUFBdkQsRUFBQTBELFlBQUFDLGdCQUFBLEVBQ0FuQixFQUFBWixNQUFBLDhEQUNBLENBQ0EsR0FBQW9DLElBQ0FDLElBQUFqRSxFQUFBaUUsSUFDQUwsVUFBQTVELEVBQUE0RCxVQUNBRSxTQUFBOUQsRUFBQThELFNBQ0FKLFlBQUExRCxFQUFBMEQsWUFFQW5CLEdBQUFlLFdBQUFVLEdBQUFwQixLQUFBLFdBQ0FKLEVBQUEwQixRQUFBLHFDQUNBZixJQUNBVCxPQWhEQSxHQUFBTSxNQUNBSyxFQUFBLEtBQ0FQLEVBQUExRCxJQUNBMEQsR0FBQUQsTUFBQSxLQUNBQyxFQUFBTSxhQUFBLEtBQ0FOLEVBQUFLLFdBQUFBLEVBQ0FMLEVBQUFRLFdBQUFBLEVBQ0FSLEVBQUFxQixZQUVBMUIsZ0VBWkF6RSxRQUFBQyxPQUFBLE9BQUFxQixXQUFBLG9CQUFBK0MsTUNGQSx1QkFJQSxTQUFBK0IsR0FBQXRGLEVBQUFnQyxFQUFBMEIsR0FNQSxRQUFBQyxNQUdBLFFBQUE0QixHQUFBQyxFQUFBQyxHQUNBekQsRUFBQTBELGlCQUFBRixFQUFBQyxHQUFBM0IsS0FBQSxTQUFBNkIsR0FDQUEsRUFFQSxlQUFBQSxFQUNBakMsRUFBQVosTUFBQSxtREFFQTlDLEVBQUFnRCxVQUNBaEQsRUFBQStDLEdBQUEvQyxFQUFBZ0QsU0FBQWhELEVBQUFpRCxZQUNBakQsRUFBQWdELFNBQUEsS0FDQWhELEVBQUFpRCxXQUFBLE1BRUFqRCxFQUFBK0MsR0FBQSwrQkFUQVcsRUFBQVosTUFBQSwrQ0FYQSxHQUFBa0IsR0FBQTFELElBQ0EwRCxHQUFBdUIsTUFBQUEsRUFFQTVCLHVEQU5BekUsUUFBQUMsT0FBQSxPQUFBcUIsV0FBQSxZQUFBOEUsTUNGQSx1QkFJQSxTQUFBTSxHQUFBNUYsRUFBQTZGLEVBQUFwQyxFQUFBQyxFQUFBMUIsRUFBQXdCLEdBVUEsUUFBQUcsS0FDQUgsRUFBQXNDLGtCQUNBOUYsRUFBQStDLEdBQUEsUUFDQThDLEVBQUFFLFFBQUFGLEVBQUFHLG1CQUNBdkMsRUFBQXdDLFdBQUFKLEVBQUFFLE9BQUFGLEVBQUFHLG1CQUFBbEMsS0FBQSxTQUFBNkIsR0FDQUEsRUFBQTFCLE9BQ0FELEVBQUFrQyxVQUFBLEtBTUEsUUFBQUMsR0FBQVgsR0FDQS9CLEVBQUEwQywwQkFBQVgsR0FBQTFCLEtBQUEsU0FBQTZCLEdBQ0FBLEVBQUExQixNQUdBUCxFQUFBMEIsUUFBQSxxREFDQXBGLEVBQUErQyxHQUFBLFNBSEFXLEVBQUFaLE1BQUEsdUNBUUEsUUFBQXNELEdBQUFDLEdBQ0FBLEVBQUFaLFdBQUFZLEVBQUFDLGdCQUNBNUMsRUFBQVosTUFBQSwwQkFFQVcsRUFBQTJDLGNBQUFQLEVBQUFFLE9BQUFGLEVBQUFHLGtCQUFBSyxFQUFBWixVQUFBM0IsS0FBQSxTQUFBNkIsR0FDQUEsRUFBQTFCLE1BQ0FqQyxFQUFBMEQsaUJBQUFDLEVBQUExQixLQUFBdUIsU0FBQWEsRUFBQVosVUFBQTNCLEtBQUEsU0FBQTZCLEdBQ0EzRixFQUFBK0MsR0FBQSxZQXZDQSxHQUFBaUIsR0FBQTFELElBQ0EwRCxHQUFBd0IsU0FBQSxHQUNBeEIsRUFBQWtDLFVBQUEsRUFDQWxDLEVBQUFxQyxxQkFDQXJDLEVBQUFtQywwQkFBQUEsRUFDQW5DLEVBQUFvQyxjQUFBQSxFQUVBekMsc0dBVkF6RSxRQUFBQyxPQUFBLE9BQUFxQixXQUFBLG9CQUFBb0YsTUNGQSx1QkFJQSxTQUFBVyxHQUFBdkcsRUFBQWdDLEVBQUEwQixHQU1BLFFBQUFDLE1BRUEsUUFBQTZDLEdBQUFDLEdBQ0FBLEVBQUFoQixXQUFBZ0IsRUFBQUgsZ0JBQ0E1QyxFQUFBWixNQUFBLDJCQUVBMkQsRUFBQTdCLGNBQ0E2QixFQUFBN0IsWUFBQTZCLEVBQUEzQixVQUFBLElBQUEyQixFQUFBekIsVUFFQWhELEVBQUEwRSxXQUFBRCxHQUFBM0MsS0FBQSxXQUNBOUQsRUFBQStDLEdBQUEsYUFmQSxHQUFBaUIsR0FBQTFELElBQ0EwRCxHQUFBd0MsU0FBQUEsRUFFQTdDLHVEQU5BekUsUUFBQUMsT0FBQSxPQUFBcUIsV0FBQSxlQUFBK0YsTUNGQSx1QkFJQSxTQUFBSSxHQUFBM0csRUFBQTZGLEVBQUFwQyxHQU9BLFFBQUFFLEtBQ0FrQyxFQUFBRSxRQUFBRixFQUFBRyxvQkFDQWhDLEVBQUE0QyxXQUFBLEVBQ0E1QyxFQUFBa0MsU0FBQSxLQUNBekMsRUFBQXdDLFdBQUFKLEVBQUFFLE9BQUFGLEVBQUFHLG1CQUFBbEMsS0FBQSxTQUFBNkIsR0FDQUEsRUFBQTFCLEtBQ0FELEVBQUFrQyxVQUFBLEVBRUFsQyxFQUFBa0MsVUFBQSxLQWRBLEdBQUFsQyxHQUFBMUQsSUFDQTBELEdBQUFrQyxTQUFBVyxPQUNBN0MsRUFBQTRDLFdBQUEsRUFFQWpELHNEQVBBekUsUUFBQUMsT0FBQSxPQUFBcUIsV0FBQSxtQkFBQW1HLE1DRkEsV0FDQSxZQU1BLFNBQUFHLEtBQ0EsR0FBQUMsSUFDQUMsa0JBQUEsRUFDQXhHLFdBQUF5RyxFQUNBdEYsYUFBQSxLQUNBdUYsU0FBQSxJQUNBQyxPQUNBQyxZQUFBLElBQ0FDLFlBQUEsSUFDQUMsbUJBQUEsSUFDQUMsa0JBQUEsS0FFQTNGLFlBQUEsZ0RBRUEsT0FBQW1GLEdBSUEsUUFBQUUsR0FBQU8sRUFBQUMsRUFBQUMsR0FPQSxRQUFBL0QsS0FDQTZELEVBQUFHLE9BQUEsaUJBQUEsV0FDQTNELEVBQUFvRCxhQUNBUSxNQUtBLFFBQUFBLEtBQ0FILEVBQUFJLGlDQUFBN0QsRUFBQW9ELFlBQUFqQyxLQUFBckIsS0FBQSxTQUFBZ0UsR0FDQTlELEVBQUE4RCxXQUFBQSxFQUFBN0QsS0FDQTZELEVBQUE3RCxLQUFBYyxPQUFBLElBR0FmLEVBQUErRCxVQUFBLEdBQUFMLElBQ0FNLEtBQUEsRUFDQUMsTUFBQWpFLEVBQUF1RCxtQkFBQSxJQUVBVyxVQUNBQyxNQUFBbkUsRUFBQThELFdBQUEvQyxPQUNBcUQsUUFBQSxTQUFBQyxFQUFBQyxHQUNBRCxFQUFBdkcsUUFBQWtDLEVBQUE4RCxXQUFBUyxPQUFBRCxFQUFBTixPQUFBLEdBQUFNLEVBQUFMLFFBQUFLLEVBQUFOLE9BQUFNLEVBQUFMLGFBSUE5RCxFQUFBTyxRQUFBVixFQUFBOEQsV0FBQSxTQUFBVSxHQVlBLEdBWEEsV0FBQUEsRUFBQUMsT0FFQXpFLEVBQUFvRCxZQUFBc0IsUUFBQTNELE9BQUEsR0FDQXlELEVBQUFHLFdBQUEvRCxZQUFBLFFBQUE0RCxFQUFBRyxXQUFBQyxLQUNBSixFQUFBSyxTQUFBakUsWUFBQSxRQUFBNEQsRUFBQUssU0FBQUQsT0FHQUosRUFBQUcsV0FBQS9ELFlBQUFULEVBQUEyRSxLQUFBOUUsRUFBQW9ELFlBQUFzQixTQUFBSyxTQUFBUCxFQUFBRyxXQUFBQyxPQUFBaEUsWUFDQTRELEVBQUFLLFNBQUFqRSxZQUFBVCxFQUFBMkUsS0FBQTlFLEVBQUFvRCxZQUFBc0IsU0FBQUssU0FBQVAsRUFBQUssU0FBQUQsT0FBQWhFLGNBR0EsSUFBQTRELEVBQUFRLFVBQUEsQ0FDQSxHQUFBQyxHQUFBQyxTQUFBQyxLQUFBRCxPQUFBVixFQUFBWSxTQUFBQyxJQUFBYixFQUFBUSxVQUFBLE9BQUEsQ0FDQVIsR0FBQWMsUUFBQUosT0FBQUssU0FBQU4sR0FBQU8sZ0JBT0EsUUFBQUMsR0FBQUMsRUFBQUMsR0FDQUMsTUFDQUMsTUFBQSwyQkFDQUMsS0FBQSxrQ0FDQXJCLEtBQUEsUUFDQXNCLGtCQUFBLEVBQ0FDLGtCQUFBLFNBQ0FDLGlCQUFBLFlBQ0FDLGdCQUFBLEVBQ0FDLGVBQUEsR0FDQSxXQUNBMUMsRUFBQWdDLGdCQUFBekYsRUFBQW9ELFlBQUFqQyxJQUFBdUUsR0FBQTVGLEtBQUEsV0FDQUUsRUFBQThELFdBQUFzQyxPQUFBVCxFQUFBLE9BaEVBLEdBQUEzRixHQUFBMUQsSUFDQTBELEdBQUE4RCxXQUFBLEtBQ0E5RCxFQUFBeUYsZ0JBQUFBLEVBRUE5Riw2REEzQkF6RSxRQUNBQyxPQUFBLE9BQ0E0SCxVQUFBLHVCQUFBRCxNQ0xBLFdBQ0EsWUFNQSxTQUFBdUQsS0FDQSxHQUFBdEQsSUFDQUMsa0JBQUEsRUFDQXhHLFdBQUF5RyxFQUNBdEYsYUFBQSxLQUNBdUYsU0FBQSxJQUNBQyxPQUNBQyxZQUFBLElBQ0FDLFlBQUEsSUFDQUMsbUJBQUEsSUFDQUMsa0JBQUEsS0FFQTNGLFlBQUEsbURBRUEsT0FBQW1GLEdBSUEsUUFBQUUsR0FBQU8sRUFBQXhILEVBQUF5SCxFQUFBQyxHQU9BLFFBQUEvRCxLQUNBNkQsRUFBQUcsT0FBQSxpQkFBQSxXQUNBM0QsRUFBQW9ELGFBQ0FrRCxNQUtBLFFBQUFBLEtBRUE3QyxFQUFBOEMsb0NBQUF2RyxFQUFBb0QsWUFBQWpDLElBQUFuQixFQUFBc0Qsb0JBQUF4RCxLQUFBLFNBQUFnRSxHQUNBOUQsRUFBQThELFdBQUFBLEVBQUE3RCxLQUNBNkQsRUFBQTdELEtBQUFjLE9BQUEsSUFHQWYsRUFBQStELFVBQUEsR0FBQUwsSUFDQU0sS0FBQSxFQUNBQyxNQUFBakUsRUFBQXVELG1CQUFBLElBRUFXLFVBQ0FDLE1BQUFuRSxFQUFBOEQsV0FBQS9DLE9BQ0FxRCxRQUFBLFNBQUFDLEVBQUFDLEdBQ0FELEVBQUF2RyxRQUFBa0MsRUFBQThELFdBQUFTLE9BQUFELEVBQUFOLE9BQUEsR0FBQU0sRUFBQUwsUUFBQUssRUFBQU4sT0FBQU0sRUFBQUwsYUFJQTlELEVBQUFPLFFBQUFWLEVBQUE4RCxXQUFBLFNBQUFVLEdBQ0FBLEVBQUFnQyxNQUFBLGVBQUFoQyxFQUFBaUMsT0FBQSxXQUFBLGFBQ0EsV0FBQWpDLEVBQUFDLE9BRUF6RSxFQUFBb0QsWUFBQXNCLFFBQUEzRCxPQUFBLEdBQ0F5RCxFQUFBRyxXQUFBL0QsWUFBQSxRQUFBNEQsRUFBQUcsV0FBQUMsS0FDQUosRUFBQUssU0FBQWpFLFlBQUEsUUFBQTRELEVBQUFLLFNBQUFELE9BR0FKLEVBQUFHLFdBQUEvRCxZQUFBVCxFQUFBMkUsS0FBQTlFLEVBQUFvRCxZQUFBc0IsU0FBQUssU0FBQVAsRUFBQUcsV0FBQUMsT0FBQWhFLFlBQ0E0RCxFQUFBSyxTQUFBakUsWUFBQVQsRUFBQTJFLEtBQUE5RSxFQUFBb0QsWUFBQXNCLFNBQUFLLFNBQUFQLEVBQUFLLFNBQUFELE9BQUFoRSxjQUdBNEQsRUFBQWtDLGNBQUF4QixPQUFBVixFQUFBbUMsV0FBQUMsU0FBQSxNQUNBQyxRQUFBLFVBQ0FDLFFBQUEsYUFDQUMsU0FBQSxPQUNBQyxRQUFBLGNBQ0FDLFNBQUEsY0FDQUMsU0FBQSxzQkFPQSxRQUFBekIsR0FBQUMsRUFBQUMsR0FDQUMsTUFDQUMsTUFBQSwyQkFDQUMsS0FBQSx1REFDQXJCLEtBQUEsUUFDQXNCLGtCQUFBLEVBQ0FDLGtCQUFBLFNBQ0FDLGlCQUFBLFlBQ0FDLGdCQUFBLEVBQ0FDLGVBQUEsR0FDQSxXQUNBMUMsRUFBQWdDLGdCQUFBekYsRUFBQW9ELFlBQUFqQyxJQUFBdUUsR0FBQTVGLEtBQUEsV0FDQUUsRUFBQThELFdBQUFzQyxPQUFBVCxFQUFBLE9BdEVBLEdBQUEzRixHQUFBMUQsSUFDQTBELEdBQUE4RCxXQUFBLEtBQ0E5RCxFQUFBeUYsZ0JBQUFBLEVBRUE5RixzRUEzQkF6RSxRQUNBQyxPQUFBLE9BQ0E0SCxVQUFBLDBCQUFBc0QsTUNMQSxXQUNBLFlBTUEsU0FBQWMsS0FDQSxHQUFBcEUsSUFDQUMsa0JBQUEsRUFDQXhHLFdBQUF5RyxFQUNBdEYsYUFBQSxLQUNBdUYsU0FBQSxJQUNBQyxPQUNBaUUsT0FBQSxLQUVBeEosWUFBQSxxREFFQSxPQUFBbUYsR0FJQSxRQUFBRSxHQUFBTyxHQXNCQSxRQUFBN0QsS0FDQTZELEVBQUFHLE9BQUEsb0JBQUEsV0FDQTNELEVBQUFvSCxTQUNBQyxFQUFBckgsRUFBQW9ILFFBQ0FFLEVBQUF0SCxFQUFBb0gsUUFDQUcsRUFBQXZILEVBQUFvSCxXQUtBLFFBQUFDLEdBQUFELEdBR0EsSUFBQSxHQURBSSxNQUNBQyxFQUFBLEVBQUFBLEVBQUF6SCxFQUFBMEgsVUFBQUQsSUFDQUQsRUFBQTdHLEtBQUE4RyxHQUFBQSxFQUFBLEdBQUEsRUFBQSxFQUlBTCxHQUFBTyxNQUFBSCxFQUFBekcsTUFFQSxLQUFBLEdBQUE2RyxHQUFBLEVBQUFBLEVBQUFKLEVBQUF6RyxPQUFBNkcsSUFDQSxHQUFBUixFQUFBckMsU0FBQXlDLEVBQUFJLEVBQUEsR0FBQSxDQUNBUixFQUFBTyxNQUFBSCxFQUFBdkcsUUFBQXVHLEVBQUFJLElBQUEsQ0FDQSxRQUtBLFFBQUFOLEdBQUFGLEdBRUEsR0FFQVMsR0FGQUMsRUFBQSxFQUNBQyxHQUFBLENBRUE1SCxHQUFBTyxRQUFBMEcsRUFBQVksUUFBQSxTQUFBeEQsR0FDQXVELElBRUEsZUFBQXZELEVBQUFpQyxRQUFBakMsRUFBQUcsV0FBQXhELE1BQUFpRyxFQUFBakcsS0FDQSxhQUFBcUQsRUFBQWlDLFFBQUFqQyxFQUFBSyxTQUFBMUQsTUFBQWlHLEVBQUFqRyxJQUVBLFdBQUEwRyxHQUNBQyxHQUFBLEVBQ0FELEVBQUEsV0FFQUUsR0FBQSxHQUdBLGFBQUF2RCxFQUFBaUMsUUFBQWpDLEVBQUFHLFdBQUF4RCxNQUFBaUcsRUFBQWpHLEtBQ0EsZUFBQXFELEVBQUFpQyxRQUFBakMsRUFBQUssU0FBQTFELE1BQUFpRyxFQUFBakcsT0FFQSxZQUFBMEcsR0FDQUMsR0FBQSxFQUNBRCxFQUFBLFVBRUFFLEdBQUEsSUFJQS9ILEVBQUE4SCxRQUNBckQsS0FBQW9ELEVBQ0FJLE1BQUFILEtBS0EsUUFBQVAsR0FBQUgsR0FFQXBILEVBQUFrSSxLQUFBQyxXQUFBaEksRUFBQWlJLEtBQUFqSSxFQUFBa0ksT0FBQWpCLEVBQUFZLFFBQUEsU0FBQXhELEdBQ0EsTUFDQUEsR0FBQUssU0FBQTFELE1BQUFpRyxFQUFBakcsS0FBQSxhQUFBcUQsRUFBQWlDLFVBSUF6RyxFQUFBa0ksS0FBQUksYUFBQW5JLEVBQUFpSSxLQUFBakksRUFBQWtJLE9BQUFqQixFQUFBWSxRQUFBLFNBQUF4RCxHQUNBLE1BQ0FBLEdBQUFHLFdBQUF4RCxNQUFBaUcsRUFBQWpHLEtBQUEsZUFBQXFELEVBQUFpQyxVQUlBekcsRUFBQWtJLEtBQUEvRCxNQUFBbkUsRUFBQWtJLEtBQUFJLGFBQUF0SSxFQUFBa0ksS0FBQUMsV0FFQW5JLEVBQUFrSSxLQUFBSyxVQUFBcEksRUFBQWlJLEtBQUFqSSxFQUFBa0ksT0FBQWpCLEVBQUFZLFFBQUEsU0FBQXhELEdBQ0EsTUFDQUEsR0FBQWdFLFVBQUFoRSxFQUFBRyxXQUFBeEQsTUFBQWlHLEVBQUFqRyxLQUFBLGVBQUFxRCxFQUFBaUMsUUFDQWpDLEVBQUFLLFNBQUExRCxNQUFBaUcsRUFBQWpHLEtBQUEsYUFBQXFELEVBQUFpQyxXQUlBekcsRUFBQXlJLE1BQUFOLFdBQUFoSSxFQUFBaUksS0FBQWpJLEVBQUFrSSxPQUFBakIsRUFBQVksUUFBQSxTQUFBeEQsR0FDQSxNQUNBQSxHQUFBSyxTQUFBMUQsTUFBQWlHLEVBQUFqRyxLQUFBLGVBQUFxRCxFQUFBaUMsVUFJQXpHLEVBQUF5SSxNQUFBSCxhQUFBbkksRUFBQWlJLEtBQUFqSSxFQUFBa0ksT0FBQWpCLEVBQUFZLFFBQUEsU0FBQXhELEdBQ0EsTUFDQUEsR0FBQUcsV0FBQXhELE1BQUFpRyxFQUFBakcsS0FBQSxhQUFBcUQsRUFBQWlDLFVBSUF6RyxFQUFBeUksTUFBQXRFLE1BQUFuRSxFQUFBeUksTUFBQUgsYUFBQXRJLEVBQUF5SSxNQUFBTixXQUVBbkksRUFBQXlJLE1BQUFGLFVBQUFwSSxFQUFBaUksS0FBQWpJLEVBQUFrSSxPQUFBakIsRUFBQVksUUFBQSxTQUFBeEQsR0FDQSxNQUNBQSxHQUFBZ0UsVUFBQWhFLEVBQUFHLFdBQUF4RCxNQUFBaUcsRUFBQWpHLEtBQUEsYUFBQXFELEVBQUFpQyxRQUNBakMsRUFBQUssU0FBQTFELE1BQUFpRyxFQUFBakcsS0FBQSxlQUFBcUQsRUFBQWlDLFdBN0hBLEdBQUF6RyxHQUFBMUQsSUFDQTBELEdBQUEwSCxVQUFBLEVBQ0ExSCxFQUFBa0ksTUFDQS9ELE1BQUEsRUFDQW1FLGFBQUEsRUFDQUgsV0FBQSxFQUNBSSxVQUFBLEdBRUF2SSxFQUFBeUksT0FDQXRFLE1BQUEsRUFDQW1FLGFBQUEsRUFDQUgsV0FBQSxFQUNBSSxVQUFBLEdBRUF2SSxFQUFBOEgsUUFDQXJELEtBQUEsS0FDQXdELE1BQUEsR0FHQXRJLHlCQXZDQXpFLFFBQ0FDLE9BQUEsT0FDQTRILFVBQUEsMEJBQUFvRSxNQ0xBLFdBQ0EsWUFNQSxTQUFBdUIsS0FDQSxHQUFBM0YsSUFDQUMsa0JBQUEsRUFDQXhHLFdBQUF5RyxFQUNBdEYsYUFBQSxLQUNBdUYsU0FBQSxJQUNBQyxPQUNBQyxZQUFBLElBQ0F3QixLQUFBLElBQ0FkLFdBQUEsS0FFQWxHLFlBQUEsbURBRUEsT0FBQW1GLEdBSUEsUUFBQUUsR0FBQU8sR0FzQkEsUUFBQTdELEtBQ0E2RCxFQUFBRyxPQUFBLGdCQUFBLFdBQ0EzRCxFQUFBOEQsWUFBQTlELEVBQUE4RCxXQUFBL0MsT0FBQSxHQUFBZixFQUFBb0QsY0FDQWtFLEVBQUF0SCxFQUFBNEUsS0FBQTVFLEVBQUE4RCxZQUNBeUQsRUFBQXZILEVBQUE0RSxLQUFBNUUsRUFBQThELFlBR0EsSUFBQTlELEVBQUFvRCxZQUFBc0IsUUFBQTNELFNBQ0FmLEVBQUEySSxtQkFBQSxFQUNBM0ksRUFBQVksWUFBQVQsRUFBQTJFLEtBQUE5RSxFQUFBb0QsWUFBQXNCLFNBQUFLLFNBQUEvRSxFQUFBNEUsT0FBQWhFLFlBQ0FaLEVBQUE0SSxXQUFBekksRUFBQTJFLEtBQUE5RSxFQUFBb0QsWUFBQXNCLFNBQUFLLFNBQUEvRSxFQUFBNEUsT0FBQTlELFVBQUEsSUFBQVgsRUFBQTJFLEtBQUE5RSxFQUFBb0QsWUFBQXNCLFNBQUFLLFNBQUEvRSxFQUFBNEUsT0FBQTVELGFBTUEsUUFBQXNHLEdBQUExQyxFQUFBZCxHQUVBLEdBRUErRCxHQUZBQyxFQUFBLEVBQ0FDLEdBQUEsQ0FFQTVILEdBQUFPLFFBQUFvRCxFQUFBLFNBQUFVLEdBQ0F1RCxJQUVBLGVBQUF2RCxFQUFBaUMsUUFBQWpDLEVBQUFHLFdBQUFDLE9BQUFBLEdBQ0EsYUFBQUosRUFBQWlDLFFBQUFqQyxFQUFBSyxTQUFBRCxPQUFBQSxFQUVBLFdBQUFpRCxHQUNBQyxHQUFBLEVBQ0FELEVBQUEsV0FFQUUsR0FBQSxHQUdBLGFBQUF2RCxFQUFBaUMsUUFBQWpDLEVBQUFHLFdBQUFDLE9BQUFBLEdBQ0EsZUFBQUosRUFBQWlDLFFBQUFqQyxFQUFBSyxTQUFBRCxPQUFBQSxLQUVBLFlBQUFpRCxHQUNBQyxHQUFBLEVBQ0FELEVBQUEsVUFFQUUsR0FBQSxJQUlBL0gsRUFBQThILFFBQ0FyRCxLQUFBb0QsRUFDQUksTUFBQUgsS0FLQSxRQUFBUCxHQUFBM0MsRUFBQWQsR0FFQTlELEVBQUFrSSxLQUFBQyxXQUFBaEksRUFBQWlJLEtBQUFqSSxFQUFBa0ksT0FBQXZFLEVBQUEsU0FBQVUsR0FDQSxNQUNBQSxHQUFBSyxTQUFBRCxPQUFBQSxHQUFBLGFBQUFKLEVBQUFpQyxVQUlBekcsRUFBQWtJLEtBQUFJLGFBQUFuSSxFQUFBaUksS0FBQWpJLEVBQUFrSSxPQUFBdkUsRUFBQSxTQUFBVSxHQUNBLE1BQ0FBLEdBQUFHLFdBQUFDLE9BQUFBLEdBQUEsZUFBQUosRUFBQWlDLFVBSUF6RyxFQUFBa0ksS0FBQS9ELE1BQUFuRSxFQUFBa0ksS0FBQUksYUFBQXRJLEVBQUFrSSxLQUFBQyxXQUVBbkksRUFBQWtJLEtBQUFLLFVBQUFwSSxFQUFBaUksS0FBQWpJLEVBQUFrSSxPQUFBdkUsRUFBQSxTQUFBVSxHQUNBLE1BQ0FBLEdBQUFnRSxVQUFBaEUsRUFBQUcsV0FBQUMsT0FBQUEsR0FBQSxlQUFBSixFQUFBaUMsUUFDQWpDLEVBQUFLLFNBQUFELE9BQUFBLEdBQUEsYUFBQUosRUFBQWlDLFdBSUF6RyxFQUFBeUksTUFBQU4sV0FBQWhJLEVBQUFpSSxLQUFBakksRUFBQWtJLE9BQUF2RSxFQUFBLFNBQUFVLEdBQ0EsTUFDQUEsR0FBQUssU0FBQUQsT0FBQUEsR0FBQSxlQUFBSixFQUFBaUMsVUFJQXpHLEVBQUF5SSxNQUFBSCxhQUFBbkksRUFBQWlJLEtBQUFqSSxFQUFBa0ksT0FBQXZFLEVBQUEsU0FBQVUsR0FDQSxNQUNBQSxHQUFBRyxXQUFBQyxPQUFBQSxHQUFBLGFBQUFKLEVBQUFpQyxVQUlBekcsRUFBQXlJLE1BQUF0RSxNQUFBbkUsRUFBQXlJLE1BQUFILGFBQUF0SSxFQUFBeUksTUFBQU4sV0FFQW5JLEVBQUF5SSxNQUFBRixVQUFBcEksRUFBQWlJLEtBQUFqSSxFQUFBa0ksT0FBQXZFLEVBQUEsU0FBQVUsR0FDQSxNQUNBQSxHQUFBZ0UsVUFBQWhFLEVBQUFHLFdBQUFDLE9BQUFBLEdBQUEsYUFBQUosRUFBQWlDLFFBQ0FqQyxFQUFBSyxTQUFBRCxPQUFBQSxHQUFBLGVBQUFKLEVBQUFpQyxXQWpIQSxHQUFBekcsR0FBQTFELElBQ0EwRCxHQUFBa0ksTUFDQS9ELE1BQUEsRUFDQW1FLGFBQUEsRUFDQUgsV0FBQSxFQUNBSSxVQUFBLEdBRUF2SSxFQUFBeUksT0FDQXRFLE1BQUEsRUFDQW1FLGFBQUEsRUFDQUgsV0FBQSxFQUNBSSxVQUFBLEdBRUF2SSxFQUFBOEgsUUFDQXJELEtBQUEsS0FDQXdELE1BQUEsR0FFQWpJLEVBQUEySSxtQkFBQSxFQUVBaEoseUJBekNBekUsUUFDQUMsT0FBQSxPQUNBNEgsVUFBQSx3QkFBQTJGLE1DTEEsdUJBTUEsU0FBQWpGLEdBQUFvRixHQWtCQSxRQUFBQyxHQUFBdEUsR0FDQSxNQUFBcUUsR0FBQUUsS0FBQSxrQ0FDQXZFLFVBQUFBLElBSUEsUUFBQXdFLEdBQUF4RSxHQUNBLE1BQUFxRSxHQUFBSSxJQUFBLGtDQUNBekUsVUFBQUEsSUFJQSxRQUFBMEUsR0FBQTFFLEdBQ0EsTUFBQXFFLEdBQUFFLEtBQUEsaUNBQ0F2RSxVQUFBQSxJQUlBLFFBQUEyRSxHQUFBM0UsR0FDQSxNQUFBcUUsR0FBQUUsS0FBQSxvQ0FDQXZFLFVBQUFBLElBSUEsUUFBQTRFLEdBQUE1RSxHQUNBLE1BQUFxRSxHQUFBRSxLQUFBLG1DQUNBdkUsVUFBQUEsSUFJQSxRQUFBNkUsR0FBQUMsR0FDQSxNQUFBVCxHQUFBbk4sSUFBQSwrQkFDQTRJLFFBQ0FnRixjQUFBQSxLQUtBLFFBQUF6RixHQUFBeUYsR0FDQSxNQUFBVCxHQUFBbk4sSUFBQSxzQ0FDQTRJLFFBQ0FnRixjQUFBQSxLQUtBLFFBQUFDLEdBQUFELEVBQUFFLEdBQ0EsTUFBQVgsR0FBQW5OLElBQUEsNkNBQ0E0SSxRQUNBZ0YsY0FBQUEsRUFDQUUsU0FBQUEsS0FLQSxRQUFBakQsR0FBQStDLEVBQUFHLEdBQ0EsTUFBQVosR0FBQW5OLElBQUEseUNBQ0E0SSxRQUNBZ0YsY0FBQUEsRUFDQUcsTUFBQUEsS0FLQSxRQUFBQyxHQUFBSixFQUFBRSxHQUNBLE1BQUFYLEdBQUFjLE9BQUEsb0RBQ0FyRixRQUNBZ0YsY0FBQUEsRUFDQUUsU0FBQUEsS0FLQSxRQUFBL0QsR0FBQTZELEVBQUE1RCxHQUNBLE1BQUFtRCxHQUFBYyxPQUFBLDBCQUNBckYsUUFDQWdGLGNBQUFBLEVBQ0E1RCxZQUFBQSxLQUtBLFFBQUFrRSxHQUFBTixFQUFBRSxHQUNBLE1BQUFYLEdBQUFuTixJQUFBLDhDQUNBNEksUUFDQWdGLGNBQUFBLEVBQ0FFLFNBQUFBLEtBdkdBLEdBQUFLLElBQ0FmLHVCQUFBQSxFQUNBSSxzQkFBQUEsRUFDQUYsdUJBQUFBLEVBQ0FHLHlCQUFBQSxFQUNBQyx3QkFBQUEsRUFDQUMsMkJBQUFBLEVBQ0F4RixpQ0FBQUEsRUFDQTBGLHdDQUFBQSxFQUNBaEQsb0NBQUFBLEVBQ0FtRCwyQ0FBQUEsRUFDQWpFLGdCQUFBQSxFQUNBbUUsOEJBQUFBLEVBR0EsT0FBQUMsdUJBcEJBM08sUUFDQUMsT0FBQSxPQUNBMk8sUUFBQSxvQkFBQXJHLE1DSkEsV0FDQSxZQU1BLFNBQUFzRyxLQUNBLEdBQUFoSCxJQUNBQyxrQkFBQSxFQUNBeEcsV0FBQXlHLEVBQ0F0RixhQUFBLEtBQ0F1RixTQUFBLElBQ0F0RixZQUFBLGlDQUVBLE9BQUFtRixHQUlBLFFBQUFFLEdBQUF6RCxFQUFBeEIsR0FLQSxRQUFBZ00sS0FDQWhNLEVBQUFnTSxTQUxBLEdBQUFoSyxHQUFBMUQsSUFDQTBELEdBQUFpSyxVQUFBekssRUFDQVEsRUFBQWdLLE9BQUFBLDhDQW5CQTlPLFFBQ0FDLE9BQUEsT0FDQTRILFVBQUEsWUFBQWdILE1DTEEsV0FDQSxZQU1BLFNBQUFHLEtBQ0EsR0FBQW5ILElBQ0FDLGtCQUFBLEVBQ0F4RyxXQUFBeUcsRUFDQXRGLGFBQUEsYUFDQXVGLFNBQUEsSUFDQXRGLFlBQUEsaUNBRUEsT0FBQW1GLEdBSUEsUUFBQUUsR0FBQU8sRUFBQWpGLEVBQUFpQixFQUFBeEIsRUFBQW1NLEdBWUEsUUFBQXhLLEtBQ0F5SyxJQUNBNUcsRUFBQUcsT0FBQSxtQ0FBQSxXQUNBbkUsRUFBQXNDLG1CQUNBc0ksTUFLQSxRQUFBQSxLQUNBQyxFQUFBQyxVQUNBOUssRUFBQXNDLG1CQUNBcUksRUFBQUksd0JBQUEvSyxFQUFBZ0wsWUFBQXJKLEtBQUFyQixLQUFBLFNBQUF3SyxHQUNBRCxFQUFBQyxPQUFBQSxFQUFBckssT0FLQSxRQUFBd0ssR0FBQUEsRUFBQUMsR0FDQVAsRUFBQU0sV0FBQUEsR0FBQTNLLEtBQUEsV0FDQXVLLEVBQUFDLE9BQUFsRSxPQUFBc0UsRUFBQSxLQUlBLFFBQUFDLEtBQ0FSLEVBQUFTLHVCQUFBcEwsRUFBQWdMLFlBQUFySixLQUFBckIsS0FBQSxXQUNBdUssRUFBQUMsWUFJQSxRQUFBTyxLQUNBdE0sRUFBQVcsa0JBQUFtTCxFQUFBUyxjQUFBQyxNQUdBLFFBQUFmLEtBQ0FoTSxFQUFBZ00sU0E5Q0EsR0FBQUssR0FBQS9OLElBQ0ErTixHQUFBSixVQUFBekssRUFDQTZLLEVBQUFMLE9BQUFBLEVBQ0FLLEVBQUFTLGNBQUF2TSxFQUFBeU0sbUJBQ0FYLEVBQUFRLGNBQUFBLEVBQ0FSLEVBQUFJLFdBQUFBLEVBQ0FKLEVBQUFNLGVBQUFBLEVBQ0FOLEVBQUFDLFVBRUEzSyxJQXlDQTZELEVBQUFoRixJQUFBLG1CQUFBLFNBQUF5TSxFQUFBWCxHQUNBOUssRUFBQXNDLG1CQUFBM0IsRUFBQStLLEtBQUFaLEdBQUEsU0FBQTlLLEVBQUFnTCxZQUFBckosT0FDQWlKLDRGQXJFQWxQLFFBQ0FDLE9BQUEsT0FDQTRILFVBQUEsWUFBQW1ILE1DTEEsV0FDQSxZQU1BLFNBQUFpQixLQUNBLEdBQUFwSSxJQUNBQyxrQkFBQSxFQUNBeEcsV0FBQXlHLEVBQ0F0RixhQUFBLGNBQ0F1RixTQUFBLElBQ0F0RixZQUFBLGtDQUVBLE9BQUFtRixHQUlBLFFBQUFFLEdBQUF6RCxFQUFBeEIsRUFBQU8sR0FNQSxRQUFBeUwsS0FDQWhNLEVBQUFnTSxTQU5BLEdBQUFoSyxHQUFBMUQsSUFDQTBELEdBQUFpSyxVQUFBekssRUFDQVEsRUFBQWdLLE9BQUFBLEVBQ0FoSyxFQUFBOEssY0FBQXZNLEVBQUF5TSxnRkFwQkE5UCxRQUNBQyxPQUFBLE9BQ0E0SCxVQUFBLGFBQUFvSSxNQ0xBLFdBQ0EsWUFHQSxTQUFBQyxLQUNBLE1BQUEsVUFBQUMsRUFBQUMsR0FDQSxJQUFBcFEsUUFBQXFRLFNBQUFGLEdBQUEsTUFBQUEsRUFFQSxJQUFBRyxLQUNBLEtBQUEsR0FBQUMsS0FBQUosR0FDQUcsRUFBQTdLLEtBQUEwSyxFQUFBSSxHQVFBLE9BTEFELEdBQUFFLEtBQUEsU0FBQUMsRUFBQUMsR0FHQSxNQUZBRCxHQUFBRSxTQUFBRixFQUFBTCxJQUNBTSxFQUFBQyxTQUFBRCxFQUFBTixJQUNBSyxFQUFBQyxJQUVBSixHQWhCQXRRLFFBQUFDLE9BQUEsT0FBQWtOLE9BQUEsZ0JBQUErQyxNQ0ZBLHVCQUlBLFNBQUFqQixHQUFBdEIsR0FlQSxRQUFBMEIsR0FBQXhJLEdBQ0EsTUFBQThHLEdBQUFuTixJQUFBLGdCQUNBNEksUUFDQXZDLE9BQUFBLEtBV0EsUUFBQTBJLEdBQUFxQixHQUNBLE1BQUFqRCxHQUFBSSxJQUFBLG9CQUNBNkMsUUFBQUEsSUFVQSxRQUFBbEIsR0FBQTdJLEdBQ0EsTUFBQThHLEdBQUFJLElBQUEscUJBQ0FsSCxPQUFBQSxJQTFDQSxHQUFBOEgsSUFDQVUsd0JBQUFBLEVBQ0FFLFdBQUFBLEVBQ0FHLHVCQUFBQSxFQUdBLE9BQUFmLHVCQVRBM08sUUFBQUMsT0FBQSxPQUFBMk8sUUFBQSxnQkFBQUssTUNGQSx1QkFJQSxTQUFBM0ssR0FBQXVNLEdBWUEsUUFBQWpLLEtBQ0EsUUFBQXhGLEtBQUFrTyxZQUdBLFFBQUF3QixHQUFBQyxHQUNBLFFBQUEzUCxLQUFBa08sYUFBQWxPLEtBQUFrTyxZQUFBMEIsTUFBQWpMLFFBQUFnTCxJQUFBLEVBaEJBLEdBQUF6QixFQUNBLFFBQUF1QixFQUFBSSx5QkFDQTNCLEVBQUF1QixFQUFBSSx1QkFFQSxJQUFBdEMsSUFDQVcsWUFBQUEsRUFDQTFJLGdCQUFBQSxFQUNBa0ssYUFBQUEsRUFFQSxPQUFBbkMseUJBWkEzTyxRQUFBQyxPQUFBLE9BQUEyTyxRQUFBLGtCQUFBdEssTUNGQSxXQUNBLFlBS0EsU0FBQUUsS0FvQkEsUUFBQTBNLEdBQUFDLEVBQUE3TyxFQUFBOE8sR0FDQUMsRUFBQUMsUUFFQUgsUUFBQUEsRUFDQTdPLElBQUFBLEVBQ0E4TyxPQUFBQSxJQUdBN0gsS0FBQSxTQUlBLFFBQUFyRCxHQUFBaUwsRUFBQTdPLEVBQUE4TyxHQUNBQyxFQUFBQyxRQUVBSCxRQUFBQSxFQUNBN08sSUFBQUEsRUFDQThPLE9BQUFBLElBR0E3SCxLQUFBLFlBSUEsUUFBQWdJLEdBQUFKLEVBQUE3TyxFQUFBOE8sR0FDQUMsRUFBQUMsUUFFQUgsUUFBQUEsRUFDQTdPLElBQUFBLEVBQ0E4TyxPQUFBQSxJQUdBN0gsS0FBQSxZQUlBLFFBQUEzRixHQUFBdU4sRUFBQTdPLEVBQUE4TyxHQUNBQyxFQUFBQyxRQUVBSCxRQUFBQSxFQUNBN08sSUFBQUEsRUFDQThPLE9BQUFBLElBR0E3SCxLQUFBLFdBSUEsUUFBQWlJLEdBQUFMLEVBQUE3TyxFQUFBOE8sR0FDQUMsRUFBQUMsUUFFQUgsUUFBQUEsRUFDQTdPLElBQUFBLEVBQ0E4TyxPQUFBQSxJQUdBN0gsS0FBQSxZQTNFQSxHQUFBb0YsSUFDQXVDLEtBQUFBLEVBQ0FoTCxRQUFBQSxFQUNBcUwsUUFBQUEsRUFDQTNOLE1BQUFBLEVBQ0E0TixRQUFBQSxFQVlBLE9BVEFILEdBQUFJLGdCQUNBQyxlQUFBLEVBQ0FDLFFBQ0FDLEVBQUEsR0FDQUMsRUFBQSxJQUVBQyxNQUFBLE1BR0FuRCxFQXRCQTNPLFFBQ0FDLE9BQUEsT0FDQTJPLFFBQUEsZ0JBQUFwSyxNQ0pBLFdBQ0EsWUFLQSxTQUFBdU4sS0FPQSxRQUFBQyxHQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBZixFQUFBWSxHQUFBSSxrQkFDQUgsTUFBQUEsRUFDQUksY0FBQSxJQUNBQyxLQUFBSixFQUNBSyxZQUNBQyxRQUFBLEVBQ0FGLEtBQUFILEVBQ0FNLGdCQUFBLEtBZEEsR0FBQS9ELElBQ0FxRCxhQUFBQSxFQUdBLE9BQUFyRCxHQVRBM08sUUFDQUMsT0FBQSxPQUNBMk8sUUFBQSxtQkFBQW1ELE1DSkEsV0FDQSxZQUtBLFNBQUExTyxLQVlBLFFBQUF5TSxLQUNBLE1BQUFGLEdBR0EsUUFBQTVMLEdBQUEyTyxHQUNBL0MsRUFBQUMsS0FBQThDLEVBaEJBLEdBQUEvQyxJQUNBQyxNQUFBLEVBQ0ErQyxPQUFBLEdBRUFqRSxHQUNBbUIsaUJBQUFBLEVBQ0E5TCxpQkFBQUEsRUFHQSxPQUFBMkssR0FkQTNPLFFBQ0FDLE9BQUEsT0FDQTJPLFFBQUEsaUJBQUF2TCxNQ0pBLHVCQU1BLFNBQUF3UCxHQUFBMVAsRUFBQTBOLEVBQUFpQyxHQVdBLFFBQUFDLEtBQ0EsTUFBQSxXQUFBbEMsRUFBQW1DLFNBQUFDLFNBQ0EsU0FBQXBDLEVBQUFtQyxTQUFBRSxLQUVBLFFBQUFyQyxFQUFBbUMsU0FBQUUsS0FJQSxRQUFBQyxLQUNBQyxFQUFBLEdBQUFDLFdBQUFOLEtBRUFLLEVBQUFFLFVBQUEsU0FBQXZELEdBQ0F3RCxFQUFBLENBQ0EsSUFBQUMsR0FBQUMsS0FBQUMsTUFBQTNELEVBQUFoTCxLQUNBNUIsR0FBQXdRLFdBQUEsTUFBQUgsRUFBQUksTUFBQUosRUFBQXpPLE9BR0FxTyxFQUFBUyxRQUFBLFdBQ0FOLEVBQUFPLEVBQUFqTyxRQUNBa08sUUFBQUMsSUFBQSxxQ0FDQWxCLEVBQUFLLEVBQUEsSUFBQVcsRUFBQVAsSUFDQUEsR0FBQSxHQUVBUSxRQUFBQyxJQUFBLDJCQUtBLFFBQUFDLEdBQUFMLEVBQUE3TyxHQUNBLEdBQUFtUCxHQUFBVCxLQUFBVSxXQUNBUCxNQUFBQSxFQUNBN08sS0FBQUEsR0FFQXFPLEdBQUFhLEtBQUFDLEdBM0NBLEdBQUFkLEdBQ0FVLEdBQUEsRUFBQSxHQUFBLElBQUEsS0FDQVAsRUFBQSxFQUNBNUUsR0FDQXdFLFFBQUFBLEVBQ0FjLEtBQUFBLEVBR0EsT0FBQXRGLGlEQWJBM08sUUFBQUMsT0FBQSxPQUFBMk8sUUFBQSxtQkFBQWlFLEdBQUF6TyxLQUFBLG1CQUFBLFNBQUF5TyxHQUNBQSxFQUFBTSxnQkNIQSx1QkFJQSxTQUFBaUIsR0FBQUMsRUFBQS9QLEdBT0EsUUFBQUcsS0FDQTRQLEVBQUFDLHdCQUFBMVAsS0FBQSxTQUFBMlAsR0FDQXpQLEVBQUEwUCxtQkFBQUQsRUFBQXhQLE9BR0FULEVBQUF3TSxhQUFBLGdCQUNBdUQsRUFBQUkseUJBQUE3UCxLQUFBLFNBQUEyUCxHQUNBelAsRUFBQTRQLG9CQUFBSCxFQUFBeFAsT0FiQSxHQUFBRCxHQUFBMUQsSUFDQTBELEdBQUEwUCxzQkFDQTFQLEVBQUE0UCx1QkFFQWpRLHdEQVBBekUsUUFBQUMsT0FBQSxPQUFBcUIsV0FBQSxXQUFBOFMsTUNGQSxXQUNBLFlBTUEsU0FBQU8sS0FDQSxHQUFBOU0sSUFDQUMsa0JBQUEsRUFDQXhHLFdBQUF5RyxFQUNBdEYsYUFBQSxLQUNBdUYsU0FBQSxJQUNBQyxPQUNBQyxZQUFBLEtBR0F4RixZQUFBLG9EQUVBLE9BQUFtRixHQUlBLFFBQUFFLEtBSUEsUUFBQXRELE1BRkFBLElBdEJBekUsUUFDQUMsT0FBQSxPQUNBNEgsVUFBQSx3QkFBQThNLE1DTEEsV0FDQSxZQU1BLFNBQUFDLEtBQ0EsR0FBQS9NLElBQ0FDLGtCQUFBLEVBQ0F4RyxXQUFBeUcsRUFDQXRGLGFBQUEsS0FDQXVGLFNBQUEsSUFDQUMsT0FDQUMsWUFBQSxLQUVBeEYsWUFBQSxnREFFQSxPQUFBbUYsR0FJQSxRQUFBRSxHQUFBc00sR0FRQSxRQUFBNVAsTUFFQSxRQUFBb1EsR0FBQTNJLEdBQ0FBLEVBQUFyQyxTQUFBL0UsRUFBQW9ELFlBQUFzQixRQUFBM0QsT0FBQSxFQUNBd08sRUFBQVEscUJBQUEvUCxFQUFBb0QsWUFBQWpDLElBQUFpRyxHQUdBLFFBQUE0SSxHQUFBNUksR0FDQW1JLEVBQUFTLGtCQUFBaFEsRUFBQW9ELFlBQUFqQyxJQUFBaUcsR0FmQSxHQUFBcEgsR0FBQTFELElBQ0EwRCxHQUFBaVEsa0JBQ0FqUSxFQUFBK1AscUJBQUFBLEVBQ0EvUCxFQUFBZ1Esa0JBQUFBLEVBRUFyUSxzQ0F6QkF6RSxRQUNBQyxPQUFBLE9BQ0E0SCxVQUFBLG9CQUFBK00sTUNMQSx1QkFNQSxTQUFBSSxLQUNBLEdBQUFuTixJQUNBRyxTQUFBLElBQ0F0RixZQUFBLHdDQUNBdVMsU0FBQSxFQUNBaE4sT0FDQUMsWUFBQSxLQUVBNUcsV0FBQXlHLEVBQ0F0RixhQUFBLEtBQ0FxRixrQkFBQSxFQUdBLE9BQUFELEdBSUEsUUFBQUUsR0FBQU8sRUFBQXhILEVBQUF1VCxFQUFBYSxFQUFBMVEsRUFBQUYsRUFBQWlFLEdBMkJBLFFBQUE5RCxLQUVBLElBQUEsR0FBQThILEdBQUFDLEVBQUFELEVBQUEsSUFBQUEsRUFDQXpILEVBQUFxUSxZQUFBNUksQ0FHQWpFLEdBQUFHLE9BQUEsaUJBQUEsV0FDQTNELEVBQUFvRCxjQUNBcEQsRUFBQXNKLGNBQUF0SixFQUFBb0QsWUFBQWpDLElBQ0FtUCxJQUNBQyxJQUNBQyxJQUNBQyxJQUNBQyxPQVFBLFFBQUFKLEtBQ0F0USxFQUFBb0QsWUFBQXNCLFFBQUEwTCxFQUFBLFdBQUFwUSxFQUFBb0QsWUFBQXNCLFFBQUEsWUFNQSxRQUFBNkwsS0FFQTlNLEVBQUFJLGlDQUFBN0QsRUFBQXNKLGVBQUF4SixLQUFBLFNBQUFnRSxHQUNBM0QsRUFBQU8sUUFBQW9ELEVBQUE3RCxLQUFBLFNBQUF1RSxHQUVBLEdBQUFHLEdBQUF4RSxFQUFBMkUsS0FBQTlFLEVBQUFvRCxZQUFBc0IsU0FBQXZELElBQUFxRCxFQUFBRyxXQUFBeEQsS0FDQXdELEdBQUFnTSxNQUFBLGNBQ0FoTSxFQUFBaU0sV0FBQSxFQUNBak0sRUFBQUgsV0FDQU8sU0FBQSxhQUNBRixTQUFBMUUsRUFBQTJFLEtBQUE5RSxFQUFBb0QsWUFBQXNCLFNBQUF2RCxJQUFBcUQsRUFBQUssU0FBQTFELE1BQUFQLFlBR0EsSUFBQWlFLEdBQUExRSxFQUFBMkUsS0FBQTlFLEVBQUFvRCxZQUFBc0IsU0FBQXZELElBQUFxRCxFQUFBSyxTQUFBMUQsS0FRQSxJQVBBMEQsRUFBQThMLE1BQUEsY0FDQTlMLEVBQUErTCxXQUFBLEVBQ0EvTCxFQUFBTCxXQUNBTyxTQUFBLFlBSUEsSUFBQVAsRUFBQVEsVUFBQSxDQUNBLEdBQUFDLEdBQUFDLFNBQUFDLEtBQUFELE9BQUFWLEVBQUFZLFNBQUFDLElBQUFiLEVBQUFRLFVBQUEsT0FBQSxFQUNBNkwsRUFBQTNMLE9BQUFLLFNBQUFOLEdBQUFPLFNBRUFQLEdBQUEsRUFDQUosRUFBQUwsVUFBQWMsUUFBQXVMLEVBRUE1TCxHQUFBLEdBQ0E2TCxFQUFBLE1BQUEsRUFBQWpNLE1BS0E3RSxFQUFBK1Esb0JBQUEsRUFDQS9RLEVBQUFnUixzQkFBQSxFQUNBeFIsRUFBQXNDLG9CQUVBOUIsRUFBQStRLG1CQUFBNVEsRUFBQStLLEtBQUFsTCxFQUFBb0QsWUFBQTZOLFFBQUEsTUFBQXpSLEVBQUFnTCxZQUFBckosTUFFQW5CLEVBQUFnUixxQkFBQTdRLEVBQUErSyxLQUFBbEwsRUFBQW9ELFlBQUE2TSxnQkFBQSxNQUFBelEsRUFBQWdMLFlBQUFySixPQUlBbkIsRUFBQWtSLDRCQUFBLEVBQ0FsUixFQUFBbVIsb0JBQUEsRUFDQWhSLEVBQUFPLFFBQUFWLEVBQUFvRCxZQUFBc0IsUUFBQSxTQUFBMEMsR0FFQTVILEVBQUFzQyxtQkFBQXNGLEVBQUFqRyxNQUFBM0IsRUFBQWdMLFlBQUFySixNQUNBbkIsRUFBQWtSLDRCQUFBLEVBQ0E5SixFQUFBdUosTUFBQXZKLEVBQUF1SixNQUFBdkosRUFBQXVKLE1BQUEsZ0JBQUEsZUFDQTNRLEVBQUFvUixrQkFBQWhLLEVBR0EzRCxFQUFBOEYsd0NBQUF2SixFQUFBc0osY0FBQWxDLEVBQUFqRyxLQUFBckIsS0FBQSxTQUFBMEUsR0FDQSxHQUFBQSxFQUFBdkUsS0FBQSxDQUNBRCxFQUFBbVIsb0JBQUEsRUFDQW5SLEVBQUFxUix3QkFBQTdNLEVBQUF2RSxLQUFBMEUsV0FBQXhELE1BQUFpRyxFQUFBakcsSUFBQXFELEVBQUF2RSxLQUFBNEUsU0FBQUwsRUFBQXZFLEtBQUEwRSxVQUVBLElBQUEyTSxHQUFBblIsRUFBQTJFLEtBQUE5RSxFQUFBb0QsWUFBQXNCLFNBQUF2RCxJQUFBbkIsRUFBQXFSLHdCQUFBbFEsS0FDQW1RLEdBQUFYLE1BQUFXLEVBQUFYLE1BQUFXLEVBQUFYLE1BQUEsb0JBQUEsdUJBR0FZLFlBV0EsUUFBQUMsS0FDQXhSLEVBQUF3SCxjQUNBLEtBQUEsR0FBQUMsR0FBQSxFQUFBQSxFQUFBQyxFQUFBRCxJQUNBekgsRUFBQXdILFlBQUE3RyxLQUFBOEcsR0FBQUEsRUFBQSxHQUFBLEVBQUEsR0FNQSxRQUFBK0ksS0FDQSxHQUFBN0ksR0FBQSxDQUNBM0gsR0FBQXlSLFVBQ0FELEdBQ0EsS0FBQSxHQUFBL0osR0FBQSxFQUFBQSxFQUFBekgsRUFBQW9ELFlBQUFzQixRQUFBM0QsT0FBQTBHLElBQ0F6SCxFQUFBd0gsWUFBQXZHLFFBQUF3RyxFQUFBLElBQUEsSUFDQUUsR0FBQSxFQUVBM0gsRUFBQXlSLE9BQUE5USxLQUFBZ0gsSUFHQTNILEVBQUFvRCxZQUFBc0IsUUFBQStDLEdBQUFFLE1BQUFBLEVBS0EsUUFBQThJLEtBQ0F6USxFQUFBMFIsZUFBQSxDQUNBLEtBQUEsR0FBQWpLLEdBQUF0SCxFQUFBd1IsS0FBQTNSLEVBQUF5UixRQUFBaEssRUFBQSxFQUFBQSxJQUNBekgsRUFBQTBSLGdCQUFBakssRUFLQSxRQUFBaUosS0FDQTFRLEVBQUE0UixvQkFBQTVSLEVBQUFvRCxZQUFBc0IsUUFBQTNELE1BQ0EsS0FBQSxHQUFBMEcsR0FBQXpILEVBQUFvRCxZQUFBc0IsUUFBQTNELE9BQUEwRyxFQUFBekgsRUFBQTBSLGVBQUFqSyxJQUNBekgsRUFBQW9ELFlBQUFzQixRQUFBL0QsTUFDQUcsVUFBQSxRQUNBRSxTQUFBLE9BQ0FKLFlBQUEsYUFDQW1FLFNBQUEsR0FDQTRMLE1BQUEsU0FJQUgsS0FJQSxRQUFBZSxLQUVBLEdBREF2UixFQUFBNlIscUJBQUEsRUFDQTdSLEVBQUFrUiw2QkFBQWxSLEVBQUFtUixtQkFBQSxDQUNBLEdBQUFXLEdBQUE5UixFQUFBb1Isa0JBQUF6SixNQUFBLEVBQUEzSCxFQUFBb1Isa0JBQUF6SixNQUFBLEVBQUEsSUFDQXhILEdBQUFPLFFBQUFWLEVBQUFvRCxZQUFBc0IsUUFBQSxTQUFBMEMsR0FDQSxHQUFBMkssR0FBQSxJQUNBM0ssR0FBQU8sUUFBQW1LLEdBQUEsS0FBQTFLLEVBQUFyQyxVQUFBLGdCQUFBcUMsRUFBQXVKLE9BQUF2SixFQUFBd0osYUFBQSxJQUVBbUIsRUFBQTVSLEVBQUEyRSxLQUFBOUUsRUFBQW9SLGtCQUFBWSxnQkFBQTVLLE9BQUFBLEVBQUFqRyxNQUVBNFEsR0FBQTdNLFNBQUErTSxTQUFBRixFQUFBek0sVUFDQThCLEVBQUF1SixNQUFBLFVBQ0F2SixFQUFBOEssVUFBQWhOLE9BQUE2TSxFQUFBek0sU0FBQTZNLE9BQUEsZ0JBRUFuUyxFQUFBNlIscUJBQUEsRUFDQXpLLEVBQUF3SixXQUFBLEVBQ0F4SixFQUFBdUosTUFBQSxpQkFZQSxRQUFBeUIsR0FBQWhMLEdBQ0EsR0FBQUEsRUFBQXdKLFVBRUEsQ0FDQTVRLEVBQUFtUixvQkFBQSxDQUNBLElBQUEzTSxJQUNBQyxLQUFBekUsRUFBQW9ELFlBQUFxQixLQUNBNE4sZ0JBQUFyUyxFQUFBb0QsWUFBQWtQLEtBQ0FoSixjQUFBdEosRUFBQXNKLGNBQ0FpSixVQUFBLEVBQ0EvSixTQUFBLEVBQ0F4RCxVQUFBaEYsRUFBQW9ELFlBQUFvUCxZQUNBN04sWUFDQXhELElBQUFuQixFQUFBb1Isa0JBQUFqUSxJQUNBc1IsTUFBQXpTLEVBQUFvUixrQkFBQXFCLE1BQ0EzUixVQUFBZCxFQUFBb1Isa0JBQUF0USxVQUNBRSxTQUFBaEIsRUFBQW9SLGtCQUFBcFEsU0FDQUosWUFBQVosRUFBQW9SLGtCQUFBeFEsWUFDQW1FLFNBQUEvRSxFQUFBb1Isa0JBQUFyTSxVQUVBRixVQUNBMUQsSUFBQWlHLEVBQUFqRyxJQUNBc1IsTUFBQXJMLEVBQUFxTCxNQUNBM1IsVUFBQXNHLEVBQUF0RyxVQUNBRSxTQUFBb0csRUFBQXBHLFNBQ0FKLFlBQUF3RyxFQUFBeEcsWUFDQW1FLFNBQUFxQyxFQUFBckMsVUFLQXRCLEdBQUFxRix1QkFBQXRFLEdBQUExRSxLQUFBLFdBQ0FFLEVBQUEwUyx1QkFBQSxRQTlCQWhULEdBQUFaLE1BQUEseUNBcUNBLFFBQUE2VCxLQUNBbFAsRUFBQThGLHdDQUFBdkosRUFBQXNKLGNBQUF0SixFQUFBb1Isa0JBQUFqUSxLQUFBckIsS0FBQSxTQUFBMEUsR0FDQUEsRUFBQXZFLE1BRUF1RSxFQUFBdkUsS0FBQTBFLFdBQUF4RCxNQUFBbkIsRUFBQW9SLGtCQUFBalEsS0FDQXNDLEVBQUF1Rix1QkFBQXhFLEVBQUF2RSxNQUFBSCxLQUFBLFdBQ0FFLEVBQUFtUixvQkFBQSxNQWNBLFFBQUFMLEdBQUE4QixFQUFBcEssRUFBQXFLLEdBQ0EsR0FBQXpMLEdBQUF5TCxHQUFBN1MsRUFBQW9SLGlCQUNBM04sR0FBQThGLHdDQUFBdkosRUFBQXNKLGNBQUFsQyxFQUFBakcsS0FBQXJCLEtBQUEsU0FBQTBFLEdBQ0F4RSxFQUFBbVIsb0JBQUEsQ0FFQSxJQUFBMkIsSUFBQSxDQUdBdEssSUFDQWhFLEVBQUF2RSxLQUFBdUksU0FBQSxFQUNBLGFBQUFxSyxFQUFBck8sVUFBQU8sVUFDQVAsRUFBQXZFLEtBQUF3RyxPQUFBLGFBQ0FxTSxHQUFBLEdBRUF0TyxFQUFBdkUsS0FBQXdHLE9BQUEsWUFHQW1NLEVBQ0FwTyxFQUFBdkUsS0FBQTBFLFdBQUF4RCxNQUFBbkIsRUFBQW9SLGtCQUFBalEsS0FDQXFELEVBQUF2RSxLQUFBd0csT0FBQSxhQUNBcU0sR0FBQSxHQUVBdE8sRUFBQXZFLEtBQUF3RyxPQUFBLFdBR0FqQyxFQUFBdkUsS0FBQTBFLFdBQUF4RCxNQUFBbkIsRUFBQW9SLGtCQUFBalEsSUFDQXFELEVBQUF2RSxLQUFBd0csT0FBQSxZQUVBakMsRUFBQXZFLEtBQUF3RyxPQUFBLGFBQ0FxTSxHQUFBLEVBSUEsSUFBQXRNLEdBQUFDLEVBQUEsSUFDQSxjQUFBakMsRUFBQXZFLEtBQUF3RyxRQUNBQSxFQUFBakMsRUFBQXZFLEtBQUE0RSxTQUNBMkIsRUFBQWhDLEVBQUF2RSxLQUFBMEUsYUFFQThCLEVBQUFqQyxFQUFBdkUsS0FBQTBFLFdBQ0E2QixFQUFBaEMsRUFBQXZFLEtBQUE0RSxVQUVBMEssRUFBQXdELG9CQUFBL1MsRUFBQXNKLGNBQUE5QyxFQUFBckYsSUFBQXNGLEVBQUF0RixJQUFBbkIsRUFBQW9ELFlBQUE0UCxtQkFJQUYsRUFDQXZELEVBQUF1RCxjQUFBOVMsRUFBQXNKLGNBQUE5RSxFQUFBdkUsS0FBQTRFLFNBQUFMLEVBQUF2RSxLQUFBMEUsWUFBQTdFLEtBQUEsV0FDQTJELEVBQUEwRix5QkFBQTNFLEVBQUF2RSxNQUFBSCxLQUFBLFdBQ0FtVCxHQUNBQyxRQUtBelAsRUFBQTBGLHlCQUFBM0UsRUFBQXZFLE1BQUFILEtBQUEsV0FDQW1ULEdBQ0FDLE1BSUFsVCxFQUFBMFMsdUJBQUEsSUFRQSxRQUFBUyxHQUFBL0wsR0FDQTBKLEVBQUEsTUFBQSxFQUFBMUosR0FPQSxRQUFBZ00sS0FDQSxHQUFBNVQsRUFBQXNDLGtCQUNBLEdBQUE5QixFQUFBNFIsb0JBQUE1UixFQUFBcVEsV0FBQSxDQUNBLEdBQUFqSixJQUNBakcsSUFBQTNCLEVBQUFnTCxZQUFBckosSUFDQUwsVUFBQXRCLEVBQUFnTCxZQUFBMUosVUFDQUUsU0FBQXhCLEVBQUFnTCxZQUFBeEosU0FDQUosWUFBQXBCLEVBQUFnTCxZQUFBNUosWUFDQTZSLE1BQUFqVCxFQUFBZ0wsWUFBQWhKLFNBQ0F1RCxTQUFBL0UsRUFBQTRSLG9CQUFBLEVBRUE1UixHQUFBb0QsWUFBQWlRLGNBZUF6TixNQUNBQyxNQUFBLHFCQUNBQyxLQUFBLHFFQUNBckIsS0FBQSxVQUNBc0Isa0JBQUEsRUFDQUMsa0JBQUEsZUFDQUMsaUJBQUEsWUFDQUMsZ0JBQUEsRUFDQUMsZUFBQSxHQUNBLFdBQ0FvSixFQUFBK0QsOEJBQUF0VCxFQUFBb0QsWUFBQWdFLEdBQUF0SCxLQUFBLFdBQ0FFLEVBQUFnUixzQkFBQSxJQUVBcEwsS0FBQSxlQUFBLGlFQUFBLGFBM0JBQSxNQUNBQyxNQUFBLG9CQUNBQyxLQUFBLGdDQUNBckIsS0FBQSxVQUNBc0Isa0JBQUEsRUFDQUMsa0JBQUEsT0FDQUMsaUJBQUEsWUFDQUMsZ0JBQUEsRUFDQUMsZUFBQSxHQUNBLFdBQ0FvSixFQUFBZ0UsdUJBQUF2VCxFQUFBc0osY0FBQWxDLEdBQ0F4QixLQUFBLGtCQUFBLHlDQUFBLGlCQW9CQWxHLEdBQUErTSxRQUFBLHVDQUdBL00sR0FBQStNLFFBQUEsc0NBQ0F6USxFQUFBZ0QsU0FBQSxvQkFDQWhELEVBQUFpRCxZQUFBcUssY0FBQXRKLEVBQUFzSixlQUNBdE4sRUFBQStDLEdBQUEsU0FPQSxRQUFBeVUsS0FDQTVOLE1BQ0FDLE1BQUEscUJBQ0FDLEtBQUEsNkRBQ0FyQixLQUFBLFFBQ0FzQixrQkFBQSxFQUNBQyxrQkFBQSxhQUNBeU4sbUJBQUEsYUFDQXhOLGlCQUFBLFdBQ0FDLGdCQUFBLEVBQ0FDLGVBQUEsR0FDQSxXQUNBK00sSUFDQXROLEtBQUEsaUJBQUEsNENBQUEsYUFVQSxRQUFBc04sS0FFQTFULEVBQUFzQyxtQkFBQTlCLEVBQUFrUiw2QkFDQStCLEdBQUEsRUFFQWpULEVBQUFtUixtQkFDQUwsRUFBQSxNQUFBLEVBQUE5USxFQUFBb1Isb0JBR0FwUixFQUFBa1IsNEJBQUEsRUFDQWxSLEVBQUFtUixvQkFBQSxFQUdBNUIsRUFBQW1FLGVBQUExVCxFQUFBc0osZUFBQXhKLEtBQUEsU0FBQTZULEdBR0EsR0FBQXZRLEdBQUF1USxFQUFBMVQsS0FHQTJULEVBQUE1VCxFQUFBb1Isa0JBQUFyTSxRQUdBNUUsR0FBQU8sUUFBQTBDLEVBQUFzQixRQUFBLFNBQUEwQyxHQUNBQSxFQUFBckMsVUFBQTZPLElBQ0F4TSxFQUFBckMsVUFBQSxJQVlBLEtBQUEsR0FQQThPLEdBQUExVCxFQUFBMlQsT0FBQTFRLEVBQUFzQixRQUFBLFNBQUEwQyxHQUNBLE1BQUFBLEdBQUFqRyxNQUFBbkIsRUFBQW9SLGtCQUFBalEsTUFLQTRTLEtBQ0F0TSxFQUFBLEVBQUFBLEVBQUF6SCxFQUFBNFIsb0JBQUEsSUFBQW5LLEVBQUEsQ0FDQSxHQUFBdU0sSUFDQTdTLElBQUFpQyxFQUFBc0IsUUFBQStDLEdBQUF0RyxJQUNBTCxVQUFBc0MsRUFBQXNCLFFBQUErQyxHQUFBM0csVUFDQUUsU0FBQW9DLEVBQUFzQixRQUFBK0MsR0FBQXpHLFNBQ0FKLFlBQUF3QyxFQUFBc0IsUUFBQStDLEdBQUE3RyxZQUNBbUUsU0FBQTNCLEVBQUFzQixRQUFBK0MsR0FBQTFDLFNBR0FnUCxHQUFBcFQsS0FBQXFULEdBSUF6RSxFQUFBMEUsNkJBQUFqVSxFQUFBc0osY0FBQXVLLEVBQUEsR0FBQUUsR0FBQWpVLEtBQUEsV0FDQW1ULEdBQUEsUUFVQSxRQUFBaUIsR0FBQTlNLEdBRUEsS0FBQUEsRUFBQXJDLFVBQUEvRSxFQUFBa1IsMkJBR0E5SixFQUFBK00sb0JBQUEvTSxFQUFBK00sbUJBRkFmLElBU0EsUUFBQWdCLEtBQ0E3RSxFQUFBbUUsZUFBQTFULEVBQUFzSixlQUFBeEosS0FBQSxTQUFBc0QsR0FDQXBELEVBQUFvRCxZQUFBQSxFQUFBbkQsT0E3ZUEsR0FBQXlILEdBQUEsRUFDQTFILEVBQUExRCxJQUNBMEQsR0FBQXNKLGNBQUEsS0FDQXRKLEVBQUF3SCxlQUNBeEgsRUFBQXlSLFVBQ0F6UixFQUFBMFIsZUFBQSxFQUNBMVIsRUFBQWtSLDRCQUFBLEVBQ0FsUixFQUFBZ1Isc0JBQUEsRUFDQWhSLEVBQUErUSxvQkFBQSxFQUNBL1EsRUFBQW1SLG9CQUFBLEVBQ0FuUixFQUFBcVIsd0JBQUEsS0FDQXJSLEVBQUE2UixxQkFBQSxFQUNBN1IsRUFBQW9TLGdCQUFBQSxFQUNBcFMsRUFBQTJTLGdCQUFBQSxFQUNBM1MsRUFBQThRLGtCQUFBQSxFQUNBOVEsRUFBQW1ULGlCQUFBQSxFQUNBblQsRUFBQW9SLHFCQUNBcFIsRUFBQTBTLHVCQUFBLEVBQ0ExUyxFQUFBb1QsNEJBQUFBLEVBQ0FwVCxFQUFBd1Qsd0NBQUFBLEVBQ0F4VCxFQUFBa1UsWUFBQUEsRUFDQWxVLEVBQUE0UixvQkFBQSxFQUNBNVIsRUFBQXFRLFdBQUEsRUFFQTFRLEdBc1lBLElBQUFzVCxJQUFBLENBb0ZBelAsR0FBQWhGLElBQUEseUJBQUEsU0FBQTJCLEVBQUFrVSxHQUNBclUsRUFBQXNKLGdCQUFBK0ssRUFBQS9LLGdCQUNBNUosRUFBQTBNLEtBQUFpSSxFQUFBQyxhQUNBRiwySEEzZ0JBbFosUUFDQUMsT0FBQSxPQUNBNEgsVUFBQSxhQUFBbU4sTUNKQSxXQUNBLFlBTUEsU0FBQXFFLEtBQ0EsR0FBQXhSLElBQ0FDLGtCQUFBLEVBQ0F4RyxXQUFBeUcsRUFDQXRGLGFBQUEsS0FDQXVGLFNBQUEsSUFDQUMsT0FDQUMsWUFBQSxLQUVBeEYsWUFBQSw4Q0FFQSxPQUFBbUYsR0FJQSxRQUFBRSxHQUFBTyxFQUFBK0wsRUFBQTlMLEVBQUFoRSxFQUFBRCxHQWVBLFFBQUFHLEtBQ0E2RCxFQUFBRyxPQUFBLGlCQUFBLFdBQ0EzRCxFQUFBb0QsY0FDQXBELEVBQUF3VSxZQUFBclUsRUFBQUMsVUFBQUosRUFBQW9ELFlBQUE2TixRQUNBalIsRUFBQXlVLGVBQUEsRUFDQXpVLEVBQUEwVSxtQkFBQXZVLEVBQUEyRSxLQUFBOUUsRUFBQW9ELFlBQUE2TixRQUFBMEQsU0FBQSxJQUFBeFQsTUFBQTNCLEVBQUFnTCxZQUFBckosSUFDQXlULE9BS0EsUUFBQUEsS0FDQTVVLEVBQUE2VSxtQkFDQUMsS0FDQXJWLEVBQUFzVixtQkFBQWpWLEtBQUEsU0FBQUMsR0FFQUksRUFBQU8sUUFBQVYsRUFBQW9ELFlBQUE2TixPQUFBLFNBQUErRCxHQUNBN1UsRUFBQTJULE9BQUEvVCxFQUFBRSxLQUFBLFNBQUFnVixHQUNBLE1BQUFELEdBQUE3VCxNQUFBOFQsRUFBQTlULFFBSUFoQixFQUFBTyxRQUFBWCxFQUFBRSxLQUFBLFNBQUFnVixHQUNBalYsRUFBQTZVLGdCQUFBbFUsTUFDQUcsVUFBQW1VLEVBQUFuVSxVQUNBRSxTQUFBaVUsRUFBQWpVLFNBQ0FKLFlBQUFxVSxFQUFBclUsWUFDQTZSLE1BQUF3QyxFQUFBelQsU0FDQUwsSUFBQThULEVBQUE5VCxRQUlBK1QsRUFBQS9VLEVBQUFDLFVBQUFKLEVBQUE2VSxtQkFLQSxRQUFBTSxLQUNBblYsRUFBQW9ELFlBQUE2TixPQUFBalIsRUFBQXdVLFlBQ0FqRixFQUFBNEYsa0JBQUFuVixFQUFBb0QsYUFBQXRELEtBQUEsV0FDQUUsRUFBQXlVLGVBQUEsSUFLQSxRQUFBVyxLQUNBTixLQUNBOVUsRUFBQXdVLFlBQUFyVSxFQUFBQyxVQUFBSixFQUFBb0QsWUFBQTZOLFFBQ0FqUixFQUFBNlUsZ0JBQUExVSxFQUFBQyxVQUFBOFUsR0FRQSxRQUFBRyxHQUFBclksR0FDQThYLEVBQUFuVSxLQUFBM0QsR0FDQWdELEVBQUE2VSxnQkFBQWxVLEtBQUFSLEVBQUEyVCxPQUFBOVQsRUFBQXdVO0FBQUFyVCxJQUFBbkUsRUFBQW1FLE1BQUEsSUFDQW5CLEVBQUF5VSxlQUFBLEVBT0EsUUFBQWEsR0FBQXRZLEdBQ0FnRCxFQUFBd1UsWUFBQTdULEtBQUFSLEVBQUEyVCxPQUFBOVQsRUFBQTZVLGlCQUFBMVQsSUFBQW5FLEVBQUFtRSxNQUFBLElBQ0FuQixFQUFBeVUsZUFBQSxFQWxGQSxHQUFBSyxNQUNBSSxLQUNBbFYsRUFBQTFELElBQ0EwRCxHQUFBNlUsbUJBQ0E3VSxFQUFBd1UsZUFDQXhVLEVBQUEwVSxvQkFBQSxFQUNBMVUsRUFBQW1WLGtCQUFBQSxFQUNBblYsRUFBQW9WLGFBQUFBLEVBQ0FwVixFQUFBcVYsWUFBQUEsRUFDQXJWLEVBQUFzVixTQUFBQSxFQUNBdFYsRUFBQXlVLGVBQUEsRUFFQTlVLG1HQWhDQXpFLFFBQ0FDLE9BQUEsT0FDQTRILFVBQUEsa0JBQUF3UixNQ0xBLFdBQ0EsWUFNQSxTQUFBZ0IsS0FDQSxHQUFBeFMsSUFDQUMsa0JBQUEsRUFDQXhHLFdBQUF5RyxFQUNBdEYsYUFBQSxLQUNBdUYsU0FBQSxJQUNBQyxPQUNBQyxZQUFBLEtBRUF4RixZQUFBLCtDQUVBLE9BQUFtRixHQUlBLFFBQUFFLEdBQUFPLEVBQUErTCxFQUFBOUwsRUFBQWhFLEVBQUFDLEdBaUJBLFFBQUFDLEtBRUEsSUFBQSxHQUFBOEgsR0FBQUMsRUFBQUQsRUFBQSxJQUFBQSxFQUNBNEksR0FBQTVJLENBRUFqRSxHQUFBRyxPQUFBLGlCQUFBLFdBQ0EzRCxFQUFBb0QsY0FDQXBELEVBQUF3VixhQUFBclYsRUFBQUMsVUFBQUosRUFBQW9ELFlBQUFzQixTQUNBMUUsRUFBQXlVLGVBQUEsRUFDQWdCLE9BS0EsUUFBQUEsS0FDQXpWLEVBQUEwVixvQkFDQUMsS0FDQWxXLEVBQUFzVixtQkFBQWpWLEtBQUEsU0FBQUMsR0FDQUksRUFBQU8sUUFBQVYsRUFBQW9ELFlBQUFzQixRQUFBLFNBQUFrUixHQUNBelYsRUFBQTJULE9BQUEvVCxFQUFBRSxLQUFBLFNBQUE0VixHQUNBLE1BQUFELEdBQUF6VSxNQUFBMFUsRUFBQTFVLFFBSUFoQixFQUFBTyxRQUFBWCxFQUFBRSxLQUFBLFNBQUE0VixHQUNBN1YsRUFBQTBWLGlCQUFBL1UsTUFDQUcsVUFBQStVLEVBQUEvVSxVQUNBRSxTQUFBNlUsRUFBQTdVLFNBQ0FKLFlBQUFpVixFQUFBalYsWUFDQTZSLE1BQUFvRCxFQUFBclUsU0FDQUwsSUFBQTBVLEVBQUExVSxRQUlBMlUsRUFBQTNWLEVBQUFDLFVBQUFKLEVBQUEwVixvQkFLQSxRQUFBUCxLQUNBLFdBQUFuVixFQUFBb0QsWUFBQXFCLE1BQUF6RSxFQUFBd1YsYUFBQXpVLE9BQUEsRUFBQSxFQUNBckIsRUFBQVosTUFBQSw0REFDQWtCLEVBQUF3VixhQUFBelUsT0FBQXNQLEVBQ0EzUSxFQUFBWixNQUFBLHVDQUFBdVIsRUFBQSxhQUVBbFEsRUFBQU8sUUFBQWlWLEVBQUEsU0FBQXZPLEdBQ0EzRCxFQUFBaUcsMkNBQUExSixFQUFBb0QsWUFBQWpDLElBQUFpRyxFQUFBakcsT0FFQW5CLEVBQUFvRCxZQUFBc0IsUUFBQTFFLEVBQUF3VixhQUNBakcsRUFBQTRGLGtCQUFBblYsRUFBQW9ELGFBQUF0RCxLQUFBLFdBQ0FFLEVBQUF5VSxlQUFBLEtBTUEsUUFBQVcsS0FDQU8sS0FDQTNWLEVBQUF3VixhQUFBclYsRUFBQUMsVUFBQUosRUFBQW9ELFlBQUFzQixTQUNBMUUsRUFBQTBWLGlCQUFBdlYsRUFBQUMsVUFBQTBWLEdBSUEsUUFBQUMsS0FDQSxXQUFBL1YsRUFBQW9ELFlBQUFxQixLQUNBdVIsSUFDQSxZQUFBaFcsRUFBQW9ELFlBQUFxQixNQUNBd1IsSUFFQWpXLEVBQUF5VSxlQUFBLEVBTUEsUUFBQXdCLEtBQ0EsR0FBQXhPLEdBQUEsQ0FDQXRILEdBQUFPLFFBQUFWLEVBQUF3VixhQUFBLFNBQUFwTyxHQUNBQSxFQUFBckMsU0FBQTBDLElBQ0FBLElBSUEsUUFBQXVPLEtBRUE3VixFQUFBTyxRQUFBVixFQUFBd1YsYUFBQSxTQUFBcE8sR0FDQUEsRUFBQXJDLFNBQUEsR0FHQSxLQUFBLEdBQUEwQyxHQUFBLEVBQUFBLEVBQUF6SCxFQUFBd1YsYUFBQXpVLE9BQUEsRUFBQTBHLElBQ0F6SCxFQUFBd1YsYUFBQS9OLEdBQUExQyxTQUFBLEVBU0EsUUFBQW1SLEdBQUE5TyxHQUNBdU8sRUFBQWhWLEtBQUF5RyxHQUNBcEgsRUFBQTBWLGlCQUFBL1UsS0FBQVIsRUFBQTJULE9BQUE5VCxFQUFBd1YsY0FBQXJVLElBQUFpRyxFQUFBakcsTUFBQSxJQUNBNFUsSUFPQSxRQUFBSSxHQUFBL08sR0FDQXBILEVBQUF3VixhQUFBN1UsS0FBQVIsRUFBQTJULE9BQUE5VCxFQUFBMFYsa0JBQUF2VSxJQUFBaUcsRUFBQWpHLE1BQUEsSUFDQTRVLElBQ0EvVixFQUFBeVUsZUFBQSxFQWhJQSxHQUFBa0IsTUFDQUcsS0FDQXBPLEVBQUEsRUFDQTJJLEVBQUEsS0FDQXJRLEVBQUExRCxJQUNBMEQsR0FBQTBWLG9CQUNBMVYsRUFBQXdWLGdCQUNBeFYsRUFBQW1WLGtCQUFBQSxFQUNBblYsRUFBQW9WLGFBQUFBLEVBQ0FwVixFQUFBK1YsZUFBQUEsRUFDQS9WLEVBQUFrVyxhQUFBQSxFQUNBbFcsRUFBQW1XLFVBQUFBLEVBQ0FuVyxFQUFBeVUsZUFBQSxFQUVBOVUsaUdBbENBekUsUUFDQUMsT0FBQSxPQUNBNEgsVUFBQSxtQkFBQXdTLE1DTEEsdUJBTUEsU0FBQWEsS0FDQSxHQUFBclQsSUFDQUcsU0FBQSxJQUNBdEYsWUFBQSx1Q0FDQXVTLFNBQUEsRUFDQWhOLE9BQ0FDLFlBQUEsS0FFQTVHLFdBQUF5RyxFQUNBdEYsYUFBQSxLQUNBcUYsa0JBQUEsRUFHQSxPQUFBRCxHQUlBLFFBQUFFLEdBQUFPLEVBQUErTCxFQUFBL1AsRUFBQWlFLEVBQUEvRCxHQW1CQSxRQUFBQyxLQUNBNkQsRUFBQUcsT0FBQSxpQkFBQSxXQUNBM0QsRUFBQW9ELGNBQ0FwRCxFQUFBc0osY0FBQXRKLEVBQUFvRCxZQUFBakMsSUFDQW5CLEVBQUFxVyxjQUFBLEVBQ0FyVyxFQUFBbVUsb0JBQUEsRUFDQW1DLElBQ0FDLE9BUUEsUUFBQUQsS0FDQXRXLEVBQUFvRCxZQUFBb1QsUUFFQTlSLFFBQUF2RSxFQUFBa0ksT0FBQXJJLEVBQUFvRCxZQUFBc0IsU0FBQSxXQUFBLE1BR0FBLFFBQUF2RSxFQUFBa0ksT0FBQXJJLEVBQUFvRCxZQUFBc0IsU0FBQSxXQUFBLE1BSUEsSUFBQTFFLEVBQUFvRCxZQUFBc0IsUUFBQTNELFNBQ0FmLEVBQUEySSxtQkFBQSxHQU9BLFFBQUE0TixLQUVBdlcsRUFBQStRLG9CQUFBLEVBQ0EvUSxFQUFBZ1Isc0JBQUEsRUFDQXhSLEVBQUFzQyxvQkFFQTlCLEVBQUErUSxtQkFBQTVRLEVBQUErSyxLQUFBbEwsRUFBQW9ELFlBQUE2TixRQUFBLE1BQUF6UixFQUFBZ0wsWUFBQXJKLE1BRUFuQixFQUFBZ1IscUJBQUE3USxFQUFBK0ssS0FBQWxMLEVBQUFvRCxZQUFBNk0sZ0JBQUEsTUFBQXpRLEVBQUFnTCxZQUFBckosT0FHQW5CLEVBQUFrUiw0QkFBQSxFQUNBbFIsRUFBQW1SLG9CQUFBLEVBQ0FoUixFQUFBTyxRQUFBVixFQUFBb0QsWUFBQXNCLFFBQUEsU0FBQTBDLEdBRUE1SCxFQUFBc0MsbUJBQUFzRixFQUFBakcsTUFBQTNCLEVBQUFnTCxZQUFBckosTUFDQW5CLEVBQUFrUiw0QkFBQSxFQUNBOUosRUFBQXVKLE1BQUEsZUFDQTNRLEVBQUFvUixrQkFBQWhLLEVBQ0FwSCxFQUFBb0QsWUFBQW9ULE1BQUFwUCxFQUFBckMsU0FBQSxHQUFBNEwsTUFBQSxvQkFDQTNRLEVBQUFvRCxZQUFBdU4sTUFBQSxpQ0FLQWxOLEVBQUFJLGlDQUFBN0QsRUFBQXNKLGVBQUF4SixLQUFBLFNBQUEwRSxHQUNBLEdBQUFBLEVBQUF2RSxLQUFBYyxPQUFBLElBQ0FmLEVBQUF5VyxnQkFBQWpTLEVBQUF2RSxLQUFBLEdBQ0FELEVBQUFtUixvQkFBQSxFQUdBLElBQUFuUixFQUFBeVcsZ0JBQUF6UixXQUFBLENBQ0EsR0FBQUMsR0FBQUMsU0FBQUMsS0FBQUQsT0FBQWxGLEVBQUF5VyxnQkFBQXJSLFNBQUFDLElBQUFyRixFQUFBeVcsZ0JBQUF6UixVQUFBLE9BQUEsRUFDQTZMLEVBQUEzTCxPQUFBSyxTQUFBTixHQUFBTyxTQUVBUCxHQUFBLEVBQ0FqRixFQUFBMFcsb0JBQUE3RixFQUVBNUwsR0FBQSxHQUNBNkwsRUFBQSxNQUFBLE1BT0EsUUFBQTZGLEtBQ0EzVyxFQUFBbVIsb0JBQUFuUixFQUFBa1IsNkJBQ0FsUixFQUFBcVcsY0FBQXJXLEVBQUFxVyxjQUlBLFFBQUFqRSxHQUFBeE4sR0FFQSxHQURBNUUsRUFBQW1VLG9CQUFBLEVBQ0FuVSxFQUFBbVIsbUJBQ0F6UixFQUFBWixNQUFBLHNEQUNBLENBQ0FrQixFQUFBbVIsb0JBQUEsQ0FFQSxJQUFBM00sSUFDQUMsS0FBQXpFLEVBQUFvRCxZQUFBcUIsS0FDQTROLGdCQUFBclMsRUFBQW9ELFlBQUFrUCxLQUNBaEosY0FBQXRKLEVBQUFzSixjQUNBaUosVUFBQSxFQUNBL0osU0FBQSxFQUNBeEQsVUFBQWhGLEVBQUFvRCxZQUFBb1AsWUFDQTdOLFlBQ0FDLEtBQUE1RSxFQUFBb1Isa0JBQUFyTSxTQUNBNUQsSUFBQW5CLEVBQUFvUixrQkFBQWpRLEtBRUEwRCxVQUNBRCxLQUFBQSxHQUtBbkIsR0FBQXlGLHNCQUFBMUUsR0FBQTFFLEtBQUEsV0FFQUUsRUFBQTBTLHVCQUFBLEtBWUEsUUFBQTVCLEdBQUE4RixFQUFBcE8sR0FDQXhJLEVBQUFtUixvQkFBQSxDQUNBLElBQUEzTSxHQUFBeEUsRUFBQXlXLGVBRUFqTyxJQUNBaEUsRUFBQWdFLFNBQUEsRUFDQWhFLEVBQUFpQyxPQUFBLGNBR0F6RyxFQUFBeVcsZ0JBQUE5UixXQUFBQyxPQUFBZ1MsRUFDQXBTLEVBQUFpQyxPQUFBLGFBRUFqQyxFQUFBaUMsT0FBQSxXQUlBaEQsRUFBQTJGLHdCQUFBNUUsR0FDQXhFLEVBQUEwUyx1QkFBQSxFQU1BLFFBQUEwQixLQUNBN0UsRUFBQW1FLGVBQUExVCxFQUFBc0osZUFBQXhKLEtBQUEsU0FBQXNELEdBQ0FwRCxFQUFBb0QsWUFBQUEsRUFBQW5ELE9BdEtBLEdBQUFELEdBQUExRCxJQUNBMEQsR0FBQXNKLGNBQUEsS0FDQXRKLEVBQUErUSxvQkFBQSxFQUNBL1EsRUFBQWdSLHNCQUFBLEVBQ0FoUixFQUFBa1IsNEJBQUEsRUFDQWxSLEVBQUF5VyxnQkFBQSxLQUNBelcsRUFBQW1SLG9CQUFBLEVBQ0FuUixFQUFBb1Isa0JBQUEsS0FDQXBSLEVBQUFvUyxnQkFBQUEsRUFDQXBTLEVBQUE4USxrQkFBQUEsRUFDQTlRLEVBQUEwVyxvQkFBQSxLQUNBMVcsRUFBQXFXLGNBQUEsRUFDQXJXLEVBQUFtVSxvQkFBQSxFQUNBblUsRUFBQTJXLGVBQUFBLEVBQ0EzVyxFQUFBMkksbUJBQUEsRUFFQWhKLElBMkpBNkQsRUFBQWhGLElBQUEseUJBQUEsU0FBQTJCLEVBQUFrVSxHQUNBclUsRUFBQXNKLGdCQUFBK0ssRUFBQS9LLGdCQUNBNUosRUFBQTBNLEtBQUFpSSxFQUFBQyxhQUNBRix3R0FwTUFsWixRQUNBQyxPQUFBLE9BQ0E0SCxVQUFBLFlBQUFxVCxNQ0pBLHVCQUlBLFNBQUE3RyxHQUFBMUcsR0EwQkEsUUFBQTZLLEdBQUFwSyxHQUNBLE1BQUFULEdBQUFuTixJQUFBLG9CQUNBNEksUUFDQWdGLGNBQUFBLEtBV0EsUUFBQXVOLEdBQUE5VSxHQUNBLE1BQUE4RyxHQUFBbk4sSUFBQSwwQkFDQTRJLFFBQ0F2QyxPQUFBQSxLQVVBLFFBQUF5TixLQUNBLE1BQUEzRyxHQUFBbk4sSUFBQSw0QkFRQSxRQUFBaVUsS0FDQSxNQUFBOUcsR0FBQW5OLElBQUEsNkJBR0EsUUFBQW9iLEdBQUExVCxHQUNBLE1BQUF5RixHQUFBRSxLQUFBLDRCQUNBM0YsWUFBQUEsSUFJQSxRQUFBK1IsR0FBQS9SLEdBQ0EsTUFBQXlGLEdBQUFFLEtBQUEsNEJBQ0EzRixZQUFBQSxJQUlBLFFBQUEyVCxHQUFBek4sR0FDQSxNQUFBVCxHQUFBYyxPQUFBLDRCQUNBckYsUUFDQWdGLGNBQUFBLEtBS0EsUUFBQXlKLEdBQUF6SixFQUFBME4sRUFBQUMsRUFBQUMsR0FDQSxNQUFBck8sR0FBQUksSUFBQSx5Q0FDQUssY0FBQUEsRUFDQTBOLFFBQUFBLEVBQ0FDLFNBQUFBLEVBQ0FDLGNBQUFBLElBSUEsUUFBQXBFLEdBQUF4SixFQUFBM0UsRUFBQUUsR0FDQSxNQUFBZ0UsR0FBQUUsS0FBQSxtQ0FDQU8sY0FBQUEsRUFDQTNFLFdBQUFBLEVBQ0FFLFNBQUFBLElBSUEsUUFBQTBPLEdBQUFqSyxFQUFBbEMsR0FDQSxNQUFBeUIsR0FBQUUsS0FBQSwrQkFDQU8sY0FBQUEsRUFDQWxDLE9BQUFBLElBSUEsUUFBQWtNLEdBQUFsUSxFQUFBZ0UsR0FDQSxNQUFBeUIsR0FBQUUsS0FBQSxzQ0FDQTNGLFlBQUFBLEVBQ0FnRSxPQUFBQSxJQUlBLFFBQUE2TSxHQUFBM0ssRUFBQXVLLEVBQUFuUCxHQUNBLE1BQUFtRSxHQUFBRSxLQUFBLGtDQUNBTyxjQUFBQSxFQUNBdUssY0FBQUEsRUFDQW5QLFFBQUFBLElBSUEsUUFBQXFMLEdBQUF6RyxFQUFBbEMsR0FDQSxNQUFBeUIsR0FBQUUsS0FBQSxtQ0FDQU8sY0FBQUEsRUFDQWxDLE9BQUFBLElBSUEsUUFBQTRJLEdBQUExRyxFQUFBbEMsR0FDQSxNQUFBeUIsR0FBQUUsS0FBQSxnQ0FDQU8sY0FBQUEsRUFDQWxDLE9BQUFBLElBdElBLEdBQUF5QyxJQUNBNkosZUFBQUEsRUFDQW1ELHVCQUFBQSxFQUNBckgsc0JBQUFBLEVBQ0FHLHVCQUFBQSxFQUNBbUgsa0JBQUFBLEVBQ0EzQixrQkFBQUEsRUFDQTRCLGtCQUFBQSxFQUNBaEUsb0JBQUFBLEVBQ0FELGNBQUFBLEVBQ0FTLHVCQUFBQSxFQUNBRCw4QkFBQUEsRUFDQVcsNkJBQUFBLEVBQ0FsRSxxQkFBQUEsRUFDQUMsa0JBQUFBLEVBR0EsT0FBQW5HLHVCQXBCQTNPLFFBQUFDLE9BQUEsT0FBQTJPLFFBQUEsc0JBQUF5RixNQ0ZBLHVCQUlBLFNBQUE0SCxHQUFBM1QsRUFBQXhILEVBQUE2RixFQUFBdU8sRUFBQWIsRUFBQS9QLEVBQUFFLEVBQUErRCxHQVNBLFFBQUE5RCxLQUNBa0MsRUFBQXlILGVBQ0F0SixFQUFBc0osY0FBQXpILEVBQUF5SCxjQUNBOEssS0FFQXBZLEVBQUErQyxHQUFBLCtCQUlBLFFBQUFxVixLQUNBN0UsRUFBQW1FLGVBQUExVCxFQUFBc0osZUFBQXhKLEtBQUEsU0FBQXNELEdBRUFBLEVBQUFuRCxNQUFBRSxFQUFBK0ssS0FBQTlILEVBQUFuRCxLQUFBZ1IsUUFBQSxNQUFBelIsRUFBQWdMLFlBQUFySixPQUNBbkIsRUFBQW9YLFNBQUEsRUFFQWhVLEVBQUFuRCxLQUFBeUUsUUFBQTBMLEVBQUEsV0FBQWhOLEVBQUFuRCxLQUFBeUUsUUFBQSxZQUNBMUUsRUFBQW9ELFlBQUFBLEVBQUFuRCxNQUVBakUsRUFBQStDLEdBQUEsaUNBR0EwRSxFQUFBOEMsb0NBQUF2RyxFQUFBc0osZUFBQXhKLEtBQUEsU0FBQWdFLEdBQ0E5RCxFQUFBOEQsV0FBQUEsRUFBQTdELE9BS0EsUUFBQW9YLEtBQ0E5SCxFQUFBbUUsZUFBQTFULEVBQUFzSixlQUFBeEosS0FBQSxTQUFBc0QsR0FDQSxHQUFBa1UsR0FBQWxVLEVBQUFuRCxJQUNBcVgsR0FBQWpFLGNBQUFyVCxFQUFBb0QsWUFBQWlRLGNBQ0E5RCxFQUFBNEYsa0JBQUFtQyxLQUtBLFFBQUFDLEtBQ0FoSSxFQUFBbUUsZUFBQTFULEVBQUFzSixlQUFBeEosS0FBQSxTQUFBc0QsR0FDQSxHQUFBa1UsR0FBQWxVLEVBQUFuRCxJQUNBcVgsR0FBQUUsUUFBQXhYLEVBQUFvRCxZQUFBb1UsUUFDQWpJLEVBQUE0RixrQkFBQW1DLEtBSUEsUUFBQVAsS0FDQW5SLE1BQ0FDLE1BQUEsc0JBQ0FDLEtBQUEseUJBQ0FyQixLQUFBLFFBQ0FzQixrQkFBQSxFQUNBQyxrQkFBQSxTQUNBQyxpQkFBQSxZQUNBQyxnQkFBQSxFQUNBQyxlQUFBLEdBQ0EsV0FDQW9KLEVBQUF3SCxrQkFBQS9XLEVBQUFzSixlQUFBeEosS0FBQSxXQUNBOUQsRUFBQStDLEdBQUEsbUNBaEVBLEdBQUFpQixHQUFBMUQsSUFDQTBELEdBQUFzSixjQUFBLEtBQ0F0SixFQUFBcVgsK0JBQUFBLEVBQ0FyWCxFQUFBdVgseUJBQUFBLEVBQ0F2WCxFQUFBK1csa0JBQUFBLEVBRUFwWCxJQWdFQTZELEVBQUFoRixJQUFBLHlCQUFBLFNBQUEyQixFQUFBc1gsR0FDQXpYLEVBQUFzSixnQkFBQW1PLEVBQUFuTyxnQkFDQTVKLEVBQUEwTSxLQUFBcUwsRUFBQW5ELGFBQ0FGLE9BS0E1USxFQUFBaEYsSUFBQSx5QkFBQSxTQUFBMkIsRUFBQXNYLEdBQ0F6WCxFQUFBc0osZ0JBQUFtTyxFQUFBbk8sZ0JBQ0E1SixFQUFBME0sS0FBQXFMLEVBQUFuRCxhQUNBdFksRUFBQStDLEdBQUEscUtBcEZBN0QsUUFBQUMsT0FBQSxPQUFBcUIsV0FBQSx1QkFBQTJhLE1DRkEsdUJBSUEsU0FBQU8sR0FBQWxVLEVBQUEzQixFQUFBN0YsRUFBQXVULEVBQUE3UCxFQUFBK0QsR0FTQSxRQUFBOUQsS0FDQWtDLEVBQUF5SCxnQkFDQXRKLEVBQUFzSixjQUFBekgsRUFBQXlILGNBQ0E4SyxLQUlBLFFBQUFBLEtBQ0E3RSxFQUFBbUUsZUFBQTFULEVBQUFzSixlQUFBeEosS0FBQSxTQUFBc0QsR0FDQUEsRUFBQW5ELE1BQ0FELEVBQUFvRCxZQUFBQSxFQUFBbkQsS0FDQSxZQUFBRCxFQUFBb0QsWUFBQXFCLEtBQ0F0RSxFQUFBTyxRQUFBVixFQUFBb0QsWUFBQXNCLFFBQUEsU0FBQTBDLEdBQ0EzRCxFQUFBbUcsOEJBQUE1SixFQUFBc0osY0FBQWxDLEVBQUFqRyxLQUFBckIsS0FBQSxTQUFBa0ksR0FDQVosRUFBQVksUUFBQUEsRUFBQS9ILFNBR0EsV0FBQUQsRUFBQW9ELFlBQUFxQixPQUNBekUsRUFBQXdXLFFBRUFtQixPQUFBLElBR0FBLE9BQUEsTUFLQTNiLEVBQUErQyxHQUFBLGlDQUlBMEUsRUFBQThDLG9DQUFBdkcsRUFBQXNKLGVBQUF4SixLQUFBLFNBQUFnRSxHQUNBOUQsRUFBQThELFdBQUFBLEVBQUE3RCxPQXpDQSxHQUFBRCxHQUFBMUQsSUFDQTBELEdBQUFzSixjQUFBLEtBQ0F0SixFQUFBb0QsZUFDQXBELEVBQUE0WCxrQkFDQTVYLEVBQUE4RCxjQUVBbkUsSUF3Q0E2RCxFQUFBaEYsSUFBQSx5QkFBQSxTQUFBMkIsRUFBQWtVLEdBQ0FyVSxFQUFBc0osZ0JBQUErSyxFQUFBL0ssZ0JBQ0E1SixFQUFBME0sS0FBQWlJLEVBQUFDLGFBQ0FGLE9BS0E1USxFQUFBaEYsSUFBQSx5QkFBQSxTQUFBMkIsRUFBQWtVLEdBQ0FyVSxFQUFBc0osZ0JBQUErSyxFQUFBL0ssZ0JBQ0E1SixFQUFBME0sS0FBQWlJLEVBQUFDLGFBQ0F0WSxFQUFBK0MsR0FBQSx5SUE1REE3RCxRQUFBQyxPQUFBLE9BQUFxQixXQUFBLHVCQUFBa2IsTUNGQSx1QkFJQSxTQUFBRyxHQUFBclUsRUFBQXhILEVBQUE2RixFQUFBME4sRUFBQTlMLEVBQUEvRCxHQU9BLFFBQUFDLEtBQ0FrQyxFQUFBeUgsZ0JBQ0F0SixFQUFBc0osY0FBQXpILEVBQUF5SCxjQUVBOEssS0FJQSxRQUFBQSxLQUNBN0UsRUFBQW1FLGVBQUExVCxFQUFBc0osZUFBQXhKLEtBQUEsU0FBQXNELEdBQ0FBLEVBQUFuRCxLQUNBRCxFQUFBb0QsWUFBQUEsRUFBQW5ELEtBRUFqRSxFQUFBK0MsR0FBQSxpQ0FuQkEsR0FBQWlCLEdBQUExRCxJQUNBMEQsR0FBQXNKLGNBQUEsS0FDQXRKLEVBQUFvRCxZQUFBLEtBRUF6RCxJQXFCQTZELEVBQUFoRixJQUFBLHlCQUFBLFNBQUEyQixFQUFBc1gsR0FDQXpYLEVBQUFzSixnQkFBQW1PLEVBQUFuTyxnQkFDQTVKLEVBQUEwTSxLQUFBcUwsRUFBQW5ELGFBQ0F0WSxFQUFBK0MsR0FBQSx5SUEvQkE3RCxRQUFBQyxPQUFBLE9BQUFxQixXQUFBLGtCQUFBcWIsTUNGQSx1QkFJQSxTQUFBQyxHQUFBdkksR0FNQSxRQUFBNVAsS0FDQTRQLEVBQUFDLHdCQUFBMVAsS0FBQSxTQUFBMlAsR0FDQXpQLEVBQUF5UCxhQUFBQSxFQUFBeFAsT0FQQSxHQUFBRCxHQUFBMUQsSUFDQTBELEdBQUF5UCxnQkFFQTlQLHNDQU5BekUsUUFBQUMsT0FBQSxPQUFBcUIsV0FBQSxtQkFBQXNiLE1DQ0EsdUJBSUEsU0FBQUMsR0FBQS9iLEVBQUF5RCxFQUFBOFAsRUFBQS9QLEVBQUFFLEdBeUJBLFFBQUFDLEtBQ0FGLEVBQUFzVixtQkFBQWpWLEtBQUEsU0FBQUMsR0FDQUMsRUFBQTBWLGlCQUFBM1YsRUFBQUUsTUFJQSxLQUFBLEdBQUF3SCxHQUFBQyxFQUFBRCxFQUFBLElBQUFBLEVBQ0E0SSxHQUFBNUksQ0FJQSxLQUFBQSxFQUFBLEVBQUFBLEVBQUFDLEVBQUFELElBQ0FELEVBQUE3RyxLQUFBOEcsR0FBQUEsRUFBQSxHQUFBLEVBQUEsR0FTQSxRQUFBME8sR0FBQS9PLEdBQ0FwSCxFQUFBd1YsYUFBQTdVLEtBQUFSLEVBQUEyVCxPQUFBOVQsRUFBQTBWLGtCQUFBdlUsSUFBQWlHLEVBQUFqRyxNQUFBLElBQ0E0VSxJQU9BLFFBQUFHLEdBQUE5TyxHQUNBcEgsRUFBQTBWLGlCQUFBL1UsS0FBQVIsRUFBQTJULE9BQUE5VCxFQUFBd1YsY0FBQXJVLElBQUFpRyxFQUFBakcsTUFBQSxJQUNBNFUsSUFNQSxRQUFBQSxLQUNBLFdBQUEvVixFQUFBZ1ksZUFBQXZULEtBQ0F1UixJQUNBLFlBQUFoVyxFQUFBZ1ksZUFBQXZULE1BQ0F3UixJQU9BLFFBQUFBLEtBQ0EsR0FBQXhPLEdBQUEsQ0FDQXRILEdBQUFPLFFBQUFWLEVBQUF3VixhQUFBLFNBQUFwTyxHQUNBQSxFQUFBckMsU0FBQTBDLElBQ0FBLElBSUEsUUFBQXVPLEtBRUE3VixFQUFBTyxRQUFBVixFQUFBd1YsYUFBQSxTQUFBcE8sR0FDQUEsRUFBQXJDLFNBQUEsR0FHQSxLQUFBLEdBQUEwQyxHQUFBLEVBQUFBLEVBQUF6SCxFQUFBd1YsYUFBQXpVLE9BQUEsRUFBQTBHLElBQ0F6SCxFQUFBd1YsYUFBQS9OLEdBQUExQyxTQUFBLEVBUUEsUUFBQStSLEdBQUExVCxHQUNBLEdBQUEsV0FBQUEsRUFBQXFCLE1BQUF6RSxFQUFBd1YsYUFBQXpVLE9BQUEsRUFBQSxFQUNBckIsRUFBQVosTUFBQSxnRUFDQSxJQUFBa0IsRUFBQXdWLGFBQUF6VSxPQUFBc1AsRUFDQTNRLEVBQUFaLE1BQUEsdUNBQUF1UixFQUFBLGdCQUNBLENBQ0FuVixRQUFBd0YsUUFBQVYsRUFBQXdWLGFBQUEsU0FBQXBPLEdBQ0EsR0FBQStPLElBQ0FoVixJQUFBaUcsRUFBQWpHLElBQ0FzUixNQUFBckwsRUFBQTVGLFNBQ0FWLFVBQUFzRyxFQUFBdEcsVUFDQUUsU0FBQW9HLEVBQUFwRyxTQUNBSixZQUFBd0csRUFBQXhHLFlBQ0FtRSxTQUFBcUMsRUFBQXJDLFNBRUEzQixHQUFBc0IsUUFBQS9ELEtBQUF3VixLQUVBL1MsRUFBQTZOLFNBQ0E5UCxJQUFBM0IsRUFBQWdMLFlBQUFySixJQUNBc1IsTUFBQWpULEVBQUFnTCxZQUFBaEosU0FDQVYsVUFBQXRCLEVBQUFnTCxZQUFBMUosVUFDQUUsU0FBQXhCLEVBQUFnTCxZQUFBeEosU0FDQUosWUFBQXBCLEVBQUFnTCxZQUFBNUosWUFDQStULFNBQUEsR0FJQSxLQUFBLEdBQUFsTixHQUFBLEVBQUFBLEVBQUFELEVBQUF6RyxPQUFBMEcsSUFDQSxHQUFBckUsRUFBQXNCLFFBQUEzRCxPQUFBeUcsRUFBQUMsR0FBQSxDQUNBckUsRUFBQXFPLE9BQUFoSyxDQUNBLE9BSUE4SCxFQUFBdUgsa0JBQUExVCxHQUFBdEQsS0FBQSxTQUFBa1ksR0FDQWhjLEVBQUErQyxHQUFBLHFCQUNBdUssY0FBQTBPLEVBQUEvWCxLQUFBa0IsU0FwSUEsR0FBQXFHLE1BQ0FFLEVBQUEsRUFDQTJJLEVBQUEsS0FDQXJRLEVBQUExRCxJQUNBMEQsR0FBQWdZLGdCQUNBdFQsV0FDQTJPLGVBQUEsRUFDQW1FLFNBQUEsR0FFQXhYLEVBQUEwVixvQkFDQTFWLEVBQUF3VixnQkFDQXhWLEVBQUE4VyxrQkFBQUEsRUFDQTlXLEVBQUFtVyxVQUFBQSxFQUNBblcsRUFBQWtXLGFBQUFBLEVBQ0FsVyxFQUFBK1YsZUFBQUEsRUFDQS9WLEVBQUFnWSxlQUFBeEYsWUFBQSxFQUNBeFMsRUFBQWdZLGVBQUFoRixrQkFBQSxFQUNBaFQsRUFBQWlZLGtCQUFBLFVBQUEsVUFFQXRZLCtGQXRCQXpFLFFBQUFDLE9BQUEsT0FBQXFCLFdBQUEsd0JBQUF1YixNQ0xBLHVCQUlBLFNBQUFHLEdBQUExVSxFQUFBK0wsRUFBQTlMLEVBQUFqRSxFQUFBRSxHQU9BLFFBQUFDLEtBQ0FrWCxJQUdBLFFBQUFBLEtBQ0FzQixLQUNBblksRUFBQXlXLGdCQUFBLEtBQ0FqWCxFQUFBc0MsbUJBQ0F5TixFQUFBc0gsdUJBQUFyWCxFQUFBZ0wsWUFBQXJKLEtBQUFyQixLQUFBLFNBQUEyUCxHQUNBelAsRUFBQXlQLGFBQUFBLEVBQUF4UCxLQUNBRSxFQUFBTyxRQUFBVixFQUFBeVAsYUFBQSxTQUFBck0sR0FDQStVLEVBQUF4WCxLQUFBeUMsRUFBQWpDLEtBQ0EsWUFBQWlDLEVBQUFxQixLQUNBaEIsRUFBQThGLHdDQUFBbkcsRUFBQWpDLElBQUEzQixFQUFBZ0wsWUFBQXJKLEtBQUFyQixLQUFBLFNBQUEwRSxHQUNBQSxFQUFBdkUsT0FDQW1ELEVBQUFxVCxnQkFBQWpTLEVBQUF2RSxLQUNBLElBQUFtRCxFQUFBcVQsZ0JBQUF6UixZQUNBNUIsRUFBQXFULGdCQUFBblIsUUFBQUosU0FBQUMsS0FBQUQsT0FBQTlCLEVBQUFxVCxnQkFBQXJSLFNBQUFDLElBQUFqQyxFQUFBcVQsZ0JBQUF6UixVQUFBLEtBQUEsTUFBQSxNQUlBLFdBQUE1QixFQUFBcUIsTUFDQWhCLEVBQUFJLGlDQUFBVCxFQUFBakMsS0FBQXJCLEtBQUEsU0FBQTBFLEdBQ0FBLEVBQUF2RSxLQUFBYyxPQUFBLElBQ0FxQyxFQUFBcVQsZ0JBQUFqUyxFQUFBdkUsS0FBQSxHQUNBLElBQUFtRCxFQUFBcVQsZ0JBQUF6UixZQUNBNUIsRUFBQXFULGdCQUFBblIsUUFBQUosU0FBQUMsS0FBQUQsT0FBQTlCLEVBQUFxVCxnQkFBQXJSLFNBQUFDLElBQUFqQyxFQUFBcVQsZ0JBQUF6UixVQUFBLEtBQUEsTUFBQSxVQWhDQSxHQUFBbVQsTUFDQW5ZLEVBQUExRCxJQUNBMEQsR0FBQXlXLGdCQUFBLEtBRUE5VyxJQXVDQTZELEVBQUFoRixJQUFBLHlCQUFBLFNBQUEyQixFQUFBa1UsR0FDQThELEVBQUFsWCxRQUFBb1QsRUFBQS9LLGdCQUFBLElBQ0E1SixFQUFBME0sS0FBQWlJLEVBQUFDLGFBQ0F1Qyx3R0FqREEzYixRQUFBQyxPQUFBLE9BQUFxQixXQUFBLHFCQUFBMGIsTUNGQSx1QkFJQSxTQUFBRSxHQUFBNVksRUFBQUMsRUFBQUMsR0FjQSxRQUFBQyxLQUNBSCxFQUFBZ0wsWUFBQTVKLGNBQ0FaLEVBQUE5QyxLQUFBMEQsWUFBQXBCLEVBQUFnTCxZQUFBMUosVUFBQSxJQUFBdEIsRUFBQWdMLFlBQUF4SixVQUVBcVgsRUFBQWxZLEVBQUFDLFVBQUFKLEVBQUE5QyxNQUdBLFFBQUFzRCxHQUFBdEQsR0FFQSxHQUFBdUQsS0FDQWhCLEdBQUFJLGNBQUFDLEtBQUEsU0FBQUMsR0FLQSxHQUpBSSxFQUFBTyxRQUFBWCxFQUFBRSxLQUFBLFNBQUEvQyxHQUNBdUQsRUFBQUUsS0FBQXpELEVBQUEwRCxZQUFBQyxpQkFHQTNELEVBQUF1RSxXQUFBdkUsRUFBQW9GLGdCQUNBNUMsRUFBQVosTUFBQSw4QkFDQSxJQUFBNUIsRUFBQTRELFVBQUFDLE9BQUEsR0FBQTdELEVBQUE4RCxTQUFBRCxPQUFBLEdBQUE3RCxFQUFBMEQsWUFBQUcsT0FBQSxFQUNBckIsRUFBQVosTUFBQSxtRUFDQSxJQUFBdVosRUFBQXpYLGNBQUExRCxFQUFBMEQsYUFBQVQsRUFBQWMsUUFBQVIsRUFBQXZELEVBQUEwRCxZQUFBQyxnQkFBQSxFQUNBbkIsRUFBQVosTUFBQSw4REFDQSxLQUFBVSxFQUFBd00sYUFBQSxnQkFBQTlPLEVBQUEwRCxZQUFBQyxjQUFBSSxRQUFBLFlBQUEsRUFDQXZCLEVBQUFaLE1BQUEsdUNBQ0EsQ0FFQSxHQUFBb0MsSUFDQUMsSUFBQWpFLEVBQUFpRSxNQUVBakUsRUFBQTRELFlBQUF0QixFQUFBZ0wsWUFBQTFKLFdBQUE1RCxFQUFBNEQsVUFBQUMsT0FBQSxHQUFBN0QsRUFBQThELFdBQUF4QixFQUFBZ0wsWUFBQXhKLFVBQUE5RCxFQUFBOEQsU0FBQUQsT0FBQSxHQUFBN0QsRUFBQTBELGNBQUFwQixFQUFBZ0wsWUFBQTVKLGFBQUExRCxFQUFBMEQsWUFBQUcsT0FBQSxLQUNBRyxFQUFBSixVQUFBNUQsRUFBQTRELFVBQ0FJLEVBQUFGLFNBQUE5RCxFQUFBOEQsU0FDQUUsRUFBQU4sWUFBQTFELEVBQUEwRCxhQUVBMUQsRUFBQXVFLFVBQUF2RSxFQUFBdUUsU0FBQTZXLE9BQUEsSUFDQXBYLEVBQUFPLFNBQUF2RSxFQUFBdUUsVUFFQWhDLEVBQUFlLFdBQUFVLEdBQUFwQixLQUFBLFdBQ0FKLEVBQUEwQixRQUFBLHFDQUNBcEIsRUFBQXFCLFNBQUFrWCxjQUVBLElBQUFDLEdBQUF0ZCxRQUFBdWQsS0FBQWpaLEVBQUFnTCxZQUNBdFAsU0FBQXdkLE9BQUFGLEVBQUF0WCxHQUNBMUIsRUFBQWdMLFlBQUFnTyxFQUNBeFksRUFBQTlDLEtBQUFvRixnQkFBQXRDLEVBQUE5QyxLQUFBdUUsU0FBQSxRQXhEQSxHQUFBNFcsR0FBQSxLQUNBclksRUFBQTFELElBQ0EwRCxHQUFBOUMsTUFDQWlFLElBQUEzQixFQUFBZ0wsWUFBQXJKLElBQ0FMLFVBQUF0QixFQUFBZ0wsWUFBQTFKLFVBQ0FFLFNBQUF4QixFQUFBZ0wsWUFBQXhKLFNBQ0FKLFlBQUFwQixFQUFBZ0wsWUFBQTVKLGFBRUFaLEVBQUFRLFdBQUFBLEVBQ0FSLEVBQUFxQixZQUVBMUIsZ0VBZEF6RSxRQUFBQyxPQUFBLE9BQUFxQixXQUFBLFdBQUE0YixNQ0ZBLHVCQUlBLFNBQUFwYSxHQUFBaEMsRUFBQTZNLEVBQUE4UCxFQUFBbFosRUFBQUQsRUFBQUUsR0FVQSxRQUFBZ0MsR0FBQUYsRUFBQUMsR0FDQSxHQUFBbVgsR0FBQUQsRUFBQUUsT0FjQSxPQWJBaFEsR0FBQUUsS0FBQSxVQUNBdkgsU0FBQUEsRUFDQUMsU0FBQUEsSUFDQTNCLEtBQUEsU0FBQTZCLEdBQ0FBLEVBQUExQixLQUFBbUIsU0FDQTVCLEVBQUFnTCxZQUFBN0ksRUFBQTFCLEtBQUEvQyxLQUNBMGIsRUFBQTlhLFNBQUEsSUFDQSxlQUFBNkQsRUFBQTFCLEtBQUFvTSxRQUNBdU0sRUFBQTlhLFFBQUEsY0FFQThhLEVBQUE5YSxTQUFBLEtBR0E4YSxFQUFBRSxRQUdBLFFBQUFwVyxHQUFBcVcsR0FDQSxHQUFBSCxHQUFBRCxFQUFBRSxPQWNBLE9BYkFoUSxHQUFBRSxLQUFBLGNBQ0FnUSxTQUFBQSxJQUNBalosS0FBQSxTQUFBNkIsR0FDQUEsRUFBQTFCLEtBQ0EyWSxFQUFBOWEsU0FBQSxHQUVBOGEsRUFBQTlhLFNBQUEsSUFFQSxTQUFBNkQsR0FDQSxnQ0FBQUEsRUFBQTFCLEtBQUErWSxRQUNBdFosRUFBQVosTUFBQSwrREFHQThaLEVBQUFFLFFBR0EsUUFBQTlPLEtBQ0EsR0FBQTRPLEdBQUFELEVBQUFFLE9BUUEsT0FQQWhRLEdBQUFFLEtBQUEsV0FDQWlCLFFBQUEsSUFDQWxLLEtBQUEsV0FDQU4sRUFBQWdMLFlBQUEzSCxPQUNBK1YsRUFBQTlhLFVBQ0E5QixFQUFBK0MsR0FBQSxVQUVBNlosRUFBQUUsUUFHQSxRQUFBN2EsR0FBQWdPLEdBQ0EsUUFBQXpNLEVBQUF3TSxhQUFBQyxJQUdBME0sRUFBQU0sT0FBQSxrQkFJQSxRQUFBL2EsS0FDQSxRQUFBc0IsRUFBQXNDLG1CQUdBNlcsRUFBQU0sT0FBQSxrQkFyRUEsR0FBQXBQLElBQ0FuSSxpQkFBQUEsRUFDQWdCLFdBQUFBLEVBQ0FzSCxPQUFBQSxFQUNBL0wsNkJBQUFBLEVBQ0FDLDBCQUFBQSxFQUVBLE9BQUEyTCxxRkFWQTNPLFFBQUFDLE9BQUEsT0FBQTJPLFFBQUEsY0FBQTlMLE1DRkEsdUJBSUEsU0FBQXlCLEdBQUFvSixHQVdBLFFBQUFoSixLQUNBLE1BQUFnSixHQUFBbk4sSUFBQSxjQUFBb0UsS0FBQSxTQUFBQyxHQUNBLE1BQUFBLEtBSUEsUUFBQWdWLEtBQ0EsTUFBQWxNLEdBQUFuTixJQUFBLHVCQUFBb0UsS0FBQSxTQUFBQyxHQU9BLE1BTEFJLEdBQUFPLFFBQUFYLEVBQUFFLEtBQUEsU0FBQS9DLEdBQ0FBLEVBQUEwRCxjQUNBMUQsRUFBQTBELFlBQUExRCxFQUFBNEQsVUFBQSxJQUFBNUQsRUFBQThELFlBR0FqQixJQUlBLFFBQUFrQyxHQUFBRixFQUFBQyxHQUNBLE1BQUE2RyxHQUFBbk4sSUFBQSwwQkFDQTRJLFFBQ0F2QyxPQUFBQSxFQUNBQyxrQkFBQUEsS0FLQSxRQUFBRyxHQUFBWCxHQUNBLE1BQUFxSCxHQUFBbk4sSUFBQSwyQkFDQTRJLFFBQ0E5QyxTQUFBQSxLQUtBLFFBQUFZLEdBQUFMLEVBQUFDLEVBQUFQLEdBQ0EsTUFBQW9ILEdBQUFJLElBQUEsNEJBQ0FsSCxPQUFBQSxFQUNBQyxrQkFBQUEsRUFDQVAsU0FBQUEsSUFJQSxRQUFBakIsR0FBQXRELEdBQ0EsTUFBQTJMLEdBQUFJLElBQUEsYUFDQS9MLEtBQUFBLElBdkRBLEdBQUEyTSxJQUNBaEssWUFBQUEsRUFDQWtWLGlCQUFBQSxFQUNBOVMsV0FBQUEsRUFDQUUsMEJBQUFBLEVBQ0FDLGNBQUFBLEVBQ0E1QixXQUFBQSxFQUVBLE9BQUFxSix1QkFYQTNPLFFBQUFDLE9BQUEsT0FBQTJPLFFBQUEsY0FBQXJLLE1DRkEsdUJBTUEsU0FBQXlaLEdBQUFqTSxHQVFBLFFBQUFrTSxHQUFBaFcsRUFBQWlXLEVBQUFDLEdBQ0EsR0FBQWhNLEdBQUFnTSxFQUFBaE0sWUFBQSxJQUNBRCxFQUFBaU0sRUFBQWpNLE9BQUEsZUFDQUUsRUFBQStMLEVBQUEvTCxnQkFBQSxHQUNBZixHQUFBLFFBQUErTSxTQUFBLGFBQ0FyTSxFQUFBQyxhQUFBa00sRUFBQWhNLEVBQUFDLEVBQUFDLEdBWkEsR0FBQXZLLElBQ0FHLFNBQUEsSUFDQXFXLEtBQUFKLEVBR0EsT0FBQXBXLGtDQVZBN0gsUUFDQUMsT0FBQSxPQUNBNEgsVUFBQSxZQUFBbVcsTUNKQSxXQUNBLFlBS0EsU0FBQU0sS0FRQSxRQUFBTCxHQUFBaFcsRUFBQXNXLEdBQ0FBLEVBQUFDLE1BQUEsV0FDQUQsRUFBQUUsT0FBQUMsWUFBQSxLQUNBSCxFQUFBSSxTQUFBQyxZQUFBLGFBVkEsR0FBQS9XLElBQ0FHLFNBQUEsSUFDQXFXLEtBQUFKLEVBR0EsT0FBQXBXLEdBVkE3SCxRQUNBQyxPQUFBLE9BQ0E0SCxVQUFBLGdCQUFBeVcsTUNKQSxXQUNBLFlBS0EsU0FBQU8sS0FRQSxRQUFBWixHQUFBaFcsRUFBQWlXLEdBQ0FBLEVBQUFFLFNBQUEsYUFBQUYsRUFBQUUsU0FBQSxhQUNBVSxNQUFBQyxPQUFBYixHQUFBLGlCQUNBQSxFQUFBRSxTQUFBLGFBQ0FVLE1BQUFDLE9BQUFiLEdBQUEsZ0JBRUFZLE1BQUFDLE9BQUFiLEdBR0FZLE1BQUFFLE9BaEJBLEdBQUFuWCxJQUNBRyxTQUFBLElBQ0FxVyxLQUFBSixFQUdBLE9BQUFwVyxHQVZBN0gsUUFDQUMsT0FBQSxPQUNBNEgsVUFBQSxjQUFBZ1gsTUNKQSxXQUNBLFlBS0EsU0FBQUksS0FRQSxRQUFBaEIsR0FBQWhXLEVBQUFpVyxHQUNBLEdBQUEvTixHQUFBK04sRUFBQWdCLFdBQUFDLFFBQ0FDLEVBQUFsQixFQUFBUyxTQUFBUCxTQUFBLFdBQ0FqTyxHQUFBa1AsTUFBQSxXQUNBbkIsRUFBQW9CLFNBQUEsZ0JBR0FuUCxFQUFBb1AsS0FBQSxhQUNBSCxHQUFBQSxHQUFBLElBQUFqUCxFQUFBcVAsTUFBQTNaLFNBQ0FxWSxFQUFBdUIsWUFBQSxnQkFoQkEsR0FBQTVYLElBQ0FHLFNBQUEsSUFDQXFXLEtBQUFKLEVBR0EsT0FBQXBXLEdBVkE3SCxRQUNBQyxPQUFBLE9BQ0E0SCxVQUFBLFNBQUFvWCIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAndWkucm91dGVyJyxcbiAgJ3VpLmJvb3RzdHJhcCcsXG4gICduZ0FuaW1hdGUnLFxuICAnYW5ndWxhci1sb2FkaW5nLWJhcicsXG4gICdub3Vpc2xpZGVyJyxcbiAgJ2xvY2FseXRpY3MuZGlyZWN0aXZlcycsXG4gICd0aW1lcicsXG4gICdMb2NhbFN0b3JhZ2VNb2R1bGUnLFxuICAnYW5ndWxhci1zb3J0YWJsZS12aWV3JyxcbiAgJ2FuZ3VsYXIudmVydGlsaXplJyxcbiAgJ25nVGFibGUnXG5dKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCAnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29uZmlnKGNvbmZpZ3VyYXRpb24pO1xuXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyYXRpb24oJGh0dHBQcm92aWRlciwgJHVpYlRvb2x0aXBQcm92aWRlciwgJHFQcm92aWRlcikge1xuICAgIC8vaW5pdGlhbGl6ZSBnZXQgaWYgbm90IHRoZXJlXG4gICAgaWYgKCEkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0KSB7XG4gICAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0ID0ge307ICAgIFxuICAgIH0gICAgXG4gICAgLy9kaXNhYmxlIElFIGFqYXggcmVxdWVzdCBjYWNoaW5nXG4gICAgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldFsnSWYtTW9kaWZpZWQtU2luY2UnXSA9ICdGcmksIDAxIEphbiAyMDE2IDA1OjAwOjAwIEdNVCc7XG4gICAgLy8gZXh0cmFcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0WydDYWNoZS1Db250cm9sJ10gPSAnbm8tY2FjaGUnO1xuICAgICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXRbJ1ByYWdtYSddID0gJ25vLWNhY2hlJztcblxuICAgICR1aWJUb29sdGlwUHJvdmlkZXIub3B0aW9ucyh7IGFwcGVuZFRvQm9keTogdHJ1ZSB9KTtcbiAgICAkcVByb3ZpZGVyLmVycm9yT25VbmhhbmRsZWRSZWplY3Rpb25zKGZhbHNlKTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdBcHBDdHJsJywgQXBwQ3RybCk7XG5cbiAgZnVuY3Rpb24gQXBwQ3RybCgkc3RhdGUsIGxvY2FsU3RvcmFnZVNlcnZpY2UpIHtcbiAgICB2YXIgYXBwQ3RybCA9IHRoaXM7XG4gICAgLy8gVXNlIHRoaXMgZm9yIFNpZGViYXIgbWVudVxuICAgIGFwcEN0cmwuJHN0YXRlID0gJHN0YXRlO1xuICAgIC8vIExvY2sgdGhlIHNpZGViYXIgaW4gdmlld1xuICAgIGFwcEN0cmwubG9ja1NpZGViYXIgPSBsb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldCgnc2lkZWJhckxvY2tlZCcpO1xuICAgIGFwcEN0cmwudG9nZ2xlU2lkZWJhckxvY2tlZCA9IHRvZ2dsZVNpZGViYXJMb2NrZWQ7XG5cbiAgICBmdW5jdGlvbiB0b2dnbGVTaWRlYmFyTG9ja2VkKGxvY2tlZCkge1xuICAgICAgbG9jYWxTdG9yYWdlU2VydmljZS5zZXQoJ3NpZGViYXJMb2NrZWQnLCBsb2NrZWQpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb25maWcoY29uZmlndXJlUm91dGVzKTtcblxuICBmdW5jdGlvbiBjb25maWd1cmVSb3V0ZXMoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICB2YXIgcm91dGVSb2xlQ2hlY2tzID0ge1xuICAgICAgc3VwZXJBZG1pbjogcmVxdWlyZVN1cGVyQWRtaW4sXG4gICAgICBhZG1pbjogcmVxdWlyZUFkbWluLFxuICAgICAgdXNlcjogcmVxdWlyZUF1dGhcbiAgICB9O1xuXG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgLy8gZm9yIGFueSB1bm1hdGNoZWQgdXJsXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLndoZW4oJy9jb21wZXRpdGlvbnMvJywgJy9jb21wZXRpdGlvbnMnKTtcbiAgICAkdXJsUm91dGVyUHJvdmlkZXIud2hlbignL2FkbWluLycsICcvYWRtaW4nKTtcblxuICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAuc3RhdGUoJ2hvbWUnLCB7XG4gICAgICAgIHVybDogJy8nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tbW9uL3ZpZXdzL2hvbWUuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdjb21wZXRpdGlvbnMnLCB7XG4gICAgICAgIHVybDogJy9jb21wZXRpdGlvbnMnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0NvbXBldGl0aW9uc0N0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wZXRpdGlvbnMvdmlld3MvY29tcGV0aXRpb25zLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgnY29tcGV0aXRpb25zLm15Q29tcGV0aXRpb25zJywge1xuICAgICAgICB1cmw6ICcvbXktY29tcGV0aXRpb25zJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTXlDb21wZXRpdGlvbnNDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcGV0aXRpb25zL3ZpZXdzL215LWNvbXBldGl0aW9ucy5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIGF1dGg6IHJvdXRlUm9sZUNoZWNrcy51c2VyXG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdjb21wZXRpdGlvbnMudmlldycsIHtcbiAgICAgICAgdXJsOiAnL3ZpZXcvOmNvbXBldGl0aW9uSWQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDb21wZXRpdGlvbkN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wZXRpdGlvbnMvdmlld3MvY29tcGV0aXRpb24uaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdjb21wZXRpdGlvbnMuc3RhdHMnLCB7XG4gICAgICAgIHVybDogJy9zdGF0cy86Y29tcGV0aXRpb25JZCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0NvbXBldGl0aW9uU3RhdHNDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcGV0aXRpb25zL3ZpZXdzL2NvbXBldGl0aW9uLXN0YXRzLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgnY29tcGV0aXRpb25zLmFkbWluJywge1xuICAgICAgICB1cmw6ICcvYWRtaW4vOmNvbXBldGl0aW9uSWQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDb21wZXRpdGlvbkFkbWluQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbXBldGl0aW9ucy92aWV3cy9jb21wZXRpdGlvbi1hZG1pbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIGF1dGg6IHJvdXRlUm9sZUNoZWNrcy51c2VyXG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdjb21wZXRpdGlvbnMuY3JlYXRlJywge1xuICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQ3JlYXRlQ29tcGV0aXRpb25DdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcGV0aXRpb25zL3ZpZXdzL2NyZWF0ZS1jb21wZXRpdGlvbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIGF1dGg6IHJvdXRlUm9sZUNoZWNrcy51c2VyXG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCd1c2VyJywge1xuICAgICAgICB1cmw6ICcvdXNlcicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVXNlckN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd1c2Vycy92aWV3cy91c2VyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0xvZ2luQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL2xvZ2luLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncmVnaXN0ZXInLCB7XG4gICAgICAgIHVybDogJy9yZWdpc3RlcicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvcmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCd2ZXJpZnknLCB7XG4gICAgICAgIHVybDogJy92ZXJpZmljYXRpb24nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZlcmlmaWNhdGlvbkN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy92ZXJpZmljYXRpb24uaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCd2ZXJpZmljYXRpb24nLCB7XG4gICAgICAgIHVybDogJy92ZXJpZmljYXRpb24vOnVzZXJJZC86dmVyaWZpY2F0aW9uVG9rZW4nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZlcmlmaWNhdGlvbkN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy92ZXJpZmljYXRpb24uaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdwYXNzd29yZC1yZXNldC1yZXF1ZXN0Jywge1xuICAgICAgICB1cmw6ICcvcGFzc3dvcmQtcmVzZXQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bhc3N3b3JkUmVzZXRDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvcGFzc3dvcmQtcmVzZXQuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdwYXNzd29yZC1yZXNldCcsIHtcbiAgICAgICAgdXJsOiAnL3Bhc3N3b3JkLXJlc2V0Lzp1c2VySWQvOnZlcmlmaWNhdGlvblRva2VuJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQYXNzd29yZFJlc2V0Q3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3Bhc3N3b3JkLXJlc2V0Lmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgnYWRtaW4nLCB7XG4gICAgICAgIHVybDogJy9hZG1pbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvbG9naW4uaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdhZG1pbi51c2VycycsIHtcbiAgICAgICAgdXJsOiAnL3VzZXJzJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnRWRpdFVzZXJBZG1pbkN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYWRtaW4vdmlld3MvZWRpdC11c2VyLWFkbWluLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnN1cGVyQWRtaW5cbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cblxuICByZXF1aXJlQWRtaW4uJGluamVjdCA9IFsnYXV0aFNlcnZpY2UnXTtcblxuICBmdW5jdGlvbiByZXF1aXJlQWRtaW4oYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSgnYWRtaW4nKTtcbiAgfVxuXG4gIHJlcXVpcmVTdXBlckFkbWluLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZVN1cGVyQWRtaW4oYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSgnc3VwZXItYWRtaW4nKTtcbiAgfVxuXG4gIHJlcXVpcmVBdXRoLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZUF1dGgoYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4gYXV0aFNlcnZpY2UuYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLnJ1bihhcHBSdW4pO1xuXG4gIGZ1bmN0aW9uIGFwcFJ1bigkcm9vdFNjb3BlLCAkc3RhdGUsICRkb2N1bWVudCwgc2lkZWJhclNlcnZpY2UpIHtcbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlRXJyb3InLCBmdW5jdGlvbiAoZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMsIGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgPT09ICdub3QgYXV0aG9yaXplZCcpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgICAkc3RhdGUucHJldmlvdXMgPSB0b1N0YXRlO1xuICAgICAgICAkc3RhdGUucHJldlBhcmFtcyA9IHRvUGFyYW1zO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKCkge1xuICAgICAgc2lkZWJhclNlcnZpY2Uuc2V0U2lkZWJhclN0YXR1cyhmYWxzZSk7XG4gICAgICAvLyBTY3JvbGwgdG8gdGhlIHRvcCBvbiByb3V0ZSBjaGFuZ2VzXG4gICAgICAkZG9jdW1lbnRbMF0uYm9keS5zY3JvbGxUb3AgPSAkZG9jdW1lbnRbMF0uZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IDA7XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignRWRpdFVzZXJBZG1pbkN0cmwnLCBFZGl0VXNlckFkbWluQ3RybCk7XG5cbiAgZnVuY3Rpb24gRWRpdFVzZXJBZG1pbkN0cmwoaWRlbnRpdHlTZXJ2aWNlLCB1c2VyU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciBvcmlnaW5hbFVzZXJzID0gW107XG4gICAgdmFyIG9yZ2luYWxTZWxlY3RlZFVzZXIgPSBudWxsO1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0udXNlcnMgPSAgbnVsbDtcbiAgICB2bS5zZWxlY3RlZFVzZXIgPSBudWxsO1xuICAgIHZtLnNlbGVjdFVzZXIgPSBzZWxlY3RVc2VyO1xuICAgIHZtLnVwZGF0ZVVzZXIgPSB1cGRhdGVVc2VyO1xuICAgIHZtLnVzZXJGb3JtID0ge307XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICByZWZyZXNoVXNlckxpc3QoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWZyZXNoVXNlckxpc3QoKSB7XG4gICAgICB1c2VyU2VydmljZS5nZXRBbGxVc2VycygpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIHZtLnVzZXJzID0gdXNlcnMuZGF0YTtcbiAgICAgICAgb3JpZ2luYWxVc2VycyA9IF8uY2xvbmVEZWVwKHZtLnVzZXJzKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlbGVjdFVzZXIodXNlcikge1xuICAgICAgdm0uc2VsZWN0ZWRVc2VyID0gdXNlcjtcbiAgICAgIG9yZ2luYWxTZWxlY3RlZFVzZXIgPSBfLmNsb25lRGVlcCh1c2VyKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVVc2VyICh1c2VyKSB7XG4gICAgICAvLyBQcmV2ZW50IG11bHRpcGxlIHBlb3BsZSBmcm9tIGhhdmluZyB0aGUgc2FtZSBkaXNwbGF5IG5hbWVcbiAgICAgIHZhciBkaXNwbGF5TmFtZXMgPSBbXTtcbiAgICAgIF8uZm9yRWFjaChvcmlnaW5hbFVzZXJzLCBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICBkaXNwbGF5TmFtZXMucHVzaCh1c2VyLmRpc3BsYXlOYW1lLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgfSk7XG5cbiAgICAgIGlmICh1c2VyLmZpcnN0TmFtZS5sZW5ndGggPCAxIHx8IHVzZXIubGFzdE5hbWUubGVuZ3RoIDwgMSB8fCB1c2VyLmRpc3BsYXlOYW1lLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignRG9uXFwndCBsZWF2ZSBuYW1lcyBibGFuayEgIEhvdyB3aWxsIHBlb3BsZSBrbm93IHdobyB5b3UgYXJlPycpO1xuICAgICAgfSBlbHNlIGlmICh1c2VyLmRpc3BsYXlOYW1lICE9PSBvcmdpbmFsU2VsZWN0ZWRVc2VyLmRpc3BsYXlOYW1lICYmIF8uaW5kZXhPZihkaXNwbGF5TmFtZXMsIHVzZXIuZGlzcGxheU5hbWUudG9Mb3dlckNhc2UoKSkgPiAtMSkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdTb3JyeSwgc29tZW9uZSBlbHNlIGlzIGFscmVhZHkgdXNpbmcgdGhhdCBkaXNwbGF5IG5hbWUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciB1c2VyVXBkYXRlcyA9IHtcbiAgICAgICAgICBfaWQ6IHVzZXIuX2lkLFxuICAgICAgICAgIGZpcnN0TmFtZTogdXNlci5maXJzdE5hbWUsXG4gICAgICAgICAgbGFzdE5hbWU6IHVzZXIubGFzdE5hbWUsXG4gICAgICAgICAgZGlzcGxheU5hbWU6IHVzZXIuZGlzcGxheU5hbWVcbiAgICAgICAgfTtcbiAgICAgICAgdXNlclNlcnZpY2UudXBkYXRlVXNlcih1c2VyVXBkYXRlcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS5zdWNjZXNzKCdVc2VyIGluZm9ybWF0aW9uIGhhcyBiZWVuIHVwZGF0ZWQnKTtcbiAgICAgICAgICBzZWxlY3RVc2VyKCk7XG4gICAgICAgICAgcmVmcmVzaFVzZXJMaXN0KCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBMb2dpbkN0cmwpO1xuXG4gIGZ1bmN0aW9uIExvZ2luQ3RybCgkc3RhdGUsIGF1dGhTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5sb2dpbiA9IGxvZ2luO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgYXV0aFNlcnZpY2UuYXV0aGVudGljYXRlVXNlcih1c2VybmFtZSwgcGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdVc2VybmFtZSAvIHBhc3N3b3JkIGNvbWJpbmFpdG9uIGluY29ycmVjdCcpO1xuICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlID09PSAndW52ZXJpZmllZCcpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdZb3UgbXVzdCB2ZXJpZnkgeW91ciBlbWFpbCBiZWZvcmUgeW91IGNhbiBsb2dpbicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICgkc3RhdGUucHJldmlvdXMpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygkc3RhdGUucHJldmlvdXMsICRzdGF0ZS5wcmV2UGFyYW1zKTtcbiAgICAgICAgICAgICRzdGF0ZS5wcmV2aW91cyA9IG51bGw7XG4gICAgICAgICAgICAkc3RhdGUucHJldlBhcmFtcyA9IG51bGw7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnY29tcGV0aXRpb25zLm15Q29tcGV0aXRpb25zJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUGFzc3dvcmRSZXNldEN0cmwnLCBQYXNzd29yZFJlc2V0Q3RybCk7XG5cbiAgZnVuY3Rpb24gUGFzc3dvcmRSZXNldEN0cmwoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIHVzZXJTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlLCBhdXRoU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS51c2VybmFtZSA9ICcnO1xuICAgIHZtLnZlcmlmaWVkID0gZmFsc2U7XG4gICAgdm0ucmVzZXRQYXNzd29yZEZvcm0gPSB7fTtcbiAgICB2bS5nZW5lcmF0ZVBhc3N3b3JkUmVzZXRMaW5rID0gZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluaztcbiAgICB2bS5yZXNldFBhc3N3b3JkID0gcmVzZXRQYXNzd29yZDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICB9IGVsc2UgaWYgKCRzdGF0ZVBhcmFtcy51c2VySWQgJiYgJHN0YXRlUGFyYW1zLnZlcmlmaWNhdGlvblRva2VuKSB7XG4gICAgICAgIHVzZXJTZXJ2aWNlLnZlcmlmeVVzZXIoJHN0YXRlUGFyYW1zLnVzZXJJZCwgJHN0YXRlUGFyYW1zLnZlcmlmaWNhdGlvblRva2VuKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgICB2bS52ZXJpZmllZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZW5lcmF0ZVBhc3N3b3JkUmVzZXRMaW5rKHVzZXJuYW1lKSB7XG4gICAgICB1c2VyU2VydmljZS5nZW5lcmF0ZVBhc3N3b3JkUmVzZXRMaW5rKHVzZXJuYW1lKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAoIXJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdDb3VsZCBub3QgZmluZCB0aGF0IGVtYWlsIGFkZHJlc3MnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLnN1Y2Nlc3MoJ1BsZWFzZSBjaGVjayB5b3VyIGVtYWlsIGZvciBhIHBhc3N3b3JkIHJlc2V0IGxpbmsnKTtcbiAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVzZXRQYXNzd29yZChyZXNldFBhc3N3b3JkRm9ybSkge1xuICAgICAgaWYgKHJlc2V0UGFzc3dvcmRGb3JtLnBhc3N3b3JkICE9PSByZXNldFBhc3N3b3JkRm9ybS5jb25maXJtUGFzc3dvcmQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignUGFzc3dvcmRzIGRvblxcJ3QgbWF0Y2ghJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1c2VyU2VydmljZS5yZXNldFBhc3N3b3JkKCRzdGF0ZVBhcmFtcy51c2VySWQsICRzdGF0ZVBhcmFtcy52ZXJpZmljYXRpb25Ub2tlbiwgcmVzZXRQYXNzd29yZEZvcm0ucGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlLmF1dGhlbnRpY2F0ZVVzZXIocmVzcG9uc2UuZGF0YS51c2VybmFtZSwgcmVzZXRQYXNzd29yZEZvcm0ucGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJywgUmVnaXN0ZXJDdHJsKTtcblxuICBmdW5jdGlvbiBSZWdpc3RlckN0cmwoJHN0YXRlLCBhdXRoU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucmVnaXN0ZXIgPSByZWdpc3RlcjtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHt9XG5cbiAgICBmdW5jdGlvbiByZWdpc3RlcihuZXdVc2VyKSB7XG4gICAgICBpZiAobmV3VXNlci5wYXNzd29yZCAhPT0gbmV3VXNlci5jb25maXJtUGFzc3dvcmQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignUGFzc3dvcmRzIGRvblxcJ3QgbWF0Y2ghJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIW5ld1VzZXIuZGlzcGxheU5hbWUpIHtcbiAgICAgICAgICBuZXdVc2VyLmRpc3BsYXlOYW1lID0gbmV3VXNlci5maXJzdE5hbWUgKyAnICcgKyBuZXdVc2VyLmxhc3ROYW1lO1xuICAgICAgICB9XG4gICAgICAgIGF1dGhTZXJ2aWNlLmNyZWF0ZVVzZXIobmV3VXNlcikudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJHN0YXRlLmdvKCd2ZXJpZnknKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1ZlcmlmaWNhdGlvbkN0cmwnLCBWZXJpZmljYXRpb25DdHJsKTtcblxuICBmdW5jdGlvbiBWZXJpZmljYXRpb25DdHJsKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCB1c2VyU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0udmVyaWZpZWQgPSB1bmRlZmluZWQ7XG4gICAgdm0udmVyaWZ5aW5nID0gZmFsc2U7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBpZiAoJHN0YXRlUGFyYW1zLnVzZXJJZCAmJiAkc3RhdGVQYXJhbXMudmVyaWZpY2F0aW9uVG9rZW4pIHtcbiAgICAgICAgdm0udmVyaWZ5aW5nID0gdHJ1ZTtcbiAgICAgICAgdm0udmVyaWZpZWQgPSBudWxsO1xuICAgICAgICB1c2VyU2VydmljZS52ZXJpZnlVc2VyKCRzdGF0ZVBhcmFtcy51c2VySWQsICRzdGF0ZVBhcmFtcy52ZXJpZmljYXRpb25Ub2tlbikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAgICAgdm0udmVyaWZpZWQgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2bS52ZXJpZmllZCA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCd3cG1BY3RpdmVDaGFsbGVuZWdlcycsIHdwbUFjdGl2ZUNoYWxsZW5lZ2VzKTtcblxuICBmdW5jdGlvbiB3cG1BY3RpdmVDaGFsbGVuZWdlcygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGNvbXBldGl0aW9uOiAnPScsXG4gICAgICAgIGFsbG93RGVsZXRlOiAnPScsXG4gICAgICAgIG51bWJlck9mQ2hhbGxlbmdlczogJ0AnLFxuICAgICAgICBjaGFsbGVuZ2VzUGVyUGFnZTogJ0AnXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY2hhbGxlbmdlcy9jb21wb25lbnRzL2FjdGl2ZS1jaGFsbGVuZ2VzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKCRzY29wZSwgY2hhbGxlbmdlc1NlcnZpY2UsIG5nVGFibGVQYXJhbXMpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNoYWxsZW5nZXMgPSBudWxsO1xuICAgIHZtLmRlbGV0ZUNoYWxsZW5nZSA9IGRlbGV0ZUNoYWxsZW5nZTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICRzY29wZS4kd2F0Y2goJ3ZtLmNvbXBldGl0aW9uJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodm0uY29tcGV0aXRpb24pIHtcbiAgICAgICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZXMoKSB7XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbi5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZXMpIHtcbiAgICAgICAgdm0uY2hhbGxlbmdlcyA9IGNoYWxsZW5nZXMuZGF0YTsgXG4gICAgICAgIGlmIChjaGFsbGVuZ2VzLmRhdGEubGVuZ3RoID4gMCkge1xuXG4gICAgICAgICAgLy9EYXRhIFRhYmxlIGluZm9cbiAgICAgICAgICB2bS50YWJsZURhdGEgPSBuZXcgbmdUYWJsZVBhcmFtcyh7XG4gICAgICAgICAgICBwYWdlOiAxLCAvLyBzaG93IGZpcnN0IHBhZ2VcbiAgICAgICAgICAgIGNvdW50OiB2bS5jaGFsbGVuZ2VzUGVyUGFnZSB8fCA1IC8vIGNvdW50IHBlciBwYWdlXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgY291bnRzOiBbXSwgLy8gaGlkZXMgcGFnZSBzaXplc1xuICAgICAgICAgICAgdG90YWw6IHZtLmNoYWxsZW5nZXMubGVuZ3RoLCAvLyBsZW5ndGggb2YgZGF0YVxuICAgICAgICAgICAgZ2V0RGF0YTogZnVuY3Rpb24gKCRkZWZlciwgcGFyYW1zKSB7XG4gICAgICAgICAgICAgICRkZWZlci5yZXNvbHZlKHZtLmNoYWxsZW5nZXMuc2xpY2UoKHBhcmFtcy5wYWdlKCkgLSAxKSAqIHBhcmFtcy5jb3VudCgpLCBwYXJhbXMucGFnZSgpICogcGFyYW1zLmNvdW50KCkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgIFxuICAgICAgICAgIF8uZm9yRWFjaCh2bS5jaGFsbGVuZ2VzLCBmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgICAgICBpZiAoY2hhbGxlbmdlLnR5cGUgPT09ICd2ZXJzdXMnKSB7XG4gICAgICAgICAgICAgIC8vIElmIG1vcmUgdGhhbiAxIHBsYXllciBwZXIgdGVhbSB0aGFuIHVzZSBUZWFtIG5hbWVcbiAgICAgICAgICAgICAgaWYgKHZtLmNvbXBldGl0aW9uLnBsYXllcnMubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgICAgIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLmRpc3BsYXlOYW1lID0gJ1RlYW0gJyArIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLnRlYW07XG4gICAgICAgICAgICAgICAgY2hhbGxlbmdlLm9wcG9uZW50LmRpc3BsYXlOYW1lID0gJ1RlYW0gJyArIGNoYWxsZW5nZS5vcHBvbmVudC50ZWFtO1xuICAgICAgICAgICAgICAvLyBJZiBvbmx5IDEgcGxheWVyIHBlciB0ZWFtIHRoYW4ganVzdCB1c2UgdGhlIHBsYXllcnMgbmFtZXNcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGFsbGVuZ2UuY2hhbGxlbmdlci5kaXNwbGF5TmFtZSA9IF8uZmluZCh2bS5jb21wZXRpdGlvbi5wbGF5ZXJzLCB7ICdwb3NpdGlvbic6ICBjaGFsbGVuZ2UuY2hhbGxlbmdlci50ZWFtfSkuZGlzcGxheU5hbWU7XG4gICAgICAgICAgICAgICAgY2hhbGxlbmdlLm9wcG9uZW50LmRpc3BsYXlOYW1lID0gXy5maW5kKHZtLmNvbXBldGl0aW9uLnBsYXllcnMsIHsgJ3Bvc2l0aW9uJzogIGNoYWxsZW5nZS5vcHBvbmVudC50ZWFtfSkuZGlzcGxheU5hbWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjaGFsbGVuZ2UudGltZUxpbWl0ICE9PSAwKSB7XG4gICAgICAgICAgICAgIHZhciB0aW1lVG9FeHBpcmUgPSBtb21lbnQoKS5kaWZmKG1vbWVudChjaGFsbGVuZ2UuY3JlYXRlZCkuYWRkKGNoYWxsZW5nZS50aW1lTGltaXQsICdkJykpICogLTE7XG4gICAgICAgICAgICAgIGNoYWxsZW5nZS5leHBpcmVzID0gbW9tZW50LmR1cmF0aW9uKHRpbWVUb0V4cGlyZSkuYXNIb3VycygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlSWQsICRpbmRleCkge1xuICAgICAgc3dhbCh7XG4gICAgICAgIHRpdGxlOiAnRGVsZXRlIENoYWxsZW5nZSBSZXN1bHQ/JyxcbiAgICAgICAgdGV4dDogJ0l0XFwnbGwgYmUgbGlrZSBpdCBuZXZlciBoYXBwZW5lZCcsXG4gICAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnRGVsZXRlJyxcbiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ05ldmVybWluZCcsXG4gICAgICAgIGNsb3NlT25Db25maXJtOiB0cnVlLFxuICAgICAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlXG4gICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmRlbGV0ZUNoYWxsZW5nZSh2bS5jb21wZXRpdGlvbi5faWQsIGNoYWxsZW5nZUlkKS50aGVuIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdm0uY2hhbGxlbmdlcy5zcGxpY2UoJGluZGV4LCAxKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ3dwbUNvbXBsZXRlZENoYWxsZW5lZ2VzJywgd3BtQ29tcGxldGVkQ2hhbGxlbmVnZXMpO1xuXG4gIGZ1bmN0aW9uIHdwbUNvbXBsZXRlZENoYWxsZW5lZ2VzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb246ICc9JyxcbiAgICAgICAgYWxsb3dEZWxldGU6ICc9JyxcbiAgICAgICAgbnVtYmVyT2ZDaGFsbGVuZ2VzOiAnQCcsXG4gICAgICAgIGNoYWxsZW5nZXNQZXJQYWdlOiAnQCdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jaGFsbGVuZ2VzL2NvbXBvbmVudHMvY29tcGxldGVkLWNoYWxsZW5nZXMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCAkc3RhdGUsIGNoYWxsZW5nZXNTZXJ2aWNlLCBuZ1RhYmxlUGFyYW1zKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jaGFsbGVuZ2VzID0gbnVsbDtcbiAgICB2bS5kZWxldGVDaGFsbGVuZ2UgPSBkZWxldGVDaGFsbGVuZ2U7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAkc2NvcGUuJHdhdGNoKCd2bS5jb21wZXRpdGlvbicsIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodm0uY29tcGV0aXRpb24pIHtcbiAgICAgICAgICBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENvbXBsZXRlZENoYWxsZW5nZXMoKSB7XG4gICAgICAvLyBHZXQgY29tcGxldGVkIGNoYWxsZW5nZXMgaW4gdGhpcyBjb21wZXRpdGlvblxuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24odm0uY29tcGV0aXRpb24uX2lkLCB2bS5udW1iZXJPZkNoYWxsZW5nZXMpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZXMpIHtcbiAgICAgICAgdm0uY2hhbGxlbmdlcyA9IGNoYWxsZW5nZXMuZGF0YTtcbiAgICAgICAgaWYgKGNoYWxsZW5nZXMuZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgIFxuICAgICAgICAgIC8vRGF0YSBUYWJsZSBpbmZvXG4gICAgICAgICAgdm0udGFibGVEYXRhID0gbmV3IG5nVGFibGVQYXJhbXMoe1xuICAgICAgICAgICAgcGFnZTogMSwgLy8gc2hvdyBmaXJzdCBwYWdlXG4gICAgICAgICAgICBjb3VudDogdm0uY2hhbGxlbmdlc1BlclBhZ2UgfHwgNSAvLyBjb3VudCBwZXIgcGFnZVxuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGNvdW50czogW10sIC8vIGhpZGVzIHBhZ2Ugc2l6ZXNcbiAgICAgICAgICAgIHRvdGFsOiB2bS5jaGFsbGVuZ2VzLmxlbmd0aCwgLy8gbGVuZ3RoIG9mIGRhdGFcbiAgICAgICAgICAgIGdldERhdGE6IGZ1bmN0aW9uICgkZGVmZXIsIHBhcmFtcykge1xuICAgICAgICAgICAgICAkZGVmZXIucmVzb2x2ZSh2bS5jaGFsbGVuZ2VzLnNsaWNlKChwYXJhbXMucGFnZSgpIC0gMSkgKiBwYXJhbXMuY291bnQoKSwgcGFyYW1zLnBhZ2UoKSAqIHBhcmFtcy5jb3VudCgpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBfLmZvckVhY2godm0uY2hhbGxlbmdlcywgZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmxvc2VyID0gY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInID8gJ29wcG9uZW50JyA6ICdjaGFsbGVuZ2VyJztcbiAgICAgICAgICAgIGlmIChjaGFsbGVuZ2UudHlwZSA9PT0gJ3ZlcnN1cycpIHtcbiAgICAgICAgICAgICAgLy8gSWYgbW9yZSB0aGFuIDEgcGxheWVyIHBlciB0ZWFtIHRoYW4gdXNlIFRlYW0gbmFtZVxuICAgICAgICAgICAgICBpZiAodm0uY29tcGV0aXRpb24ucGxheWVycy5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICAgICAgY2hhbGxlbmdlLmNoYWxsZW5nZXIuZGlzcGxheU5hbWUgPSAnVGVhbSAnICsgY2hhbGxlbmdlLmNoYWxsZW5nZXIudGVhbTtcbiAgICAgICAgICAgICAgICBjaGFsbGVuZ2Uub3Bwb25lbnQuZGlzcGxheU5hbWUgPSAnVGVhbSAnICsgY2hhbGxlbmdlLm9wcG9uZW50LnRlYW07XG4gICAgICAgICAgICAgIC8vIElmIG9ubHkgMSBwbGF5ZXIgcGVyIHRlYW0gdGhhbiBqdXN0IHVzZSB0aGUgcGxheWVycyBuYW1lc1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLmRpc3BsYXlOYW1lID0gXy5maW5kKHZtLmNvbXBldGl0aW9uLnBsYXllcnMsIHsgJ3Bvc2l0aW9uJzogIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLnRlYW19KS5kaXNwbGF5TmFtZTtcbiAgICAgICAgICAgICAgICBjaGFsbGVuZ2Uub3Bwb25lbnQuZGlzcGxheU5hbWUgPSBfLmZpbmQodm0uY29tcGV0aXRpb24ucGxheWVycywgeyAncG9zaXRpb24nOiAgY2hhbGxlbmdlLm9wcG9uZW50LnRlYW19KS5kaXNwbGF5TmFtZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hhbGxlbmdlLndoZW5Db21wbGV0ZWQgPSBtb21lbnQoY2hhbGxlbmdlLmNvbXBsZXRlZCkuY2FsZW5kYXIobnVsbCwge1xuICAgICAgICAgICAgICBzYW1lRGF5OiAnW1RvZGF5XScsXG4gICAgICAgICAgICAgIG5leHREYXk6ICdbVG9tb3Jyb3ddJyxcbiAgICAgICAgICAgICAgbmV4dFdlZWs6ICdkZGRkJyxcbiAgICAgICAgICAgICAgbGFzdERheTogJ1tZZXN0ZXJkYXldJyxcbiAgICAgICAgICAgICAgbGFzdFdlZWs6ICdbTGFzdF0gZGRkZCcsXG4gICAgICAgICAgICAgIHNhbWVFbHNlOiAnTU1NIERELCBZWVlZJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbGV0ZUNoYWxsZW5nZShjaGFsbGVuZ2VJZCwgJGluZGV4KSB7XG4gICAgICBzd2FsKHtcbiAgICAgICAgdGl0bGU6ICdEZWxldGUgQ2hhbGxlbmdlIFJlc3VsdD8nLFxuICAgICAgICB0ZXh0OiAnWW91XFwnbGwgc3RpbGwgbmVlZCB0byByZW9yZGVyIHRoZSBwbGF5ZXJzIG9uIHlvdXIgb3duJyxcbiAgICAgICAgdHlwZTogJ2Vycm9yJyxcbiAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICdEZWxldGUnLFxuICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAnTmV2ZXJtaW5kJyxcbiAgICAgICAgY2xvc2VPbkNvbmZpcm06IHRydWUsXG4gICAgICAgIGNsb3NlT25DYW5jZWw6IHRydWVcbiAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZGVsZXRlQ2hhbGxlbmdlKHZtLmNvbXBldGl0aW9uLl9pZCwgY2hhbGxlbmdlSWQpLnRoZW4gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2bS5jaGFsbGVuZ2VzLnNwbGljZSgkaW5kZXgsIDEpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnd3BtUGxheWVyT3ZlcmFsbFJlc3VsdHMnLCB3cG1QbGF5ZXJPdmVyYWxsUmVzdWx0cyk7XG5cbiAgZnVuY3Rpb24gd3BtUGxheWVyT3ZlcmFsbFJlc3VsdHMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBwbGF5ZXI6ICc9J1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NoYWxsZW5nZXMvY29tcG9uZW50cy9wbGF5ZXItb3ZlcmFsbC1yZXN1bHRzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKCRzY29wZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubWF4TGV2ZWxzID0gNztcbiAgICB2bS53aW5zID0ge1xuICAgICAgdG90YWw6IDAsXG4gICAgICBhc0NoYWxsZW5nZXI6IDAsXG4gICAgICBhc09wcG9uZW50OiAwLFxuICAgICAgYnlGb3JmZWl0OiAwXG4gICAgfTtcbiAgICB2bS5sb3NlcyA9IHtcbiAgICAgIHRvdGFsOiAwLFxuICAgICAgYXNDaGFsbGVuZ2VyOiAwLFxuICAgICAgYXNPcHBvbmVudDogMCxcbiAgICAgIGJ5Rm9yZmVpdDogMFxuICAgIH07XG4gICAgdm0uc3RyZWFrID0ge1xuICAgICAgdHlwZTogbnVsbCxcbiAgICAgIHZhbHVlOiAwXG4gICAgfTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICRzY29wZS4kd2F0Y2goJ3ZtLnBsYXllci5yZXN1bHRzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodm0ucGxheWVyKSB7XG4gICAgICAgICAgYXNzaWducGxheWVyc1RvTGV2ZWxzKHZtLnBsYXllcik7XG4gICAgICAgICAgY2FsY3VsYXRlU3RyZWFrKHZtLnBsYXllcik7XG4gICAgICAgICAgY2FsY3VhdGVXaW5BbmRMb3Nlcyh2bS5wbGF5ZXIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhc3NpZ25wbGF5ZXJzVG9MZXZlbHMocGxheWVyKSB7XG4gICAgICAvLyBEZXRlcm1pbmUgYWxsIHRoZSBicmVhayBwb2ludHMgdG8gZmlndXJlIG91dCBsZXZlbHNcbiAgICAgIHZhciBicmVha1BvaW50cyA9IFtdO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2bS5tYXhMZXZlbHM7IGkrKykge1xuICAgICAgICBicmVha1BvaW50cy5wdXNoKCgoKGkgKiAoaSArIDEpKSAvIDIpKSArIDEpO1xuICAgICAgfVxuXG4gICAgICAvLyBEZWZhdWx0IGFsbCBwbGF5ZXJzIHRvIHRoZSBsb3dlc3QgbGV2ZWxcbiAgICAgIHBsYXllci5sZXZlbCA9IGJyZWFrUG9pbnRzLmxlbmd0aDtcbiAgICAgIC8vIE5vdyBjaGVjayB0byBzZWUgaWYgdGhlIHBsYXllciBpcyBhdCBhIGhpZ2hlciBsZXZlbFxuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBicmVha1BvaW50cy5sZW5ndGg7IGorKykge1xuICAgICAgICBpZiAocGxheWVyLnBvc2l0aW9uIDwgYnJlYWtQb2ludHNbaiArIDFdKSB7XG4gICAgICAgICAgcGxheWVyLmxldmVsID0gYnJlYWtQb2ludHMuaW5kZXhPZihicmVha1BvaW50c1tqXSkgKyAxO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlU3RyZWFrKHBsYXllcikge1xuICAgICAgLy8gRmlndXJlIG91dCB0aGUgcGxheWVyJ3MgY3VycmVudCBzdHJlYWtcbiAgICAgIHZhciBzdHJlYWsgPSAwO1xuICAgICAgdmFyIGNvbnRpbnVlU3RyZWFrID0gdHJ1ZTtcbiAgICAgIHZhciBzdHJlYWtUeXBlO1xuICAgICAgXy5mb3JFYWNoKHBsYXllci5yZXN1bHRzLCBmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgIGlmIChjb250aW51ZVN0cmVhaykge1xuICAgICAgICAgIC8vIFdpbm5pbmcgU3RyZWFrXG4gICAgICAgICAgaWYgKChjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcicgJiYgY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkID09PSBwbGF5ZXIuX2lkKSB8fFxuICAgICAgICAgICAgKGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCcgJiYgY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVyLl9pZCkpIHtcbiAgICAgICAgICAgIC8vIElmIHRoZXkgYXJlIG5vdCBhbHJlYWR5IG9uIGEgbG9zaW5nIHN0cmVhayBhbmQgMSB0byB0aGVpciB3aW5uaW5nIHN0cmVha1xuICAgICAgICAgICAgaWYgKHN0cmVha1R5cGUgIT09ICdsb3NpbmcnKSB7XG4gICAgICAgICAgICAgIHN0cmVhayArPSAxO1xuICAgICAgICAgICAgICBzdHJlYWtUeXBlID0gJ3dpbm5pbmcnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29udGludWVTdHJlYWsgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAvLyBMb3NpbmcgU3RyZWFrXG4gICAgICAgICAgfSBlbHNlIGlmICgoY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50JyAmJiBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllci5faWQpIHx8XG4gICAgICAgICAgICAoY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInICYmIGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllci5faWQpKSB7XG4gICAgICAgICAgICAvLyBJZiB0aGV5IGFyZSBub3QgYWxyZWFkeSBvbiBhIHdpbm5pbmcgc3RyZWFrIGFuZCAxIHRvIHRoZWlyIGxvc2luZyBzdHJlYWtcbiAgICAgICAgICAgIGlmIChzdHJlYWtUeXBlICE9PSAnd2lubmluZycpIHtcbiAgICAgICAgICAgICAgc3RyZWFrICs9IDE7XG4gICAgICAgICAgICAgIHN0cmVha1R5cGUgPSAnbG9zaW5nJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlU3RyZWFrID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZtLnN0cmVhayA9IHtcbiAgICAgICAgICB0eXBlOiBzdHJlYWtUeXBlLFxuICAgICAgICAgIHZhbHVlOiBzdHJlYWtcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbGN1YXRlV2luQW5kTG9zZXMocGxheWVyKSB7XG4gICAgICAvLyBGaWd1cmUgb3V0IHdpbnMgYW5kIGxvc2VzXG4gICAgICB2bS53aW5zLmFzT3Bwb25lbnQgPSBfLnNpemUoXy5maWx0ZXIocGxheWVyLnJlc3VsdHMsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkID09PSBwbGF5ZXIuX2lkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCdcbiAgICAgICAgKTtcbiAgICAgIH0pKTtcblxuICAgICAgdm0ud2lucy5hc0NoYWxsZW5nZXIgPSBfLnNpemUoXy5maWx0ZXIocGxheWVyLnJlc3VsdHMsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllci5faWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInXG4gICAgICAgICk7XG4gICAgICB9KSk7XG5cbiAgICAgIHZtLndpbnMudG90YWwgPSB2bS53aW5zLmFzQ2hhbGxlbmdlciArIHZtLndpbnMuYXNPcHBvbmVudDtcblxuICAgICAgdm0ud2lucy5ieUZvcmZlaXQgPSBfLnNpemUoXy5maWx0ZXIocGxheWVyLnJlc3VsdHMsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICBjaGFsbGVuZ2UuZm9yZmVpdCAmJiAoKGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVyLl9pZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcicpIHx8XG4gICAgICAgICAgKGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllci5faWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50JykpXG4gICAgICAgICk7XG4gICAgICB9KSk7XG5cbiAgICAgIHZtLmxvc2VzLmFzT3Bwb25lbnQgPSBfLnNpemUoXy5maWx0ZXIocGxheWVyLnJlc3VsdHMsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkID09PSBwbGF5ZXIuX2lkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJ1xuICAgICAgICApO1xuICAgICAgfSkpO1xuXG4gICAgICB2bS5sb3Nlcy5hc0NoYWxsZW5nZXIgPSBfLnNpemUoXy5maWx0ZXIocGxheWVyLnJlc3VsdHMsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllci5faWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50J1xuICAgICAgICApO1xuICAgICAgfSkpO1xuXG4gICAgICB2bS5sb3Nlcy50b3RhbCA9IHZtLmxvc2VzLmFzQ2hhbGxlbmdlciArIHZtLmxvc2VzLmFzT3Bwb25lbnQ7XG5cbiAgICAgIHZtLmxvc2VzLmJ5Rm9yZmVpdCA9IF8uc2l6ZShfLmZpbHRlcihwbGF5ZXIucmVzdWx0cywgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIGNoYWxsZW5nZS5mb3JmZWl0ICYmICgoY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkID09PSBwbGF5ZXIuX2lkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCcpIHx8XG4gICAgICAgICAgKGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllci5faWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInKSlcbiAgICAgICAgKTtcbiAgICAgIH0pKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ3dwbVRlYW1PdmVyYWxsUmVzdWx0cycsIHdwbVRlYW1PdmVyYWxsUmVzdWx0cyk7XG5cbiAgZnVuY3Rpb24gd3BtVGVhbU92ZXJhbGxSZXN1bHRzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb246ICc9JyxcbiAgICAgICAgdGVhbTogJz0nLFxuICAgICAgICBjaGFsbGVuZ2VzOiAnPSdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jaGFsbGVuZ2VzL2NvbXBvbmVudHMvdGVhbS1vdmVyYWxsLXJlc3VsdHMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS53aW5zID0ge1xuICAgICAgdG90YWw6IDAsXG4gICAgICBhc0NoYWxsZW5nZXI6IDAsXG4gICAgICBhc09wcG9uZW50OiAwLFxuICAgICAgYnlGb3JmZWl0OiAwXG4gICAgfTtcbiAgICB2bS5sb3NlcyA9IHtcbiAgICAgIHRvdGFsOiAwLFxuICAgICAgYXNDaGFsbGVuZ2VyOiAwLFxuICAgICAgYXNPcHBvbmVudDogMCxcbiAgICAgIGJ5Rm9yZmVpdDogMFxuICAgIH07XG4gICAgdm0uc3RyZWFrID0ge1xuICAgICAgdHlwZTogbnVsbCxcbiAgICAgIHZhbHVlOiAwXG4gICAgfTtcbiAgICB2bS5zaW5nbGVQbGF5ZXJUZWFtcyA9IGZhbHNlO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgJHNjb3BlLiR3YXRjaCgndm0uY2hhbGxlbmdlcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHZtLmNoYWxsZW5nZXMgJiYgdm0uY2hhbGxlbmdlcy5sZW5ndGggPiAwICYmIHZtLmNvbXBldGl0aW9uKSB7XG4gICAgICAgICAgY2FsY3VsYXRlU3RyZWFrKHZtLnRlYW0sIHZtLmNoYWxsZW5nZXMpO1xuICAgICAgICAgIGNhbGN1YXRlV2luQW5kTG9zZXModm0udGVhbSwgdm0uY2hhbGxlbmdlcyk7XG5cbiAgICAgICAgICAvLyBJZiB0aGVyZSBpcyBvbmx5IDEgcGxheWVyIHBlciB0ZWFtIHRoYW4gdXNlIHBsYXllcidzIG5hbWVcbiAgICAgICAgICBpZiAodm0uY29tcGV0aXRpb24ucGxheWVycy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgIHZtLnNpbmdsZVBsYXllclRlYW1zID0gdHJ1ZTtcbiAgICAgICAgICAgIHZtLmRpc3BsYXlOYW1lID0gXy5maW5kKHZtLmNvbXBldGl0aW9uLnBsYXllcnMsIHsgJ3Bvc2l0aW9uJzogIHZtLnRlYW19KS5kaXNwbGF5TmFtZTtcbiAgICAgICAgICAgIHZtLnBsYXllck5hbWUgPSAgXy5maW5kKHZtLmNvbXBldGl0aW9uLnBsYXllcnMsIHsgJ3Bvc2l0aW9uJzogIHZtLnRlYW19KS5maXJzdE5hbWUgKyAnICcgKyAgXy5maW5kKHZtLmNvbXBldGl0aW9uLnBsYXllcnMsIHsgJ3Bvc2l0aW9uJzogIHZtLnRlYW19KS5sYXN0TmFtZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVN0cmVhayh0ZWFtLCBjaGFsbGVuZ2VzKSB7XG4gICAgICAvLyBGaWd1cmUgb3V0IHRoZSB0ZWFtJ3MgY3VycmVudCBzdHJlYWtcbiAgICAgIHZhciBzdHJlYWsgPSAwO1xuICAgICAgdmFyIGNvbnRpbnVlU3RyZWFrID0gdHJ1ZTtcbiAgICAgIHZhciBzdHJlYWtUeXBlO1xuICAgICAgXy5mb3JFYWNoKGNoYWxsZW5nZXMsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgaWYgKGNvbnRpbnVlU3RyZWFrKSB7XG4gICAgICAgICAgLy8gV2lubmluZyBTdHJlYWtcbiAgICAgICAgICBpZiAoKGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJyAmJiBjaGFsbGVuZ2UuY2hhbGxlbmdlci50ZWFtID09PSB0ZWFtKSB8fFxuICAgICAgICAgICAgKGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCcgJiYgY2hhbGxlbmdlLm9wcG9uZW50LnRlYW0gPT09IHRlYW0pKSB7XG4gICAgICAgICAgICAvLyBJZiB0aGV5IGFyZSBub3QgYWxyZWFkeSBvbiBhIGxvc2luZyBzdHJlYWsgYW5kIDEgdG8gdGhlaXIgd2lubmluZyBzdHJlYWtcbiAgICAgICAgICAgIGlmIChzdHJlYWtUeXBlICE9PSAnbG9zaW5nJykge1xuICAgICAgICAgICAgICBzdHJlYWsgKz0gMTtcbiAgICAgICAgICAgICAgc3RyZWFrVHlwZSA9ICd3aW5uaW5nJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlU3RyZWFrID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgLy8gTG9zaW5nIFN0cmVha1xuICAgICAgICAgIH0gZWxzZSBpZiAoKGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCcgJiYgY2hhbGxlbmdlLmNoYWxsZW5nZXIudGVhbSA9PT0gdGVhbSkgfHxcbiAgICAgICAgICAgIChjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcicgJiYgY2hhbGxlbmdlLm9wcG9uZW50LnRlYW0gPT09IHRlYW0pKSB7XG4gICAgICAgICAgICAvLyBJZiB0aGV5IGFyZSBub3QgYWxyZWFkeSBvbiBhIHdpbm5pbmcgc3RyZWFrIGFuZCAxIHRvIHRoZWlyIGxvc2luZyBzdHJlYWtcbiAgICAgICAgICAgIGlmIChzdHJlYWtUeXBlICE9PSAnd2lubmluZycpIHtcbiAgICAgICAgICAgICAgc3RyZWFrICs9IDE7XG4gICAgICAgICAgICAgIHN0cmVha1R5cGUgPSAnbG9zaW5nJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlU3RyZWFrID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZtLnN0cmVhayA9IHtcbiAgICAgICAgICB0eXBlOiBzdHJlYWtUeXBlLFxuICAgICAgICAgIHZhbHVlOiBzdHJlYWtcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbGN1YXRlV2luQW5kTG9zZXModGVhbSAsIGNoYWxsZW5nZXMpIHtcbiAgICAgIC8vIEZpZ3VyZSBvdXQgd2lucyBhbmQgbG9zZXNcbiAgICAgIHZtLndpbnMuYXNPcHBvbmVudCA9IF8uc2l6ZShfLmZpbHRlcihjaGFsbGVuZ2VzLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgY2hhbGxlbmdlLm9wcG9uZW50LnRlYW0gPT09IHRlYW0gJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50J1xuICAgICAgICApO1xuICAgICAgfSkpO1xuXG4gICAgICB2bS53aW5zLmFzQ2hhbGxlbmdlciA9IF8uc2l6ZShfLmZpbHRlcihjaGFsbGVuZ2VzLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgY2hhbGxlbmdlLmNoYWxsZW5nZXIudGVhbSA9PT0gdGVhbSAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcidcbiAgICAgICAgKTtcbiAgICAgIH0pKTtcblxuICAgICAgdm0ud2lucy50b3RhbCA9IHZtLndpbnMuYXNDaGFsbGVuZ2VyICsgdm0ud2lucy5hc09wcG9uZW50O1xuXG4gICAgICB2bS53aW5zLmJ5Rm9yZmVpdCA9IF8uc2l6ZShfLmZpbHRlcihjaGFsbGVuZ2VzLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgY2hhbGxlbmdlLmZvcmZlaXQgJiYgKChjaGFsbGVuZ2UuY2hhbGxlbmdlci50ZWFtID09PSB0ZWFtICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJykgfHxcbiAgICAgICAgICAoY2hhbGxlbmdlLm9wcG9uZW50LnRlYW0gPT09IHRlYW0gJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50JykpXG4gICAgICAgICk7XG4gICAgICB9KSk7XG5cbiAgICAgIHZtLmxvc2VzLmFzT3Bwb25lbnQgPSBfLnNpemUoXy5maWx0ZXIoY2hhbGxlbmdlcywgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIGNoYWxsZW5nZS5vcHBvbmVudC50ZWFtID09PSB0ZWFtICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJ1xuICAgICAgICApO1xuICAgICAgfSkpO1xuXG4gICAgICB2bS5sb3Nlcy5hc0NoYWxsZW5nZXIgPSBfLnNpemUoXy5maWx0ZXIoY2hhbGxlbmdlcywgZnVuY3Rpb24oY2hhbGxlbmdlKSB7IFxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLnRlYW0gPT09IHRlYW0gJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50J1xuICAgICAgICApO1xuICAgICAgfSkpO1xuXG4gICAgICB2bS5sb3Nlcy50b3RhbCA9IHZtLmxvc2VzLmFzQ2hhbGxlbmdlciArIHZtLmxvc2VzLmFzT3Bwb25lbnQ7XG5cbiAgICAgIHZtLmxvc2VzLmJ5Rm9yZmVpdCA9IF8uc2l6ZShfLmZpbHRlcihjaGFsbGVuZ2VzLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgY2hhbGxlbmdlLmZvcmZlaXQgJiYgKChjaGFsbGVuZ2UuY2hhbGxlbmdlci50ZWFtID09PSB0ZWFtICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCcpIHx8XG4gICAgICAgICAgKGNoYWxsZW5nZS5vcHBvbmVudC50ZWFtID09PSB0ZWFtICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJykpXG4gICAgICAgICk7XG4gICAgICB9KSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmZhY3RvcnkoJ2NoYWxsZW5nZXNTZXJ2aWNlJywgY2hhbGxlbmdlc1NlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIGNoYWxsZW5nZXNTZXJ2aWNlKCRodHRwKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBjcmVhdGVQeXJhbWlkQ2hhbGxlbmdlOiBjcmVhdGVQeXJhbWlkQ2hhbGxlbmdlLFxuICAgICAgY3JlYXRlVmVyc3VzQ2hhbGxlbmdlOiBjcmVhdGVWZXJzdXNDaGFsbGVuZ2UsXG4gICAgICBjYW5jZWxQeXJhbWlkQ2hhbGxlbmdlOiBjYW5jZWxQeXJhbWlkQ2hhbGxlbmdlLFxuICAgICAgY29tcGxldGVQeXJhbWlkQ2hhbGxlbmdlOiBjb21wbGV0ZVB5cmFtaWRDaGFsbGVuZ2UsXG4gICAgICBjb21wbGV0ZVZlcnN1c0NoYWxsZW5nZTogY29tcGxldGVWZXJzdXNDaGFsbGVuZ2UsXG4gICAgICBnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbjogZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb24sXG4gICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbjogZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24sXG4gICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXI6IGdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcixcbiAgICAgIGdldENvbXBsZXRlZENoYWxsZW5nZXNCeUNvbXBldGl0aW9uOiBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbixcbiAgICAgIGRlbGV0ZUFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcjogZGVsZXRlQWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyLFxuICAgICAgZGVsZXRlQ2hhbGxlbmdlOiBkZWxldGVDaGFsbGVuZ2UsXG4gICAgICBnZXRQbGF5ZXJSZXN1bHRzQnlDb21wZXRpdGlvbjogZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb25cbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVQeXJhbWlkQ2hhbGxlbmdlKGNoYWxsZW5nZSkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvY2hhbGxlbmdlcy9weXJhbWlkL2NyZWF0ZScsIHtcbiAgICAgICAgY2hhbGxlbmdlOiBjaGFsbGVuZ2VcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbmNlbFB5cmFtaWRDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucHV0KCcvYXBpL2NoYWxsZW5nZXMvcHlyYW1pZC9jYW5jZWwnLCB7XG4gICAgICAgIGNoYWxsZW5nZTogY2hhbGxlbmdlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVWZXJzdXNDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jaGFsbGVuZ2VzL3ZlcnN1cy9jcmVhdGUnLCB7XG4gICAgICAgIGNoYWxsZW5nZTogY2hhbGxlbmdlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb21wbGV0ZVB5cmFtaWRDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jaGFsbGVuZ2VzL3B5cmFtaWQvY29tcGxldGUnLCAge1xuICAgICAgICBjaGFsbGVuZ2U6IGNoYWxsZW5nZVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcGxldGVWZXJzdXNDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jaGFsbGVuZ2VzL3ZlcnN1cy9jb21wbGV0ZScsICB7XG4gICAgICAgIGNoYWxsZW5nZTogY2hhbGxlbmdlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvY29tcGV0aXRpb24nLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9hY3RpdmUvY29tcGV0aXRpb24nLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcihjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2FjdGl2ZS9jb21wZXRpdGlvbi9wbGF5ZXInLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICAgIHBsYXllcklkOiBwbGF5ZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkLCBsaW1pdCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2NvbXBsZXRlZC9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgbGltaXQ6IGxpbWl0XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbGV0ZUFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcihjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS9jaGFsbGVuZ2VzL2FjdGl2ZS9jb21wZXRpdGlvbi9wbGF5ZXIvZGVsZXRlJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBwbGF5ZXJJZDogcGxheWVySWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsZXRlQ2hhbGxlbmdlKGNvbXBldGl0aW9uSWQsIGNoYWxsZW5nZUlkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZGVsZXRlKCcvYXBpL2NoYWxsZW5nZXMvZGVsZXRlJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBjaGFsbGVuZ2VJZDogY2hhbGxlbmdlSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCwgcGxheWVySWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9yZXN1bHRzL2NvbXBldGl0aW9uL3BsYXllcicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgcGxheWVySWQ6IHBsYXllcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnd3BtRm9vdGVyJywgd3BtRm9vdGVyKTtcblxuICBmdW5jdGlvbiB3cG1Gb290ZXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9mb290ZXIuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoaWRlbnRpdHlTZXJ2aWNlLCBhdXRoU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgIHZtLmxvZ291dCA9IGxvZ291dDtcblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnd3BtSGVhZGVyJywgd3BtSGVhZGVyKTtcblxuICBmdW5jdGlvbiB3cG1IZWFkZXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ2hlYWRlckN0cmwnLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbW1vbi9jb21wb25lbnRzL2hlYWRlci5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUsIHNpZGViYXJTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UsIGF1dGhTZXJ2aWNlLCBhbGVydHNTZXJ2aWNlKSB7XG4gICAgdmFyIGhlYWRlckN0cmwgPSB0aGlzO1xuICAgIGhlYWRlckN0cmwuaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgIGhlYWRlckN0cmwubG9nb3V0ID0gbG9nb3V0O1xuICAgIGhlYWRlckN0cmwuc2lkZWJhclN0YXR1cyA9IHNpZGViYXJTZXJ2aWNlLmdldFNpZGViYXJTdGF0dXMoKTtcbiAgICBoZWFkZXJDdHJsLnRvZ2dsZVNpZGViYXIgPSB0b2dnbGVTaWRlYmFyO1xuICAgIGhlYWRlckN0cmwuY2xlYXJBbGVydCA9IGNsZWFyQWxlcnQ7XG4gICAgaGVhZGVyQ3RybC5jbGVhckFsbEFsZXJ0cyA9IGNsZWFyQWxsQWxlcnRzO1xuICAgIGhlYWRlckN0cmwuYWxlcnRzID0gW107XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBnZXRBY3RpdmVBbGVydHMoKTtcbiAgICAgICRzY29wZS4kd2F0Y2goJ2hlYWRlckN0cmwuaW5kZW50aXR5LmN1cnJlbnRVc2VyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgICAgZ2V0QWN0aXZlQWxlcnRzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUFsZXJ0cygpIHtcbiAgICAgIGhlYWRlckN0cmwuYWxlcnRzID0gW107XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgIGFsZXJ0c1NlcnZpY2UuZ2V0QWN0aXZlQWxlcnRzQnlQbGF5ZXIoaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCkudGhlbihmdW5jdGlvbiAoYWxlcnRzKSB7XG4gICAgICAgICAgaGVhZGVyQ3RybC5hbGVydHMgPSBhbGVydHMuZGF0YTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xlYXJBbGVydChjbGVhckFsZXJ0LCBpbmRleCkge1xuICAgICAgYWxlcnRzU2VydmljZS5jbGVhckFsZXJ0KGNsZWFyQWxlcnQpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBoZWFkZXJDdHJsLmFsZXJ0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xlYXJBbGxBbGVydHMoKSB7XG4gICAgICBhbGVydHNTZXJ2aWNlLmNsZWFyQWxsQWxlcnRzQnlQbGF5ZXIoaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGhlYWRlckN0cmwuYWxlcnRzID0gW107XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0b2dnbGVTaWRlYmFyKCkge1xuICAgICAgc2lkZWJhclNlcnZpY2Uuc2V0U2lkZWJhclN0YXR1cyghaGVhZGVyQ3RybC5zaWRlYmFyU3RhdHVzLmxlZnQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czp1cGRhdGVfYWxlcnRzJywgZnVuY3Rpb24gKGUsIGFsZXJ0cykge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSAmJiBfLnNvbWUoYWxlcnRzLCBbJ3VzZXJJZCcsIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWRdKSkge1xuICAgICAgICBnZXRBY3RpdmVBbGVydHMoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnd3BtU2lkZWJhcicsIHdwbVNpZGViYXIpO1xuXG4gIGZ1bmN0aW9uIHdwbVNpZGViYXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3NpZGViYXJDdHJsJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9zaWRlYmFyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UsIHNpZGViYXJTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pbmRlbnRpdHkgPSBpZGVudGl0eVNlcnZpY2U7XG4gICAgdm0ubG9nb3V0ID0gbG9nb3V0O1xuICAgIHZtLnNpZGViYXJTdGF0dXMgPSBzaWRlYmFyU2VydmljZS5nZXRTaWRlYmFyU3RhdHVzKCk7XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmlsdGVyKCdvcmRlck9iamVjdEJ5Jywgb3JkZXJPYmplY3RCeSk7XG5cbiAgZnVuY3Rpb24gb3JkZXJPYmplY3RCeSgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGlucHV0LCBhdHRyaWJ1dGUpIHtcbiAgICAgIGlmICghYW5ndWxhci5pc09iamVjdChpbnB1dCkpIHJldHVybiBpbnB1dDtcblxuICAgICAgdmFyIGFycmF5ID0gW107XG4gICAgICBmb3IgKHZhciBvYmplY3RLZXkgaW4gaW5wdXQpIHtcbiAgICAgICAgYXJyYXkucHVzaChpbnB1dFtvYmplY3RLZXldKTtcbiAgICAgIH1cblxuICAgICAgYXJyYXkuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICBhID0gcGFyc2VJbnQoYVthdHRyaWJ1dGVdKTtcbiAgICAgICAgYiA9IHBhcnNlSW50KGJbYXR0cmlidXRlXSk7XG4gICAgICAgIHJldHVybiBhIC0gYjtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH07XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnYWxlcnRzU2VydmljZScsIGFsZXJ0c1NlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIGFsZXJ0c1NlcnZpY2UoJGh0dHApIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGdldEFjdGl2ZUFsZXJ0c0J5UGxheWVyOiBnZXRBY3RpdmVBbGVydHNCeVBsYXllcixcbiAgICAgIGNsZWFyQWxlcnQ6IGNsZWFyQWxlcnQsXG4gICAgICBjbGVhckFsbEFsZXJ0c0J5UGxheWVyOiBjbGVhckFsbEFsZXJ0c0J5UGxheWVyXG4gICAgfTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgLyoqXG4gICAgICogR2V0cyB1bmNsZWFyZWQgYWxlcnRzIGZvciBhIHVzZXIgZnJvbSB0aGUgZGF0YWJhc2VcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB1c2VySWQgaWQgZm9yIHRoZSB1c2VyXG4gICAgICogQHJldHVybiB7QXJyYXl9IGFsZXJ0c1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUFsZXJ0c0J5UGxheWVyKHVzZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9hbGVydHMvJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICB1c2VySWQ6IHVzZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNYXJrcyBhIGFsZXJ0cyBhcyBjbGVhcmVkXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gYWxlcnRJZCBpZCBmb3IgdGhlIGFsZXJ0XG4gICAgICogQHJldHVybiB7U3RyaW5nfSBTdGF0dXNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbGVhckFsZXJ0KGFsZXJ0SWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wdXQoJy9hcGkvYWxlcnQvY2xlYXInLCB7XG4gICAgICAgIGFsZXJ0SWQ6IGFsZXJ0SWRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1hcmtzIGFsbCB1bnZpZXdlZCBhbGVydHMgYXMgdmlld2VkIGZvciBhIHVzZXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB1c2VySWQgaWQgZm9yIHRoZSB1c2VyXG4gICAgICogQHJldHVybiB7U3RyaW5nfSBTdGF0dXNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbGVhckFsbEFsZXJ0c0J5UGxheWVyKHVzZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS9hbGVydHMvY2xlYXInLCB7XG4gICAgICAgIHVzZXJJZDogdXNlcklkXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnaWRlbnRpdHlTZXJ2aWNlJywgaWRlbnRpdHlTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBpZGVudGl0eVNlcnZpY2UoJHdpbmRvdykge1xuICAgIHZhciBjdXJyZW50VXNlcjtcbiAgICBpZiAoJHdpbmRvdy5ib290c3RyYXBwZWRVc2VyT2JqZWN0ICE9PSBudWxsKSB7XG4gICAgICBjdXJyZW50VXNlciA9ICR3aW5kb3cuYm9vdHN0cmFwcGVkVXNlck9iamVjdDtcbiAgICB9XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBjdXJyZW50VXNlcjogY3VycmVudFVzZXIsXG4gICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGlzQXV0aGVudGljYXRlZCxcbiAgICAgIGlzQXV0aG9yaXplZDogaXNBdXRob3JpemVkXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZCgpIHtcbiAgICAgIHJldHVybiAhIXRoaXMuY3VycmVudFVzZXI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNBdXRob3JpemVkKHJvbGUpIHtcbiAgICAgIHJldHVybiAhIXRoaXMuY3VycmVudFVzZXIgJiYgdGhpcy5jdXJyZW50VXNlci5yb2xlcy5pbmRleE9mKHJvbGUpID4gLTE7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmZhY3RvcnkoJ25vdGlmeVNlcnZpY2UnLCBub3RpZnlTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBub3RpZnlTZXJ2aWNlKCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgaW5mbzogaW5mbyxcbiAgICAgIHN1Y2Nlc3M6IHN1Y2Nlc3MsXG4gICAgICB3YXJuaW5nOiB3YXJuaW5nLFxuICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgaW52ZXJzZTogaW52ZXJzZVxuICAgIH07XG5cbiAgICAkLm5vdGlmeURlZmF1bHRzKHtcbiAgICAgIG5ld2VzdF9vbl90b3A6IHRydWUsXG4gICAgICBvZmZzZXQ6IHtcbiAgICAgICAgeDogMjAsXG4gICAgICAgIHk6IDg1XG4gICAgICB9LFxuICAgICAgZGVsYXk6IDUwMDAsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGluZm8obWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ2luZm8nXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdzdWNjZXNzJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd2FybmluZyhtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnd2FybmluZydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdkYW5nZXInXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnZlcnNlKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdpbnZlcnNlJ1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmZhY3RvcnkoJ3Njcm9sbGJhclNlcnZpY2UnLCBzY3JvbGxiYXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBzY3JvbGxiYXJTZXJ2aWNlKCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgbWFsaWh1U2Nyb2xsOiBtYWxpaHVTY3JvbGxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBtYWxpaHVTY3JvbGwoc2VsZWN0b3IsIHRoZW1lLCBzY3JvbGxheGlzLCBtb3VzZXdoZWVsYXhpcykge1xuICAgICAgJChzZWxlY3RvcikubUN1c3RvbVNjcm9sbGJhcih7XG4gICAgICAgIHRoZW1lOiB0aGVtZSxcbiAgICAgICAgc2Nyb2xsSW5lcnRpYTogMTAwLFxuICAgICAgICBheGlzOiBzY3JvbGxheGlzLFxuICAgICAgICBtb3VzZVdoZWVsOiB7XG4gICAgICAgICAgZW5hYmxlOiB0cnVlLFxuICAgICAgICAgIGF4aXM6IG1vdXNld2hlZWxheGlzLFxuICAgICAgICAgIHByZXZlbnREZWZhdWx0OiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdzaWRlYmFyU2VydmljZScsIHNpZGViYXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBzaWRlYmFyU2VydmljZSgpIHtcbiAgICB2YXIgc2lkZWJhclN0YXR1cyA9IHtcbiAgICAgIGxlZnQ6IGZhbHNlLFxuICAgICAgcmlnaHQ6IGZhbHNlXG4gICAgfTtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGdldFNpZGViYXJTdGF0dXM6IGdldFNpZGViYXJTdGF0dXMsXG4gICAgICBzZXRTaWRlYmFyU3RhdHVzOiBzZXRTaWRlYmFyU3RhdHVzXG4gICAgfTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gZ2V0U2lkZWJhclN0YXR1cygpIHtcbiAgICAgIHJldHVybiBzaWRlYmFyU3RhdHVzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFNpZGViYXJTdGF0dXMoc3RhdHVzKSB7XG4gICAgICBzaWRlYmFyU3RhdHVzLmxlZnQgPSBzdGF0dXM7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ3dlYnNvY2tldFNlcnZpY2UnLCB3ZWJzb2NrZXRTZXJ2aWNlKS5ydW4oZnVuY3Rpb24gKHdlYnNvY2tldFNlcnZpY2UpIHtcbiAgICB3ZWJzb2NrZXRTZXJ2aWNlLmNvbm5lY3QoKTtcbiAgfSk7XG5cbiAgZnVuY3Rpb24gd2Vic29ja2V0U2VydmljZSgkcm9vdFNjb3BlLCAkd2luZG93LCAkdGltZW91dCkge1xuICAgIHZhciBjb25uZWN0aW9uO1xuICAgIHZhciByZXRyeVNlY29uZHMgPSBbMywgMTAsIDEwMCwgMTAwMF07XG4gICAgdmFyIHJldHJ5ID0gMDtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGNvbm5lY3Q6IGNvbm5lY3QsXG4gICAgICBzZW5kOiBzZW5kXG4gICAgfTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gd2Vic29ja2V0SG9zdCgpIHtcbiAgICAgIGlmICgkd2luZG93LmxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cHM6Jykge1xuICAgICAgICByZXR1cm4gJ3dzczovLycgKyAkd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJ3dzOi8vJyArICR3aW5kb3cubG9jYXRpb24uaG9zdDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb25uZWN0KCkge1xuICAgICAgY29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQod2Vic29ja2V0SG9zdCgpKTtcblxuICAgICAgY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICByZXRyeSA9IDA7XG4gICAgICAgIHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpO1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3dzOicgKyBwYXlsb2FkLnRvcGljLCBwYXlsb2FkLmRhdGEpO1xuICAgICAgfTtcblxuICAgICAgY29ubmVjdGlvbi5vbmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAocmV0cnkgPCByZXRyeVNlY29uZHMubGVuZ3RoKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1dlYlNvY2tldCBjbG9zZWQuIFJlY29ubmVjdGluZy4uLicpO1xuICAgICAgICAgICR0aW1lb3V0KGNvbm5lY3QsIHJldHJ5U2Vjb25kc1tyZXRyeV0qMTAwMCk7XG4gICAgICAgICAgcmV0cnkgKz0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnR2l2aW5nIHVwIG9uIFdlYlNvY2tldCcpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlbmQodG9waWMsIGRhdGEpIHtcbiAgICAgIHZhciBqc29uID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICB0b3BpYzogdG9waWMsXG4gICAgICAgIGRhdGE6IGRhdGFcbiAgICAgIH0pO1xuICAgICAgY29ubmVjdGlvbi5zZW5kKGpzb24pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdIb21lQ3RybCcsIEhvbWVDdHJsKTtcblxuICBmdW5jdGlvbiBIb21lQ3RybChjb21wZXRpdGlvbnNTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnB1YmxpY0NvbXBldGl0aW9ucyA9IFtdO1xuICAgIHZtLnByaXZhdGVDb21wZXRpdGlvbnMgPSBbXTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGNvbXBldGl0aW9uc1NlcnZpY2UuZ2V0UHVibGljQ29tcGV0aXRpb25zKCkudGhlbihmdW5jdGlvbiAoY29tcGV0aXRpb25zKSB7XG4gICAgICAgIHZtLnB1YmxpY0NvbXBldGl0aW9ucyA9IGNvbXBldGl0aW9ucy5kYXRhO1xuICAgICAgfSk7XG4gICAgICAvLyBHZXQgcHJpdmF0ZSBjb21wZXRpdGlvbnMgZm9yIHN1cGVyLWFkbWluc1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhvcml6ZWQoJ3N1cGVyLWFkbWluJykpIHtcbiAgICAgICAgY29tcGV0aXRpb25zU2VydmljZS5nZXRQcml2YXRlQ29tcGV0aXRpb25zKCkudGhlbihmdW5jdGlvbiAoY29tcGV0aXRpb25zKSB7XG4gICAgICAgICAgdm0ucHJpdmF0ZUNvbXBldGl0aW9ucyA9IGNvbXBldGl0aW9ucy5kYXRhO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ3dwbUNvbXBldGl0aW9uQ29tcGFjdCcsIHdwbUNvbXBldGl0aW9uQ29tcGFjdCk7XG5cbiAgZnVuY3Rpb24gd3BtQ29tcGV0aXRpb25Db21wYWN0KCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb246ICc9JyxcblxuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbXBldGl0aW9ucy9jb21wb25lbnRzL2NvbXBldGl0aW9uLWNvbXBhY3QuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoKSB7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCd3cG1QZW5kaW5nUGxheWVycycsIHdwbVBlbmRpbmdQbGF5ZXJzKTtcblxuICBmdW5jdGlvbiB3cG1QZW5kaW5nUGxheWVycygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGNvbXBldGl0aW9uOiAnPSdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21wZXRpdGlvbnMvY29tcG9uZW50cy9wZW5kaW5nLXBsYXllcnMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoY29tcGV0aXRpb25zU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucGVuZGluZ1BsYXllcnMgPSBbXTtcbiAgICB2bS5hcHByb3ZlUGVuZGluZ1BsYXllciA9IGFwcHJvdmVQZW5kaW5nUGxheWVyO1xuICAgIHZtLmRlbnlQZW5kaW5nUGxheWVyID0gZGVueVBlbmRpbmdQbGF5ZXI7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuXG4gICAgZnVuY3Rpb24gYXBwcm92ZVBlbmRpbmdQbGF5ZXIocGxheWVyKSB7XG4gICAgICBwbGF5ZXIucG9zaXRpb24gPSB2bS5jb21wZXRpdGlvbi5wbGF5ZXJzLmxlbmd0aCArIDE7XG4gICAgICBjb21wZXRpdGlvbnNTZXJ2aWNlLmFwcHJvdmVQZW5kaW5nUGxheWVyKHZtLmNvbXBldGl0aW9uLl9pZCwgcGxheWVyKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZW55UGVuZGluZ1BsYXllcihwbGF5ZXIpIHtcbiAgICAgIGNvbXBldGl0aW9uc1NlcnZpY2UuZGVueVBlbmRpbmdQbGF5ZXIodm0uY29tcGV0aXRpb24uX2lkLCBwbGF5ZXIpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ3dwbVB5cmFtaWQnLCB3cG1QeXJhbWlkKTtcblxuICBmdW5jdGlvbiB3cG1QeXJhbWlkKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY29tcGV0aXRpb25zL2NvbXBvbmVudHMvcHlyYW1pZC5odG1sJyxcbiAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbjogJz0nXG4gICAgICB9LFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCAkc3RhdGUsIGNvbXBldGl0aW9uc1NlcnZpY2UsICRmaWx0ZXIsIG5vdGlmeVNlcnZpY2UsIGlkZW50aXR5U2VydmljZSwgY2hhbGxlbmdlc1NlcnZpY2UpIHtcbiAgICB2YXIgbWF4TGV2ZWxzID0gNztcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNvbXBldGl0aW9uSWQgPSBudWxsO1xuICAgIHZtLmJyZWFrUG9pbnRzID0gW107XG4gICAgdm0ubGV2ZWxzID0gW107XG4gICAgdm0ubnVtYmVyT2ZCbG9ja3MgPSAwO1xuICAgIHZtLmN1cnJlbnRVc2VySXNPbkNvbXBldGl0aW9uID0gZmFsc2U7XG4gICAgdm0uY3VycmVudFVzZXJJc1BlbmRpbmcgPSBmYWxzZTtcbiAgICB2bS5jdXJyZW50VXNlcklzQWRtaW4gPSBmYWxzZTtcbiAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcbiAgICB2bS5hY3RpdmVDaGFsbGVuZ2VPcHBvbmVudCA9IG51bGw7XG4gICAgdm0uYXZhaWxhYmxlQ2hhbGxlbmdlcyA9IGZhbHNlO1xuICAgIHZtLmNyZWF0ZUNoYWxsZW5nZSA9IGNyZWF0ZUNoYWxsZW5nZTtcbiAgICB2bS5jYW5jZWxDaGFsbGVuZ2UgPSBjYW5jZWxDaGFsbGVuZ2U7XG4gICAgdm0uY29tcGxldGVDaGFsbGVuZ2UgPSBjb21wbGV0ZUNoYWxsZW5nZTtcbiAgICB2bS5mb3JmZWl0Q2hhbGxlbmdlID0gZm9yZmVpdENoYWxsZW5nZTtcbiAgICB2bS5jdXJyZW50VXNlclBsYXllciA9IHt9O1xuICAgIHZtLmNvbXBldGl0aW9uTWVudVRvZ2dsZSA9IGZhbHNlO1xuICAgIHZtLmFkZEN1cnJlbnRVc2VyVG9Db21wZXRpdGlvbiA9IGFkZEN1cnJlbnRVc2VyVG9Db21wZXRpdGlvbjtcbiAgICB2bS5jb25maXJtUmVtb3ZlQ3VycmVudFVzZXJGcm9tQ29tcGV0aXRpb24gPSBjb25maXJtUmVtb3ZlQ3VycmVudFVzZXJGcm9tQ29tcGV0aXRpb247XG4gICAgdm0ucGxheWVyQ2xpY2sgPSBwbGF5ZXJDbGljaztcbiAgICB2bS5udW1iZXJPZlJlYWxQbGF5ZXJzID0gMDtcbiAgICB2bS5tYXhQbGF5ZXJzID0gMDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIC8vIERldGVybWluZSB0aGUgbWF4aW11bSBudW1iZXIgb2YgcGxheWVycyBiYXNlZCBvbiB0aGUgbWF4aW11bSBudW1iZXIgb2YgbGV2ZWxzXG4gICAgICBmb3IgKHZhciBpID0gbWF4TGV2ZWxzOyBpID4gMDsgLS1pKSB7XG4gICAgICAgIHZtLm1heFBsYXllcnMgKz0gaTtcbiAgICAgIH1cblxuICAgICAgJHNjb3BlLiR3YXRjaCgndm0uY29tcGV0aXRpb24nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh2bS5jb21wZXRpdGlvbikge1xuICAgICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSB2bS5jb21wZXRpdGlvbi5faWQ7XG4gICAgICAgICAgb3JkZXJQbGF5ZXJzKCk7XG4gICAgICAgICAgZ2V0UGxheWVyc1N0YXR1cygpO1xuICAgICAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgICAgICAgIGNhbGN1bGF0ZUNvbXBldGl0aW9uQmxvY2tzKCk7XG4gICAgICAgICAgZmlsbEluRW1wdHlCbG9ja3MoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3JkZXIgdGhlIHBsYXllcnMgYnkgdGhlIHBvc2l0aW9uIHByb3BlcnR5IG9mIHRoZSBwbGF5ZXJzIGFycmF5IGluIHRoZSBjb21wZXRpdGlvbiBvYmplY3RcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBvcmRlclBsYXllcnMoKSB7XG4gICAgICB2bS5jb21wZXRpdGlvbi5wbGF5ZXJzID0gJGZpbHRlcignb3JkZXJCeScpKHZtLmNvbXBldGl0aW9uLnBsYXllcnMsICdwb3NpdGlvbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpZ3VyZSBvdXQgaWYgZWFjaCBwbGF5ZXIgaXMgYWxyZWFkeSBjaGFsbGVuZ2VkIGFuZCBzZXQgc29tZSBzdHVmZlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFBsYXllcnNTdGF0dXMoKSB7XG4gICAgICAvLyBDaGVjayBhbGwgdGhlIGFjdGl2ZSBjaGFsbGVuZ2VzIGZvciB0aGlzIGNvbXBldGl0aW9uIGFuZCBzZXRzIHRoZSBzdGF0dXMgb2YgdGhlIHBsYXllcnNcbiAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZXMpIHtcbiAgICAgICAgXy5mb3JFYWNoKGNoYWxsZW5nZXMuZGF0YSwgZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuXG4gICAgICAgICAgdmFyIGNoYWxsZW5nZXIgPSBfLmZpbmQodm0uY29tcGV0aXRpb24ucGxheWVycywgeyAnX2lkJzogY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkIH0pO1xuICAgICAgICAgIGNoYWxsZW5nZXIuY2xhc3MgPSAndW5hdmFpbGFibGUnO1xuICAgICAgICAgIGNoYWxsZW5nZXIuYXZhaWxhYmxlID0gZmFsc2U7XG4gICAgICAgICAgY2hhbGxlbmdlci5jaGFsbGVuZ2UgPSB7XG4gICAgICAgICAgICBwb3NpdGlvbjogJ2NoYWxsZW5nZXInLFxuICAgICAgICAgICAgb3Bwb25lbnQ6IF8uZmluZCh2bS5jb21wZXRpdGlvbi5wbGF5ZXJzLCB7ICdfaWQnOiBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkIH0pLmRpc3BsYXlOYW1lXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHZhciBvcHBvbmVudCA9IF8uZmluZCh2bS5jb21wZXRpdGlvbi5wbGF5ZXJzLCB7ICdfaWQnOiBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkIH0pO1xuICAgICAgICAgIG9wcG9uZW50LmNsYXNzID0gJ3VuYXZhaWxhYmxlJztcbiAgICAgICAgICBvcHBvbmVudC5hdmFpbGFibGUgPSBmYWxzZTtcbiAgICAgICAgICBvcHBvbmVudC5jaGFsbGVuZ2UgPSB7XG4gICAgICAgICAgICBwb3NpdGlvbjogJ29wcG9uZW50J1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICAvLyBUcmFjayB3aGVuIHRoZSBjaGFsbGVuZ2Ugd2lsbCBleHBpcmVcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLnRpbWVMaW1pdCAhPT0gMCkge1xuICAgICAgICAgICAgdmFyIHRpbWVUb0V4cGlyZSA9IG1vbWVudCgpLmRpZmYobW9tZW50KGNoYWxsZW5nZS5jcmVhdGVkKS5hZGQoY2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2QnKSkgKiAtMTtcbiAgICAgICAgICAgIHZhciBob3Vyc1RvRXhwaXJlID0gbW9tZW50LmR1cmF0aW9uKHRpbWVUb0V4cGlyZSkuYXNIb3VycygpO1xuICAgICAgICAgICAgLy8gSWYgdGhlIGNoYWxsZW5nZSBoYXMgbm90IHlldCBleHBpcmVkIGRpc3BsYXkgYSBjb3VudGRvd24gb24gdGhlIG9wcG9uZW50XG4gICAgICAgICAgICBpZiAodGltZVRvRXhwaXJlID4gMCkge1xuICAgICAgICAgICAgICBvcHBvbmVudC5jaGFsbGVuZ2UuZXhwaXJlcyA9IGhvdXJzVG9FeHBpcmU7XG4gICAgICAgICAgICAgIC8vIElmIHRoZSBjaGFsbGVuZ2UgZXhwaXJlZCB3aGlsZSBubyBvbmUgd2FzIHZpZXdpbmcgdGhpcyBjb21wZXRpdGlvbiBjb21wbGV0ZSB0aGUgY2hhbGxlbmdlIGJ5IGZvcmZlaXRcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGltZVRvRXhwaXJlIDw9IDApIHtcbiAgICAgICAgICAgICAgY29tcGxldGVDaGFsbGVuZ2UobnVsbCwgdHJ1ZSwgb3Bwb25lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdm0uY3VycmVudFVzZXJJc0FkbWluID0gZmFsc2U7XG4gICAgICAgIHZtLmN1cnJlbnRVc2VySXNQZW5kaW5nID0gZmFsc2U7XG4gICAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIGN1cnJlbnQgdXNlciBpcyBhbiBhZG1pbiBvZiB0aGlzIGNvbXBldGl0aW9uXG4gICAgICAgICAgdm0uY3VycmVudFVzZXJJc0FkbWluID0gXy5zb21lKHZtLmNvbXBldGl0aW9uLmFkbWlucywgWydfaWQnLCBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkXSk7XG4gICAgICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIGEgcGVuZGluZyByZXF1ZXN0IHRvIGpvaW5cbiAgICAgICAgICB2bS5jdXJyZW50VXNlcklzUGVuZGluZyA9IF8uc29tZSh2bS5jb21wZXRpdGlvbi5wZW5kaW5nUGxheWVycywgWydfaWQnLCBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkXSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXQgc3R1ZmYgZm9yIHRoZSBjdXJyZW50IHVzZXJcbiAgICAgICAgdm0uY3VycmVudFVzZXJJc09uQ29tcGV0aXRpb24gPSBmYWxzZTtcbiAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gZmFsc2U7XG4gICAgICAgIF8uZm9yRWFjaCh2bS5jb21wZXRpdGlvbi5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgICAgLy8gRmluZCB0aGUgY3VycmVudCB1c2VyIGlmIHRoZXkgYXJlIG9uIHRoaXMgY29tcGV0aXRpb24gYW5kIHNldCBzb21lIHByb3BlcnRpZXNcbiAgICAgICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpICYmIHBsYXllci5faWQgPT09IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQpIHtcbiAgICAgICAgICAgIHZtLmN1cnJlbnRVc2VySXNPbkNvbXBldGl0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIHBsYXllci5jbGFzcyA9IHBsYXllci5jbGFzcyA/IHBsYXllci5jbGFzcyArICcgY3VycmVudC11c2VyJzogJ2N1cnJlbnQtdXNlcic7XG4gICAgICAgICAgICB2bS5jdXJyZW50VXNlclBsYXllciA9IHBsYXllcjtcblxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgdXNlciBoYXMgYW4gYWN0aXZlIGNoYWxsZW5nZVxuICAgICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllci5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZtLmFjdGl2ZUNoYWxsZW5nZU9wcG9uZW50ID0gY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci5faWQgPT09IHBsYXllci5faWQgPyBjaGFsbGVuZ2UuZGF0YS5vcHBvbmVudCA6IGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXI7XG4gICAgICAgICAgICAgICAgLy8gQWRkIGEgY2xhc3MgdG8gdGhlIGN1cnJlbnQgdXNlcidzIG9wcG9uZW50J1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50T3Bwb25lbnQgPSBfLmZpbmQodm0uY29tcGV0aXRpb24ucGxheWVycywgeydfaWQnOiB2bS5hY3RpdmVDaGFsbGVuZ2VPcHBvbmVudC5faWR9KTtcbiAgICAgICAgICAgICAgICBjdXJyZW50T3Bwb25lbnQuY2xhc3MgPSBjdXJyZW50T3Bwb25lbnQuY2xhc3MgPyBjdXJyZW50T3Bwb25lbnQuY2xhc3MgKyAnIGN1cnJlbnQtb3Bwb25lbnQnOiAnY3VycmVudC1vcHBvbmVudCc7XG4gICAgICAgICAgICAgIC8vIE5vdyB0aGF0IHdlIGtub3cgYWJvdXQgYWxsIHRoZSBhY3RpdmUgY2hhbGxlbmdlcyBmaW5kIHRoZSBhdmFpbGFibGUgY2hhbGxlbmdlcyBmb3IgdGhlIGN1cnJlbnQgdXNlclxuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaWd1cmUgb3V0IHdoZXJlIHRvIHN0YXJ0IGVhY2ggbmV3IHJvdyBvbiB0aGUgY29tcGV0aXRpb25cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVCcmVha1BvaW50cygpIHtcbiAgICAgIHZtLmJyZWFrUG9pbnRzID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1heExldmVsczsgaSsrKSB7XG4gICAgICAgIHZtLmJyZWFrUG9pbnRzLnB1c2goKCgoaSAqIChpICsgMSkpIC8gMikpICsgMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gR2l2ZSBlYWNoIHBsYXllciBhIGxldmVsIHByb3BlcnR5IGJhc2VkIG9uIHRoZSBicmVhayBwb2ludHNcbiAgICAvLyBUaGlzIHdpbGwgYmUgdXNlZCB0byBkZXRlcm1pbmUgd2hvIG90aGVyIHBsYXllcnMgY2FuIGNoYWxsZW5nZVxuICAgIGZ1bmN0aW9uIGFzc2lnbkxldmVsc1RvUGxheWVycygpIHtcbiAgICAgIHZhciBsZXZlbCA9IDA7XG4gICAgICB2bS5sZXZlbHMgPSBbXTtcbiAgICAgIGNyZWF0ZUJyZWFrUG9pbnRzKCk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLmNvbXBldGl0aW9uLnBsYXllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHZtLmJyZWFrUG9pbnRzLmluZGV4T2YoaSArIDEpID4gLTEpIHtcbiAgICAgICAgICBsZXZlbCArPSAxO1xuICAgICAgICAgIC8vIFNldCB0aGUgbnVtYmVyIG9mIHRvdGFsIGxldmVsc1xuICAgICAgICAgIHZtLmxldmVscy5wdXNoKGxldmVsKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBHaXZlIGVhY2ggcGxheWVyIGEgbGV2ZWxcbiAgICAgICAgdm0uY29tcGV0aXRpb24ucGxheWVyc1tpXS5sZXZlbCA9IGxldmVsO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhvdyBtYW55IHRvdGFsIGJsb2NrcyBpbiB0aGlzIGNvbXBldGl0aW9uXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlQ29tcGV0aXRpb25CbG9ja3MoKSB7XG4gICAgICB2bS5udW1iZXJPZkJsb2NrcyA9IDA7XG4gICAgICBmb3IgKHZhciBpID0gXy5sYXN0KHZtLmxldmVscyk7IGkgPiAwOyBpLS0pIHtcbiAgICAgICAgdm0ubnVtYmVyT2ZCbG9ja3MgKz0gaTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGaWxsIG91dCB0aGUgcmVtYWluaW5nIGJsb2NrcyBvZiB0aGUgY29tcGV0aXRpb24gd2l0aCBlbXB0eSBibG9ja3NcbiAgICBmdW5jdGlvbiBmaWxsSW5FbXB0eUJsb2NrcygpIHtcbiAgICAgIHZtLm51bWJlck9mUmVhbFBsYXllcnMgPSB2bS5jb21wZXRpdGlvbi5wbGF5ZXJzLmxlbmd0aDtcbiAgICAgIGZvciAodmFyIGkgPSB2bS5jb21wZXRpdGlvbi5wbGF5ZXJzLmxlbmd0aDsgaSA8IHZtLm51bWJlck9mQmxvY2tzOyBpKyspIHtcbiAgICAgICAgdm0uY29tcGV0aXRpb24ucGxheWVycy5wdXNoKHtcbiAgICAgICAgICBmaXJzdE5hbWU6ICdFbXB0eScsXG4gICAgICAgICAgbGFzdE5hbWU6ICdTcG90JyxcbiAgICAgICAgICBkaXNwbGF5TmFtZTogJ0VtcHR5IFNwb3QnLFxuICAgICAgICAgIHBvc2l0aW9uOiA5OSxcbiAgICAgICAgICBjbGFzczogJ2VtcHR5J1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIC8vIFdlIGhhdmUgdG8gZ2l2ZSBsZXZlbHMgdG8gdGhlIG5ldyBlbXB0eSBzcG90c1xuICAgICAgYXNzaWduTGV2ZWxzVG9QbGF5ZXJzKCk7XG4gICAgfVxuXG4gICAgLy8gRmluZCBhbGwgdGhlIHBsYXllcnMgdGhhdCBhcmUgYXZhaWxhYmxlIHRvIGJlIGNoYWxsZW5nZWQgYnkgdGhpcyB1c2VyXG4gICAgZnVuY3Rpb24gZmluZEF2YWlsYWJsZUNoYWxsZW5nZXMoKSB7XG4gICAgICB2bS5hdmFpbGFibGVDaGFsbGVuZ2VzID0gZmFsc2U7XG4gICAgICBpZiAodm0uY3VycmVudFVzZXJJc09uQ29tcGV0aXRpb24gJiYgIXZtLmhhc0FjdGl2ZUNoYWxsZW5nZSkge1xuICAgICAgICB2YXIgbGV2ZWxBYm92ZSA9IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxldmVsID4gMSA/IHZtLmN1cnJlbnRVc2VyUGxheWVyLmxldmVsIC0gMSA6IG51bGw7XG4gICAgICAgIF8uZm9yRWFjaCh2bS5jb21wZXRpdGlvbi5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgICAgdmFyIHdhaXRpbmdGb3JQbGF5ZXIgPSBudWxsO1xuICAgICAgICAgIGlmIChwbGF5ZXIubGV2ZWwgPT09IGxldmVsQWJvdmUgJiYgcGxheWVyLnBvc2l0aW9uICE9PSA5OSAmJiBwbGF5ZXIuY2xhc3MgIT09ICd1bmF2YWlsYWJsZScgJiYgcGxheWVyLmF2YWlsYWJsZSAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZXJlIGlzIGEgd2FpdGluZyBwZXJpb2QgZm9yIHRoaXMgcGxheWVyXG4gICAgICAgICAgICB3YWl0aW5nRm9yUGxheWVyID0gXy5maW5kKHZtLmN1cnJlbnRVc2VyUGxheWVyLndhaXRpbmdQZXJpb2RzLCB7ICdwbGF5ZXInOiBwbGF5ZXIuX2lkIH0pO1xuICAgICAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSB3YWl0aW4gcGVyaW9kIGZvciB0aGlzIHVzZXIgZG9uJ3QgbWFrZSB0aGVtIGF2YWlsYWJsZVxuICAgICAgICAgICAgaWYgKHdhaXRpbmdGb3JQbGF5ZXIgJiYgbW9tZW50KCkuaXNCZWZvcmUod2FpdGluZ0ZvclBsYXllci5leHBpcmVzKSkge1xuICAgICAgICAgICAgICBwbGF5ZXIuY2xhc3MgPSAnd2FpdGluZyc7XG4gICAgICAgICAgICAgIHBsYXllci53YWl0VW50aWwgPSBtb21lbnQod2FpdGluZ0ZvclBsYXllci5leHBpcmVzKS5mb3JtYXQoJ01NTSBEbyAgTFQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHZtLmF2YWlsYWJsZUNoYWxsZW5nZXMgPSB0cnVlO1xuICAgICAgICAgICAgICBwbGF5ZXIuYXZhaWxhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgcGxheWVyLmNsYXNzID0gJ2F2YWlsYWJsZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY2hhbGxlbmdlIGJldHdlZW4gdGhlIGN1cnJlbnQgdXNlciBhbmQgdGhlIHBsYXllciBzZWxlY3RlZFxuICAgICAqIFxuICAgICAqIEBwYXJhbSAge29iamVjdH0gcGxheWVyLCB0aGUgY2hhbGxlbmdlZCBwbGF5ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFsbGVuZ2UocGxheWVyKSB7XG4gICAgICBpZiAoIXBsYXllci5hdmFpbGFibGUpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignU29ycnksIHRoYXQgaXMgbm90IGEgdmFsaWQgY2hhbGxlbmdlLicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gdHJ1ZTtcbiAgICAgICAgdmFyIGNoYWxsZW5nZSA9IHtcbiAgICAgICAgICB0eXBlOiB2bS5jb21wZXRpdGlvbi50eXBlLFxuICAgICAgICAgIGNvbXBldGl0aW9uTmFtZTogdm0uY29tcGV0aXRpb24ubmFtZSxcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiB2bS5jb21wZXRpdGlvbklkLFxuICAgICAgICAgIGNvbXBsZXRlOiBmYWxzZSxcbiAgICAgICAgICBmb3JmZWl0OiBmYWxzZSxcbiAgICAgICAgICB0aW1lTGltaXQ6IHZtLmNvbXBldGl0aW9uLmZvcmZlaXREYXlzLFxuICAgICAgICAgIGNoYWxsZW5nZXI6IHtcbiAgICAgICAgICAgIF9pZDogdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkLFxuICAgICAgICAgICAgZW1haWw6IHZtLmN1cnJlbnRVc2VyUGxheWVyLmVtYWlsLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiB2bS5jdXJyZW50VXNlclBsYXllci5maXJzdE5hbWUsXG4gICAgICAgICAgICBsYXN0TmFtZTogdm0uY3VycmVudFVzZXJQbGF5ZXIubGFzdE5hbWUsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogdm0uY3VycmVudFVzZXJQbGF5ZXIuZGlzcGxheU5hbWUsXG4gICAgICAgICAgICBwb3NpdGlvbjogdm0uY3VycmVudFVzZXJQbGF5ZXIucG9zaXRpb25cbiAgICAgICAgICB9LFxuICAgICAgICAgIG9wcG9uZW50OiB7XG4gICAgICAgICAgICBfaWQ6IHBsYXllci5faWQsXG4gICAgICAgICAgICBlbWFpbDogcGxheWVyLmVtYWlsLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiBwbGF5ZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgbGFzdE5hbWU6IHBsYXllci5sYXN0TmFtZSxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBwbGF5ZXIuZGlzcGxheU5hbWUsXG4gICAgICAgICAgICBwb3NpdGlvbjogcGxheWVyLnBvc2l0aW9uXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvLyBDcmVhdGUgdGhlIGNoYWxsZW5nZVxuICAgICAgICAvLyBXZWJzb2NrZXQgZXZlbnQgd2lsbCByZWZyZXNoIHRoZSBjb21wZXRpdGlvblxuICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jcmVhdGVQeXJhbWlkQ2hhbGxlbmdlKGNoYWxsZW5nZSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdm0uY29tcGV0aXRpb25NZW51VG9nZ2xlID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFsbG93cyB0aGUgY2hhbGxlbmdlciB0byBjYW5jZWwgYSBjaGFsbGVuZ2VcbiAgICAvLyBJbmZvcm1zIHRoZSBvcHBvbmVudCB0byBhc2sgdGhlIGNoYWxsZW5nZXIgdG8gY2FuY2VsIHRoZSBvcHBvbmVudFxuICAgIGZ1bmN0aW9uIGNhbmNlbENoYWxsZW5nZSgpIHtcbiAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcih2bS5jb21wZXRpdGlvbklkLCB2bS5jdXJyZW50VXNlclBsYXllci5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEpIHtcbiAgICAgICAgICAvLyBBbGxvdyB0aGUgY2hhbGxlbmdlciB0byBjYW5jZWwgdGhlIGNoYWxsZW5nZVxuICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLl9pZCA9PT0gdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jYW5jZWxQeXJhbWlkQ2hhbGxlbmdlKGNoYWxsZW5nZS5kYXRhKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbXBsZXRlIGEgY2hhbGxlbmdlIGJ5IGEgdXNlciBpbnRlcmFjdGlvbiBvciBhIGZvcmZlaXRcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSB3aW5uZXJJc0N1cnJlbnRVc2VyXG4gICAgICogQHBhcmFtICB7Ym9vbGVhbn0gZm9yZmVpdFxuICAgICAqIEBwYXJhbSAge29iamVjdH0gZm9yZmVpdExvc2VyXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29tcGxldGVDaGFsbGVuZ2Uod2lubmVySXNDdXJyZW50VXNlciwgZm9yZmVpdCwgZm9yZmVpdExvc2VyKSB7XG4gICAgICB2YXIgcGxheWVyID0gZm9yZmVpdExvc2VyIHx8IHZtLmN1cnJlbnRVc2VyUGxheWVyO1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllci5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcblxuICAgICAgICB2YXIgc3dhcFBvc2l0aW9ucyA9IGZhbHNlO1xuXG4gICAgICAgIC8vIElmIHRoZXJlIGlzIGEgZm9yZmVpdFxuICAgICAgICBpZiAoZm9yZmVpdCkge1xuICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLmZvcmZlaXQgPSB0cnVlO1xuICAgICAgICAgIGlmIChmb3JmZWl0TG9zZXIuY2hhbGxlbmdlLnBvc2l0aW9uID09PSAnb3Bwb25lbnQnKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnY2hhbGxlbmdlcic7XG4gICAgICAgICAgICBzd2FwUG9zaXRpb25zID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ29wcG9uZW50JztcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gRmlndXJlIG91dCB3aG8gdGhlIHdpbm5lciB3YXMgdG8gc3RvcmUgaW4gdGhlIGNoYWxsZW5nZSByZWNvcmRcbiAgICAgICAgfSBlbHNlIGlmICh3aW5uZXJJc0N1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgaWYgKGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIuX2lkID09PSB2bS5jdXJyZW50VXNlclBsYXllci5faWQpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdjaGFsbGVuZ2VyJztcbiAgICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnb3Bwb25lbnQnO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci5faWQgPT09IHZtLmN1cnJlbnRVc2VyUGxheWVyLl9pZCkge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ29wcG9uZW50JztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ2NoYWxsZW5nZXInO1xuICAgICAgICAgICAgc3dhcFBvc2l0aW9ucyA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGxvc2VyLCB3aW5uZXIgPSBudWxsO1xuICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEud2lubmVyID09PSAnb3Bwb25lbnQnKSB7XG4gICAgICAgICAgd2lubmVyID0gY2hhbGxlbmdlLmRhdGEub3Bwb25lbnQ7XG4gICAgICAgICAgbG9zZXIgPSBjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHdpbm5lciA9IGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXI7XG4gICAgICAgICAgbG9zZXIgPSBjaGFsbGVuZ2UuZGF0YS5vcHBvbmVudDtcbiAgICAgICAgfVxuICAgICAgICBjb21wZXRpdGlvbnNTZXJ2aWNlLmNyZWF0ZVdhaXRpbmdQZXJpb2Qodm0uY29tcGV0aXRpb25JZCwgbG9zZXIuX2lkLCB3aW5uZXIuX2lkLCB2bS5jb21wZXRpdGlvbi53YWl0aW5nUGVyaW9kRGF5cyk7XG5cbiAgICAgICAgLy8gU3dhcCBwb3NpdGlvbnMgYW5kIHRoZW4gY29tcGxldGUgdGhlIGNoYWxsZW5nZSBvciBqdXN0IGNvbXBsZXRlIHRoZSBjaGFsbGVuZ2VcbiAgICAgICAgLy8gV2Vic29ja2V0IGV2ZW50IHdpbGwgcmVmcmVzaCB0aGUgY29tcGV0aXRpb25cbiAgICAgICAgaWYgKHN3YXBQb3NpdGlvbnMpIHtcbiAgICAgICAgICBjb21wZXRpdGlvbnNTZXJ2aWNlLnN3YXBQb3NpdGlvbnModm0uY29tcGV0aXRpb25JZCwgY2hhbGxlbmdlLmRhdGEub3Bwb25lbnQsIGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY29tcGxldGVQeXJhbWlkQ2hhbGxlbmdlKGNoYWxsZW5nZS5kYXRhKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgaWYgKHJlbW92aW5nQ3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgICByZW1vdmVDdXJyZW50VXNlckZyb21Db21wZXRpdGlvbigpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jb21wbGV0ZVB5cmFtaWRDaGFsbGVuZ2UoY2hhbGxlbmdlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHJlbW92aW5nQ3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgcmVtb3ZlQ3VycmVudFVzZXJGcm9tQ29tcGV0aXRpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2bS5jb21wZXRpdGlvbk1lbnVUb2dnbGUgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxzIHRoZSBjb21wbGV0ZSBjaGFsbG5nZSBmdW5jdGlvbiB3aXRoIHRoZSBmb3JmZWl0aW5nIHBsYXllclxuICAgICAqIEBwYXJhbSAge29iamVjdH0gcGxheWVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gZm9yZmVpdENoYWxsZW5nZShwbGF5ZXIpIHtcbiAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlKG51bGwsIHRydWUsIHBsYXllcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyB0aGUgY3VycmVudCB1c2VyIHRoZSBjb21wZXRpdGlvbiBcbiAgICAgKiBpZiB0aGV5J3JlIG5vdCBhbHJlYWR5IG9uIGl0IGFuZCB0aGVyZSdzIHNwYWNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWRkQ3VycmVudFVzZXJUb0NvbXBldGl0aW9uKCkge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICBpZiAodm0ubnVtYmVyT2ZSZWFsUGxheWVycyA8IHZtLm1heFBsYXllcnMpIHtcbiAgICAgICAgICB2YXIgcGxheWVyID0ge1xuICAgICAgICAgICAgX2lkOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgbGFzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5sYXN0TmFtZSxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuZGlzcGxheU5hbWUsXG4gICAgICAgICAgICBlbWFpbDogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLnVzZXJuYW1lLFxuICAgICAgICAgICAgcG9zaXRpb246IHZtLm51bWJlck9mUmVhbFBsYXllcnMgKyAxXG4gICAgICAgICAgfTtcbiAgICAgICAgICBpZiAoIXZtLmNvbXBldGl0aW9uLnJlc3RyaWN0Sm9pbnMpIHtcbiAgICAgICAgICAgIHN3YWwoe1xuICAgICAgICAgICAgICB0aXRsZTogJ0pvaW4gQ29tcGV0aXRpb24/JyxcbiAgICAgICAgICAgICAgdGV4dDogJ1lvdVxcJ2xsIGJlIGFkZGVkIHRvIHRoZSBib3R0b20nLFxuICAgICAgICAgICAgICB0eXBlOiAnd2FybmluZycsXG4gICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnSm9pbicsXG4gICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICdOZXZlcm1pbmQnLFxuICAgICAgICAgICAgICBjbG9zZU9uQ29uZmlybTogZmFsc2UsXG4gICAgICAgICAgICAgIGNsb3NlT25DYW5jZWw6IHRydWVcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgY29tcGV0aXRpb25zU2VydmljZS5hZGRQbGF5ZXJUb0NvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllcik7XG4gICAgICAgICAgICAgIHN3YWwoJ1dlbGNvbWUgQWJvYXJkIScsICdOb3cgc3RhcnQgZmlnaHRpbmcgeW91ciB3YXkgdG8gdGhlIHRvcCcsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICB9KTsgIFxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzd2FsKHtcbiAgICAgICAgICAgICAgdGl0bGU6ICdTZW5kIEpvaW4gUmVxdWVzdD8nLFxuICAgICAgICAgICAgICB0ZXh0OiAnVGhpcyBpcyBhIGNsb3NlZCBjb21wZXRpdGlvbiBzbyBhbiBhZG1pbiBtdXN0IGFwcHJvdmUgeW91ciByZXF1ZXN0JyxcbiAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnLFxuICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLFxuICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ1NlbmQgUmVxdWVzdCcsXG4gICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICdOZXZlcm1pbmQnLFxuICAgICAgICAgICAgICBjbG9zZU9uQ29uZmlybTogZmFsc2UsXG4gICAgICAgICAgICAgIGNsb3NlT25DYW5jZWw6IHRydWVcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgY29tcGV0aXRpb25zU2VydmljZS5hZGRQbGF5ZXJUb0NvbXBldGl0aW9uUmVxdWVzdCh2bS5jb21wZXRpdGlvbiwgcGxheWVyKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2bS5jdXJyZW50VXNlcklzUGVuZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBzd2FsKCdSZXF1ZXN0IFNlbnQnLCAnWW91IHdpbGwgcmVjZWl2ZSBhbiBlbWFpbCBvbmNlIGFuIGFkbWluIHByb2Nlc3NlcyB0aGUgcmVxdWVzdC4nLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2Uud2FybmluZygnU29ycnksIHRoaXMgY29tcGV0aXRpb24gaXMgZnVsbCcpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLndhcm5pbmcoJ1BsZWFzZSBsb2dpbiB0byBqb2luIGEgY29tcGV0aXRpb24nKTtcbiAgICAgICAgJHN0YXRlLnByZXZpb3VzID0gJ2NvbXBldGl0aW9ucy52aWV3JztcbiAgICAgICAgJHN0YXRlLnByZXZQYXJhbXMgPSB7J2NvbXBldGl0aW9uSWQnOiB2bS5jb21wZXRpdGlvbklkfTtcbiAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERpc3BsYXkgY29uZmlybWF0aW9uIG1vZGFsIGZvciBsZWF2aW5nIHRoZSBjb21wZXRpdGlvbiBcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb25maXJtUmVtb3ZlQ3VycmVudFVzZXJGcm9tQ29tcGV0aXRpb24oKSB7XG4gICAgICBzd2FsKHtcbiAgICAgICAgdGl0bGU6ICdMZWF2ZSBDb21wZXRpdGlvbj8nLFxuICAgICAgICB0ZXh0OiAnWW91IHdpbGwgbG9zZSB5b3VyIHNwb3QgYW5kIGZvcmZlaXQgYW55IGFjdGl2ZSBjaGFsbGVuZ2VzLicsXG4gICAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnWWVzLCBsZWF2ZScsXG4gICAgICAgIGNvbmZpcm1CdXR0b25DbGFzczogJ2J0bi1kYW5nZXInLFxuICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAnTm8sIHN0YXknLFxuICAgICAgICBjbG9zZU9uQ29uZmlybTogZmFsc2UsXG4gICAgICAgIGNsb3NlT25DYW5jZWw6IHRydWVcbiAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmVtb3ZlQ3VycmVudFVzZXJGcm9tQ29tcGV0aXRpb24oKTtcbiAgICAgICAgc3dhbCgnT0ssIHlvdVxcJ3Igb3V0IScsICdZb3VcXCd2ZSBiZWVuIHJlbW92ZWQgZnJvbSB0aGUgY29tcGV0aXRpb24uJywgJ3N1Y2Nlc3MnKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFVzZSB0aGlzIHRvIGVuZm9yY2Ugb3JkZXIgb2Ygb3BlcmF0aW9ucyB3aGVuIHRoZSBwbGF5ZXIgdG8gYmUgcmVtb3ZlZCBoYWQgYW4gYWN0aXZlIGNoYWxsZW5nZVxuICAgIHZhciByZW1vdmluZ0N1cnJlbnRVc2VyID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBjdXJyZW50IHVzZXIgZnJvbSB0aGUgY29tcGV0aXRpb25cbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZW1vdmVDdXJyZW50VXNlckZyb21Db21wZXRpdGlvbigpIHtcbiAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgdXNlciBpcyBsb2dnZWQgaW4gYW5kIGlzIG9uIHRoaXMgY29tcGV0aXRpb25cbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkgJiYgdm0uY3VycmVudFVzZXJJc09uQ29tcGV0aXRpb24pIHtcbiAgICAgICAgcmVtb3ZpbmdDdXJyZW50VXNlciA9IHRydWU7XG4gICAgICAgIC8vIEZvcmZlaXQgaWYgdGhleSBoYXZlIGFuIGFjdGl2ZSBjaGFsbGVuZ2VcbiAgICAgICAgaWYgKHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSkge1xuICAgICAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlKG51bGwsIHRydWUsIHZtLmN1cnJlbnRVc2VyUGxheWVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBTaW5jZSB3ZSBhcmUgcmVtb3ZpbmcgdGhlbSAuLi5cbiAgICAgICAgICB2bS5jdXJyZW50VXNlcklzT25Db21wZXRpdGlvbiA9IGZhbHNlO1xuICAgICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IGZhbHNlO1xuXG4gICAgICAgICAgLy8gR2V0IGFuIHVwZGF0ZWQgY29weSBvZiB0aGUgY29tcGV0aXRpb24gaW5jYXNlIGEgZm9yZmVpdCBoYXBwZW5lZFxuICAgICAgICAgIGNvbXBldGl0aW9uc1NlcnZpY2UuZ2V0Q29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIHVwZGF0ZWQgY29weSBsb2NhbGx5IHNvIGFzIG5vdCB0byBkaXN0cnVwdCB0aGUgY29tcGV0aXRpb25cbiAgICAgICAgICAgIC8vIHVudGlsIHRoZSBwbGF5ZXIgaGFzIGJlZW4gcmVtb3ZlZFxuICAgICAgICAgICAgdmFyIGNvbXBldGl0aW9uID0gcC5kYXRhO1xuXG4gICAgICAgICAgICAvLyBLZWVwIHRyYWNrIG9mIHRoZSBzcG90IHRoZXkgd2VyZSBpbiBvbiB0aGUgY29tcGV0aXRpb25cbiAgICAgICAgICAgIHZhciBvcGVuUG9zaXRpb24gPSB2bS5jdXJyZW50VXNlclBsYXllci5wb3NpdGlvbjtcblxuICAgICAgICAgICAgLy8gTW92ZSBhbGwgdGhlIHBsYXllcnMgdXAgMSBwb3NpdGlvbiB0aGF0IHdlcmUgYmVoaW5kIHRoZSByZW1vdmVkIHBsYXllclxuICAgICAgICAgICAgXy5mb3JFYWNoKGNvbXBldGl0aW9uLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgICAgICAgaWYgKHBsYXllci5wb3NpdGlvbiA+PSBvcGVuUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIucG9zaXRpb24gLT0gMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZWQgdGhlIHBsYXllciBmcm9tIHRoZSBjb21wZXRpdGlvblxuICAgICAgICAgICAgdmFyIHJlbW92ZWRQbGF5ZXIgPSBfLnJlbW92ZShjb21wZXRpdGlvbi5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgICAgICAgIHJldHVybiBwbGF5ZXIuX2lkID09PSB2bS5jdXJyZW50VXNlclBsYXllci5faWQ7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gTWFrZSBhIG5ldyBhcnJheSBvZiBhbGwgdGhlIHBsYXllcnMgc3RpbGwgb24gdGhlIGNvbXBldGl0aW9uXG4gICAgICAgICAgICAvLyBvbmx5IHVzZSB0aGUgcHJvcGVydGllcyB3ZSB3YW50IHRvIHN0b3JlIGluIHRoZSBjb21wZXRpdGlvbiBkb2N1bWVudFxuICAgICAgICAgICAgdmFyIHVwZGF0ZWRQbGF5ZXJzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLm51bWJlck9mUmVhbFBsYXllcnMgLSAxOyArK2kpIHtcbiAgICAgICAgICAgICAgdmFyIHVwZGF0ZWRQbGF5ZXIgPSB7XG4gICAgICAgICAgICAgICAgX2lkOiBjb21wZXRpdGlvbi5wbGF5ZXJzW2ldLl9pZCxcbiAgICAgICAgICAgICAgICBmaXJzdE5hbWU6IGNvbXBldGl0aW9uLnBsYXllcnNbaV0uZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgIGxhc3ROYW1lOiBjb21wZXRpdGlvbi5wbGF5ZXJzW2ldLmxhc3ROYW1lLFxuICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBjb21wZXRpdGlvbi5wbGF5ZXJzW2ldLmRpc3BsYXlOYW1lLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBjb21wZXRpdGlvbi5wbGF5ZXJzW2ldLnBvc2l0aW9uXG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgdXBkYXRlZFBsYXllcnMucHVzaCh1cGRhdGVkUGxheWVyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ2FsbCBzZXJ2aWNlIHRvIHJlbW92ZSB0aGUgcGxheWVyXG4gICAgICAgICAgICBjb21wZXRpdGlvbnNTZXJ2aWNlLnJlbW92ZWRQbGF5ZXJGcm9tQ29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCwgcmVtb3ZlZFBsYXllclswXSwgdXBkYXRlZFBsYXllcnMpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICByZW1vdmluZ0N1cnJlbnRVc2VyID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpZ3VyZSBvdXQgd2hhdCB0aGUgYXBwcm9wcmlhdGUgYWN0aW9uIGlzIGJhc2VkIG9uIHRoZSBwbGF5ZXIgY2xpY2tpbmcgYW5kIHRoZSBwbGF5ZXIgYmVpbmcgY2xpY2tlZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHBsYXllckNsaWNrKHBsYXllcikge1xuICAgICAgLy8gY2xpY2tlZCBvbiBlbXB0eSBzcG90XG4gICAgICBpZiAocGxheWVyLnBvc2l0aW9uID09PSA5OSAmJiAhdm0uY3VycmVudFVzZXJJc09uQ29tcGV0aXRpb24pIHtcbiAgICAgICAgYWRkQ3VycmVudFVzZXJUb0NvbXBldGl0aW9uKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwbGF5ZXIuc2hvd0NoYWxsZW5nZU1vZGFsID0gIXBsYXllci5zaG93Q2hhbGxlbmdlTW9kYWw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVmcmVzaCB0aGUgY29tcGV0aXRpb24gYmVjYXN1ZSBvZiBhbiB1cGRhdGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZWZyZXNoQ29tcGV0aXRpb24oKSB7XG4gICAgICBjb21wZXRpdGlvbnNTZXJ2aWNlLmdldENvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKGNvbXBldGl0aW9uKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uID0gY29tcGV0aXRpb24uZGF0YTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjb21wZXRpdGlvbl91cGRhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoQ29tcGV0aXRpb24oKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnd3BtVXBkYXRlQWRtaW5zJywgd3BtVXBkYXRlQWRtaW5zKTtcblxuICBmdW5jdGlvbiB3cG1VcGRhdGVBZG1pbnMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbjogJz0nXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY29tcGV0aXRpb25zL2NvbXBvbmVudHMvdXBkYXRlLWFkbWlucy5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUsIGNvbXBldGl0aW9uc1NlcnZpY2UsIGNoYWxsZW5nZXNTZXJ2aWNlLCB1c2VyU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlKSB7XG4gICAgdmFyIHJlbW92ZWRBZG1pbnMgPSBbXTtcbiAgICB2YXIgb3JpZ2luYWxBdmFpbGFibGVBZG1pbnMgPSBbXTtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmF2YWlsYWJsZUFkbWlucyA9IFtdO1xuICAgIHZtLmFkZGVkQWRtaW5zID0gW107XG4gICAgdm0udXNlcklzUHJpbWFyeUFkbWluID0gZmFsc2U7XG4gICAgdm0udXBkYXRlQ29tcGV0aXRpb24gPSB1cGRhdGVDb21wZXRpdGlvbjtcbiAgICB2bS5jYW5jZWxVcGRhdGUgPSBjYW5jZWxVcGRhdGU7XG4gICAgdm0ucmVtb3ZlQWRtaW4gPSByZW1vdmVBZG1pbjtcbiAgICB2bS5hZGRBZG1pbiA9IGFkZEFkbWluO1xuICAgIHZtLmRpc2FibGVTdWJtaXQgPSB0cnVlO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgJHNjb3BlLiR3YXRjaCgndm0uY29tcGV0aXRpb24nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh2bS5jb21wZXRpdGlvbikge1xuICAgICAgICAgIHZtLmFkZGVkQWRtaW5zID0gXy5jbG9uZURlZXAodm0uY29tcGV0aXRpb24uYWRtaW5zKTtcbiAgICAgICAgICB2bS5kaXNhYmxlU3VibWl0ID0gdHJ1ZTtcbiAgICAgICAgICB2bS51c2VySXNQcmltYXJ5QWRtaW4gPSBfLmZpbmQodm0uY29tcGV0aXRpb24uYWRtaW5zLCB7J3ByaW1hcnknOiB0cnVlfSkuX2lkID09PSBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkID8gdHJ1ZTogZmFsc2U7XG4gICAgICAgICAgZ2V0QXZhaWxhYmxlQWRtaW5zKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEF2YWlsYWJsZUFkbWlucygpIHtcbiAgICAgIHZtLmF2YWlsYWJsZUFkbWlucyA9IFtdO1xuICAgICAgcmVtb3ZlZEFkbWlucyA9IFtdO1xuICAgICAgdXNlclNlcnZpY2UuZ2V0VmVyaWZpZWRVc2VycygpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIC8vIFJlbW92ZSB0aGUgY3VycmVudCBhZG1pbnMgZnJvbSB0aGUgbGlzdCBvZiBhdmFpbGFibGUgYWRtaW5zXG4gICAgICAgIF8uZm9yRWFjaCh2bS5jb21wZXRpdGlvbi5hZG1pbnMsIGZ1bmN0aW9uIChjb21wZXRpdGlvbkFkbWluKSB7XG4gICAgICAgICAgXy5yZW1vdmUodXNlcnMuZGF0YSwgZnVuY3Rpb24gKGF2YWlsYWJsZUFkbWluKXtcbiAgICAgICAgICAgIHJldHVybiBjb21wZXRpdGlvbkFkbWluLl9pZCA9PT0gYXZhaWxhYmxlQWRtaW4uX2lkO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gT25seSB1c2UgY2VydGFpbiBwcm9wZXJ0aWVzIG9mIHRoZSB1c2VyIGZvciB0aGUgYWRtaW4gcmVjb3JkXG4gICAgICAgIF8uZm9yRWFjaCh1c2Vycy5kYXRhLCBmdW5jdGlvbiAoYXZhaWxhYmxlQWRtaW4pIHtcbiAgICAgICAgICB2bS5hdmFpbGFibGVBZG1pbnMucHVzaCh7XG4gICAgICAgICAgICBmaXJzdE5hbWU6IGF2YWlsYWJsZUFkbWluLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiBhdmFpbGFibGVBZG1pbi5sYXN0TmFtZSxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBhdmFpbGFibGVBZG1pbi5kaXNwbGF5TmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiBhdmFpbGFibGVBZG1pbi51c2VybmFtZSxcbiAgICAgICAgICAgIF9pZDogYXZhaWxhYmxlQWRtaW4uX2lkXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG9yaWdpbmFsQXZhaWxhYmxlQWRtaW5zID0gXy5jbG9uZURlZXAodm0uYXZhaWxhYmxlQWRtaW5zKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFBlcmZvcm0gdGhlIHVwZGF0ZXMgdGhhdCB3ZXJlIHJlcXVzdGVkXG4gICAgZnVuY3Rpb24gdXBkYXRlQ29tcGV0aXRpb24oKSB7XG4gICAgICB2bS5jb21wZXRpdGlvbi5hZG1pbnMgPSB2bS5hZGRlZEFkbWlucztcbiAgICAgIGNvbXBldGl0aW9uc1NlcnZpY2UudXBkYXRlQ29tcGV0aXRpb24odm0uY29tcGV0aXRpb24pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICB2bS5kaXNhYmxlU3VibWl0ID0gdHJ1ZTtcbiAgICAgIH0pOyAgIFxuICAgIH1cblxuICAgIC8vIENhbmNlbCB0aGUgdXBkYXRlIGFuZCBwdXQgZXZlcnl0aGluZyBiYWNrIHRvIHRoZSBvcmdpbmFsXG4gICAgZnVuY3Rpb24gY2FuY2VsVXBkYXRlKCkge1xuICAgICAgcmVtb3ZlZEFkbWlucyA9IFtdO1xuICAgICAgdm0uYWRkZWRBZG1pbnMgPSBfLmNsb25lRGVlcCh2bS5jb21wZXRpdGlvbi5hZG1pbnMpO1xuICAgICAgdm0uYXZhaWxhYmxlQWRtaW5zID0gXy5jbG9uZURlZXAob3JpZ2luYWxBdmFpbGFibGVBZG1pbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYW4gYWRtaW4gZnJvbSB0aGUgY29tcGV0aXRpb25cbiAgICAgKiBRdWV1ZSB1cCB0aGUgYWRtaW5zIHRvIGJlIHJlbW92ZWQgYW5kIHJlbW92ZSB0aGVtIGZyb20gdGhlIGRpc3BsYXlcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IGFkbWluXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVtb3ZlQWRtaW4oYWRtaW4pIHtcbiAgICAgIHJlbW92ZWRBZG1pbnMucHVzaChhZG1pbik7XG4gICAgICB2bS5hdmFpbGFibGVBZG1pbnMucHVzaChfLnJlbW92ZSh2bS5hZGRlZEFkbWlucywge19pZDogYWRtaW4uX2lkfSlbMF0pO1xuICAgICAgdm0uZGlzYWJsZVN1Ym1pdCA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZHMgYW4gYWRtaW4gdG8gdGhlIGNvbXBldGl0aW9uXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBhZG1pblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZEFkbWluKGFkbWluKSB7XG4gICAgICB2bS5hZGRlZEFkbWlucy5wdXNoKF8ucmVtb3ZlKHZtLmF2YWlsYWJsZUFkbWlucywge19pZDogYWRtaW4uX2lkfSlbMF0pO1xuICAgICAgdm0uZGlzYWJsZVN1Ym1pdCA9IGZhbHNlO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnd3BtVXBkYXRlUGxheWVycycsIHdwbVVwZGF0ZVBsYXllcnMpO1xuXG4gIGZ1bmN0aW9uIHdwbVVwZGF0ZVBsYXllcnMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbjogJz0nXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY29tcGV0aXRpb25zL2NvbXBvbmVudHMvdXBkYXRlLXBsYXllcnMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBjb21wZXRpdGlvbnNTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSwgdXNlclNlcnZpY2UsIG5vdGlmeVNlcnZpY2UpIHtcbiAgICB2YXIgcmVtb3ZlZFBsYXllcnMgPSBbXTtcbiAgICB2YXIgb3JpZ2luYWxBdmFpbGFibGVQbGF5ZXJzID0gW107XG4gICAgdmFyIG1heExldmVscyA9IDc7XG4gICAgdmFyIG1heFBsYXllcnMgPSBudWxsO1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IFtdO1xuICAgIHZtLmFkZGVkUGxheWVycyA9IFtdO1xuICAgIHZtLnVwZGF0ZUNvbXBldGl0aW9uID0gdXBkYXRlQ29tcGV0aXRpb247XG4gICAgdm0uY2FuY2VsVXBkYXRlID0gY2FuY2VsVXBkYXRlO1xuICAgIHZtLnJlb3JkZXJQbGF5ZXJzID0gcmVvcmRlclBsYXllcnM7XG4gICAgdm0ucmVtb3ZlUGxheWVyID0gcmVtb3ZlUGxheWVyO1xuICAgIHZtLmFkZFBsYXllciA9IGFkZFBsYXllcjtcbiAgICB2bS5kaXNhYmxlU3VibWl0ID0gdHJ1ZTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIC8vIERldGVybWluZSB0aGUgbWF4aW11bSBudW1iZXIgb2YgcGxheWVycyBiYXNlZCBvbiB0aGUgbWF4aW11bSBudW1iZXIgb2YgbGV2ZWxzXG4gICAgICBmb3IgKHZhciBpID0gbWF4TGV2ZWxzOyBpID4gMDsgLS1pKSB7XG4gICAgICAgIG1heFBsYXllcnMgKz0gaTtcbiAgICAgIH1cbiAgICAgICRzY29wZS4kd2F0Y2goJ3ZtLmNvbXBldGl0aW9uJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodm0uY29tcGV0aXRpb24pIHtcbiAgICAgICAgICB2bS5hZGRlZFBsYXllcnMgPSBfLmNsb25lRGVlcCh2bS5jb21wZXRpdGlvbi5wbGF5ZXJzKTtcbiAgICAgICAgICB2bS5kaXNhYmxlU3VibWl0ID0gdHJ1ZTtcbiAgICAgICAgICBnZXRBdmFpbGFibGVQbGF5ZXJzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEF2YWlsYWJsZVBsYXllcnMoKSB7XG4gICAgICB2bS5hdmFpbGFibGVQbGF5ZXJzID0gW107XG4gICAgICByZW1vdmVkUGxheWVycyA9IFtdO1xuICAgICAgdXNlclNlcnZpY2UuZ2V0VmVyaWZpZWRVc2VycygpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIF8uZm9yRWFjaCh2bS5jb21wZXRpdGlvbi5wbGF5ZXJzLCBmdW5jdGlvbiAoY29tcGV0aXRpb25QbGF5ZXIpIHtcbiAgICAgICAgICBfLnJlbW92ZSh1c2Vycy5kYXRhLCBmdW5jdGlvbiAoYXZhaWxhYmxlUGxheWVyKXtcbiAgICAgICAgICAgIHJldHVybiBjb21wZXRpdGlvblBsYXllci5faWQgPT09IGF2YWlsYWJsZVBsYXllci5faWQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBPbmx5IHVzZSBjZXJ0YWluIHByb3BlcnRpZXMgb2YgdGhlIHVzZXIgZm9yIHRoZSBwbGF5ZXIgcmVjb3JkXG4gICAgICAgIF8uZm9yRWFjaCh1c2Vycy5kYXRhLCBmdW5jdGlvbiAoYXZhaWxhYmxlUGxheWVyKSB7XG4gICAgICAgICAgdm0uYXZhaWxhYmxlUGxheWVycy5wdXNoKHtcbiAgICAgICAgICAgIGZpcnN0TmFtZTogYXZhaWxhYmxlUGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiBhdmFpbGFibGVQbGF5ZXIubGFzdE5hbWUsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogYXZhaWxhYmxlUGxheWVyLmRpc3BsYXlOYW1lLFxuICAgICAgICAgICAgZW1haWw6IGF2YWlsYWJsZVBsYXllci51c2VybmFtZSxcbiAgICAgICAgICAgIF9pZDogYXZhaWxhYmxlUGxheWVyLl9pZFxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIG9yaWdpbmFsQXZhaWxhYmxlUGxheWVycyA9IF8uY2xvbmVEZWVwKHZtLmF2YWlsYWJsZVBsYXllcnMpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUGVyZm9ybSB0aGUgdXBkYXRlcyB0aGF0IHdlcmUgcmVxdXN0ZWRcbiAgICBmdW5jdGlvbiB1cGRhdGVDb21wZXRpdGlvbigpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbi50eXBlID09PSAndmVyc3VzJyAmJiB2bS5hZGRlZFBsYXllcnMubGVuZ3RoICUgMiA+IDApIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignQSBWZXJzdXMgY29tcGV0aXRpb24gbXVzdCBoYXZlIGFuIGV2ZW4gbnVtYmVyIG9mIHBsYXllcnMnKTtcbiAgICAgIH0gZWxzZSBpZiAodm0uYWRkZWRQbGF5ZXJzLmxlbmd0aCA+IG1heFBsYXllcnMpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignQSBjb21wZXRpdGlvbiBjYW4gaGF2ZSBhIG1heGltdW0gb2YgJyArIG1heFBsYXllcnMgKyAnIHBsYXllcnMnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF8uZm9yRWFjaChyZW1vdmVkUGxheWVycywgZnVuY3Rpb24ocGxheWVyKSB7XG4gICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZGVsZXRlQWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKHZtLmNvbXBldGl0aW9uLl9pZCwgcGxheWVyLl9pZCk7XG4gICAgICAgIH0pO1xuICAgICAgICB2bS5jb21wZXRpdGlvbi5wbGF5ZXJzID0gdm0uYWRkZWRQbGF5ZXJzO1xuICAgICAgICBjb21wZXRpdGlvbnNTZXJ2aWNlLnVwZGF0ZUNvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2bS5kaXNhYmxlU3VibWl0ID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2FuY2VsIHRoZSB1cGRhdGUgYW5kIHB1dCBldmVyeXRoaW5nIGJhY2sgdG8gdGhlIG9yZ2luYWxcbiAgICBmdW5jdGlvbiBjYW5jZWxVcGRhdGUoKSB7XG4gICAgICByZW1vdmVkUGxheWVycyA9IFtdO1xuICAgICAgdm0uYWRkZWRQbGF5ZXJzID0gXy5jbG9uZURlZXAodm0uY29tcGV0aXRpb24ucGxheWVycyk7XG4gICAgICB2bS5hdmFpbGFibGVQbGF5ZXJzID0gXy5jbG9uZURlZXAob3JpZ2luYWxBdmFpbGFibGVQbGF5ZXJzKTtcbiAgICB9XG5cbiAgICAvLyBSZW9yZGVyIHRoZSBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBkcmFnLWRyb3BcbiAgICBmdW5jdGlvbiByZW9yZGVyUGxheWVycygpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbi50eXBlID09PSAndmVyc3VzJykge1xuICAgICAgICByZW9yZGVyVmVyc3VzUGxheWVycygpO1xuICAgICAgfSBlbHNlIGlmICh2bS5jb21wZXRpdGlvbi50eXBlID09PSAncHlyYW1pZCcpIHtcbiAgICAgICAgcmVvcmRlclB5cmFtaWRQbGF5ZXJzKCk7XG4gICAgICB9XG4gICAgICB2bS5kaXNhYmxlU3VibWl0ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVvcmRlciB0aGUgcGxheWVycyBiYXNlZCBvbiB0aGUgZHJhZy1kcm9wXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVvcmRlclB5cmFtaWRQbGF5ZXJzKCkge1xuICAgICAgdmFyIGkgPSAxO1xuICAgICAgXy5mb3JFYWNoKHZtLmFkZGVkUGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICBwbGF5ZXIucG9zaXRpb24gPSBpO1xuICAgICAgICArK2k7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW9yZGVyVmVyc3VzUGxheWVycygpIHtcbiAgICAgIC8vIFNldCBhbGwgcGxheWVycyB0byB0ZWFtIDJcbiAgICAgIF8uZm9yRWFjaCh2bS5hZGRlZFBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgcGxheWVyLnBvc2l0aW9uID0gMjtcbiAgICAgIH0pO1xuICAgICAgLy8gU2V0IHRoZSBmaXJzdCBoYWxmIG9mIHRoZSBwbGF5ZXJzIHRvIHRlYW0gMVxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAodm0uYWRkZWRQbGF5ZXJzLmxlbmd0aCAvIDIpOyBpKyspIHtcbiAgICAgICAgdm0uYWRkZWRQbGF5ZXJzW2ldLnBvc2l0aW9uID0gMTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGEgcGxheWVyIGZyb20gdGhlIGNvbXBldGl0aW9uXG4gICAgICogUXVldWUgdXAgdGhlIHBsYXllcnMgdG8gYmUgcmVtb3ZlZCBhbmQgcmVtb3ZlIHRoZW0gZnJvbSB0aGUgZGlzcGxheVxuICAgICAqIEBwYXJhbSAge29iamVjdH0gcGxheWVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVtb3ZlUGxheWVyKHBsYXllcikge1xuICAgICAgcmVtb3ZlZFBsYXllcnMucHVzaChwbGF5ZXIpO1xuICAgICAgdm0uYXZhaWxhYmxlUGxheWVycy5wdXNoKF8ucmVtb3ZlKHZtLmFkZGVkUGxheWVycywge19pZDogcGxheWVyLl9pZH0pWzBdKTtcbiAgICAgIHJlb3JkZXJQbGF5ZXJzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBhIHBsYXllciB0byB0aGUgbmV3IGNvbXBldGl0aW9uXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBwbGF5ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhZGRQbGF5ZXIocGxheWVyKSB7XG4gICAgICB2bS5hZGRlZFBsYXllcnMucHVzaChfLnJlbW92ZSh2bS5hdmFpbGFibGVQbGF5ZXJzLCB7X2lkOiBwbGF5ZXIuX2lkfSlbMF0pO1xuICAgICAgcmVvcmRlclBsYXllcnMoKTtcbiAgICAgIHZtLmRpc2FibGVTdWJtaXQgPSBmYWxzZTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCd3cG1WZXJzdXMnLCB3cG1WZXJzdXMpO1xuXG4gIGZ1bmN0aW9uIHdwbVZlcnN1cygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbXBldGl0aW9ucy9jb21wb25lbnRzL3ZlcnN1cy5odG1sJyxcbiAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbjogJz0nXG4gICAgICB9LFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBjb21wZXRpdGlvbnNTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UsIGNoYWxsZW5nZXNTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jb21wZXRpdGlvbklkID0gbnVsbDtcbiAgICB2bS5jdXJyZW50VXNlcklzQWRtaW4gPSBmYWxzZTtcbiAgICB2bS5jdXJyZW50VXNlcklzUGVuZGluZyA9IGZhbHNlO1xuICAgIHZtLmN1cnJlbnRVc2VySXNPbkNvbXBldGl0aW9uID0gZmFsc2U7XG4gICAgdm0uYWN0aXZlQ2hhbGxlbmdlID0gbnVsbDtcbiAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcbiAgICB2bS5jdXJyZW50VXNlclBsYXllciA9IG51bGw7XG4gICAgdm0uY3JlYXRlQ2hhbGxlbmdlID0gY3JlYXRlQ2hhbGxlbmdlO1xuICAgIHZtLmNvbXBsZXRlQ2hhbGxlbmdlID0gY29tcGxldGVDaGFsbGVuZ2U7XG4gICAgdm0uY2hhbGxlbmdlRXhwaXJlVGltZSA9IG51bGw7XG4gICAgdm0uc2hvd0NvbnRyb2xzID0gZmFsc2U7XG4gICAgdm0uc2hvd0NoYWxsZW5nZU1vZGFsID0gZmFsc2U7XG4gICAgdm0udG9nZ2xlQ29udHJvbHMgPSB0b2dnbGVDb250cm9scztcbiAgICB2bS5zaW5nbGVQbGF5ZXJUZWFtcyA9IGZhbHNlO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgJHNjb3BlLiR3YXRjaCgndm0uY29tcGV0aXRpb24nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh2bS5jb21wZXRpdGlvbikge1xuICAgICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSB2bS5jb21wZXRpdGlvbi5faWQ7XG4gICAgICAgICAgdm0uc2hvd0NvbnRyb2xzID0gZmFsc2U7XG4gICAgICAgICAgdm0uc2hvd0NoYWxsZW5nZU1vZGFsID0gZmFsc2U7XG4gICAgICAgICAgZ3JvdXBQbGF5ZXJzKCk7XG4gICAgICAgICAgZ2V0Q3VycmVudFVzZXJTdGF0dXMoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR3JvdXAgcGxheWVycyBieSB0ZWFtXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ3JvdXBQbGF5ZXJzKCkge1xuICAgICAgdm0uY29tcGV0aXRpb24udGVhbXMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBwbGF5ZXJzOiBfLmZpbHRlcih2bS5jb21wZXRpdGlvbi5wbGF5ZXJzLCBbJ3Bvc2l0aW9uJywgMV0pLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcGxheWVyczogXy5maWx0ZXIodm0uY29tcGV0aXRpb24ucGxheWVycywgWydwb3NpdGlvbicsIDJdKSxcbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uLnBsYXllcnMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIHZtLnNpbmdsZVBsYXllclRlYW1zID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaWd1cmUgb3V0IGlmIGVhY2ggcGxheWVyIGlzIGFscmVhZHkgY2hhbGxlbmdlZCBhbmQgc2V0IHNvbWUgc3R1ZmZcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRDdXJyZW50VXNlclN0YXR1cygpIHtcbiAgICAgIFxuICAgICAgdm0uY3VycmVudFVzZXJJc0FkbWluID0gZmFsc2U7XG4gICAgICB2bS5jdXJyZW50VXNlcklzUGVuZGluZyA9IGZhbHNlO1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIGN1cnJlbnQgdXNlciBpcyBhbiBhZG1pbiBvZiB0aGlzIGNvbXBldGl0aW9uXG4gICAgICAgIHZtLmN1cnJlbnRVc2VySXNBZG1pbiA9IF8uc29tZSh2bS5jb21wZXRpdGlvbi5hZG1pbnMsIFsnX2lkJywgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZF0pO1xuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIGN1cnJlbnQgdXNlciBoYXMgYSBwZW5kaW5nIHJlcXVlc3QgdG8gam9pblxuICAgICAgICB2bS5jdXJyZW50VXNlcklzUGVuZGluZyA9IF8uc29tZSh2bS5jb21wZXRpdGlvbi5wZW5kaW5nUGxheWVycywgWydfaWQnLCBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkXSk7XG4gICAgICB9XG5cbiAgICAgIHZtLmN1cnJlbnRVc2VySXNPbkNvbXBldGl0aW9uID0gZmFsc2U7XG4gICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcbiAgICAgIF8uZm9yRWFjaCh2bS5jb21wZXRpdGlvbi5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIC8vIEZpbmQgdGhlIGN1cnJlbnQgdXNlciBpZiB0aGV5IGFyZSBvbiB0aGlzIGNvbXBldGl0aW9uIGFuZCBzZXQgc29tZSBwcm9wZXJ0aWVzXG4gICAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkgJiYgcGxheWVyLl9pZCA9PT0gaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCkge1xuICAgICAgICAgIHZtLmN1cnJlbnRVc2VySXNPbkNvbXBldGl0aW9uID0gdHJ1ZTtcbiAgICAgICAgICBwbGF5ZXIuY2xhc3MgPSAnY3VycmVudC11c2VyJztcbiAgICAgICAgICB2bS5jdXJyZW50VXNlclBsYXllciA9IHBsYXllcjtcbiAgICAgICAgICB2bS5jb21wZXRpdGlvbi50ZWFtc1twbGF5ZXIucG9zaXRpb24gLSAxXS5jbGFzcyA9ICdjdXJyZW50LXVzZXItdGVhbSc7XG4gICAgICAgICAgdm0uY29tcGV0aXRpb24uY2xhc3MgPSAnY3VycmVudC11c2VyLW9uLWNvbXBldGl0aW9uJztcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIENoZWNrIGlmIHRoZXJlIGlzIGFuIGFjdGl2ZSBjaGFsbGVuZ2UgZm9yIHRoaXMgY29tcGV0aXRpb25cbiAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZtLmFjdGl2ZUNoYWxsZW5nZSA9IGNoYWxsZW5nZS5kYXRhWzBdO1xuICAgICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IHRydWU7XG5cbiAgICAgICAgICAvLyBUcmFjayB3aGVuIHRoZSBjaGFsbGVuZ2Ugd2lsbCBleHBpcmVcbiAgICAgICAgICBpZiAodm0uYWN0aXZlQ2hhbGxlbmdlLnRpbWVMaW1pdCAhPT0gMCkge1xuICAgICAgICAgICAgdmFyIHRpbWVUb0V4cGlyZSA9IG1vbWVudCgpLmRpZmYobW9tZW50KHZtLmFjdGl2ZUNoYWxsZW5nZS5jcmVhdGVkKS5hZGQodm0uYWN0aXZlQ2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2QnKSkgKiAtMTtcbiAgICAgICAgICAgIHZhciBob3Vyc1RvRXhwaXJlID0gbW9tZW50LmR1cmF0aW9uKHRpbWVUb0V4cGlyZSkuYXNIb3VycygpO1xuICAgICAgICAgICAgLy8gSWYgdGhlIGNoYWxsZW5nZSBoYXMgbm90IHlldCBleHBpcmVkIGRpc3BsYXkgYSBjb3VudGRvd25cbiAgICAgICAgICAgIGlmICh0aW1lVG9FeHBpcmUgPiAwKSB7XG4gICAgICAgICAgICAgIHZtLmNoYWxsZW5nZUV4cGlyZVRpbWUgPSBob3Vyc1RvRXhwaXJlO1xuICAgICAgICAgICAgICAvLyBJZiB0aGUgY2hhbGxlbmdlIGV4cGlyZWQgd2hpbGUgbm8gb25lIHdhcyB2aWV3aW5nIHRoaXMgY29tcGV0aXRpb24gY29tcGxldGUgdGhlIGNoYWxsZW5nZSBieSBmb3JmZWl0XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRpbWVUb0V4cGlyZSA8PSAwKSB7XG4gICAgICAgICAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlKG51bGwsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdG9nZ2xlQ29udHJvbHMoKSB7XG4gICAgICBpZiAodm0uaGFzQWN0aXZlQ2hhbGxlbmdlICYmIHZtLmN1cnJlbnRVc2VySXNPbkNvbXBldGl0aW9uKSB7XG4gICAgICAgIHZtLnNob3dDb250cm9scyA9ICF2bS5zaG93Q29udHJvbHM7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlQ2hhbGxlbmdlKHRlYW0pIHtcbiAgICAgIHZtLnNob3dDaGFsbGVuZ2VNb2RhbCA9IGZhbHNlO1xuICAgICAgaWYgKHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdTb3JyeSwgeW91IGFyZSBhbHJlYWR5IGluIGFuIGFjdGl2ZSBjaGFsbGVuZ2UuJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSB0cnVlO1xuICAgICAgICAvLyBDbG9zZSB0aGUgY2hhbGxlbmdlIG1vZGFsXG4gICAgICAgIHZhciBjaGFsbGVuZ2UgPSB7XG4gICAgICAgICAgdHlwZTogdm0uY29tcGV0aXRpb24udHlwZSxcbiAgICAgICAgICBjb21wZXRpdGlvbk5hbWU6IHZtLmNvbXBldGl0aW9uLm5hbWUsXG4gICAgICAgICAgY29tcGV0aXRpb25JZDogdm0uY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBjb21wbGV0ZTogZmFsc2UsXG4gICAgICAgICAgZm9yZmVpdDogZmFsc2UsXG4gICAgICAgICAgdGltZUxpbWl0OiB2bS5jb21wZXRpdGlvbi5mb3JmZWl0RGF5cyxcbiAgICAgICAgICBjaGFsbGVuZ2VyOiB7XG4gICAgICAgICAgICB0ZWFtOiB2bS5jdXJyZW50VXNlclBsYXllci5wb3NpdGlvbixcbiAgICAgICAgICAgIF9pZDogdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkXG4gICAgICAgICAgfSxcbiAgICAgICAgICBvcHBvbmVudDoge1xuICAgICAgICAgICAgdGVhbTogdGVhbVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBjaGFsbGVuZ2VcbiAgICAgICAgLy8gV2Vic29ja2V0IGV2ZW50IHdpbGwgcmVmcmVzaCB0aGUgY29tcGV0aXRpb25cbiAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY3JlYXRlVmVyc3VzQ2hhbGxlbmdlKGNoYWxsZW5nZSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgLy8gQ2xvc2UgdGhlIGNvbXBldGl0aW9uIHNpZGViYXJcbiAgICAgICAgICB2bS5jb21wZXRpdGlvbk1lbnVUb2dnbGUgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29tcGxldGUgYSBjaGFsbGVuZ2UgYnkgYSB1c2VyIGludGVyYWN0aW9uIG9yIGEgZm9yZmVpdFxuICAgICAqIFxuICAgICAqIEBwYXJhbSAge051bWJlcn0gd2lubmluZ1RlYW1cbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSBmb3JmZWl0XG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBmb3JmZWl0TG9zZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb21wbGV0ZUNoYWxsZW5nZSh3aW5uaW5nVGVhbSwgZm9yZmVpdCkge1xuICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gZmFsc2U7XG4gICAgICB2YXIgY2hhbGxlbmdlID0gdm0uYWN0aXZlQ2hhbGxlbmdlO1xuICAgICAgLy8gSWYgdGhlcmUgaXMgYSBmb3JmZWl0XG4gICAgICBpZiAoZm9yZmVpdCkge1xuICAgICAgICBjaGFsbGVuZ2UuZm9yZmVpdCA9IHRydWU7XG4gICAgICAgIGNoYWxsZW5nZS53aW5uZXIgPSAnY2hhbGxlbmdlcic7XG4gICAgICAvLyBGaWd1cmUgb3V0IHdobyB0aGUgd2lubmVyIHdhcyB0byBzdG9yZSBpbiB0aGUgY2hhbGxlbmdlIHJlY29yZFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHZtLmFjdGl2ZUNoYWxsZW5nZS5jaGFsbGVuZ2VyLnRlYW0gPT09IHdpbm5pbmdUZWFtKSB7XG4gICAgICAgICAgY2hhbGxlbmdlLndpbm5lciA9ICdjaGFsbGVuZ2VyJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjaGFsbGVuZ2Uud2lubmVyID0gJ29wcG9uZW50JztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5jb21wbGV0ZVZlcnN1c0NoYWxsZW5nZShjaGFsbGVuZ2UpO1xuICAgICAgdm0uY29tcGV0aXRpb25NZW51VG9nZ2xlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVmcmVzaCB0aGUgY29tcGV0aXRpb24gYmVjYXN1ZSBvZiBhbiB1cGRhdGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZWZyZXNoQ29tcGV0aXRpb24oKSB7XG4gICAgICBjb21wZXRpdGlvbnNTZXJ2aWNlLmdldENvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKGNvbXBldGl0aW9uKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uID0gY29tcGV0aXRpb24uZGF0YTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjb21wZXRpdGlvbl91cGRhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoQ29tcGV0aXRpb24oKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdjb21wZXRpdGlvbnNTZXJ2aWNlJywgY29tcGV0aXRpb25zU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gY29tcGV0aXRpb25zU2VydmljZSgkaHR0cCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0Q29tcGV0aXRpb246IGdldENvbXBldGl0aW9uLFxuICAgICAgZ2V0Q29tcGV0aXRpb25zRm9yVXNlcjogZ2V0Q29tcGV0aXRpb25zRm9yVXNlcixcbiAgICAgIGdldFB1YmxpY0NvbXBldGl0aW9uczogZ2V0UHVibGljQ29tcGV0aXRpb25zLFxuICAgICAgZ2V0UHJpdmF0ZUNvbXBldGl0aW9uczogZ2V0UHJpdmF0ZUNvbXBldGl0aW9ucyxcbiAgICAgIGNyZWF0ZUNvbXBldGl0aW9uOiBjcmVhdGVDb21wZXRpdGlvbixcbiAgICAgIHVwZGF0ZUNvbXBldGl0aW9uOiB1cGRhdGVDb21wZXRpdGlvbixcbiAgICAgIGRlbGV0ZUNvbXBldGl0aW9uOiBkZWxldGVDb21wZXRpdGlvbixcbiAgICAgIGNyZWF0ZVdhaXRpbmdQZXJpb2Q6IGNyZWF0ZVdhaXRpbmdQZXJpb2QsXG4gICAgICBzd2FwUG9zaXRpb25zOiBzd2FwUG9zaXRpb25zLFxuICAgICAgYWRkUGxheWVyVG9Db21wZXRpdGlvbjogYWRkUGxheWVyVG9Db21wZXRpdGlvbixcbiAgICAgIGFkZFBsYXllclRvQ29tcGV0aXRpb25SZXF1ZXN0OiBhZGRQbGF5ZXJUb0NvbXBldGl0aW9uUmVxdWVzdCxcbiAgICAgIHJlbW92ZWRQbGF5ZXJGcm9tQ29tcGV0aXRpb246IHJlbW92ZWRQbGF5ZXJGcm9tQ29tcGV0aXRpb24sXG4gICAgICBhcHByb3ZlUGVuZGluZ1BsYXllcjogYXBwcm92ZVBlbmRpbmdQbGF5ZXIsXG4gICAgICBkZW55UGVuZGluZ1BsYXllcjogZGVueVBlbmRpbmdQbGF5ZXJcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGEgY29tcGV0aXRpb24gZnJvbSB0aGUgZGF0YWJhc2UgKG9yIG1lbW9yeSlcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjb21wZXRpdGlvbiBpZCBmb3IgdGhlIHJlcXVlc3RlZCBjb21wZXRpdGlvblxuICAgICAqIEByZXR1cm4ge09iamVjdH0gY29tcGV0aXRpb25cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRDb21wZXRpdGlvbihjb21wZXRpdGlvbklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NvbXBldGl0aW9uJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYWxsIGNvbXBldGl0aW9ucyBmcm9tIHRoZSBkYXRhYmFzZSB0aGF0IGEgcGFydGljdWxhciB1c2VyIGlzIGluY2x1ZGVkIGluXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3VzZXJJZH0gdGhlIHVzZXIgaWQgZm9yIHRoZSByZXF1ZXN0ZWQgdXNlclxuICAgICAqIEByZXR1cm4ge09iamVjdH0gY29tcGV0aXRpb25zXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0Q29tcGV0aXRpb25zRm9yVXNlcih1c2VySWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY29tcGV0aXRpb25zL3VzZXInLCB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHVzZXJJZDogdXNlcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYWxsIGFjdGl2ZSBwdWJsaWMgY29tcGV0aXRpb25zIGZyb20gdGhlIGRhdGFiYXNlXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGNvbXBldGl0aW9uc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFB1YmxpY0NvbXBldGl0aW9ucygpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY29tcGV0aXRpb25zL3B1YmxpYycpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYWxsIHByaXZhdGUgY29tcGV0aXRpb25zIGZyb20gdGhlIGRhdGFiYXNlXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGNvbXBldGl0aW9uc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFByaXZhdGVDb21wZXRpdGlvbnMoKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NvbXBldGl0aW9ucy9wcml2YXRlJyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlQ29tcGV0aXRpb24oY29tcGV0aXRpb24pIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NvbXBldGl0aW9ucy9jcmVhdGUnLCB7XG4gICAgICAgIGNvbXBldGl0aW9uOiBjb21wZXRpdGlvblxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlQ29tcGV0aXRpb24oY29tcGV0aXRpb24pIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NvbXBldGl0aW9ucy91cGRhdGUnLCB7XG4gICAgICAgIGNvbXBldGl0aW9uOiBjb21wZXRpdGlvblxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsZXRlQ29tcGV0aXRpb24oY29tcGV0aXRpb25JZCkge1xuICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS9jb21wZXRpdGlvbnMvZGVsZXRlJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVXYWl0aW5nUGVyaW9kKGNvbXBldGl0aW9uSWQsIGxvc2VySWQsIHdpbm5lcklkLCB3YWl0aW5nUGVyaW9kKSB7XG4gICAgICByZXR1cm4gJGh0dHAucHV0KCcvYXBpL2NvbXBldGl0aW9ucy9jcmVhdGVXYWl0aW5nUGVyaW9kJywgIHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgbG9zZXJJZDogbG9zZXJJZCxcbiAgICAgICAgd2lubmVySWQ6IHdpbm5lcklkLFxuICAgICAgICB3YWl0aW5nUGVyaW9kOiB3YWl0aW5nUGVyaW9kXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzd2FwUG9zaXRpb25zKGNvbXBldGl0aW9uSWQsIGNoYWxsZW5nZXIsIG9wcG9uZW50KSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jb21wZXRpdGlvbnMvc3dhcFBvc2l0aW9ucycsIHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgY2hhbGxlbmdlcjogY2hhbGxlbmdlcixcbiAgICAgICAgb3Bwb25lbnQ6IG9wcG9uZW50XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRQbGF5ZXJUb0NvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQsIHBsYXllcikge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvY29tcGV0aXRpb25zL2FkZFBsYXllcicsIHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgcGxheWVyOiBwbGF5ZXJcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFBsYXllclRvQ29tcGV0aXRpb25SZXF1ZXN0KGNvbXBldGl0aW9uLCBwbGF5ZXIpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NvbXBldGl0aW9ucy9hZGRQbGF5ZXJSZXF1ZXN0Jywge1xuICAgICAgICBjb21wZXRpdGlvbjogY29tcGV0aXRpb24sXG4gICAgICAgIHBsYXllcjogcGxheWVyXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmVkUGxheWVyRnJvbUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQsIHJlbW92ZWRQbGF5ZXIsIHBsYXllcnMpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NvbXBldGl0aW9ucy9yZW1vdmVQbGF5ZXInLCB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgIHJlbW92ZWRQbGF5ZXI6IHJlbW92ZWRQbGF5ZXIsXG4gICAgICAgIHBsYXllcnM6IHBsYXllcnNcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFwcHJvdmVQZW5kaW5nUGxheWVyKGNvbXBldGl0aW9uSWQsIHBsYXllcikge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvY29tcGV0aXRpb25zL2FwcHJvdmVQbGF5ZXInLCB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgIHBsYXllcjogcGxheWVyXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZW55UGVuZGluZ1BsYXllcihjb21wZXRpdGlvbklkLCBwbGF5ZXIpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NvbXBldGl0aW9ucy9kZW55UGxheWVyJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0NvbXBldGl0aW9uQWRtaW5DdHJsJywgQ29tcGV0aXRpb25BZG1pbkN0cmwpO1xuXG4gIGZ1bmN0aW9uIENvbXBldGl0aW9uQWRtaW5DdHJsKCRzY29wZSwgJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRmaWx0ZXIsIGNvbXBldGl0aW9uc1NlcnZpY2UsIGlkZW50aXR5U2VydmljZSwgbm90aWZ5U2VydmljZSwgY2hhbGxlbmdlc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNvbXBldGl0aW9uSWQgPSBudWxsO1xuICAgIHZtLnVwZGF0ZUNvbXBldGl0aW9uUmVzdHJpY3RKb2lucyA9IHVwZGF0ZUNvbXBldGl0aW9uUmVzdHJpY3RKb2lucztcbiAgICB2bS51cGRhdGVDb21wZXRpdGlvblByaXZhdGUgPSB1cGRhdGVDb21wZXRpdGlvblByaXZhdGU7XG4gICAgdm0uZGVsZXRlQ29tcGV0aXRpb24gPSBkZWxldGVDb21wZXRpdGlvbjtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICgkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICB2bS5jb21wZXRpdGlvbklkID0gJHN0YXRlUGFyYW1zLmNvbXBldGl0aW9uSWQ7XG4gICAgICAgIHJlZnJlc2hDb21wZXRpdGlvbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHN0YXRlLmdvKCdjb21wZXRpdGlvbnMubXlDb21wZXRpdGlvbnMnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWZyZXNoQ29tcGV0aXRpb24oKSB7XG4gICAgICBjb21wZXRpdGlvbnNTZXJ2aWNlLmdldENvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKGNvbXBldGl0aW9uKSB7XG4gICAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGlzIHVzZXIgaXMgYW4gYWRtaW4gb2YgdGhpcyBjb21wZXRpdGlvblxuICAgICAgICBpZiAoY29tcGV0aXRpb24uZGF0YSAmJiBfLnNvbWUoY29tcGV0aXRpb24uZGF0YS5hZG1pbnMsIFsnX2lkJywgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZF0pKSB7XG4gICAgICAgICAgdm0uaXNBZG1pbiA9IHRydWU7XG4gICAgICAgICAgLy8gRGlzcGxheSB0aGUgcGxheWVycyBpbiB0aGUgcHJvcGVyIG9yZGVyXG4gICAgICAgICAgY29tcGV0aXRpb24uZGF0YS5wbGF5ZXJzID0gJGZpbHRlcignb3JkZXJCeScpKGNvbXBldGl0aW9uLmRhdGEucGxheWVycywgJ3Bvc2l0aW9uJyk7XG4gICAgICAgICAgdm0uY29tcGV0aXRpb24gPSBjb21wZXRpdGlvbi5kYXRhO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRzdGF0ZS5nbygnY29tcGV0aXRpb25zLm15Q29tcGV0aXRpb25zJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlcykge1xuICAgICAgICB2bS5jaGFsbGVuZ2VzID0gY2hhbGxlbmdlcy5kYXRhO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUGVyZm9ybSB0aGUgdXBkYXRlcyB0aGF0IHdlcmUgcmVxdXN0ZWRcbiAgICBmdW5jdGlvbiB1cGRhdGVDb21wZXRpdGlvblJlc3RyaWN0Sm9pbnMoKSB7XG4gICAgICBjb21wZXRpdGlvbnNTZXJ2aWNlLmdldENvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKGNvbXBldGl0aW9uKSB7XG4gICAgICAgIHZhciB1cGRhdGVkQ29tcGV0aXRpb24gPSBjb21wZXRpdGlvbi5kYXRhO1xuICAgICAgICB1cGRhdGVkQ29tcGV0aXRpb24ucmVzdHJpY3RKb2lucyA9IHZtLmNvbXBldGl0aW9uLnJlc3RyaWN0Sm9pbnM7XG4gICAgICAgIGNvbXBldGl0aW9uc1NlcnZpY2UudXBkYXRlQ29tcGV0aXRpb24odXBkYXRlZENvbXBldGl0aW9uKTtcbiAgICAgIH0pOyAgICAgIFxuICAgIH1cblxuICAgIC8vIFBlcmZvcm0gdGhlIHVwZGF0ZXMgdGhhdCB3ZXJlIHJlcXVzdGVkXG4gICAgZnVuY3Rpb24gdXBkYXRlQ29tcGV0aXRpb25Qcml2YXRlKCkge1xuICAgICAgY29tcGV0aXRpb25zU2VydmljZS5nZXRDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjb21wZXRpdGlvbikge1xuICAgICAgICB2YXIgdXBkYXRlZENvbXBldGl0aW9uID0gY29tcGV0aXRpb24uZGF0YTtcbiAgICAgICAgdXBkYXRlZENvbXBldGl0aW9uLnByaXZhdGUgPSB2bS5jb21wZXRpdGlvbi5wcml2YXRlO1xuICAgICAgICBjb21wZXRpdGlvbnNTZXJ2aWNlLnVwZGF0ZUNvbXBldGl0aW9uKHVwZGF0ZWRDb21wZXRpdGlvbik7XG4gICAgICB9KTsgICAgICBcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVDb21wZXRpdGlvbigpIHtcbiAgICAgIHN3YWwoe1xuICAgICAgICB0aXRsZTogJ0RlbGV0ZSBDb21wZXRpdGlvbj8nLFxuICAgICAgICB0ZXh0OiAnVGhpcyBjYW4gbm90IGJlIHVuZG9uZScsXG4gICAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnRGVsZXRlJyxcbiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ05ldmVybWluZCcsXG4gICAgICAgIGNsb3NlT25Db25maXJtOiB0cnVlLFxuICAgICAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlXG4gICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbXBldGl0aW9uc1NlcnZpY2UuZGVsZXRlQ29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJHN0YXRlLmdvKCdjb21wZXRpdGlvbnMubXlDb21wZXRpdGlvbnMnKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y29tcGV0aXRpb25fdXBkYXRlZCcsIGZ1bmN0aW9uIChfLCBjb21wZXRpdGlvbkRldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjb21wZXRpdGlvbkRldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY29tcGV0aXRpb25EZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaENvbXBldGl0aW9uKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y29tcGV0aXRpb25fZGVsZXRlZCcsIGZ1bmN0aW9uIChfLCBjb21wZXRpdGlvbkRldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjb21wZXRpdGlvbkRldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY29tcGV0aXRpb25EZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgJHN0YXRlLmdvKCdjb21wZXRpdGlvbnMubXlDb21wZXRpdGlvbnMnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdDb21wZXRpdGlvblN0YXRzQ3RybCcsIENvbXBldGl0aW9uU3RhdHNDdHJsKTtcblxuICBmdW5jdGlvbiBDb21wZXRpdGlvblN0YXRzQ3RybCgkc2NvcGUsICRzdGF0ZVBhcmFtcywgJHN0YXRlLCBjb21wZXRpdGlvbnNTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY29tcGV0aXRpb25JZCA9IG51bGw7XG4gICAgdm0uY29tcGV0aXRpb24gPSB7fTtcbiAgICB2bS5wbGF5ZXJzUmVzdWx0cyA9IFtdO1xuICAgIHZtLmNoYWxsZW5nZXMgPSBbXTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICgkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICB2bS5jb21wZXRpdGlvbklkID0gJHN0YXRlUGFyYW1zLmNvbXBldGl0aW9uSWQ7XG4gICAgICAgIHJlZnJlc2hDb21wZXRpdGlvbigpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlZnJlc2hDb21wZXRpdGlvbigpIHtcbiAgICAgIGNvbXBldGl0aW9uc1NlcnZpY2UuZ2V0Q29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAoY29tcGV0aXRpb24pIHtcbiAgICAgICAgaWYgKGNvbXBldGl0aW9uLmRhdGEpIHtcbiAgICAgICAgICB2bS5jb21wZXRpdGlvbiA9IGNvbXBldGl0aW9uLmRhdGE7XG4gICAgICAgICAgaWYgKHZtLmNvbXBldGl0aW9uLnR5cGUgPT09ICdweXJhbWlkJykge1xuICAgICAgICAgICAgXy5mb3JFYWNoKHZtLmNvbXBldGl0aW9uLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCwgcGxheWVyLl9pZCkudGhlbihmdW5jdGlvbiAocmVzdWx0cykge1xuICAgICAgICAgICAgICAgIHBsYXllci5yZXN1bHRzID0gcmVzdWx0cy5kYXRhO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSBpZiAodm0uY29tcGV0aXRpb24udHlwZSA9PT0gJ3ZlcnN1cycpIHtcbiAgICAgICAgICAgIHZtLnRlYW1zID0gW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbnVtYmVyOiAxXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBudW1iZXI6IDJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJHN0YXRlLmdvKCdjb21wZXRpdGlvbnMubXlDb21wZXRpdGlvbnMnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICAvLyBVc2VkIGZvciB0aGUgY29tcGxldGVkIGNoYWxsZW5nZXMgZGlyZWN0aXZlXG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIHZtLmNoYWxsZW5nZXMgPSBjaGFsbGVuZ2VzLmRhdGE7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y29tcGV0aXRpb25fdXBkYXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaENvbXBldGl0aW9uKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y29tcGV0aXRpb25fZGVsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgJHN0YXRlLmdvKCdjb21wZXRpdGlvbnMubXlDb21wZXRpdGlvbnMnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdDb21wZXRpdGlvbkN0cmwnLCBDb21wZXRpdGlvbkN0cmwpO1xuXG4gIGZ1bmN0aW9uIENvbXBldGl0aW9uQ3RybCgkc2NvcGUsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBjb21wZXRpdGlvbnNTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY29tcGV0aXRpb25JZCA9IG51bGw7XG4gICAgdm0uY29tcGV0aXRpb24gPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcblxuICAgICAgICByZWZyZXNoQ29tcGV0aXRpb24oKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWZyZXNoQ29tcGV0aXRpb24oKSB7XG4gICAgICBjb21wZXRpdGlvbnNTZXJ2aWNlLmdldENvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKGNvbXBldGl0aW9uKSB7XG4gICAgICAgIGlmIChjb21wZXRpdGlvbi5kYXRhKSB7XG4gICAgICAgICAgdm0uY29tcGV0aXRpb24gPSBjb21wZXRpdGlvbi5kYXRhO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRzdGF0ZS5nbygnY29tcGV0aXRpb25zLm15Q29tcGV0aXRpb25zJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjb21wZXRpdGlvbl9kZWxldGVkJywgZnVuY3Rpb24gKF8sIGNvbXBldGl0aW9uRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNvbXBldGl0aW9uRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjb21wZXRpdGlvbkRldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICAkc3RhdGUuZ28oJ2NvbXBldGl0aW9ucy5teUNvbXBldGl0aW9ucycpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0NvbXBldGl0aW9uc0N0cmwnLCBDb21wZXRpdGlvbnNDdHJsKTtcblxuICBmdW5jdGlvbiBDb21wZXRpdGlvbnNDdHJsKGNvbXBldGl0aW9uc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNvbXBldGl0aW9ucyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgY29tcGV0aXRpb25zU2VydmljZS5nZXRQdWJsaWNDb21wZXRpdGlvbnMoKS50aGVuKGZ1bmN0aW9uIChjb21wZXRpdGlvbnMpIHtcbiAgICAgICAgdm0uY29tcGV0aXRpb25zID0gY29tcGV0aXRpb25zLmRhdGE7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiLyoqXG4gKiBDcmVhdGVzIGEgY29tcGV0aXRpb25cbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQ3JlYXRlQ29tcGV0aXRpb25DdHJsJywgQ3JlYXRlQ29tcGV0aXRpb25DdHJsKTtcblxuICBmdW5jdGlvbiBDcmVhdGVDb21wZXRpdGlvbkN0cmwoJHN0YXRlLCB1c2VyU2VydmljZSwgY29tcGV0aXRpb25zU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIGJyZWFrUG9pbnRzID0gW107XG4gICAgdmFyIG1heExldmVscyA9IDc7XG4gICAgdmFyIG1heFBsYXllcnMgPSBudWxsO1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubmV3Q29tcGV0aXRpb24gPSB7XG4gICAgICBwbGF5ZXJzOiBbXSxcbiAgICAgIHJlc3RyaWN0Sm9pbnM6IGZhbHNlLFxuICAgICAgcHJpdmF0ZTogZmFsc2VcbiAgICB9O1xuICAgIHZtLmF2YWlsYWJsZVBsYXllcnMgPSBbXTtcbiAgICB2bS5hZGRlZFBsYXllcnMgPSBbXTtcbiAgICB2bS5jcmVhdGVDb21wZXRpdGlvbiA9IGNyZWF0ZUNvbXBldGl0aW9uO1xuICAgIHZtLmFkZFBsYXllciA9IGFkZFBsYXllcjtcbiAgICB2bS5yZW1vdmVQbGF5ZXIgPSByZW1vdmVQbGF5ZXI7XG4gICAgdm0ucmVvcmRlclBsYXllcnMgPSByZW9yZGVyUGxheWVycztcbiAgICB2bS5uZXdDb21wZXRpdGlvbi5mb3JmZWl0RGF5cyA9IDE7XG4gICAgdm0ubmV3Q29tcGV0aXRpb24ud2FpdGluZ1BlcmlvZERheXMgPSAxO1xuICAgIHZtLmNvbXBldGl0aW9uVHlwZXMgPSBbJ3B5cmFtaWQnLCAndmVyc3VzJ107XG5cbiAgICBhY3RpdmF0ZSgpO1xuICAgIFxuICAgIC8qKlxuICAgICAqIFJ1bnMgb24gY29udHJvbGxlciBpbnN0YW50aWF0aW9uXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICB1c2VyU2VydmljZS5nZXRWZXJpZmllZFVzZXJzKCkudGhlbihmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IHVzZXJzLmRhdGE7XG4gICAgICB9KTtcblxuICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBtYXhpbXVtIG51bWJlciBvZiBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBtYXhpbXVtIG51bWJlciBvZiBsZXZlbHNcbiAgICAgIGZvciAodmFyIGkgPSBtYXhMZXZlbHM7IGkgPiAwOyAtLWkpIHtcbiAgICAgICAgbWF4UGxheWVycyArPSBpO1xuICAgICAgfVxuXG4gICAgICAvLyBDcmVhdGUgYnJlYWsgcG9pbnRzIGFycmF5XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgbWF4TGV2ZWxzOyBpKyspIHtcbiAgICAgICAgYnJlYWtQb2ludHMucHVzaCgoKChpICogKGkgKyAxKSkgLyAyKSkgKyAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgcGxheWVyIHRvIHRoZSBuZXcgY29tcGV0aXRpb25cbiAgICAgKiBDaGVja3MgdG8gbWFrZSBzdXJlIHlvdSBhcmUgbm90IGFkZGluZyB0b28gbWFueSBwbGF5ZXJzXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBwbGF5ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhZGRQbGF5ZXIocGxheWVyKSB7XG4gICAgICB2bS5hZGRlZFBsYXllcnMucHVzaChfLnJlbW92ZSh2bS5hdmFpbGFibGVQbGF5ZXJzLCB7X2lkOiBwbGF5ZXIuX2lkfSlbMF0pO1xuICAgICAgcmVvcmRlclBsYXllcnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGEgcHJldml1b3NseSBhZGRlZCBwbGF5ZXIgZnJvbSB0aGUgY29tcGV0aXRpb25cbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHBsYXllclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlbW92ZVBsYXllcihwbGF5ZXIpIHtcbiAgICAgIHZtLmF2YWlsYWJsZVBsYXllcnMucHVzaChfLnJlbW92ZSh2bS5hZGRlZFBsYXllcnMsIHtfaWQ6IHBsYXllci5faWR9KVswXSk7XG4gICAgICByZW9yZGVyUGxheWVycygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1ha2UgY2hhbmdlcyBiYXNlZCBvbiB0aGUgY29tcGV0aXRpb24gdHlwZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlb3JkZXJQbGF5ZXJzKCkge1xuICAgICAgaWYgKHZtLm5ld0NvbXBldGl0aW9uLnR5cGUgPT09ICd2ZXJzdXMnKSB7XG4gICAgICAgIHJlb3JkZXJWZXJzdXNQbGF5ZXJzKCk7XG4gICAgICB9IGVsc2UgaWYgKHZtLm5ld0NvbXBldGl0aW9uLnR5cGUgPT09ICdweXJhbWlkJykge1xuICAgICAgICByZW9yZGVyUHlyYW1pZFBsYXllcnMoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW9yZGVyIHRoZSBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBkcmFnLWRyb3BcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZW9yZGVyUHlyYW1pZFBsYXllcnMoKSB7XG4gICAgICB2YXIgaSA9IDE7XG4gICAgICBfLmZvckVhY2godm0uYWRkZWRQbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIHBsYXllci5wb3NpdGlvbiA9IGk7XG4gICAgICAgICsraTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlb3JkZXJWZXJzdXNQbGF5ZXJzKCkge1xuICAgICAgLy8gU2V0IGFsbCBwbGF5ZXJzIHRvIHRlYW0gMlxuICAgICAgXy5mb3JFYWNoKHZtLmFkZGVkUGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICBwbGF5ZXIucG9zaXRpb24gPSAyO1xuICAgICAgfSk7XG4gICAgICAvLyBTZXQgdGhlIGZpcnN0IGhhbGYgb2YgdGhlIHBsYXllcnMgdG8gdGVhbSAxXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICh2bS5hZGRlZFBsYXllcnMubGVuZ3RoIC8gMik7IGkrKykge1xuICAgICAgICB2bS5hZGRlZFBsYXllcnNbaV0ucG9zaXRpb24gPSAxO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSB0aGUgY29tcGV0aXRpb25cbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IGNvbXBldGl0aW9uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlQ29tcGV0aXRpb24oY29tcGV0aXRpb24pIHtcbiAgICAgIGlmIChjb21wZXRpdGlvbi50eXBlID09PSAndmVyc3VzJyAmJiB2bS5hZGRlZFBsYXllcnMubGVuZ3RoICUgMiA+IDApIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignQSBWZXJzdXMgY29tcGV0aXRpb24gbXVzdCBoYXZlIGFuIGV2ZW4gbnVtYmVyIG9mIHBsYXllcnMnKTtcbiAgICAgIH0gZWxzZSBpZiAodm0uYWRkZWRQbGF5ZXJzLmxlbmd0aCA+IG1heFBsYXllcnMpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignQSBjb21wZXRpdGlvbiBjYW4gaGF2ZSBhIG1heGltdW0gb2YgJyArIG1heFBsYXllcnMgKyAnIHBsYXllcnMnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaCh2bS5hZGRlZFBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgICB2YXIgYWRkUGxheWVyID0ge1xuICAgICAgICAgICAgX2lkOiBwbGF5ZXIuX2lkLFxuICAgICAgICAgICAgZW1haWw6IHBsYXllci51c2VybmFtZSxcbiAgICAgICAgICAgIGZpcnN0TmFtZTogcGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiBwbGF5ZXIubGFzdE5hbWUsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogcGxheWVyLmRpc3BsYXlOYW1lLFxuICAgICAgICAgICAgcG9zaXRpb246IHBsYXllci5wb3NpdGlvblxuICAgICAgICAgIH07XG4gICAgICAgICAgY29tcGV0aXRpb24ucGxheWVycy5wdXNoKGFkZFBsYXllcik7XG4gICAgICAgIH0pO1xuICAgICAgICBjb21wZXRpdGlvbi5hZG1pbnMgPSBbe1xuICAgICAgICAgIF9pZDogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCxcbiAgICAgICAgICBlbWFpbDogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLnVzZXJuYW1lLFxuICAgICAgICAgIGZpcnN0TmFtZTogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmZpcnN0TmFtZSxcbiAgICAgICAgICBsYXN0TmFtZTogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmxhc3ROYW1lLFxuICAgICAgICAgIGRpc3BsYXlOYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuZGlzcGxheU5hbWUsXG4gICAgICAgICAgcHJpbWFyeTogdHJ1ZVxuICAgICAgICB9XTtcblxuICAgICAgICAvLyBGaWd1cmUgb3V0IHRoZSBudW1iZXIgb2YgbGV2ZWxzIGJhc2VkIG9uIHRoZSBudW1iZXIgb2YgcGxheWVyc1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJyZWFrUG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKGNvbXBldGl0aW9uLnBsYXllcnMubGVuZ3RoIDwgYnJlYWtQb2ludHNbaV0pIHtcbiAgICAgICAgICAgIGNvbXBldGl0aW9uLmxldmVscyA9IGk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb21wZXRpdGlvbnNTZXJ2aWNlLmNyZWF0ZUNvbXBldGl0aW9uKGNvbXBldGl0aW9uKS50aGVuKGZ1bmN0aW9uIChuZXdDb21wZXRpdGlvbikge1xuICAgICAgICAgICRzdGF0ZS5nbygnY29tcGV0aXRpb25zLnZpZXcnLCB7XG4gICAgICAgICAgICBjb21wZXRpdGlvbklkOiBuZXdDb21wZXRpdGlvbi5kYXRhLl9pZFxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTXlDb21wZXRpdGlvbnNDdHJsJywgTXlDb21wZXRpdGlvbnNDdHJsKTtcblxuICBmdW5jdGlvbiBNeUNvbXBldGl0aW9uc0N0cmwoJHNjb3BlLCBjb21wZXRpdGlvbnNTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIG15Q29tcGV0aXRpb25zID0gW107XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5hY3RpdmVDaGFsbGVuZ2UgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgZ2V0Q29tcGV0aXRpb25zRm9yVXNlcigpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENvbXBldGl0aW9uc0ZvclVzZXIoKSB7XG4gICAgICBteUNvbXBldGl0aW9ucyA9IFtdO1xuICAgICAgdm0uYWN0aXZlQ2hhbGxlbmdlID0gbnVsbDtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgY29tcGV0aXRpb25zU2VydmljZS5nZXRDb21wZXRpdGlvbnNGb3JVc2VyKGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQpLnRoZW4oZnVuY3Rpb24gKGNvbXBldGl0aW9ucykge1xuICAgICAgICAgIHZtLmNvbXBldGl0aW9ucyA9IGNvbXBldGl0aW9ucy5kYXRhO1xuICAgICAgICAgIF8uZm9yRWFjaCh2bS5jb21wZXRpdGlvbnMsIGZ1bmN0aW9uKGNvbXBldGl0aW9uKSB7XG4gICAgICAgICAgICBteUNvbXBldGl0aW9ucy5wdXNoKGNvbXBldGl0aW9uLl9pZCk7XG4gICAgICAgICAgICBpZiAoY29tcGV0aXRpb24udHlwZSA9PT0gJ3B5cmFtaWQnKSB7XG4gICAgICAgICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcihjb21wZXRpdGlvbi5faWQsIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YSkge1xuICAgICAgICAgICAgICAgICAgY29tcGV0aXRpb24uYWN0aXZlQ2hhbGxlbmdlID0gY2hhbGxlbmdlLmRhdGE7XG4gICAgICAgICAgICAgICAgICBpZiAoY29tcGV0aXRpb24uYWN0aXZlQ2hhbGxlbmdlLnRpbWVMaW1pdCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb21wZXRpdGlvbi5hY3RpdmVDaGFsbGVuZ2UuZXhwaXJlcyA9IChtb21lbnQoKS5kaWZmKG1vbWVudChjb21wZXRpdGlvbi5hY3RpdmVDaGFsbGVuZ2UuY3JlYXRlZCkuYWRkKGNvbXBldGl0aW9uLmFjdGl2ZUNoYWxsZW5nZS50aW1lTGltaXQsICdkJyksJ3MnKSkgKiAtMTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb21wZXRpdGlvbi50eXBlID09PSAndmVyc3VzJykge1xuICAgICAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbi5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICBjb21wZXRpdGlvbi5hY3RpdmVDaGFsbGVuZ2UgPSBjaGFsbGVuZ2UuZGF0YVswXTtcbiAgICAgICAgICAgICAgICAgIGlmIChjb21wZXRpdGlvbi5hY3RpdmVDaGFsbGVuZ2UudGltZUxpbWl0ICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBldGl0aW9uLmFjdGl2ZUNoYWxsZW5nZS5leHBpcmVzID0gKG1vbWVudCgpLmRpZmYobW9tZW50KGNvbXBldGl0aW9uLmFjdGl2ZUNoYWxsZW5nZS5jcmVhdGVkKS5hZGQoY29tcGV0aXRpb24uYWN0aXZlQ2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2QnKSwncycpKSAqIC0xO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjb21wZXRpdGlvbl91cGRhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmIChteUNvbXBldGl0aW9ucy5pbmRleE9mKGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkgPj0gMCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIGdldENvbXBldGl0aW9uc0ZvclVzZXIoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdVc2VyQ3RybCcsIFVzZXJDdHJsKTtcblxuICBmdW5jdGlvbiBVc2VyQ3RybChpZGVudGl0eVNlcnZpY2UsIHVzZXJTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIG9yaWdpbmFsVXNlciA9IG51bGw7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS51c2VyID0gIHtcbiAgICAgIF9pZDogIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQsXG4gICAgICBmaXJzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5maXJzdE5hbWUsXG4gICAgICBsYXN0TmFtZTogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmxhc3ROYW1lLFxuICAgICAgZGlzcGxheU5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5kaXNwbGF5TmFtZVxuICAgIH07XG4gICAgdm0udXBkYXRlVXNlciA9IHVwZGF0ZVVzZXI7XG4gICAgdm0udXNlckZvcm0gPSB7fTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICghaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmRpc3BsYXlOYW1lKSB7XG4gICAgICAgIHZtLnVzZXIuZGlzcGxheU5hbWUgPSBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuZmlyc3ROYW1lICsgJyAnICsgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmxhc3ROYW1lO1xuICAgICAgfVxuICAgICAgb3JpZ2luYWxVc2VyID0gXy5jbG9uZURlZXAodm0udXNlcik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlVXNlciAodXNlcikge1xuICAgICAgLy8gUHJldmVudCBtdWx0aXBsZSBwZW9wbGUgZnJvbSBoYXZpbmcgdGhlIHNhbWUgZGlzcGxheSBuYW1lXG4gICAgICB2YXIgZGlzcGxheU5hbWVzID0gW107XG4gICAgICB1c2VyU2VydmljZS5nZXRBbGxVc2VycygpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIF8uZm9yRWFjaCh1c2Vycy5kYXRhLCBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICAgIGRpc3BsYXlOYW1lcy5wdXNoKHVzZXIuZGlzcGxheU5hbWUudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh1c2VyLnBhc3N3b3JkICE9PSB1c2VyLmNvbmZpcm1QYXNzd29yZCkge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1Bhc3N3b3JkcyBkb25cXCd0IG1hdGNoIScpO1xuICAgICAgICB9IGVsc2UgaWYgKHVzZXIuZmlyc3ROYW1lLmxlbmd0aCA8IDEgfHwgdXNlci5sYXN0TmFtZS5sZW5ndGggPCAxIHx8IHVzZXIuZGlzcGxheU5hbWUubGVuZ3RoIDwgMSkge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ0RvblxcJ3QgbGVhdmUgbmFtZXMgYmxhbmshICBIb3cgd2lsbCBwZW9wbGUga25vdyB3aG8geW91IGFyZT8nKTtcbiAgICAgICAgfSBlbHNlIGlmIChvcmlnaW5hbFVzZXIuZGlzcGxheU5hbWUgIT09IHVzZXIuZGlzcGxheU5hbWUgJiYgXy5pbmRleE9mKGRpc3BsYXlOYW1lcywgdXNlci5kaXNwbGF5TmFtZS50b0xvd2VyQ2FzZSgpKSA+IC0xKSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignU29ycnksIHNvbWVvbmUgZWxzZSBpcyBhbHJlYWR5IHVzaW5nIHRoYXQgZGlzcGxheSBuYW1lJyk7XG4gICAgICAgIH0gZWxzZSBpZiAoIWlkZW50aXR5U2VydmljZS5pc0F1dGhvcml6ZWQoJ3N1cGVyLWFkbWluJykgJiYgdXNlci5kaXNwbGF5TmFtZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ21hZXN0cm8nKSA+IC0xKSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignU29ycnksIHRoZXJlXFwncyBvbmx5IG9uZSBNYWVzdHJvJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gSWYgYW55IG9mIHRoZSBuYW1lcyB3ZXJlIHVwZGF0ZWQgd2UnbGwgbmVlZCB0byB1cGRhdGUgdGhlbSBpbiB0aGUgb3RoZXIgY29sbGVjdGlvbnMnXG4gICAgICAgICAgdmFyIHVzZXJVcGRhdGVzID0ge1xuICAgICAgICAgICAgX2lkOiB1c2VyLl9pZFxuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKCh1c2VyLmZpcnN0TmFtZSAhPT0gaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmZpcnN0TmFtZSAmJiB1c2VyLmZpcnN0TmFtZS5sZW5ndGggPiAwKSB8fCAodXNlci5sYXN0TmFtZSAhPT0gaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmxhc3ROYW1lICYmIHVzZXIubGFzdE5hbWUubGVuZ3RoID4gMCkgfHwgKHVzZXIuZGlzcGxheU5hbWUgIT09IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5kaXNwbGF5TmFtZSAmJiB1c2VyLmRpc3BsYXlOYW1lLmxlbmd0aCA+IDApKSB7XG4gICAgICAgICAgICB1c2VyVXBkYXRlcy5maXJzdE5hbWUgPSB1c2VyLmZpcnN0TmFtZTtcbiAgICAgICAgICAgIHVzZXJVcGRhdGVzLmxhc3ROYW1lID0gdXNlci5sYXN0TmFtZTtcbiAgICAgICAgICAgIHVzZXJVcGRhdGVzLmRpc3BsYXlOYW1lID0gdXNlci5kaXNwbGF5TmFtZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHVzZXIucGFzc3dvcmQgJiYgdXNlci5wYXNzd29yZC5sZW50Z2ggPiAwKSB7XG4gICAgICAgICAgICB1c2VyVXBkYXRlcy5wYXNzd29yZCA9IHVzZXIucGFzc3dvcmQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIHVzZXJTZXJ2aWNlLnVwZGF0ZVVzZXIodXNlclVwZGF0ZXMpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbm90aWZ5U2VydmljZS5zdWNjZXNzKCdZb3VyIGluZm9ybWF0aW9uIGhhcyBiZWVuIHVwZGF0ZWQnKTtcbiAgICAgICAgICAgIHZtLnVzZXJGb3JtLiRzZXRQcmlzdGluZSgpO1xuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBjdXJyZW50IHVzZXIgd2l0aCB0aGUgdXBkYXRlZCBkYXRhXG4gICAgICAgICAgICB2YXIgY3VycmVudFVzZXJDbG9uZSA9IGFuZ3VsYXIuY29weShpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIpO1xuICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoY3VycmVudFVzZXJDbG9uZSwgdXNlclVwZGF0ZXMpO1xuICAgICAgICAgICAgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyID0gY3VycmVudFVzZXJDbG9uZTtcbiAgICAgICAgICAgIHZtLnVzZXIuY29uZmlybVBhc3N3b3JkID0gdm0udXNlci5wYXNzd29yZCA9ICcnO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnYXV0aFNlcnZpY2UnLCBhdXRoU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gYXV0aFNlcnZpY2UoJHN0YXRlLCAkaHR0cCwgJHEsIHVzZXJTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UsIG5vdGlmeVNlcnZpY2UpIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGF1dGhlbnRpY2F0ZVVzZXI6IGF1dGhlbnRpY2F0ZVVzZXIsXG4gICAgICBjcmVhdGVVc2VyOiBjcmVhdGVVc2VyLFxuICAgICAgbG9nb3V0OiBsb2dvdXQsXG4gICAgICBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlOiBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlLFxuICAgICAgYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZTogYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZVxuICAgIH07XG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBhdXRoZW50aWNhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5wb3N0KCcvbG9naW4nLCB7XG4gICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcbiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyID0gcmVzcG9uc2UuZGF0YS51c2VyO1xuICAgICAgICAgIGRmZC5yZXNvbHZlKHRydWUpO1xuICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PT0gJ3VudmVyaWZpZWQnKSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUoJ3VudmVyaWZpZWQnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkZmQucmVzb2x2ZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVVzZXIodXNlckRhdGEpIHtcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xuICAgICAgJGh0dHAucG9zdCgnL2FwaS91c2VycycsIHtcbiAgICAgICAgdXNlckRhdGE6IHVzZXJEYXRhXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAgIGRmZC5yZXNvbHZlKHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRmZC5yZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnJlYXNvbiA9PT0gJ0Vycm9yOiBFbWFpbCBhbHJlYWR5IGluIHVzZScpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdTb3JyeSwgYW4gYWNjb3VudCBhbHJlYWR5IGV4aXN0cyB3aXRoIHRoYXQgZW1haWwgYWRkcmVzcy4nKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5wb3N0KCcvbG9nb3V0Jywge1xuICAgICAgICBsb2dvdXQ6IHRydWVcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIGRmZC5yZXNvbHZlKCk7XG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZShyb2xlKSB7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aG9yaXplZChyb2xlKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoJ25vdCBhdXRob3JpemVkJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpIHtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJHEucmVqZWN0KCdub3QgYXV0aG9yaXplZCcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCd1c2VyU2VydmljZScsIHVzZXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiB1c2VyU2VydmljZSgkaHR0cCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0QWxsVXNlcnM6IGdldEFsbFVzZXJzLFxuICAgICAgZ2V0VmVyaWZpZWRVc2VyczogZ2V0VmVyaWZpZWRVc2VycyxcbiAgICAgIHZlcmlmeVVzZXI6IHZlcmlmeVVzZXIsXG4gICAgICBnZW5lcmF0ZVBhc3N3b3JkUmVzZXRMaW5rOiBnZW5lcmF0ZVBhc3N3b3JkUmVzZXRMaW5rLFxuICAgICAgcmVzZXRQYXNzd29yZDogcmVzZXRQYXNzd29yZCxcbiAgICAgIHVwZGF0ZVVzZXI6IHVwZGF0ZVVzZXJcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gZ2V0QWxsVXNlcnMoKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJykudGhlbihmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJzO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0VmVyaWZpZWRVc2VycygpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMvdmVyaWZpZWQnKS50aGVuKGZ1bmN0aW9uICh1c2Vycykge1xuICAgICAgICAvLyBNYWtlIHN1cmUgZXZlcnkgdXNlciBoYXMgYSBkaXNwbGF5IG5hbWVcbiAgICAgICAgXy5mb3JFYWNoKHVzZXJzLmRhdGEsIGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgICAgaWYgKCF1c2VyLmRpc3BsYXlOYW1lKSB7XG4gICAgICAgICAgICB1c2VyLmRpc3BsYXlOYW1lID0gdXNlci5maXJzdE5hbWUgKyAnICcgKyB1c2VyLmxhc3ROYW1lO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB1c2VycztcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZlcmlmeVVzZXIodXNlcklkLCB2ZXJpZmljYXRpb25Ub2tlbikge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VyL3ZlcmlmaWNhdGlvbicsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgdXNlcklkOiB1c2VySWQsXG4gICAgICAgICAgdmVyaWZpY2F0aW9uVG9rZW46IHZlcmlmaWNhdGlvblRva2VuXG4gICAgICAgIH1cbiAgICAgIH0pOyAgXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayh1c2VybmFtZSkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VyL3Bhc3N3b3JkL2xpbmsnLCB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZVxuICAgICAgICB9XG4gICAgICB9KTsgIFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQodXNlcklkLCB2ZXJpZmljYXRpb25Ub2tlbiwgcGFzc3dvcmQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wdXQoJy9hcGkvdXNlci9wYXNzd29yZC9yZXNldCcsIHtcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXG4gICAgICAgIHZlcmlmaWNhdGlvblRva2VuOiB2ZXJpZmljYXRpb25Ub2tlbixcbiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICB9KTsgIFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZVVzZXIodXNlcikge1xuICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS91c2VyJywge1xuICAgICAgICB1c2VyOiB1c2VyXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdjT3ZlcmZsb3cnLCBjT3ZlcmZsb3cpO1xuXG4gIGZ1bmN0aW9uIGNPdmVyZmxvdyhzY3JvbGxiYXJTZXJ2aWNlKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQycsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgdmFyIHNjcm9sbGF4aXMgPSBhdHRycy5zY3JvbGxheGlzIHx8ICd5JztcbiAgICAgIHZhciB0aGVtZSA9IGF0dHJzLnRoZW1lIHx8ICdtaW5pbWFsLWRhcmsnO1xuICAgICAgdmFyIG1vdXNld2hlZWxheGlzID0gYXR0cnMubW91c2V3aGVlbGF4aXMgfHwgJ3knO1xuICAgICAgaWYgKCEkKCdodG1sJykuaGFzQ2xhc3MoJ2lzbW9iaWxlJykpIHtcbiAgICAgICAgc2Nyb2xsYmFyU2VydmljZS5tYWxpaHVTY3JvbGwoZWxlbWVudCwgdGhlbWUsIHNjcm9sbGF4aXMsIG1vdXNld2hlZWxheGlzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCd0b2dnbGVTdWJtZW51JywgdG9nZ2xlU3VibWVudSk7XG5cbiAgZnVuY3Rpb24gdG9nZ2xlU3VibWVudSgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsKSB7XG4gICAgICBlbC5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVsLm5leHQoKS5zbGlkZVRvZ2dsZSgyMDApO1xuICAgICAgICBlbC5wYXJlbnQoKS50b2dnbGVDbGFzcygndG9nZ2xlZCcpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnd2F2ZXNFZmZlY3QnLCB3YXZlc0VmZmVjdCk7XG5cbiAgZnVuY3Rpb24gd2F2ZXNFZmZlY3QoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQycsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICBpZiAoZWxlbWVudC5oYXNDbGFzcygnYnRuLWljb24nKSB8fCBlbGVtZW50Lmhhc0NsYXNzKCdidG4tZmxvYXQnKSkge1xuICAgICAgICBXYXZlcy5hdHRhY2goZWxlbWVudCwgWyd3YXZlcy1jaXJjbGUnXSk7XG4gICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ2J0bi1saWdodCcpKSB7XG4gICAgICAgIFdhdmVzLmF0dGFjaChlbGVtZW50LCBbJ3dhdmVzLWxpZ2h0J10pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgV2F2ZXMuYXR0YWNoKGVsZW1lbnQpO1xuICAgICAgfVxuXG4gICAgICBXYXZlcy5pbml0KCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnZmdMaW5lJywgZmdMaW5lKTtcblxuICBmdW5jdGlvbiBmZ0xpbmUoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQycsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICB2YXIgaW5wdXQgPSBlbGVtZW50LmNoaWxkcmVuKCkuZmlyc3QoKTtcbiAgICAgIHZhciBpc0Zsb2F0TGFiZWwgPSBlbGVtZW50LnBhcmVudCgpLmhhc0NsYXNzKCdmZy1mbG9hdCcpO1xuICAgICAgaW5wdXQuZm9jdXMoZnVuY3Rpb24gKCkge1xuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdmZy10b2dnbGVkJyk7XG4gICAgICB9KTtcblxuICAgICAgaW5wdXQuYmx1cihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghaXNGbG9hdExhYmVsIHx8IChpc0Zsb2F0TGFiZWwgJiYgaW5wdXQudmFsKCkubGVuZ3RoID09PSAwKSkge1xuICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2ZnLXRvZ2dsZWQnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
