angular.module("app",["ui.router","ui.bootstrap","ngAnimate","angular-loading-bar","nouislider","localytics.directives","timer","LocalStorageModule","angular-sortable-view"]),function(){"use strict ";function e(e,t){e.defaults.headers.get||(e.defaults.headers.get={}),e.defaults.headers.get["If-Modified-Since"]="Fri, 01 Jan 2016 05:00:00 GMT",e.defaults.headers.get["Cache-Control"]="no-cache",e.defaults.headers.get.Pragma="no-cache",t.options({appendToBody:!0})}e.$inject=["$httpProvider","$uibTooltipProvider"],angular.module("app").config(e)}(),function(){"use strict";function e(e,t){function n(e){t.set("sidebarLocked",e)}var r=this;r.$state=e,r.lockSidebar=t.get("sidebarLocked"),r.toggleSidebarLocked=n}e.$inject=["$state","localStorageService"],angular.module("app").controller("AppCtrl",e)}(),function(){"use strict";function e(e,i,o){var a={superAdmin:n,admin:t,user:r};o.html5Mode(!0),i.otherwise("/"),i.when("/pyramids/","/pyramids"),e.state("home",{url:"/",views:{content:{controller:"HomeCtrl",controllerAs:"vm",templateUrl:"common/views/home.html"}}}).state("pyramids",{url:"/pyramids",views:{content:{controller:"PyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramids.html"}}}).state("pyramids.myPyramids",{url:"/my-pyramids",views:{"content@":{controller:"MyPyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/my-pyramids.html"}},resolve:{auth:a.user}}).state("pyramids.view",{url:"/view/:competitionId",views:{"content@":{controller:"PyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramid.html"}}}).state("pyramids.stats",{url:"/stats/:competitionId",views:{"content@":{controller:"StatsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/stats.html"}}}).state("pyramids.admin",{url:"/admin/:competitionId",views:{"content@":{controller:"AdminCtrl",controllerAs:"vm",templateUrl:"pyramids/views/admin.html"}},resolve:{auth:a.user}}).state("pyramids.create",{url:"/create",views:{"content@":{controller:"CreatePyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/create-pyramid.html"}},resolve:{auth:a.user}}).state("user",{url:"/user",views:{content:{controller:"UserCtrl",controllerAs:"vm",templateUrl:"users/views/user.html"}},resolve:{auth:a.user}}).state("login",{url:"/login",views:{content:{controller:"LoginCtrl",controllerAs:"vm",templateUrl:"authentication/views/login.html"}}}).state("register",{url:"/register",views:{content:{controller:"RegisterCtrl",controllerAs:"vm",templateUrl:"authentication/views/register.html"}}}).state("verify",{url:"/verification",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}}).state("verification",{url:"/verification/:userId/:verificationToken",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}}).state("password-reset-request",{url:"/password-reset",views:{content:{controller:"PasswordResetCtrl",controllerAs:"vm",templateUrl:"authentication/views/password-reset.html"}}}).state("password-reset",{url:"/password-reset/:userId/:verificationToken",views:{content:{controller:"PasswordResetCtrl",controllerAs:"vm",templateUrl:"authentication/views/password-reset.html"}}})}function t(e){return e.authorizeCurrentUserForRoute("admin")}function n(e){return e.authorizeCurrentUserForRoute("super-admin")}function r(e){return e.authenticatedUserForRoute()}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app").config(e),t.$inject=["authService"],n.$inject=["authService"],r.$inject=["authService"]}(),function(){"use strict";function e(e,t,n){e.$on("$stateChangeError",function(e,n,r,i,o,a){"not authorized"===a&&(t.go("login"),t.previous=n,t.prevParams=r)}),e.$on("$stateChangeStart",function(){n.setSidebarStatus(!1)})}e.$inject=["$rootScope","$state","sidebarService"],angular.module("app").run(e)}(),function(){"use strict";function e(e,t,n,r,i,o){function a(e,r){var o=n.defer();return t.post("/login",{username:e,password:r}).then(function(e){e.data.success?(i.currentUser=e.data.user,o.resolve(!0)):"unverified"===e.data.message?o.resolve("unverified"):o.resolve(!1)}),o.promise}function s(e){var r=n.defer();return t.post("/api/users",{userData:e}).then(function(e){e.data?r.resolve(!0):r.resolve(!1)},function(e){"Error: Duplicate Username"===e.data.reason&&o.error("Sorry, an account already exists with that email address.")}),r.promise}function l(){var r=n.defer();return t.post("/logout",{logout:!0}).then(function(){i.currentUser=void 0,r.resolve(),e.go("home")}),r.promise}function c(e){return!!i.isAuthorized(e)||n.reject("not authorized")}function u(){return!!i.isAuthenticated()||n.reject("not authorized")}var d={authenticateUser:a,createUser:s,logout:l,authorizeCurrentUserForRoute:c,authenticatedUserForRoute:u};return d}e.$inject=["$state","$http","$q","userService","identityService","notifyService"],angular.module("app").factory("authService",e)}(),function(){"use strict";function e(e){function t(){return e.get("/api/users").then(function(e){return e})}function n(t,n){return e.get("/api/user/verification",{params:{userId:t,verificationToken:n}})}function r(t){return e.get("/api/user/password/link",{params:{username:t}})}function i(t,n,r){return e.put("/api/user/password/reset",{userId:t,verificationToken:n,password:r})}var o={getAllUsers:t,verifyUser:n,generatePasswordResetLink:r,resetPassword:i};return o}e.$inject=["$http"],angular.module("app").factory("userService",e)}(),function(){"use strict";function e(e,t,n){function r(){}function i(r,i){t.authenticateUser(r,i).then(function(t){t?"unverified"===t?n.error("You must verify your email before you can login"):e.previous?(e.go(e.previous,e.prevParams),e.previous=null,e.prevParams=null):e.go("home"):n.error("Username / password combinaiton incorrect")})}var o=this;o.login=i,r()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("LoginCtrl",e)}(),function(){"use strict";function e(e,t,n,r,i,o){function a(){o.isAuthenticated()?e.go("home"):t.userId&&t.verificationToken&&n.verifyUser(t.userId,t.verificationToken).then(function(e){e.data&&(c.verified=!0)})}function s(t){n.generatePasswordResetLink(t).then(function(t){t.data?(r.success("Please check your email for a password reset link"),e.go("home")):r.error("Could not find that email address")})}function l(o){o.password!==o.confirmPassword?r.error("Passwords don't match!"):n.resetPassword(t.userId,t.verificationToken,o.password).then(function(t){t.data&&i.authenticateUser(t.data.username,o.password).then(function(t){e.go("home")})})}var c=this;c.username="",c.verified=!1,c.resetPasswordForm={},c.generatePasswordResetLink=s,c.resetPassword=l,a()}e.$inject=["$state","$stateParams","userService","notifyService","authService","identityService"],angular.module("app").controller("PasswordResetCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){}function i(r){r.password!==r.confirmPassword?n.error("Passwords don't match!"):t.createUser(r).then(function(){e.go("verify")})}var o=this;o.register=i,r()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("RegisterCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){t.userId&&t.verificationToken&&(i.verifying=!0,i.verified=null,n.verifyUser(t.userId,t.verificationToken).then(function(e){e.data?i.verified=!0:i.verified=!1}))}var i=this;i.verified=void 0,i.verifying=!1,r()}e.$inject=["$state","$stateParams","userService"],angular.module("app").controller("VerificationCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@"},templateUrl:"/challenges/components/active-challenges.html"};return e}function t(e,t){function n(){r()}function r(){i.challenges=[],t.getActiveChallengesByCompetition(i.competitionId).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){0!==e.timeLimit&&(e.expires=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1)}))})}var i=this;i.challenges=[],n(),e.$on("ws:challenge_created",function(e,t){i.competitionId===t.competitionId&&r()}),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&r()}),e.$on("ws:pyramid_updated",function(e,t){i.competitionId===t.competitionId&&r()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpActiveChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@",limit:"@"},templateUrl:"/challenges/components/completed-challenges.html"};return e}function t(e,t){function n(){r()}function r(){i.challenges=[],t.getCompletedChallengesByCompetition(i.competitionId,i.limit).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){e.loser="challenger"===e.winner?"opponent":"challenger",e.whenCompleted=moment(e.completed).calendar(null,{sameDay:"[Today]",nextDay:"[Tomorrow]",nextWeek:"dddd",lastDay:"[Yesterday]",lastWeek:"[Last] dddd",sameElse:"DD/MM/YYYY"})}))})}var i=this;i.challenges=[],n(),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&r()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpCompletedChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@",player:"="},templateUrl:"/challenges/components/player-overall-results.html"};return e}function t(e){function t(){n(r.competitionId,r.player._id)}function n(t,n){e.getPlayerResultsByCompetition(t,n).then(function(e){for(var t=[],i=0;i<r.maxLevels;i++)t.push(i*(i+1)/2+1);r.player.level=t.length;for(var o=0;o<t.length;o++)if(r.player.position<t[o+1]){r.player.level=t.indexOf(t[o])+1;break}var a,s=0,l=!0;_.forEach(e.data,function(e){l&&("challenger"===e.winner&&e.challenger._id===n||"opponent"===e.winner&&e.opponent._id===n?"losing"!==a?(s+=1,a="winning"):l=!1:("opponent"===e.winner&&e.challenger._id===n||"challenger"===e.winner&&e.opponent._id===n)&&("winning"!==a?(s+=1,a="losing"):l=!1)),r.streak={type:a,value:s}}),r.wins.asOpponent=_.size(_.filter(e.data,function(e){return e.opponent._id===n&&"opponent"===e.winner})),r.wins.asChallenger=_.size(_.filter(e.data,function(e){return e.challenger._id===n&&"challenger"===e.winner})),r.wins.total=r.wins.asChallenger+r.wins.asOpponent,r.wins.byForfeit=_.size(_.filter(e.data,function(e){return e.forfeit&&(e.challenger._id===n&&"challenger"===e.winner||e.opponent._id===n&&"opponent"===e.winner)})),r.loses.asOpponent=_.size(_.filter(e.data,function(e){return e.opponent._id===n&&"challenger"===e.winner})),r.loses.asChallenger=_.size(_.filter(e.data,function(e){return e.challenger._id===n&&"opponent"===e.winner})),r.loses.total=r.loses.asChallenger+r.loses.asOpponent,r.loses.byForfeit=_.size(_.filter(e.data,function(e){return e.forfeit&&(e.challenger._id===n&&"opponent"===e.winner||e.opponent._id===n&&"challenger"===e.winner)}))})}var r=this;r.maxLevels=10,r.wins={total:0,asChallenger:0,asOpponent:0,byForfeit:0},r.loses={total:0,asChallenger:0,asOpponent:0,byForfeit:0},r.streak={type:null,value:0},t()}t.$inject=["challengesService"],angular.module("app").directive("kpPlayerOverallResults",e)}(),function(){"use strict";function e(e){function t(t){return e.post("/api/challenges/create",{challenge:t})}function n(t){return e.post("/api/challenges/complete",{challenge:t})}function r(t){return e.get("/api/challenges/competition",{params:{competitionId:t}})}function i(t){return e.get("/api/challenges/active/competition",{params:{competitionId:t}})}function o(t,n){return e.get("/api/challenges/active/competition/player",{params:{competitionId:t,playerId:n}})}function a(t,n){return e.get("/api/challenges/completed/competition",{params:{competitionId:t,limit:n}})}function s(t,n){return e.delete("/api/challenges/active/competition/player/delete",{params:{competitionId:t,playerId:n}})}function l(t){return e.delete("/api/challenges/delete",{params:{challengeId:t}})}function c(t,n){return e.get("/api/challenges/results/competition/player",{params:{competitionId:t,playerId:n}})}var u={createChallenge:t,completeChallenge:n,getChallengesByCompetition:r,getActiveChallengesByCompetition:i,getActiveChallengeByCompetitionByPlayer:o,getCompletedChallengesByCompetition:a,deleteActiveChallengeByCompetitionByPlayer:s,deleteChallenge:l,getPlayerResultsByCompetition:c};return u}e.$inject=["$http"],angular.module("app").factory("challengesService",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",templateUrl:"/common/components/footer.html"};return e}function t(e,t){function n(){t.logout()}var r=this;r.indentity=e,r.logout=n}t.$inject=["identityService","authService"],angular.module("app").directive("kpFooter",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"headerCtrl",restrict:"A",templateUrl:"/common/components/header.html"};return e}function t(e,t,n){function r(){o.sidebarStatus.left=!o.sidebarStatus.left,e.setSidebarStatus(o.sidebarStatus.left)}function i(){n.logout()}var o=this;o.indentity=t,o.logout=i,o.sidebarStatus=e.getSidebarStatus(),o.toggleSidebar=r}t.$inject=["sidebarService","identityService","authService"],angular.module("app").directive("kpHeader",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"sidebarCtrl",restrict:"A",templateUrl:"/common/components/sidebar.html"};return e}function t(e,t,n){function r(){t.logout()}var i=this;i.indentity=e,i.logout=r,i.sidebarStatus=n.getSidebarStatus()}t.$inject=["identityService","authService","sidebarService"],angular.module("app").directive("kpSidebar",e)}(),function(){"use strict";function e(){return function(e,t){if(!angular.isObject(e))return e;var n=[];for(var r in e)n.push(e[r]);return n.sort(function(e,n){return e=parseInt(e[t]),n=parseInt(n[t]),e-n}),n}}angular.module("app").filter("orderObjectBy",e)}(),function(){"use strict";function e(e){function t(){return!!this.currentUser}function n(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}var r;null!==e.bootstrappedUserObject&&(r=e.bootstrappedUserObject);var i={currentUser:r,isAuthenticated:t,isAuthorized:n};return i}e.$inject=["$window"],angular.module("app").factory("identityService",e)}(),function(){"use strict";function e(){function e(e,t,n){$.notify({message:e,url:t,target:n},{type:"info"})}function t(e,t,n){$.notify({message:e,url:t,target:n},{type:"success"})}function n(e,t,n){$.notify({message:e,url:t,target:n},{type:"warning"})}function r(e,t,n){$.notify({message:e,url:t,target:n},{type:"danger"})}function i(e,t,n){$.notify({message:e,url:t,target:n},{type:"inverse"})}var o={info:e,success:t,warning:n,error:r,inverse:i};return $.notifyDefaults({newest_on_top:!0,offset:{x:20,y:85}}),o}angular.module("app").factory("notifyService",e)}(),function(){"use strict";function e(){function e(e,t,n,r){$(e).mCustomScrollbar({theme:t,scrollInertia:100,axis:n,mouseWheel:{enable:!0,axis:r,preventDefault:!0}})}var t={malihuScroll:e};return t}angular.module("app").factory("scrollbarService",e)}(),function(){"use strict";function e(){function e(){return n}function t(e){n.left=e}var n={left:!1,right:!1},r={getSidebarStatus:e,setSidebarStatus:t};return r}angular.module("app").factory("sidebarService",e)}(),angular.module("app").service("websocketService",["$rootScope","$window",function(e,t){function n(){return"https:"===t.location.protocol?"wss://"+t.location.host:"ws://"+t.location.host}var r;this.connect=function(){r=new WebSocket(n()),r.onmessage=function(t){var n=JSON.parse(t.data);e.$broadcast("ws:"+n.topic,n.data)}},this.send=function(e,t){var n=JSON.stringify({topic:e,data:t});r.send(n)}}]).run(["websocketService",function(e){e.connect()}]),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("HomeCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{pyramid:"="},templateUrl:"/pyramids/components/pending-players.html"};return e}function t(e){function t(){}function n(t){t.position=i.pyramid.players.length+1,e.approvePendingPlayer(i.pyramid._id,t)}function r(t){e.denyPendingPlayer(i.pyramid._id,t)}var i=this;i.pendingPlayers=[],i.approvePendingPlayer=n,i.denyPendingPlayer=r,t()}t.$inject=["pyramidsService"],angular.module("app").directive("kpPendingPlayers",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{type:"@"},templateUrl:"/pyramids/components/pyramid-compact.html"};return e}function t(e,t){function n(){"user"===r.type?e.getPyramidsForUser(t.currentUser._id).then(function(e){r.pyramids=e.data}):e.getPyramids().then(function(e){r.pyramids=e.data})}var r=this;r.pyramids=null,n()}t.$inject=["pyramidsService","identityService"],angular.module("app").directive("kpPyramidCompact",e)}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"/pyramids/components/pyramid.html",replace:!0,scope:{competitionId:"@"},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,n,r,i,o,a){function s(){n.getPyramid(S.competitionId).then(function(e){for(var t=I;t>0;--t)S.maxPlayers+=t;e.data&&(S.pyramid=e.data,l(),c(),d(),p(),m())})}function l(){S.pyramid.players=r("orderBy")(S.pyramid.players,"position")}function c(){S.currentUserIsOwner=!1,S.currentUserIsPending=!1,o.isAuthenticated()&&(S.currentUserIsOwner=_.some(S.pyramid.owners,["_id",o.currentUser._id]),S.currentUserIsPending=_.some(S.pyramid.pendingPlayers,["_id",o.currentUser._id])),S.currentUserIsOnPyramid=!1,S.hasActiveChallenge=!1,_.forEach(S.pyramid.players,function(e){o.isAuthenticated()&&e._id===o.currentUser._id&&(S.currentUserIsOnPyramid=!0,e.class="current-user",S.currentUserPlayer=e,a.getActiveChallengeByCompetitionByPlayer(S.competitionId,e._id).then(function(t){t.data&&(S.hasActiveChallenge=!0,S.activeChallengeOpponent=t.data.challenger._id===e._id?t.data.opponent:t.data.challenger)}))}),a.getActiveChallengesByCompetition(S.competitionId).then(function(e){_.forEach(e.data,function(e){var t=_.find(S.pyramid.players,{_id:e.challenger._id});t.class="unavailable",t.challenge={position:"challenger"};var n=_.find(S.pyramid.players,{_id:e.opponent._id});if(n.class="unavailable",n.challenge={position:"opponent"},0!==e.timeLimit){var r=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1;r>0?n.challenge.expires=r:r<=0&&v(null,!0,n)}}),f()})}function u(){S.breakPoints=[];for(var e=0;e<I;e++)S.breakPoints.push(e*(e+1)/2+1)}function d(){var e=0;S.levels=[],u();for(var t=0;t<S.pyramid.players.length;t++)S.breakPoints.indexOf(t+1)>-1&&(e+=1,S.levels.push(e)),S.pyramid.players[t].level=e}function p(){S.numberOfBlocks=0;for(var e=_.last(S.levels);e>0;e--)S.numberOfBlocks+=e}function m(){S.numberOfRealPlayers=S.pyramid.players.length;for(var e=S.pyramid.players.length;e<S.numberOfBlocks;e++)S.pyramid.players.push({firstName:"Empty",lastName:"Spot",position:99,class:"empty"});d()}function f(){var e=S.currentUserPlayer.level>1?S.currentUserPlayer.level-1:null;_.forEach(S.pyramid.players,function(t){t.level===e&&99!==t.position&&"unavailable"!==t.class&&(S.availableChallenges=!0,t.available=!0)})}function y(e){if(e.available){S.hasActiveChallenge=!0;var t={competitionName:S.pyramid.name,competitionId:S.competitionId,complete:!1,forfeit:!1,timeLimit:S.pyramid.forfeitDays,challenger:{_id:S.currentUserPlayer._id,email:S.currentUserPlayer.email,firstName:S.currentUserPlayer.firstName,lastName:S.currentUserPlayer.lastName,position:S.currentUserPlayer.position},opponent:{_id:e._id,email:e.email,firstName:e.firstName,lastName:e.lastName,position:e.position}};a.createChallenge(t).then(function(){S.pyramidMenuToggle=!1})}else i.error("Sorry, that is not a valid challenge.")}function v(e,t,r){var i=r||S.currentUserPlayer;a.getActiveChallengeByCompetitionByPlayer(S.competitionId,i._id).then(function(i){S.hasActiveChallenge=!1;var o=!1;t?(i.data.forfeit=!0,"opponent"===r.challenge.position?(i.data.winner="challenger",o=!0):i.data.winner="opponent"):e?i.data.challenger._id===S.currentUserPlayer._id?(i.data.winner="challenger",o=!0):i.data.winner="opponent":i.data.challenger._id===S.currentUserPlayer._id?i.data.winner="opponent":(i.data.winner="challenger",o=!0),o?n.swapPositions(S.competitionId,i.data.opponent,i.data.challenger).then(function(){a.completeChallenge(i.data).then(function(){$&&w()})}):a.completeChallenge(i.data).then(function(){$&&w()}),S.pyramidMenuToggle=!1})}function h(e){v(null,!0,e)}function g(){if(o.isAuthenticated())if(S.numberOfRealPlayers<S.maxPlayers){var e={_id:o.currentUser._id,firstName:o.currentUser.firstName,lastName:o.currentUser.lastName,email:o.currentUser.username,position:S.numberOfRealPlayers+1};S.pyramid.open?swal({title:"Join Competition?",text:"You'll be added to the bottom",type:"warning",showCancelButton:!0,confirmButtonText:"Join",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToPyramid(S.competitionId,e),swal("Welcome Aboard!","Now start fighting your way to the top","success")}):swal({title:"Send Join Request?",text:"This is a closed competition so the owner must approve your request",type:"warning",showCancelButton:!0,confirmButtonText:"Send Request",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToPyramidRequest(S.pyramid,e).then(function(){S.currentUserIsPending=!0}),swal("Request Sent","You will receive an email once the owner processes the request.","success")})}else i.warning("Sorry, this pyramid is full");else t.go("login")}function P(){swal({title:"Leave Pyramid?",text:"You will lose your spot and forfeit any active challenges.",type:"error",showCancelButton:!0,confirmButtonText:"Yes, leave",confirmButtonClass:"btn-danger",cancelButtonText:"No, stay",closeOnConfirm:!1,closeOnCancel:!0},function(){w(),swal("OK, you'r out!","You've been removed from the pyramid.","success")})}function w(){o.isAuthenticated()&&S.currentUserIsOnPyramid&&($=!0,S.hasActiveChallenge?v(null,!0,S.currentUserPlayer):(S.currentUserIsOnPyramid=!1,S.hasActiveChallenge=!1,n.getPyramid(S.competitionId).then(function(e){var t=e.data,r=S.currentUserPlayer.position;_.forEach(t.players,function(e){e.position>=r&&(e.position-=1)});for(var i=_.remove(t.players,function(e){return e._id===S.currentUserPlayer._id}),o=[],a=0;a<S.numberOfRealPlayers-1;++a){var s={_id:t.players[a]._id,firstName:t.players[a].firstName,lastName:t.players[a].lastName,position:t.players[a].position};o.push(s)}n.removedPlayerFromPyramid(S.competitionId,i[0],o).then(function(){$=!1})})))}function C(){n.getPyramid(S.competitionId).then(function(e){S.pyramid=e.data,l(),c(),d(),p(),m()})}var I=10,S=this;S.pyramid={},S.breakPoints=[],S.levels=[],S.numberOfBlocks=0,S.currentUserIsOnPyramid=!1,S.currentUserIsPending=!1,S.currentUserIsOwner=!1,S.hasActiveChallenge=!1,S.activeChallengeOpponent=null,S.availableChallenges=!1,S.createChallenge=y,S.completeChallenge=v,S.challengeExpired=h,S.currentUserPlayer={},S.pyramidMenuToggle=!1,S.addCurrentUserToPyramid=g,S.confirmRemoveCurrentUserFromPyramid=P,S.numberOfRealPlayers=0,S.maxPlayers=0,s();var $=!1;e.$on("ws:challenge_created",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:challenge_completed",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),$||C())}),e.$on("ws:player_added",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:player_removed",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:pyramid_updated",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())})}t.$inject=["$scope","$state","pyramidsService","$filter","notifyService","identityService","challengesService"],angular.module("app").directive("kpPyramid",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{pyramid:"="},templateUrl:"/pyramids/components/update-players.html"};return e}function t(e,t,n){function r(){}function i(){_.forEach(l,function(e){n.deleteActiveChallengeByCompetitionByPlayer(c.pyramid._id,e._id)}),t.updatePyramid(c.pyramid)}function o(){t.getPyramid(c.pyramid._id).then(function(t){t.data.players=e("orderBy")(t.data.players,"position"),c.pyramid=t.data})}function a(){var e=1;_.forEach(c.pyramid.players,function(t){t.position=e,++e})}function s(e,t){l.push(e),c.pyramid.players.splice(t,1),a()}var l=[],c=this;c.updatePyramid=i,c.cancelUpdate=o,c.reorderPlayers=a,c.removePlayer=s,r()}t.$inject=["$filter","pyramidsService","challengesService"],angular.module("app").directive("kpUpdatePlayers",e)}(),function(){"use strict";function e(e){function t(t){return e.get("/api/pyramid",{params:{competitionId:t}})}function n(t){return e.get("/api/pyramids/user",{params:{userId:t}})}function r(){return e.get("/api/pyramids")}function i(t){return e.post("/api/pyramids/create",{pyramid:t})}function o(t){return e.post("/api/pyramids/update",{pyramid:t})}function a(t,n,r){return e.post("/api/pyramids/swapPositions",{competitionId:t,challenger:n,opponent:r})}function s(t,n){return e.post("/api/pyramids/addPlayer",{competitionId:t,player:n})}function l(t,n){return e.post("/api/pyramids/addPlayerRequest",{competition:t,player:n})}function c(t,n,r){return e.post("/api/pyramids/removePlayer",{competitionId:t,removedPlayer:n,players:r})}function u(t,n){return e.post("/api/pyramids/approvePlayer",{competitionId:t,player:n})}function d(t,n){return e.post("/api/pyramids/denyPlayer",{competitionId:t,player:n})}var p={getPyramid:t,getPyramidsForUser:n,getPyramids:r,createPyramid:i,updatePyramid:o,swapPositions:a,addPlayerToPyramid:s,addPlayerToPyramidRequest:l,removedPlayerFromPyramid:c,approvePendingPlayer:u,denyPendingPlayer:d};return p}e.$inject=["$http"],angular.module("app").factory("pyramidsService",e)}(),function(){"use strict";function e(e,t,n,r,i,o,a){function s(){n.competitionId?(u.competitionId=n.competitionId,l()):t.go("pyramids.myPyramids")}function l(){i.getPyramid(u.competitionId).then(function(e){e.data&&_.some(e.data.owners,["_id",o.currentUser._id])?(e.data.players=r("orderBy")(e.data.players,"position"),u.pyramid=e.data):t.go("pyramids.myPyramids")})}function c(){i.getPyramid(u.competitionId).then(function(e){var t=e.data;t.open=u.pyramid.open,i.updatePyramid(t)})}var u=this;u.competitionId=null,u.updatePyramidOpenStatus=c,s(),e.$on("ws:challenge_completed",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),l())}),e.$on("ws:player_added",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),l())}),e.$on("ws:player_removed",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),l())}),e.$on("ws:pyramid_updated",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),l())}),e.$on("ws:add_player_request",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),l())}),e.$on("ws:add_player_request_denied",function(e,t){u.competitionId===t.competitionId&&(a.info(t.description),l())})}e.$inject=["$scope","$state","$stateParams","$filter","pyramidsService","identityService","notifyService"],angular.module("app").controller("AdminCtrl",e)}(),function(){"use strict";function e(e,t,n,r){function i(){t.getAllUsers().then(function(e){d.availablePlayers=e.data});for(var e=0;e<u;e++)c.push(e*(e+1)/2+1)}function o(e){e.position=d.addedPlayers.length+1,d.addedPlayers.push(_.remove(d.availablePlayers,{_id:e._id})[0])}function a(e){d.availablePlayers.push(_.remove(d.addedPlayers,{_id:e._id})[0]),s()}function s(){var e=1;_.forEach(d.addedPlayers,function(t){t.position=e,++e})}function l(t){angular.forEach(d.addedPlayers,function(e){p+=1;var n={position:p,_id:e._id,email:e.username,firstName:e.firstName,lastName:e.lastName};t.players.push(n)}),t.owners=[{_id:r.currentUser._id,email:r.currentUser.username,firstName:r.currentUser.firstName,lastName:r.currentUser.lastName}];for(var i=0;i<c.length;i++)if(t.players.length<c[i]){t.levels=i;break}n.createPyramid(t).then(function(t){e.go("pyramids.view",{competitionId:t.data._id})})}var c=[],u=10,d=this;d.newPyramid={players:[],open:!1},d.availablePlayers=[],d.addedPlayers=[],d.createPyramid=l,d.addPlayer=o,d.removePlayer=a,d.reorderPlayers=s,d.newPyramid.forfeitDays=1,i();var p=0}e.$inject=["$state","userService","pyramidsService","identityService"],angular.module("app").controller("CreatePyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("MyPyramidsCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){t.competitionId&&(i.competitionId=t.competitionId,n.getPyramid(i.competitionId).then(function(t){t.data?i.pyramid=t.data:e.go("pyramids.myPyramids")}))}var i=this;i.competitionId=null,i.pyramid=null,r()}e.$inject=["$state","$stateParams","pyramidsService"],angular.module("app").controller("PyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("PyramidsCtrl",e)}(),function(){"use strict";function e(e,t,n,r,i){function o(){t.competitionId&&(s.competitionId=t.competitionId,a())}function a(){r.getPyramid(s.competitionId).then(function(e){e.data?s.pyramid=e.data:n.go("pyramids.myPyramids")})}var s=this;s.competitionId=null,s.pyramid=null,o(),e.$on("ws:challenge_completed",function(e,t){s.competitionId===t.competitionId&&(i.info(t.description),a())})}e.$inject=["$scope","$stateParams","$state","pyramidsService","notifyService"],angular.module("app").controller("StatsCtrl",e)}(),function(){"use strict";function e(e){function t(){}var n=this;n.indentity=e,t()}e.$inject=["identityService"],angular.module("app").controller("UserCtrl",e)}(),function(){"use strict";function e(e){function t(t,n,r){var i=r.scrollaxis||"y",o=r.theme||"minimal-dark",a=r.mousewheelaxis||"y";$("html").hasClass("ismobile")||e.malihuScroll(n,o,i,a)}var n={restrict:"C",link:t};return n}e.$inject=["scrollbarService"],angular.module("app").directive("cOverflow",e)}(),function(){"use strict";function e(){function e(e,t){t.click(function(){t.next().slideToggle(200),t.parent().toggleClass("toggled")})}var t={restrict:"A",link:e};return t}angular.module("app").directive("toggleSubmenu",e)}(),function(){"use strict";function e(){function e(e,t){t.hasClass("btn-icon")||t.hasClass("btn-float")?Waves.attach(t,["waves-circle"]):t.hasClass("btn-light")?Waves.attach(t,["waves-light"]):Waves.attach(t),Waves.init()}var t={restrict:"C",link:e};return t}angular.module("app").directive("wavesEffect",e)}(),function(){"use strict";function e(){function e(e,t){var n=t.children().first(),r=t.parent().hasClass("fg-float");n.focus(function(){t.addClass("fg-toggled")}),n.blur(function(){(!r||r&&0===n.val().length)&&t.removeClass("fg-toggled")})}var t={restrict:"C",link:e};return t}angular.module("app").directive("fgLine",e)}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiYXBwLmNvbnRyb2xsZXIuanMiLCJhcHAucm91dGVzLmpzIiwiYXBwLnJ1bi5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL2F1dGguc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL3VzZXIuc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3ZpZXdzL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJhdXRoZW50aWNhdGlvbi92aWV3cy9wYXNzd29yZC1yZXNldC5jb250cm9sbGVyLmpzIiwiYXV0aGVudGljYXRpb24vdmlld3MvcmVnaXN0ZXIuY29udHJvbGxlci5qcyIsImF1dGhlbnRpY2F0aW9uL3ZpZXdzL3ZlcmlmaWNhdGlvbi5jb250cm9sbGVyLmpzIiwiY2hhbGxlbmdlcy9jb21wb25lbnRzL2FjdGl2ZS1jaGFsbGVuZ2VzLmRpcmVjdGl2ZS5qcyIsImNoYWxsZW5nZXMvY29tcG9uZW50cy9jb21wbGV0ZWQtY2hhbGxlbmdlcy5kaXJlY3RpdmUuanMiLCJjaGFsbGVuZ2VzL2NvbXBvbmVudHMvcGxheWVyLW92ZXJhbGwtcmVzdWx0cy5kaXJlY3RpdmUuanMiLCJjaGFsbGVuZ2VzL3NlcnZpY2VzL2NoYWxsZW5nZXMuc2VydmljZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL2Zvb3Rlci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy9oZWFkZXIuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvc2lkZWJhci5kaXJlY3RpdmUuanMiLCJjb21tb24vZmlsdGVycy9vcmRlci1vYmplY3QtYnkuZmlsdGVyLmpzIiwiY29tbW9uL3NlcnZpY2VzL2luZGVudGl0eS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL25vdGlmeS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3Njcm9sbGJhci5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3NpZGViYXIuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy93ZWJzb2NrZXQuc2VydmljZS5qcyIsImNvbW1vbi92aWV3cy9ob21lLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3BlbmRpbmctcGxheWVycy5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQtY29tcGFjdC5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQuZGlyZWN0aXZlLmpzIiwicHlyYW1pZHMvY29tcG9uZW50cy91cGRhdGUtcGxheWVycy5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9zZXJ2aWNlcy9weXJhbWlkcy5zZXJ2aWNlLmpzIiwicHlyYW1pZHMvdmlld3MvYWRtaW4uY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL2NyZWF0ZS1weXJhbWlkLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy92aWV3cy9teS1weXJhbWlkcy5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvcHlyYW1pZC5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvcHlyYW1pZHMuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL3N0YXRzLmNvbnRyb2xsZXIuanMiLCJ1c2Vycy92aWV3cy91c2VyLmNvbnRyb2xsZXIuanMiLCJjb21tb24vY29tcG9uZW50cy91aS9zY3JvbGxiYXIuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvdWkvdG9nZ2xlLXN1Ym1lbnUuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvdWkvd2F2ZXMuZGlyZWN0aXZlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvdWkvZm9ybXMvZmctbGluZS5kaXJlY3RpdmUuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZ3VyYXRpb24iLCIkaHR0cFByb3ZpZGVyIiwiJHVpYlRvb2x0aXBQcm92aWRlciIsImRlZmF1bHRzIiwiaGVhZGVycyIsImdldCIsIm9wdGlvbnMiLCJhcHBlbmRUb0JvZHkiLCJjb25maWciLCJBcHBDdHJsIiwiJHN0YXRlIiwibG9jYWxTdG9yYWdlU2VydmljZSIsInRvZ2dsZVNpZGViYXJMb2NrZWQiLCJsb2NrZWQiLCJzZXQiLCJhcHBDdHJsIiwidGhpcyIsImxvY2tTaWRlYmFyIiwiY29udHJvbGxlciIsImNvbmZpZ3VyZVJvdXRlcyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJyb3V0ZVJvbGVDaGVja3MiLCJzdXBlckFkbWluIiwicmVxdWlyZVN1cGVyQWRtaW4iLCJhZG1pbiIsInJlcXVpcmVBZG1pbiIsInVzZXIiLCJyZXF1aXJlQXV0aCIsImh0bWw1TW9kZSIsIm90aGVyd2lzZSIsIndoZW4iLCJzdGF0ZSIsInVybCIsInZpZXdzIiwiY29udGVudCIsImNvbnRyb2xsZXJBcyIsInRlbXBsYXRlVXJsIiwiY29udGVudEAiLCJyZXNvbHZlIiwiYXV0aCIsImF1dGhTZXJ2aWNlIiwiYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSIsImF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUiLCIkaW5qZWN0IiwiYXBwUnVuIiwiJHJvb3RTY29wZSIsInNpZGViYXJTZXJ2aWNlIiwiJG9uIiwiZXZlbnQiLCJ0b1N0YXRlIiwidG9QYXJhbXMiLCJmcm9tU3RhdGUiLCJmcm9tUGFyYW1zIiwiZXJyb3IiLCJnbyIsInByZXZpb3VzIiwicHJldlBhcmFtcyIsInNldFNpZGViYXJTdGF0dXMiLCJydW4iLCIkaHR0cCIsIiRxIiwidXNlclNlcnZpY2UiLCJpZGVudGl0eVNlcnZpY2UiLCJub3RpZnlTZXJ2aWNlIiwiYXV0aGVudGljYXRlVXNlciIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJkZmQiLCJkZWZlciIsInBvc3QiLCJ0aGVuIiwicmVzcG9uc2UiLCJkYXRhIiwic3VjY2VzcyIsImN1cnJlbnRVc2VyIiwibWVzc2FnZSIsInByb21pc2UiLCJjcmVhdGVVc2VyIiwidXNlckRhdGEiLCJyZWFzb24iLCJsb2dvdXQiLCJ1bmRlZmluZWQiLCJyb2xlIiwiaXNBdXRob3JpemVkIiwicmVqZWN0IiwiaXNBdXRoZW50aWNhdGVkIiwic2VydmljZSIsImZhY3RvcnkiLCJnZXRBbGxVc2VycyIsInVzZXJzIiwidmVyaWZ5VXNlciIsInVzZXJJZCIsInZlcmlmaWNhdGlvblRva2VuIiwicGFyYW1zIiwiZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayIsInJlc2V0UGFzc3dvcmQiLCJwdXQiLCJMb2dpbkN0cmwiLCJhY3RpdmF0ZSIsImxvZ2luIiwidm0iLCJQYXNzd29yZFJlc2V0Q3RybCIsIiRzdGF0ZVBhcmFtcyIsInZlcmlmaWVkIiwicmVzZXRQYXNzd29yZEZvcm0iLCJjb25maXJtUGFzc3dvcmQiLCJSZWdpc3RlckN0cmwiLCJyZWdpc3RlciIsIm5ld1VzZXIiLCJWZXJpZmljYXRpb25DdHJsIiwidmVyaWZ5aW5nIiwia3BBY3RpdmVDaGFsbGVuZWdlcyIsImRpcmVjdGl2ZSIsImJpbmRUb0NvbnRyb2xsZXIiLCJjdHJsRnVuYyIsInJlc3RyaWN0Iiwic2NvcGUiLCJjb21wZXRpdGlvbklkIiwiJHNjb3BlIiwiY2hhbGxlbmdlc1NlcnZpY2UiLCJnZXRBY3RpdmVDaGFsbGVuZ2VzIiwiY2hhbGxlbmdlcyIsImdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uIiwibGVuZ3RoIiwiXyIsImZvckVhY2giLCJjaGFsbGVuZ2UiLCJ0aW1lTGltaXQiLCJleHBpcmVzIiwibW9tZW50IiwiZGlmZiIsImNyZWF0ZWQiLCJhZGQiLCJjaGFsbGVuZ2VEZXRhaWxzIiwia3BDb21wbGV0ZWRDaGFsbGVuZWdlcyIsImxpbWl0IiwiZ2V0Q29tcGxldGVkQ2hhbGxlbmdlcyIsImdldENvbXBsZXRlZENoYWxsZW5nZXNCeUNvbXBldGl0aW9uIiwibG9zZXIiLCJ3aW5uZXIiLCJ3aGVuQ29tcGxldGVkIiwiY29tcGxldGVkIiwiY2FsZW5kYXIiLCJzYW1lRGF5IiwibmV4dERheSIsIm5leHRXZWVrIiwibGFzdERheSIsImxhc3RXZWVrIiwic2FtZUVsc2UiLCJrcFBsYXllck92ZXJhbGxSZXN1bHRzIiwicGxheWVyIiwiZ2V0UGxheWVyT3ZlcmFsbFJlc3VsdHMiLCJfaWQiLCJwbGF5ZXJJZCIsImdldFBsYXllclJlc3VsdHNCeUNvbXBldGl0aW9uIiwicmVzdWx0cyIsImJyZWFrUG9pbnRzIiwiaSIsIm1heExldmVscyIsInB1c2giLCJsZXZlbCIsImoiLCJwb3NpdGlvbiIsImluZGV4T2YiLCJzdHJlYWtUeXBlIiwic3RyZWFrIiwiY29udGludWVTdHJlYWsiLCJjaGFsbGVuZ2VyIiwib3Bwb25lbnQiLCJ0eXBlIiwidmFsdWUiLCJ3aW5zIiwiYXNPcHBvbmVudCIsInNpemUiLCJmaWx0ZXIiLCJhc0NoYWxsZW5nZXIiLCJ0b3RhbCIsImJ5Rm9yZmVpdCIsImZvcmZlaXQiLCJsb3NlcyIsImNyZWF0ZUNoYWxsZW5nZSIsImNvbXBsZXRlQ2hhbGxlbmdlIiwiZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb24iLCJnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIiLCJkZWxldGVBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIiLCJkZWxldGUiLCJkZWxldGVDaGFsbGVuZ2UiLCJjaGFsbGVuZ2VJZCIsImtwRm9vdGVyIiwiaW5kZW50aXR5Iiwia3BIZWFkZXIiLCJ0b2dnbGVTaWRlYmFyIiwic2lkZWJhclN0YXR1cyIsImxlZnQiLCJnZXRTaWRlYmFyU3RhdHVzIiwia3BTaWRlYmFyIiwib3JkZXJPYmplY3RCeSIsImlucHV0IiwiYXR0cmlidXRlIiwiaXNPYmplY3QiLCJhcnJheSIsIm9iamVjdEtleSIsInNvcnQiLCJhIiwiYiIsInBhcnNlSW50IiwiJHdpbmRvdyIsInJvbGVzIiwiYm9vdHN0cmFwcGVkVXNlck9iamVjdCIsImluZm8iLCJ0YXJnZXQiLCIkIiwibm90aWZ5Iiwid2FybmluZyIsImludmVyc2UiLCJub3RpZnlEZWZhdWx0cyIsIm5ld2VzdF9vbl90b3AiLCJvZmZzZXQiLCJ4IiwieSIsInNjcm9sbGJhclNlcnZpY2UiLCJtYWxpaHVTY3JvbGwiLCJzZWxlY3RvciIsInRoZW1lIiwic2Nyb2xsYXhpcyIsIm1vdXNld2hlZWxheGlzIiwibUN1c3RvbVNjcm9sbGJhciIsInNjcm9sbEluZXJ0aWEiLCJheGlzIiwibW91c2VXaGVlbCIsImVuYWJsZSIsInByZXZlbnREZWZhdWx0Iiwic3RhdHVzIiwicmlnaHQiLCJ3ZWJzb2NrZXRIb3N0IiwibG9jYXRpb24iLCJwcm90b2NvbCIsImhvc3QiLCJjb25uZWN0aW9uIiwiY29ubmVjdCIsIldlYlNvY2tldCIsIm9ubWVzc2FnZSIsImUiLCJwYXlsb2FkIiwiSlNPTiIsInBhcnNlIiwiJGJyb2FkY2FzdCIsInRvcGljIiwic2VuZCIsImpzb24iLCJzdHJpbmdpZnkiLCJ3ZWJzb2NrZXRTZXJ2aWNlIiwiSG9tZUN0cmwiLCJrcFBlbmRpbmdQbGF5ZXJzIiwicHlyYW1pZCIsInB5cmFtaWRzU2VydmljZSIsImFwcHJvdmVQZW5kaW5nUGxheWVyIiwicGxheWVycyIsImRlbnlQZW5kaW5nUGxheWVyIiwicGVuZGluZ1BsYXllcnMiLCJrcFB5cmFtaWRDb21wYWN0IiwiZ2V0UHlyYW1pZHNGb3JVc2VyIiwicHlyYW1pZHMiLCJnZXRQeXJhbWlkcyIsImtwUHlyYW1pZCIsInJlcGxhY2UiLCIkZmlsdGVyIiwiZ2V0UHlyYW1pZCIsIm1heFBsYXllcnMiLCJvcmRlclBsYXllcnMiLCJnZXRQbGF5ZXJzU3RhdHVzIiwiYXNzaWduTGV2ZWxzVG9QbGF5ZXJzIiwiY2FsY3VsYXRlUHlyYW1pZEJsb2NrcyIsImZpbGxJbkVtcHR5QmxvY2tzIiwiY3VycmVudFVzZXJJc093bmVyIiwiY3VycmVudFVzZXJJc1BlbmRpbmciLCJzb21lIiwib3duZXJzIiwiY3VycmVudFVzZXJJc09uUHlyYW1pZCIsImhhc0FjdGl2ZUNoYWxsZW5nZSIsImNsYXNzIiwiY3VycmVudFVzZXJQbGF5ZXIiLCJhY3RpdmVDaGFsbGVuZ2VPcHBvbmVudCIsImZpbmQiLCJ0aW1lVG9FeHBpcmUiLCJmaW5kQXZhaWxhYmxlQ2hhbGxlbmdlcyIsImNyZWF0ZUJyZWFrUG9pbnRzIiwibGV2ZWxzIiwibnVtYmVyT2ZCbG9ja3MiLCJsYXN0IiwibnVtYmVyT2ZSZWFsUGxheWVycyIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwibGV2ZWxBYm92ZSIsImF2YWlsYWJsZUNoYWxsZW5nZXMiLCJhdmFpbGFibGUiLCJjb21wZXRpdGlvbk5hbWUiLCJuYW1lIiwiY29tcGxldGUiLCJmb3JmZWl0RGF5cyIsImVtYWlsIiwicHlyYW1pZE1lbnVUb2dnbGUiLCJ3aW5uZXJJc0N1cnJlbnRVc2VyIiwiZm9yZmVpdExvc2VyIiwic3dhcFBvc2l0aW9ucyIsInJlbW92aW5nQ3VycmVudFVzZXIiLCJyZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkIiwiY2hhbGxlbmdlRXhwaXJlZCIsImFkZEN1cnJlbnRVc2VyVG9QeXJhbWlkIiwib3BlbiIsInN3YWwiLCJ0aXRsZSIsInRleHQiLCJzaG93Q2FuY2VsQnV0dG9uIiwiY29uZmlybUJ1dHRvblRleHQiLCJjYW5jZWxCdXR0b25UZXh0IiwiY2xvc2VPbkNvbmZpcm0iLCJjbG9zZU9uQ2FuY2VsIiwiYWRkUGxheWVyVG9QeXJhbWlkIiwiYWRkUGxheWVyVG9QeXJhbWlkUmVxdWVzdCIsImNvbmZpcm1SZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkIiwiY29uZmlybUJ1dHRvbkNsYXNzIiwicCIsIm9wZW5Qb3NpdGlvbiIsInJlbW92ZWRQbGF5ZXIiLCJyZW1vdmUiLCJ1cGRhdGVkUGxheWVycyIsInVwZGF0ZWRQbGF5ZXIiLCJyZW1vdmVkUGxheWVyRnJvbVB5cmFtaWQiLCJyZWZyZXNoUHlyYW1pZCIsImRlc2NyaXB0aW9uIiwiZGV0YWlscyIsImtwVXBkYXRlUGxheWVycyIsInVwZGF0ZVB5cmFtaWQiLCJyZW1vdmVkUGxheWVycyIsImNhbmNlbFVwZGF0ZSIsInJlb3JkZXJQbGF5ZXJzIiwicmVtb3ZlUGxheWVyIiwicGxheWVySW5kZXgiLCJzcGxpY2UiLCJjcmVhdGVQeXJhbWlkIiwiY29tcGV0aXRpb24iLCJBZG1pbkN0cmwiLCJ1cGRhdGVQeXJhbWlkT3BlblN0YXR1cyIsInVwZGF0ZWRQeXJhbWlkIiwiQ3JlYXRlUHlyYW1pZEN0cmwiLCJhdmFpbGFibGVQbGF5ZXJzIiwiYWRkUGxheWVyIiwiYWRkZWRQbGF5ZXJzIiwibmV3UHlyYW1pZCIsIk15UHlyYW1pZHNDdHJsIiwiUHlyYW1pZEN0cmwiLCJQeXJhbWlkc0N0cmwiLCJTdGF0c0N0cmwiLCJVc2VyQ3RybCIsImNPdmVyZmxvdyIsImxpbmtGdW5jIiwiZWxlbWVudCIsImF0dHJzIiwiaGFzQ2xhc3MiLCJsaW5rIiwidG9nZ2xlU3VibWVudSIsImVsIiwiY2xpY2siLCJuZXh0Iiwic2xpZGVUb2dnbGUiLCJwYXJlbnQiLCJ0b2dnbGVDbGFzcyIsIndhdmVzRWZmZWN0IiwiV2F2ZXMiLCJhdHRhY2giLCJpbml0IiwiZmdMaW5lIiwiY2hpbGRyZW4iLCJmaXJzdCIsImlzRmxvYXRMYWJlbCIsImZvY3VzIiwiYWRkQ2xhc3MiLCJibHVyIiwidmFsIiwicmVtb3ZlQ2xhc3MiXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFBQyxPQUFBLE9BQ0EsWUFDQSxlQUNBLFlBQ0Esc0JBQ0EsYUFDQSx3QkFDQSxRQUNBLHFCQUNBLDBCQ1RBLHdCQUlBLFNBQUFDLEdBQUFDLEVBQUFDLEdBRUFELEVBQUFFLFNBQUFDLFFBQUFDLE1BQ0FKLEVBQUFFLFNBQUFDLFFBQUFDLFFBR0FKLEVBQUFFLFNBQUFDLFFBQUFDLElBQUEscUJBQUEsZ0NBRUFKLEVBQUFFLFNBQUFDLFFBQUFDLElBQUEsaUJBQUEsV0FDQUosRUFBQUUsU0FBQUMsUUFBQUMsSUFBQSxPQUFBLFdBRUFILEVBQUFJLFNBQUFDLGNBQUEsc0RBYkFULFFBQUFDLE9BQUEsT0FBQVMsT0FBQVIsTUNGQSx1QkFJQSxTQUFBUyxHQUFBQyxFQUFBQyxHQVFBLFFBQUFDLEdBQUFDLEdBQ0FGLEVBQUFHLElBQUEsZ0JBQUFELEdBUkEs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Q0FHLFNBQUEsSUFDQXFQLEtBQUFKLEVBR0EsT0FBQXBQLEdBVkFwSCxRQUNBQyxPQUFBLE9BQ0FtSCxVQUFBLGdCQUFBeVAsTUNKQSxXQUNBLFlBS0EsU0FBQU8sS0FRQSxRQUFBWixHQUFBaFAsRUFBQWlQLEdBQ0FBLEVBQUFFLFNBQUEsYUFBQUYsRUFBQUUsU0FBQSxhQUNBVSxNQUFBQyxPQUFBYixHQUFBLGlCQUNBQSxFQUFBRSxTQUFBLGFBQ0FVLE1BQUFDLE9BQUFiLEdBQUEsZ0JBRUFZLE1BQUFDLE9BQUFiLEdBR0FZLE1BQUFFLE9BaEJBLEdBQUFuUSxJQUNBRyxTQUFBLElBQ0FxUCxLQUFBSixFQUdBLE9BQUFwUCxHQVZBcEgsUUFDQUMsT0FBQSxPQUNBbUgsVUFBQSxjQUFBZ1EsTUNKQSxXQUNBLFlBS0EsU0FBQUksS0FRQSxRQUFBaEIsR0FBQWhQLEVBQUFpUCxHQUNBLEdBQUFoSyxHQUFBZ0ssRUFBQWdCLFdBQUFDLFFBQ0FDLEVBQUFsQixFQUFBUyxTQUFBUCxTQUFBLFdBQ0FsSyxHQUFBbUwsTUFBQSxXQUNBbkIsRUFBQW9CLFNBQUEsZ0JBR0FwTCxFQUFBcUwsS0FBQSxhQUNBSCxHQUFBQSxHQUFBLElBQUFsTCxFQUFBc0wsTUFBQWhRLFNBQ0EwTyxFQUFBdUIsWUFBQSxnQkFoQkEsR0FBQTVRLElBQ0FHLFNBQUEsSUFDQXFQLEtBQUFKLEVBR0EsT0FBQXBQLEdBVkFwSCxRQUNBQyxPQUFBLE9BQ0FtSCxVQUFBLFNBQUFvUSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAndWkucm91dGVyJyxcbiAgJ3VpLmJvb3RzdHJhcCcsXG4gICduZ0FuaW1hdGUnLFxuICAnYW5ndWxhci1sb2FkaW5nLWJhcicsXG4gICdub3Vpc2xpZGVyJyxcbiAgJ2xvY2FseXRpY3MuZGlyZWN0aXZlcycsXG4gICd0aW1lcicsXG4gICdMb2NhbFN0b3JhZ2VNb2R1bGUnLFxuICAnYW5ndWxhci1zb3J0YWJsZS12aWV3J1xuXSk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QgJztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbmZpZyhjb25maWd1cmF0aW9uKTtcblxuICBmdW5jdGlvbiBjb25maWd1cmF0aW9uKCRodHRwUHJvdmlkZXIsICR1aWJUb29sdGlwUHJvdmlkZXIpIHtcbiAgICAvL2luaXRpYWxpemUgZ2V0IGlmIG5vdCB0aGVyZVxuICAgIGlmICghJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldCkge1xuICAgICAgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldCA9IHt9OyAgICBcbiAgICB9ICAgIFxuICAgIC8vZGlzYWJsZSBJRSBhamF4IHJlcXVlc3QgY2FjaGluZ1xuICAgICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXRbJ0lmLU1vZGlmaWVkLVNpbmNlJ10gPSAnRnJpLCAwMSBKYW4gMjAxNiAwNTowMDowMCBHTVQnO1xuICAgIC8vIGV4dHJhXG4gICAgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldFsnQ2FjaGUtQ29udHJvbCddID0gJ25vLWNhY2hlJztcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0WydQcmFnbWEnXSA9ICduby1jYWNoZSc7XG5cbiAgICAkdWliVG9vbHRpcFByb3ZpZGVyLm9wdGlvbnMoeyBhcHBlbmRUb0JvZHk6IHRydWUgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQXBwQ3RybCcsIEFwcEN0cmwpO1xuXG4gIGZ1bmN0aW9uIEFwcEN0cmwoJHN0YXRlLCBsb2NhbFN0b3JhZ2VTZXJ2aWNlKSB7XG4gICAgdmFyIGFwcEN0cmwgPSB0aGlzO1xuICAgIC8vIFVzZSB0aGlzIGZvciBTaWRlYmFyIG1lbnVcbiAgICBhcHBDdHJsLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgICAvLyBMb2NrIHRoZSBzaWRlYmFyIGluIHZpZXdcbiAgICBhcHBDdHJsLmxvY2tTaWRlYmFyID0gbG9jYWxTdG9yYWdlU2VydmljZS5nZXQoJ3NpZGViYXJMb2NrZWQnKTtcbiAgICBhcHBDdHJsLnRvZ2dsZVNpZGViYXJMb2NrZWQgPSB0b2dnbGVTaWRlYmFyTG9ja2VkO1xuXG4gICAgZnVuY3Rpb24gdG9nZ2xlU2lkZWJhckxvY2tlZChsb2NrZWQpIHtcbiAgICAgIGxvY2FsU3RvcmFnZVNlcnZpY2Uuc2V0KCdzaWRlYmFyTG9ja2VkJywgbG9ja2VkKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29uZmlnKGNvbmZpZ3VyZVJvdXRlcyk7XG5cbiAgZnVuY3Rpb24gY29uZmlndXJlUm91dGVzKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgdmFyIHJvdXRlUm9sZUNoZWNrcyA9IHtcbiAgICAgIHN1cGVyQWRtaW46IHJlcXVpcmVTdXBlckFkbWluLFxuICAgICAgYWRtaW46IHJlcXVpcmVBZG1pbixcbiAgICAgIHVzZXI6IHJlcXVpcmVBdXRoXG4gICAgfTtcblxuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcblxuICAgIC8vIGZvciBhbnkgdW5tYXRjaGVkIHVybFxuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcblxuICAgICR1cmxSb3V0ZXJQcm92aWRlci53aGVuKCcvcHlyYW1pZHMvJywgJy9weXJhbWlkcycpO1xuXG4gICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgIC5zdGF0ZSgnaG9tZScsIHtcbiAgICAgICAgdXJsOiAnLycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21tb24vdmlld3MvaG9tZS5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzJywge1xuICAgICAgICB1cmw6ICcvcHlyYW1pZHMnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1B5cmFtaWRzQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL3B5cmFtaWRzLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMubXlQeXJhbWlkcycsIHtcbiAgICAgICAgdXJsOiAnL215LXB5cmFtaWRzJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTXlQeXJhbWlkc0N0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9teS1weXJhbWlkcy5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIGF1dGg6IHJvdXRlUm9sZUNoZWNrcy51c2VyXG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy52aWV3Jywge1xuICAgICAgICB1cmw6ICcvdmlldy86Y29tcGV0aXRpb25JZCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1B5cmFtaWRDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvcHlyYW1pZC5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLnN0YXRzJywge1xuICAgICAgICB1cmw6ICcvc3RhdHMvOmNvbXBldGl0aW9uSWQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTdGF0c0N0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9zdGF0cy5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLmFkbWluJywge1xuICAgICAgICB1cmw6ICcvYWRtaW4vOmNvbXBldGl0aW9uSWQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBZG1pbkN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9hZG1pbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIGF1dGg6IHJvdXRlUm9sZUNoZWNrcy51c2VyXG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy5jcmVhdGUnLCB7XG4gICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDcmVhdGVQeXJhbWlkQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL2NyZWF0ZS1weXJhbWlkLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3VzZXInLCB7XG4gICAgICAgIHVybDogJy91c2VyJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdVc2VyQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3VzZXJzL3ZpZXdzL3VzZXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICBhdXRoOiByb3V0ZVJvbGVDaGVja3MudXNlclxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvbG9naW4uaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdyZWdpc3RlcicsIHtcbiAgICAgICAgdXJsOiAnL3JlZ2lzdGVyJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy9yZWdpc3Rlci5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3ZlcmlmeScsIHtcbiAgICAgICAgdXJsOiAnL3ZlcmlmaWNhdGlvbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVmVyaWZpY2F0aW9uQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3ZlcmlmaWNhdGlvbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3ZlcmlmaWNhdGlvbicsIHtcbiAgICAgICAgdXJsOiAnL3ZlcmlmaWNhdGlvbi86dXNlcklkLzp2ZXJpZmljYXRpb25Ub2tlbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVmVyaWZpY2F0aW9uQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3ZlcmlmaWNhdGlvbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3Bhc3N3b3JkLXJlc2V0LXJlcXVlc3QnLCB7XG4gICAgICAgIHVybDogJy9wYXNzd29yZC1yZXNldCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUGFzc3dvcmRSZXNldEN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy9wYXNzd29yZC1yZXNldC5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3Bhc3N3b3JkLXJlc2V0Jywge1xuICAgICAgICB1cmw6ICcvcGFzc3dvcmQtcmVzZXQvOnVzZXJJZC86dmVyaWZpY2F0aW9uVG9rZW4nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bhc3N3b3JkUmVzZXRDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvcGFzc3dvcmQtcmVzZXQuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgcmVxdWlyZUFkbWluLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZUFkbWluKGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUoJ2FkbWluJyk7XG4gIH1cblxuICByZXF1aXJlU3VwZXJBZG1pbi4kaW5qZWN0ID0gWydhdXRoU2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIHJlcXVpcmVTdXBlckFkbWluKGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUoJ3N1cGVyLWFkbWluJyk7XG4gIH1cblxuICByZXF1aXJlQXV0aC4kaW5qZWN0ID0gWydhdXRoU2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIHJlcXVpcmVBdXRoKGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUoKTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5ydW4oYXBwUnVuKTtcblxuICBmdW5jdGlvbiBhcHBSdW4oJHJvb3RTY29wZSwgJHN0YXRlLCBzaWRlYmFyU2VydmljZSkge1xuICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VFcnJvcicsIGZ1bmN0aW9uIChldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcywgZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvciA9PT0gJ25vdCBhdXRob3JpemVkJykge1xuICAgICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XG4gICAgICAgICRzdGF0ZS5wcmV2aW91cyA9IHRvU3RhdGU7XG4gICAgICAgICRzdGF0ZS5wcmV2UGFyYW1zID0gdG9QYXJhbXM7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBzaWRlYmFyU2VydmljZS5zZXRTaWRlYmFyU3RhdHVzKGZhbHNlKTtcbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdhdXRoU2VydmljZScsIGF1dGhTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBhdXRoU2VydmljZSgkc3RhdGUsICRodHRwLCAkcSwgdXNlclNlcnZpY2UsIGlkZW50aXR5U2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgYXV0aGVudGljYXRlVXNlcjogYXV0aGVudGljYXRlVXNlcixcbiAgICAgIGNyZWF0ZVVzZXI6IGNyZWF0ZVVzZXIsXG4gICAgICBsb2dvdXQ6IGxvZ291dCxcbiAgICAgIGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGU6IGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUsXG4gICAgICBhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlOiBhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9sb2dpbicsIHtcbiAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSByZXNwb25zZS5kYXRhLnVzZXI7XG4gICAgICAgICAgZGZkLnJlc29sdmUodHJ1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlID09PSAndW52ZXJpZmllZCcpIHtcbiAgICAgICAgICBkZmQucmVzb2x2ZSgndW52ZXJpZmllZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRmZC5yZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlVXNlcih1c2VyRGF0YSkge1xuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywge1xuICAgICAgICB1c2VyRGF0YTogdXNlckRhdGFcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUodHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEucmVhc29uID09PSAnRXJyb3I6IER1cGxpY2F0ZSBVc2VybmFtZScpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdTb3JyeSwgYW4gYWNjb3VudCBhbHJlYWR5IGV4aXN0cyB3aXRoIHRoYXQgZW1haWwgYWRkcmVzcy4nKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5wb3N0KCcvbG9nb3V0Jywge1xuICAgICAgICBsb2dvdXQ6IHRydWVcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIGRmZC5yZXNvbHZlKCk7XG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZShyb2xlKSB7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aG9yaXplZChyb2xlKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoJ25vdCBhdXRob3JpemVkJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpIHtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJHEucmVqZWN0KCdub3QgYXV0aG9yaXplZCcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCd1c2VyU2VydmljZScsIHVzZXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiB1c2VyU2VydmljZSgkaHR0cCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0QWxsVXNlcnM6IGdldEFsbFVzZXJzLFxuICAgICAgdmVyaWZ5VXNlcjogdmVyaWZ5VXNlcixcbiAgICAgIGdlbmVyYXRlUGFzc3dvcmRSZXNldExpbms6IGdlbmVyYXRlUGFzc3dvcmRSZXNldExpbmssXG4gICAgICByZXNldFBhc3N3b3JkOiByZXNldFBhc3N3b3JkXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGdldEFsbFVzZXJzKCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIHJldHVybiB1c2VycztcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZlcmlmeVVzZXIodXNlcklkLCB2ZXJpZmljYXRpb25Ub2tlbikge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VyL3ZlcmlmaWNhdGlvbicsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgdXNlcklkOiB1c2VySWQsXG4gICAgICAgICAgdmVyaWZpY2F0aW9uVG9rZW46IHZlcmlmaWNhdGlvblRva2VuXG4gICAgICAgIH1cbiAgICAgIH0pOyAgXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayh1c2VybmFtZSkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VyL3Bhc3N3b3JkL2xpbmsnLCB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZVxuICAgICAgICB9XG4gICAgICB9KTsgIFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQodXNlcklkLCB2ZXJpZmljYXRpb25Ub2tlbiwgcGFzc3dvcmQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wdXQoJy9hcGkvdXNlci9wYXNzd29yZC9yZXNldCcsIHtcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXG4gICAgICAgIHZlcmlmaWNhdGlvblRva2VuOiB2ZXJpZmljYXRpb25Ub2tlbixcbiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICB9KTsgIFxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBMb2dpbkN0cmwpO1xuXG4gIGZ1bmN0aW9uIExvZ2luQ3RybCgkc3RhdGUsIGF1dGhTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5sb2dpbiA9IGxvZ2luO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgYXV0aFNlcnZpY2UuYXV0aGVudGljYXRlVXNlcih1c2VybmFtZSwgcGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdVc2VybmFtZSAvIHBhc3N3b3JkIGNvbWJpbmFpdG9uIGluY29ycmVjdCcpO1xuICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlID09PSAndW52ZXJpZmllZCcpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdZb3UgbXVzdCB2ZXJpZnkgeW91ciBlbWFpbCBiZWZvcmUgeW91IGNhbiBsb2dpbicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICgkc3RhdGUucHJldmlvdXMpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygkc3RhdGUucHJldmlvdXMsICRzdGF0ZS5wcmV2UGFyYW1zKTtcbiAgICAgICAgICAgICRzdGF0ZS5wcmV2aW91cyA9IG51bGw7XG4gICAgICAgICAgICAkc3RhdGUucHJldlBhcmFtcyA9IG51bGw7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1Bhc3N3b3JkUmVzZXRDdHJsJywgUGFzc3dvcmRSZXNldEN0cmwpO1xuXG4gIGZ1bmN0aW9uIFBhc3N3b3JkUmVzZXRDdHJsKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCB1c2VyU2VydmljZSwgbm90aWZ5U2VydmljZSwgYXV0aFNlcnZpY2UsIGlkZW50aXR5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0udXNlcm5hbWUgPSAnJztcbiAgICB2bS52ZXJpZmllZCA9IGZhbHNlO1xuICAgIHZtLnJlc2V0UGFzc3dvcmRGb3JtID0ge307XG4gICAgdm0uZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayA9IGdlbmVyYXRlUGFzc3dvcmRSZXNldExpbms7XG4gICAgdm0ucmVzZXRQYXNzd29yZCA9IHJlc2V0UGFzc3dvcmQ7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgfSBlbHNlIGlmICgkc3RhdGVQYXJhbXMudXNlcklkICYmICRzdGF0ZVBhcmFtcy52ZXJpZmljYXRpb25Ub2tlbikge1xuICAgICAgICB1c2VyU2VydmljZS52ZXJpZnlVc2VyKCRzdGF0ZVBhcmFtcy51c2VySWQsICRzdGF0ZVBhcmFtcy52ZXJpZmljYXRpb25Ub2tlbikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAgICAgdm0udmVyaWZpZWQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayh1c2VybmFtZSkge1xuICAgICAgdXNlclNlcnZpY2UuZ2VuZXJhdGVQYXNzd29yZFJlc2V0TGluayh1c2VybmFtZSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignQ291bGQgbm90IGZpbmQgdGhhdCBlbWFpbCBhZGRyZXNzJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS5zdWNjZXNzKCdQbGVhc2UgY2hlY2sgeW91ciBlbWFpbCBmb3IgYSBwYXNzd29yZCByZXNldCBsaW5rJyk7XG4gICAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQocmVzZXRQYXNzd29yZEZvcm0pIHtcbiAgICAgIGlmIChyZXNldFBhc3N3b3JkRm9ybS5wYXNzd29yZCAhPT0gcmVzZXRQYXNzd29yZEZvcm0uY29uZmlybVBhc3N3b3JkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1Bhc3N3b3JkcyBkb25cXCd0IG1hdGNoIScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXNlclNlcnZpY2UucmVzZXRQYXNzd29yZCgkc3RhdGVQYXJhbXMudXNlcklkLCAkc3RhdGVQYXJhbXMudmVyaWZpY2F0aW9uVG9rZW4sIHJlc2V0UGFzc3dvcmRGb3JtLnBhc3N3b3JkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgICBhdXRoU2VydmljZS5hdXRoZW50aWNhdGVVc2VyKHJlc3BvbnNlLmRhdGEudXNlcm5hbWUsIHJlc2V0UGFzc3dvcmRGb3JtLnBhc3N3b3JkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIFJlZ2lzdGVyQ3RybCk7XG5cbiAgZnVuY3Rpb24gUmVnaXN0ZXJDdHJsKCRzdGF0ZSwgYXV0aFNlcnZpY2UsIG5vdGlmeVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnJlZ2lzdGVyID0gcmVnaXN0ZXI7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXIobmV3VXNlcikge1xuICAgICAgaWYgKG5ld1VzZXIucGFzc3dvcmQgIT09IG5ld1VzZXIuY29uZmlybVBhc3N3b3JkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1Bhc3N3b3JkcyBkb25cXCd0IG1hdGNoIScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXV0aFNlcnZpY2UuY3JlYXRlVXNlcihuZXdVc2VyKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkc3RhdGUuZ28oJ3ZlcmlmeScpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignVmVyaWZpY2F0aW9uQ3RybCcsIFZlcmlmaWNhdGlvbkN0cmwpO1xuXG4gIGZ1bmN0aW9uIFZlcmlmaWNhdGlvbkN0cmwoJHN0YXRlLCAkc3RhdGVQYXJhbXMsIHVzZXJTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS52ZXJpZmllZCA9IHVuZGVmaW5lZDtcbiAgICB2bS52ZXJpZnlpbmcgPSBmYWxzZTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICgkc3RhdGVQYXJhbXMudXNlcklkICYmICRzdGF0ZVBhcmFtcy52ZXJpZmljYXRpb25Ub2tlbikge1xuICAgICAgICB2bS52ZXJpZnlpbmcgPSB0cnVlO1xuICAgICAgICB2bS52ZXJpZmllZCA9IG51bGw7XG4gICAgICAgIHVzZXJTZXJ2aWNlLnZlcmlmeVVzZXIoJHN0YXRlUGFyYW1zLnVzZXJJZCwgJHN0YXRlUGFyYW1zLnZlcmlmaWNhdGlvblRva2VuKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgICB2bS52ZXJpZmllZCA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZtLnZlcmlmaWVkID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twQWN0aXZlQ2hhbGxlbmVnZXMnLCBrcEFjdGl2ZUNoYWxsZW5lZ2VzKTtcblxuICBmdW5jdGlvbiBrcEFjdGl2ZUNoYWxsZW5lZ2VzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogJ0AnXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY2hhbGxlbmdlcy9jb21wb25lbnRzL2FjdGl2ZS1jaGFsbGVuZ2VzLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKCRzY29wZSwgY2hhbGxlbmdlc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNoYWxsZW5nZXMgPSBbXTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGdldEFjdGl2ZUNoYWxsZW5nZXMoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRBY3RpdmVDaGFsbGVuZ2VzKCkge1xuICAgICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlcykge1xuICAgICAgICBpZiAoY2hhbGxlbmdlcy5kYXRhLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB2bS5jaGFsbGVuZ2VzID0gY2hhbGxlbmdlcy5kYXRhO1xuICAgICAgICAgIF8uZm9yRWFjaCh2bS5jaGFsbGVuZ2VzLCBmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgICAgICBpZiAoY2hhbGxlbmdlLnRpbWVMaW1pdCAhPT0gMCkge1xuICAgICAgICAgICAgICBjaGFsbGVuZ2UuZXhwaXJlcyA9IChtb21lbnQoKS5kaWZmKG1vbWVudChjaGFsbGVuZ2UuY3JlYXRlZCkuYWRkKGNoYWxsZW5nZS50aW1lTGltaXQsICdkJyksJ3MnKSkgKiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jcmVhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlcygpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jb21wbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cHlyYW1pZF91cGRhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlcygpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcENvbXBsZXRlZENoYWxsZW5lZ2VzJywga3BDb21wbGV0ZWRDaGFsbGVuZWdlcyk7XG5cbiAgZnVuY3Rpb24ga3BDb21wbGV0ZWRDaGFsbGVuZWdlcygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6ICdAJyxcbiAgICAgICAgbGltaXQ6ICdAJ1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NoYWxsZW5nZXMvY29tcG9uZW50cy9jb21wbGV0ZWQtY2hhbGxlbmdlcy5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUsIGNoYWxsZW5nZXNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jaGFsbGVuZ2VzID0gW107XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Q29tcGxldGVkQ2hhbGxlbmdlcygpIHtcbiAgICAgIHZtLmNoYWxsZW5nZXMgPSBbXTtcbiAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldENvbXBsZXRlZENoYWxsZW5nZXNCeUNvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uSWQsIHZtLmxpbWl0KS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIGlmIChjaGFsbGVuZ2VzLmRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZtLmNoYWxsZW5nZXMgPSBjaGFsbGVuZ2VzLmRhdGE7XG4gICAgICAgICAgXy5mb3JFYWNoKHZtLmNoYWxsZW5nZXMsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5sb3NlciA9IGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJyA/ICdvcHBvbmVudCcgOiAnY2hhbGxlbmdlcic7XG4gICAgICAgICAgICBjaGFsbGVuZ2Uud2hlbkNvbXBsZXRlZCA9IG1vbWVudChjaGFsbGVuZ2UuY29tcGxldGVkKS5jYWxlbmRhcihudWxsLCB7XG4gICAgICAgICAgICAgIHNhbWVEYXk6ICdbVG9kYXldJyxcbiAgICAgICAgICAgICAgbmV4dERheTogJ1tUb21vcnJvd10nLFxuICAgICAgICAgICAgICBuZXh0V2VlazogJ2RkZGQnLFxuICAgICAgICAgICAgICBsYXN0RGF5OiAnW1llc3RlcmRheV0nLFxuICAgICAgICAgICAgICBsYXN0V2VlazogJ1tMYXN0XSBkZGRkJyxcbiAgICAgICAgICAgICAgc2FtZUVsc2U6ICdERC9NTS9ZWVlZJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjaGFsbGVuZ2VfY29tcGxldGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgZ2V0Q29tcGxldGVkQ2hhbGxlbmdlcygpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFBsYXllck92ZXJhbGxSZXN1bHRzJywga3BQbGF5ZXJPdmVyYWxsUmVzdWx0cyk7XG5cbiAgZnVuY3Rpb24ga3BQbGF5ZXJPdmVyYWxsUmVzdWx0cygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6ICdAJyxcbiAgICAgICAgcGxheWVyOiAnPSdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jaGFsbGVuZ2VzL2NvbXBvbmVudHMvcGxheWVyLW92ZXJhbGwtcmVzdWx0cy5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYyhjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubWF4TGV2ZWxzID0gMTA7XG4gICAgdm0ud2lucyA9IHtcbiAgICAgIHRvdGFsOiAwLFxuICAgICAgYXNDaGFsbGVuZ2VyOiAwLFxuICAgICAgYXNPcHBvbmVudDogMCxcbiAgICAgIGJ5Rm9yZmVpdDogMFxuICAgIH07XG4gICAgdm0ubG9zZXMgPSB7XG4gICAgICB0b3RhbDogMCxcbiAgICAgIGFzQ2hhbGxlbmdlcjogMCxcbiAgICAgIGFzT3Bwb25lbnQ6IDAsXG4gICAgICBieUZvcmZlaXQ6IDBcbiAgICB9O1xuICAgIHZtLnN0cmVhayA9IHtcbiAgICAgIHR5cGU6IG51bGwsXG4gICAgICB2YWx1ZTogMFxuICAgIH07XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBnZXRQbGF5ZXJPdmVyYWxsUmVzdWx0cyh2bS5jb21wZXRpdGlvbklkLCB2bS5wbGF5ZXIuX2lkKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJPdmVyYWxsUmVzdWx0cyhjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkge1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCwgcGxheWVySWQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHtcblxuICAgICAgICAvLyBEZXRlcm1pbmUgYWxsIHRoZSBicmVhayBwb2ludHMgdG8gZmlndXJlIG91dCBsZXZlbHNcbiAgICAgICAgdmFyIGJyZWFrUG9pbnRzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ubWF4TGV2ZWxzOyBpKyspIHtcbiAgICAgICAgICBicmVha1BvaW50cy5wdXNoKCgoKGkgKiAoaSArIDEpKSAvIDIpKSArIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGVmYXVsdCBhbGwgcGxheWVycyB0byB0aGUgbG93ZXN0IGxldmVsXG4gICAgICAgIHZtLnBsYXllci5sZXZlbCA9IGJyZWFrUG9pbnRzLmxlbmd0aDtcbiAgICAgICAgLy8gTm93IGNoZWNrIHRvIHNlZSBpZiB0aGUgcGxheWVyIGlzIGF0IGEgaGlnaGVyIGxldmVsXG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgYnJlYWtQb2ludHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBpZiAodm0ucGxheWVyLnBvc2l0aW9uIDwgYnJlYWtQb2ludHNbaiArIDFdKSB7XG4gICAgICAgICAgICB2bS5wbGF5ZXIubGV2ZWwgPSBicmVha1BvaW50cy5pbmRleE9mKGJyZWFrUG9pbnRzW2pdKSArIDE7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGaWd1cmUgb3V0IHRoZSBwbGF5ZXIncyBjdXJyZW50IHN0cmVha1xuICAgICAgICB2YXIgc3RyZWFrID0gMDtcbiAgICAgICAgdmFyIGNvbnRpbnVlU3RyZWFrID0gdHJ1ZTtcbiAgICAgICAgdmFyIHN0cmVha1R5cGU7XG4gICAgICAgIF8uZm9yRWFjaChyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICBpZiAoY29udGludWVTdHJlYWspIHtcbiAgICAgICAgICAgIC8vIFdpbm5pbmcgU3RyZWFrXG4gICAgICAgICAgICBpZiAoKGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJyAmJiBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkKSB8fFxuICAgICAgICAgICAgICAoY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50JyAmJiBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkID09PSBwbGF5ZXJJZCkpIHtcbiAgICAgICAgICAgICAgLy8gSWYgdGhleSBhcmUgbm90IGFscmVhZHkgb24gYSBsb3Npbmcgc3RyZWFrIGFuZCAxIHRvIHRoZWlyIHdpbm5pbmcgc3RyZWFrXG4gICAgICAgICAgICAgIGlmIChzdHJlYWtUeXBlICE9PSAnbG9zaW5nJykge1xuICAgICAgICAgICAgICAgIHN0cmVhayArPSAxO1xuICAgICAgICAgICAgICAgIHN0cmVha1R5cGUgPSAnd2lubmluZyc7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGludWVTdHJlYWsgPSBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gTG9zaW5nIFN0cmVha1xuICAgICAgICAgICAgfSBlbHNlIGlmICgoY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50JyAmJiBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkKSB8fFxuICAgICAgICAgICAgICAoY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInICYmIGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkKSkge1xuICAgICAgICAgICAgICAvLyBJZiB0aGV5IGFyZSBub3QgYWxyZWFkeSBvbiBhIHdpbm5pbmcgc3RyZWFrIGFuZCAxIHRvIHRoZWlyIGxvc2luZyBzdHJlYWtcbiAgICAgICAgICAgICAgaWYgKHN0cmVha1R5cGUgIT09ICd3aW5uaW5nJykge1xuICAgICAgICAgICAgICAgIHN0cmVhayArPSAxO1xuICAgICAgICAgICAgICAgIHN0cmVha1R5cGUgPSAnbG9zaW5nJztcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZVN0cmVhayA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHZtLnN0cmVhayA9IHtcbiAgICAgICAgICAgIHR5cGU6IHN0cmVha1R5cGUsXG4gICAgICAgICAgICB2YWx1ZTogc3RyZWFrXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRmlndXJlIG91dCB3aW5zIGFuZCBsb3Nlc1xuICAgICAgICB2bS53aW5zLmFzT3Bwb25lbnQgPSBfLnNpemUoXy5maWx0ZXIocmVzdWx0cy5kYXRhLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCdcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgdm0ud2lucy5hc0NoYWxsZW5nZXIgPSBfLnNpemUoXy5maWx0ZXIocmVzdWx0cy5kYXRhLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVySWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInXG4gICAgICAgICAgKTtcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHZtLndpbnMudG90YWwgPSB2bS53aW5zLmFzQ2hhbGxlbmdlciArIHZtLndpbnMuYXNPcHBvbmVudDtcblxuICAgICAgICB2bS53aW5zLmJ5Rm9yZmVpdCA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLmZvcmZlaXQgJiYgKChjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJykgfHxcbiAgICAgICAgICAgIChjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnKSlcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgdm0ubG9zZXMuYXNPcHBvbmVudCA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVySWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInXG4gICAgICAgICAgKTtcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHZtLmxvc2VzLmFzQ2hhbGxlbmdlciA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnXG4gICAgICAgICAgKTtcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHZtLmxvc2VzLnRvdGFsID0gdm0ubG9zZXMuYXNDaGFsbGVuZ2VyICsgdm0ubG9zZXMuYXNPcHBvbmVudDtcblxuICAgICAgICB2bS5sb3Nlcy5ieUZvcmZlaXQgPSBfLnNpemUoXy5maWx0ZXIocmVzdWx0cy5kYXRhLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGNoYWxsZW5nZS5mb3JmZWl0ICYmICgoY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnKSB8fFxuICAgICAgICAgICAgKGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJykpXG4gICAgICAgICAgKTtcbiAgICAgICAgfSkpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmZhY3RvcnkoJ2NoYWxsZW5nZXNTZXJ2aWNlJywgY2hhbGxlbmdlc1NlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIGNoYWxsZW5nZXNTZXJ2aWNlKCRodHRwKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBjcmVhdGVDaGFsbGVuZ2U6IGNyZWF0ZUNoYWxsZW5nZSxcbiAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlOiBjb21wbGV0ZUNoYWxsZW5nZSxcbiAgICAgIGdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uOiBnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbixcbiAgICAgIGdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uOiBnZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbixcbiAgICAgIGdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcjogZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyLFxuICAgICAgZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldENvbXBsZXRlZENoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZGVsZXRlQWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyOiBkZWxldGVBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIsXG4gICAgICBkZWxldGVDaGFsbGVuZ2U6IGRlbGV0ZUNoYWxsZW5nZSxcbiAgICAgIGdldFBsYXllclJlc3VsdHNCeUNvbXBldGl0aW9uOiBnZXRQbGF5ZXJSZXN1bHRzQnlDb21wZXRpdGlvblxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYWxsZW5nZShjaGFsbGVuZ2UpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NoYWxsZW5nZXMvY3JlYXRlJywge1xuICAgICAgICBjaGFsbGVuZ2U6IGNoYWxsZW5nZVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jaGFsbGVuZ2VzL2NvbXBsZXRlJywgIHtcbiAgICAgICAgY2hhbGxlbmdlOiBjaGFsbGVuZ2VcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2FjdGl2ZS9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvYWN0aXZlL2NvbXBldGl0aW9uL3BsYXllcicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgcGxheWVySWQ6IHBsYXllcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENvbXBsZXRlZENoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQsIGxpbWl0KSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvY29tcGxldGVkL2NvbXBldGl0aW9uJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBsaW1pdDogbGltaXRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsZXRlQWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZGVsZXRlKCcvYXBpL2NoYWxsZW5nZXMvYWN0aXZlL2NvbXBldGl0aW9uL3BsYXllci9kZWxldGUnLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICAgIHBsYXllcklkOiBwbGF5ZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5kZWxldGUoJy9hcGkvY2hhbGxlbmdlcy9kZWxldGUnLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjaGFsbGVuZ2VJZDogY2hhbGxlbmdlSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCwgcGxheWVySWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9yZXN1bHRzL2NvbXBldGl0aW9uL3BsYXllcicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgcGxheWVySWQ6IHBsYXllcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BGb290ZXInLCBrcEZvb3Rlcik7XG5cbiAgZnVuY3Rpb24ga3BGb290ZXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9mb290ZXIuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoaWRlbnRpdHlTZXJ2aWNlLCBhdXRoU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgIHZtLmxvZ291dCA9IGxvZ291dDtcblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BIZWFkZXInLCBrcEhlYWRlcik7XG5cbiAgZnVuY3Rpb24ga3BIZWFkZXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ2hlYWRlckN0cmwnLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbW1vbi9jb21wb25lbnRzL2hlYWRlci5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYyhzaWRlYmFyU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBhdXRoU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgIHZtLmxvZ291dCA9IGxvZ291dDtcbiAgICB2bS5zaWRlYmFyU3RhdHVzID0gc2lkZWJhclNlcnZpY2UuZ2V0U2lkZWJhclN0YXR1cygpO1xuICAgIHZtLnRvZ2dsZVNpZGViYXIgPSB0b2dnbGVTaWRlYmFyO1xuXG4gICAgZnVuY3Rpb24gdG9nZ2xlU2lkZWJhcigpIHtcbiAgICAgIHZtLnNpZGViYXJTdGF0dXMubGVmdCA9ICF2bS5zaWRlYmFyU3RhdHVzLmxlZnQ7XG4gICAgICBzaWRlYmFyU2VydmljZS5zZXRTaWRlYmFyU3RhdHVzKHZtLnNpZGViYXJTdGF0dXMubGVmdCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFNpZGViYXInLCBrcFNpZGViYXIpO1xuXG4gIGZ1bmN0aW9uIGtwU2lkZWJhcigpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAnc2lkZWJhckN0cmwnLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbW1vbi9jb21wb25lbnRzL3NpZGViYXIuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoaWRlbnRpdHlTZXJ2aWNlLCBhdXRoU2VydmljZSwgc2lkZWJhclNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmluZGVudGl0eSA9IGlkZW50aXR5U2VydmljZTtcbiAgICB2bS5sb2dvdXQgPSBsb2dvdXQ7XG4gICAgdm0uc2lkZWJhclN0YXR1cyA9IHNpZGViYXJTZXJ2aWNlLmdldFNpZGViYXJTdGF0dXMoKTtcblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5maWx0ZXIoJ29yZGVyT2JqZWN0QnknLCBvcmRlck9iamVjdEJ5KTtcblxuICBmdW5jdGlvbiBvcmRlck9iamVjdEJ5KCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoaW5wdXQsIGF0dHJpYnV0ZSkge1xuICAgICAgaWYgKCFhbmd1bGFyLmlzT2JqZWN0KGlucHV0KSkgcmV0dXJuIGlucHV0O1xuXG4gICAgICB2YXIgYXJyYXkgPSBbXTtcbiAgICAgIGZvciAodmFyIG9iamVjdEtleSBpbiBpbnB1dCkge1xuICAgICAgICBhcnJheS5wdXNoKGlucHV0W29iamVjdEtleV0pO1xuICAgICAgfVxuXG4gICAgICBhcnJheS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIGEgPSBwYXJzZUludChhW2F0dHJpYnV0ZV0pO1xuICAgICAgICBiID0gcGFyc2VJbnQoYlthdHRyaWJ1dGVdKTtcbiAgICAgICAgcmV0dXJuIGEgLSBiO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gYXJyYXk7XG4gICAgfTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdpZGVudGl0eVNlcnZpY2UnLCBpZGVudGl0eVNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIGlkZW50aXR5U2VydmljZSgkd2luZG93KSB7XG4gICAgdmFyIGN1cnJlbnRVc2VyO1xuICAgIGlmICgkd2luZG93LmJvb3RzdHJhcHBlZFVzZXJPYmplY3QgIT09IG51bGwpIHtcbiAgICAgIGN1cnJlbnRVc2VyID0gJHdpbmRvdy5ib290c3RyYXBwZWRVc2VyT2JqZWN0O1xuICAgIH1cbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGN1cnJlbnRVc2VyOiBjdXJyZW50VXNlcixcbiAgICAgIGlzQXV0aGVudGljYXRlZDogaXNBdXRoZW50aWNhdGVkLFxuICAgICAgaXNBdXRob3JpemVkOiBpc0F1dGhvcml6ZWRcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gaXNBdXRoZW50aWNhdGVkKCkge1xuICAgICAgcmV0dXJuICEhdGhpcy5jdXJyZW50VXNlcjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0F1dGhvcml6ZWQocm9sZSkge1xuICAgICAgcmV0dXJuICEhdGhpcy5jdXJyZW50VXNlciAmJiB0aGlzLmN1cnJlbnRVc2VyLnJvbGVzLmluZGV4T2Yocm9sZSkgPiAtMTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnbm90aWZ5U2VydmljZScsIG5vdGlmeVNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIG5vdGlmeVNlcnZpY2UoKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBpbmZvOiBpbmZvLFxuICAgICAgc3VjY2Vzczogc3VjY2VzcyxcbiAgICAgIHdhcm5pbmc6IHdhcm5pbmcsXG4gICAgICBlcnJvcjogZXJyb3IsXG4gICAgICBpbnZlcnNlOiBpbnZlcnNlXG4gICAgfTtcblxuICAgICQubm90aWZ5RGVmYXVsdHMoe1xuICAgICAgbmV3ZXN0X29uX3RvcDogdHJ1ZSxcbiAgICAgIG9mZnNldDoge1xuICAgICAgICB4OiAyMCxcbiAgICAgICAgeTogODVcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gaW5mbyhtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnaW5mbydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Y2Nlc3MobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB3YXJuaW5nKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICd3YXJuaW5nJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXJyb3IobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ2RhbmdlcidcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGludmVyc2UobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ2ludmVyc2UnXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnc2Nyb2xsYmFyU2VydmljZScsIHNjcm9sbGJhclNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHNjcm9sbGJhclNlcnZpY2UoKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBtYWxpaHVTY3JvbGw6IG1hbGlodVNjcm9sbFxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIG1hbGlodVNjcm9sbChzZWxlY3RvciwgdGhlbWUsIHNjcm9sbGF4aXMsIG1vdXNld2hlZWxheGlzKSB7XG4gICAgICAkKHNlbGVjdG9yKS5tQ3VzdG9tU2Nyb2xsYmFyKHtcbiAgICAgICAgdGhlbWU6IHRoZW1lLFxuICAgICAgICBzY3JvbGxJbmVydGlhOiAxMDAsXG4gICAgICAgIGF4aXM6IHNjcm9sbGF4aXMsXG4gICAgICAgIG1vdXNlV2hlZWw6IHtcbiAgICAgICAgICBlbmFibGU6IHRydWUsXG4gICAgICAgICAgYXhpczogbW91c2V3aGVlbGF4aXMsXG4gICAgICAgICAgcHJldmVudERlZmF1bHQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmZhY3RvcnkoJ3NpZGViYXJTZXJ2aWNlJywgc2lkZWJhclNlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHNpZGViYXJTZXJ2aWNlKCkge1xuICAgIHZhciBzaWRlYmFyU3RhdHVzID0ge1xuICAgICAgbGVmdDogZmFsc2UsXG4gICAgICByaWdodDogZmFsc2VcbiAgICB9O1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0U2lkZWJhclN0YXR1czogZ2V0U2lkZWJhclN0YXR1cyxcbiAgICAgIHNldFNpZGViYXJTdGF0dXM6IHNldFNpZGViYXJTdGF0dXNcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBnZXRTaWRlYmFyU3RhdHVzKCkge1xuICAgICAgcmV0dXJuIHNpZGViYXJTdGF0dXM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0U2lkZWJhclN0YXR1cyhzdGF0dXMpIHtcbiAgICAgIHNpZGViYXJTdGF0dXMubGVmdCA9IHN0YXR1cztcbiAgICB9XG4gIH1cbn0pKCk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gIC5zZXJ2aWNlKCd3ZWJzb2NrZXRTZXJ2aWNlJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICR3aW5kb3cpIHtcbiAgICBmdW5jdGlvbiB3ZWJzb2NrZXRIb3N0KCkge1xuICAgICAgaWYgKCR3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT09ICdodHRwczonKSB7XG4gICAgICAgIHJldHVybiAnd3NzOi8vJyArICR3aW5kb3cubG9jYXRpb24uaG9zdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAnd3M6Ly8nICsgJHdpbmRvdy5sb2NhdGlvbi5ob3N0O1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBjb25uZWN0aW9uO1xuICAgIHRoaXMuY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHdlYnNvY2tldEhvc3QoKSk7XG5cbiAgICAgIGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHBheWxvYWQgPSBKU09OLnBhcnNlKGUuZGF0YSk7XG4gICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudG9waWMsIHBheWxvYWQuZGF0YSk7XG4gICAgICB9O1xuICAgIH07XG5cbiAgICB0aGlzLnNlbmQgPSBmdW5jdGlvbiAodG9waWMsIGRhdGEpIHtcbiAgICAgIHZhciBqc29uID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICB0b3BpYzogdG9waWMsXG4gICAgICAgIGRhdGE6IGRhdGFcbiAgICAgIH0pO1xuICAgICAgY29ubmVjdGlvbi5zZW5kKGpzb24pO1xuICAgIH07XG4gIH0pLnJ1bihmdW5jdGlvbiAod2Vic29ja2V0U2VydmljZSkge1xuICAgIHdlYnNvY2tldFNlcnZpY2UuY29ubmVjdCgpO1xuICB9KTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdIb21lQ3RybCcsIEhvbWVDdHJsKTtcblxuICBmdW5jdGlvbiBIb21lQ3RybCgpIHtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHt9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twUGVuZGluZ1BsYXllcnMnLCBrcFBlbmRpbmdQbGF5ZXJzKTtcblxuICBmdW5jdGlvbiBrcFBlbmRpbmdQbGF5ZXJzKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcHlyYW1pZDogJz0nXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvcHlyYW1pZHMvY29tcG9uZW50cy9wZW5kaW5nLXBsYXllcnMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMocHlyYW1pZHNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5wZW5kaW5nUGxheWVycyA9IFtdO1xuICAgIHZtLmFwcHJvdmVQZW5kaW5nUGxheWVyID0gYXBwcm92ZVBlbmRpbmdQbGF5ZXI7XG4gICAgdm0uZGVueVBlbmRpbmdQbGF5ZXIgPSBkZW55UGVuZGluZ1BsYXllcjtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHt9XG5cbiAgICBmdW5jdGlvbiBhcHByb3ZlUGVuZGluZ1BsYXllcihwbGF5ZXIpIHtcbiAgICAgIHBsYXllci5wb3NpdGlvbiA9IHZtLnB5cmFtaWQucGxheWVycy5sZW5ndGggKyAxO1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmFwcHJvdmVQZW5kaW5nUGxheWVyKHZtLnB5cmFtaWQuX2lkLCBwbGF5ZXIpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbnlQZW5kaW5nUGxheWVyKHBsYXllcikge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmRlbnlQZW5kaW5nUGxheWVyKHZtLnB5cmFtaWQuX2lkLCBwbGF5ZXIpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BQeXJhbWlkQ29tcGFjdCcsIGtwUHlyYW1pZENvbXBhY3QpO1xuXG4gIGZ1bmN0aW9uIGtwUHlyYW1pZENvbXBhY3QoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICB0eXBlOiAnQCcsXG5cbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9weXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQtY29tcGFjdC5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYyhweXJhbWlkc1NlcnZpY2UsIGlkZW50aXR5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucHlyYW1pZHMgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKHZtLnR5cGUgPT09ICd1c2VyJykge1xuICAgICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZHNGb3JVc2VyKGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWRzKSB7XG4gICAgICAgICAgdm0ucHlyYW1pZHMgPSBweXJhbWlkcy5kYXRhO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkcygpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWRzKSB7XG4gICAgICAgICAgdm0ucHlyYW1pZHMgPSBweXJhbWlkcy5kYXRhO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFB5cmFtaWQnLCBrcFB5cmFtaWQpO1xuXG4gIGZ1bmN0aW9uIGtwUHlyYW1pZCgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3B5cmFtaWRzL2NvbXBvbmVudHMvcHlyYW1pZC5odG1sJyxcbiAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCdcbiAgICAgIH0sXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWVcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUsICRzdGF0ZSwgcHlyYW1pZHNTZXJ2aWNlLCAkZmlsdGVyLCBub3RpZnlTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UsIGNoYWxsZW5nZXNTZXJ2aWNlKSB7XG4gICAgdmFyIG1heExldmVscyA9IDEwO1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucHlyYW1pZCA9IHt9O1xuICAgIHZtLmJyZWFrUG9pbnRzID0gW107XG4gICAgdm0ubGV2ZWxzID0gW107XG4gICAgdm0ubnVtYmVyT2ZCbG9ja3MgPSAwO1xuICAgIHZtLmN1cnJlbnRVc2VySXNPblB5cmFtaWQgPSBmYWxzZTtcbiAgICB2bS5jdXJyZW50VXNlcklzUGVuZGluZyA9IGZhbHNlO1xuICAgIHZtLmN1cnJlbnRVc2VySXNPd25lciA9IGZhbHNlO1xuICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IGZhbHNlO1xuICAgIHZtLmFjdGl2ZUNoYWxsZW5nZU9wcG9uZW50ID0gbnVsbDtcbiAgICB2bS5hdmFpbGFibGVDaGFsbGVuZ2VzID0gZmFsc2U7XG4gICAgdm0uY3JlYXRlQ2hhbGxlbmdlID0gY3JlYXRlQ2hhbGxlbmdlO1xuICAgIHZtLmNvbXBsZXRlQ2hhbGxlbmdlID0gY29tcGxldGVDaGFsbGVuZ2U7XG4gICAgdm0uY2hhbGxlbmdlRXhwaXJlZCA9IGNoYWxsZW5nZUV4cGlyZWQ7XG4gICAgdm0uY3VycmVudFVzZXJQbGF5ZXIgPSB7fTtcbiAgICB2bS5weXJhbWlkTWVudVRvZ2dsZSA9IGZhbHNlO1xuICAgIHZtLmFkZEN1cnJlbnRVc2VyVG9QeXJhbWlkID0gYWRkQ3VycmVudFVzZXJUb1B5cmFtaWQ7XG4gICAgdm0uY29uZmlybVJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQgPSBjb25maXJtUmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZDtcbiAgICB2bS5udW1iZXJPZlJlYWxQbGF5ZXJzID0gMDtcbiAgICB2bS5tYXhQbGF5ZXJzID0gMDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBtYXhpbXVtIG51bWJlciBvZiBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBtYXhpbXVtIG51bWJlciBvZiBsZXZlbHNcbiAgICAgICAgZm9yICh2YXIgaSA9IG1heExldmVsczsgaSA+IDA7IC0taSkge1xuICAgICAgICAgIHZtLm1heFBsYXllcnMgKz0gaTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChweXJhbWlkLmRhdGEpIHtcbiAgICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuXG4gICAgICAgICAgb3JkZXJQbGF5ZXJzKCk7XG4gICAgICAgICAgZ2V0UGxheWVyc1N0YXR1cygpO1xuICAgICAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgICAgICAgIGNhbGN1bGF0ZVB5cmFtaWRCbG9ja3MoKTtcbiAgICAgICAgICBmaWxsSW5FbXB0eUJsb2NrcygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPcmRlciB0aGUgcGxheWVycyBieSB0aGUgcG9zaXRpb24gcHJvcGVydHkgb2YgdGhlIHBsYXllcnMgYXJyYXkgaW4gdGhlIHB5cmFtaWQgb2JqZWN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gb3JkZXJQbGF5ZXJzKCkge1xuICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzID0gJGZpbHRlcignb3JkZXJCeScpKHZtLnB5cmFtaWQucGxheWVycywgJ3Bvc2l0aW9uJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlndXJlIG91dCBpZiBlYWNoIHBsYXllciBpcyBhbHJlYWR5IGNoYWxsZW5nZWQgYW5kIHNldCBzb21lIHN0dWZmXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UGxheWVyc1N0YXR1cygpIHtcbiAgICAgIFxuICAgICAgdm0uY3VycmVudFVzZXJJc093bmVyID0gZmFsc2U7XG4gICAgICB2bS5jdXJyZW50VXNlcklzUGVuZGluZyA9IGZhbHNlO1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIGN1cnJlbnQgdXNlciBpcyBhbiBvd25lciBvZiB0aGlzIHB5cmFtaWRcbiAgICAgICAgdm0uY3VycmVudFVzZXJJc093bmVyID0gXy5zb21lKHZtLnB5cmFtaWQub3duZXJzLCBbJ19pZCcsIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWRdKTtcbiAgICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIGEgcGVuZGluZyByZXF1ZXN0IHRvIGpvaW5cbiAgICAgICAgdm0uY3VycmVudFVzZXJJc1BlbmRpbmcgPSBfLnNvbWUodm0ucHlyYW1pZC5wZW5kaW5nUGxheWVycywgWydfaWQnLCBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkXSk7XG4gICAgICB9XG5cbiAgICAgIHZtLmN1cnJlbnRVc2VySXNPblB5cmFtaWQgPSBmYWxzZTtcbiAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IGZhbHNlO1xuICAgICAgXy5mb3JFYWNoKHZtLnB5cmFtaWQucGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICAvLyBGaW5kIHRoZSBjdXJyZW50IHVzZXIgaWYgdGhleSBhcmUgb24gdGhpcyBweXJhbWlkIGFuZCBzZXQgc29tZSBwcm9wZXJ0aWVzXG4gICAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkgJiYgcGxheWVyLl9pZCA9PT0gaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCkge1xuICAgICAgICAgIHZtLmN1cnJlbnRVc2VySXNPblB5cmFtaWQgPSB0cnVlO1xuICAgICAgICAgIHBsYXllci5jbGFzcyA9ICdjdXJyZW50LXVzZXInO1xuICAgICAgICAgIHZtLmN1cnJlbnRVc2VyUGxheWVyID0gcGxheWVyO1xuXG4gICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgdXNlciBoYXMgYW4gYWN0aXZlIGNoYWxsZW5nZVxuICAgICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcih2bS5jb21wZXRpdGlvbklkLCBwbGF5ZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YSkge1xuICAgICAgICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSB0cnVlO1xuICAgICAgICAgICAgICB2bS5hY3RpdmVDaGFsbGVuZ2VPcHBvbmVudCA9IGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIuX2lkID09PSBwbGF5ZXIuX2lkID8gY2hhbGxlbmdlLmRhdGEub3Bwb25lbnQgOiBjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlcykge1xuICAgICAgICBfLmZvckVhY2goY2hhbGxlbmdlcy5kYXRhLCBmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG5cbiAgICAgICAgICB2YXIgY2hhbGxlbmdlciA9IF8uZmluZCh2bS5weXJhbWlkLnBsYXllcnMsIHsgJ19pZCc6IGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCB9KTtcbiAgICAgICAgICBjaGFsbGVuZ2VyLmNsYXNzID0gJ3VuYXZhaWxhYmxlJztcbiAgICAgICAgICBjaGFsbGVuZ2VyLmNoYWxsZW5nZSA9IHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnY2hhbGxlbmdlcidcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgdmFyIG9wcG9uZW50ID0gXy5maW5kKHZtLnB5cmFtaWQucGxheWVycywgeyAnX2lkJzogY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCB9KTtcbiAgICAgICAgICBvcHBvbmVudC5jbGFzcyA9ICd1bmF2YWlsYWJsZSc7XG4gICAgICAgICAgb3Bwb25lbnQuY2hhbGxlbmdlID0ge1xuICAgICAgICAgICAgcG9zaXRpb246ICdvcHBvbmVudCdcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgLy8gVHJhY2sgd2hlbiB0aGUgY2hhbGxlbmdlIHdpbGwgZXhwaXJlXG4gICAgICAgICAgaWYgKGNoYWxsZW5nZS50aW1lTGltaXQgIT09IDApIHtcbiAgICAgICAgICAgIHZhciB0aW1lVG9FeHBpcmUgPSBtb21lbnQoKS5kaWZmKG1vbWVudChjaGFsbGVuZ2UuY3JlYXRlZCkuYWRkKGNoYWxsZW5nZS50aW1lTGltaXQsICdkJyksICdzJykgKiAtMTtcbiAgICAgICAgICAgIC8vIElmIHRoZSBjaGFsbGVuZ2UgaGFzIG5vdCB5ZXQgZXhwaXJlZCBkaXNwbGF5IGEgY291bnRkb3duIG9uIHRoZSBvcHBvbmVudFxuICAgICAgICAgICAgaWYgKHRpbWVUb0V4cGlyZSA+IDApIHtcbiAgICAgICAgICAgICAgb3Bwb25lbnQuY2hhbGxlbmdlLmV4cGlyZXMgPSB0aW1lVG9FeHBpcmU7XG4gICAgICAgICAgICAgIC8vIElmIHRoZSBjaGFsbGVuZ2UgZXhwaXJlZCB3aGlsZSBubyBvbmUgd2FzIHZpZXdpbmcgdGhpcyBweXJhbWlkIGNvbXBsZXRlIHRoZSBjaGFsbGVuZ2UgYnkgZm9yZmVpdFxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aW1lVG9FeHBpcmUgPD0gMCkge1xuICAgICAgICAgICAgICBjb21wbGV0ZUNoYWxsZW5nZShudWxsLCB0cnVlLCBvcHBvbmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gTm93IHRoYXQgd2Uga25vdyB3aGljaCBwbGF5ZXJzIGFyZSBpbiBjaGFsbGVuZ2VzIGFuZCB3aGljaCBhcmVuJ3RcbiAgICAgICAgLy8gZmluZCB0aGUgYXZhaWxhYmxlIGNoYWxsZW5nZXMgZm9yIHRoaXMgdXNlclxuICAgICAgICBmaW5kQXZhaWxhYmxlQ2hhbGxlbmdlcygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlndXJlIG91dCB3aGVyZSB0byBzdGFydCBlYWNoIG5ldyByb3cgb24gdGhlIHB5cmFtaWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVCcmVha1BvaW50cygpIHtcbiAgICAgIHZtLmJyZWFrUG9pbnRzID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1heExldmVsczsgaSsrKSB7XG4gICAgICAgIHZtLmJyZWFrUG9pbnRzLnB1c2goKCgoaSAqIChpICsgMSkpIC8gMikpICsgMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gR2l2ZSBlYWNoIHBsYXllciBhIGxldmVsIHByb3BlcnR5IGJhc2VkIG9uIHRoZSBicmVhayBwb2ludHNcbiAgICAvLyBUaGlzIHdpbGwgYmUgdXNlZCB0byBkZXRlcm1pbmUgd2hvIG90aGVyIHBsYXllcnMgY2FuIGNoYWxsZW5nZVxuICAgIGZ1bmN0aW9uIGFzc2lnbkxldmVsc1RvUGxheWVycygpIHtcbiAgICAgIHZhciBsZXZlbCA9IDA7XG4gICAgICB2bS5sZXZlbHMgPSBbXTtcbiAgICAgIGNyZWF0ZUJyZWFrUG9pbnRzKCk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLnB5cmFtaWQucGxheWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAodm0uYnJlYWtQb2ludHMuaW5kZXhPZihpICsgMSkgPiAtMSkge1xuICAgICAgICAgIGxldmVsICs9IDE7XG4gICAgICAgICAgLy8gU2V0IHRoZSBudW1iZXIgb2YgdG90YWwgbGV2ZWxzXG4gICAgICAgICAgdm0ubGV2ZWxzLnB1c2gobGV2ZWwpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEdpdmUgZWFjaCBwbGF5ZXIgYSBsZXZlbFxuICAgICAgICB2bS5weXJhbWlkLnBsYXllcnNbaV0ubGV2ZWwgPSBsZXZlbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBIb3cgbWFueSB0b3RhbCBibG9ja3MgaW4gdGhpcyBweXJhbWlkXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlUHlyYW1pZEJsb2NrcygpIHtcbiAgICAgIHZtLm51bWJlck9mQmxvY2tzID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSBfLmxhc3Qodm0ubGV2ZWxzKTsgaSA+IDA7IGktLSkge1xuICAgICAgICB2bS5udW1iZXJPZkJsb2NrcyArPSBpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZpbGwgb3V0IHRoZSByZW1haW5pbmcgYmxvY2tzIG9mIHRoZSBweXJhbWlkIHdpdGggZW1wdHkgYmxvY2tzXG4gICAgZnVuY3Rpb24gZmlsbEluRW1wdHlCbG9ja3MoKSB7XG4gICAgICB2bS5udW1iZXJPZlJlYWxQbGF5ZXJzID0gdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDtcbiAgICAgIGZvciAodmFyIGkgPSB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoOyBpIDwgdm0ubnVtYmVyT2ZCbG9ja3M7IGkrKykge1xuICAgICAgICB2bS5weXJhbWlkLnBsYXllcnMucHVzaCh7XG4gICAgICAgICAgZmlyc3ROYW1lOiAnRW1wdHknLFxuICAgICAgICAgIGxhc3ROYW1lOiAnU3BvdCcsXG4gICAgICAgICAgcG9zaXRpb246IDk5LFxuICAgICAgICAgIGNsYXNzOiAnZW1wdHknXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgLy8gV2UgaGF2ZSB0byBnaXZlIGxldmVscyB0byB0aGUgbmV3IGVtcHR5IHNwb3RzXG4gICAgICBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKTtcbiAgICB9XG5cbiAgICAvLyBGaW5kIGFsbCB0aGUgcGxheWVycyB0aGF0IGFyZSBhdmFpbGFibGUgdG8gYmUgY2hhbGxlbmdlZCBieSB0aGlzIHVzZXJcbiAgICBmdW5jdGlvbiBmaW5kQXZhaWxhYmxlQ2hhbGxlbmdlcygpIHtcbiAgICAgIHZhciBsZXZlbEFib3ZlID0gdm0uY3VycmVudFVzZXJQbGF5ZXIubGV2ZWwgPiAxID8gdm0uY3VycmVudFVzZXJQbGF5ZXIubGV2ZWwgLSAxIDogbnVsbDtcbiAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgaWYgKHBsYXllci5sZXZlbCA9PT0gbGV2ZWxBYm92ZSAmJiBwbGF5ZXIucG9zaXRpb24gIT09IDk5ICYmIHBsYXllci5jbGFzcyAhPT0gJ3VuYXZhaWxhYmxlJykge1xuICAgICAgICAgIHZtLmF2YWlsYWJsZUNoYWxsZW5nZXMgPSB0cnVlO1xuICAgICAgICAgIHBsYXllci5hdmFpbGFibGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFsbGVuZ2UocGxheWVyKSB7XG4gICAgICBpZiAoIXBsYXllci5hdmFpbGFibGUpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignU29ycnksIHRoYXQgaXMgbm90IGEgdmFsaWQgY2hhbGxlbmdlLicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gdHJ1ZTtcbiAgICAgICAgdmFyIGNoYWxsZW5nZSA9IHtcbiAgICAgICAgICBjb21wZXRpdGlvbk5hbWU6IHZtLnB5cmFtaWQubmFtZSxcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiB2bS5jb21wZXRpdGlvbklkLFxuICAgICAgICAgIGNvbXBsZXRlOiBmYWxzZSxcbiAgICAgICAgICBmb3JmZWl0OiBmYWxzZSxcbiAgICAgICAgICB0aW1lTGltaXQ6IHZtLnB5cmFtaWQuZm9yZmVpdERheXMsXG4gICAgICAgICAgY2hhbGxlbmdlcjoge1xuICAgICAgICAgICAgX2lkOiB2bS5jdXJyZW50VXNlclBsYXllci5faWQsXG4gICAgICAgICAgICBlbWFpbDogdm0uY3VycmVudFVzZXJQbGF5ZXIuZW1haWwsXG4gICAgICAgICAgICBmaXJzdE5hbWU6IHZtLmN1cnJlbnRVc2VyUGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiB2bS5jdXJyZW50VXNlclBsYXllci5sYXN0TmFtZSxcbiAgICAgICAgICAgIHBvc2l0aW9uOiB2bS5jdXJyZW50VXNlclBsYXllci5wb3NpdGlvblxuICAgICAgICAgIH0sXG4gICAgICAgICAgb3Bwb25lbnQ6IHtcbiAgICAgICAgICAgIF9pZDogcGxheWVyLl9pZCxcbiAgICAgICAgICAgIGVtYWlsOiBwbGF5ZXIuZW1haWwsXG4gICAgICAgICAgICBmaXJzdE5hbWU6IHBsYXllci5maXJzdE5hbWUsXG4gICAgICAgICAgICBsYXN0TmFtZTogcGxheWVyLmxhc3ROYW1lLFxuICAgICAgICAgICAgcG9zaXRpb246IHBsYXllci5wb3NpdGlvblxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBjaGFsbGVuZ2VcbiAgICAgICAgLy8gV2Vic29ja2V0IGV2ZW50IHdpbGwgcmVmcmVzaCB0aGUgcHlyYW1pZFxuICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jcmVhdGVDaGFsbGVuZ2UoY2hhbGxlbmdlKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2bS5weXJhbWlkTWVudVRvZ2dsZSA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tcGxldGUgYSBjaGFsbGVuZ2UgYnkgYSB1c2VyIGludGVyYWN0aW9uIG9yIGEgZm9yZmVpdFxuICAgICAqIFxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IHdpbm5lcklzQ3VycmVudFVzZXJcbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSBmb3JmZWl0XG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBmb3JmZWl0TG9zZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb21wbGV0ZUNoYWxsZW5nZSh3aW5uZXJJc0N1cnJlbnRVc2VyLCBmb3JmZWl0LCBmb3JmZWl0TG9zZXIpIHtcbiAgICAgIHZhciBwbGF5ZXIgPSBmb3JmZWl0TG9zZXIgfHwgdm0uY3VycmVudFVzZXJQbGF5ZXI7XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIodm0uY29tcGV0aXRpb25JZCwgcGxheWVyLl9pZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBzd2FwUG9zaXRpb25zID0gZmFsc2U7XG5cbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBmb3JmZWl0XG4gICAgICAgIGlmIChmb3JmZWl0KSB7XG4gICAgICAgICAgY2hhbGxlbmdlLmRhdGEuZm9yZmVpdCA9IHRydWU7XG4gICAgICAgICAgaWYgKGZvcmZlaXRMb3Nlci5jaGFsbGVuZ2UucG9zaXRpb24gPT09ICdvcHBvbmVudCcpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdjaGFsbGVuZ2VyJztcbiAgICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnb3Bwb25lbnQnO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBGaWd1cmUgb3V0IHdobyB0aGUgd2lubmVyIHdhcyB0byBzdG9yZSBpbiB0aGUgY2hhbGxlbmdlIHJlY29yZFxuICAgICAgICB9IGVsc2UgaWYgKHdpbm5lcklzQ3VycmVudFVzZXIpIHtcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci5faWQgPT09IHZtLmN1cnJlbnRVc2VyUGxheWVyLl9pZCkge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ2NoYWxsZW5nZXInO1xuICAgICAgICAgICAgc3dhcFBvc2l0aW9ucyA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdvcHBvbmVudCc7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLl9pZCA9PT0gdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnb3Bwb25lbnQnO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnY2hhbGxlbmdlcic7XG4gICAgICAgICAgICBzd2FwUG9zaXRpb25zID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTd2FwIHBvc2l0aW9ucyBhbmQgdGhlbiBjb21wbGV0ZSB0aGUgY2hhbGxlbmdlIG9yIGp1c3QgY29tcGxldGUgdGhlIGNoYWxsZW5nZVxuICAgICAgICAvLyBXZWJzb2NrZXQgZXZlbnQgd2lsbCByZWZyZXNoIHRoZSBweXJhbWlkXG4gICAgICAgIGlmIChzd2FwUG9zaXRpb25zKSB7XG4gICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLnN3YXBQb3NpdGlvbnModm0uY29tcGV0aXRpb25JZCwgY2hhbGxlbmdlLmRhdGEub3Bwb25lbnQsIGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBpZiAocmVtb3ZpbmdDdXJyZW50VXNlcikge1xuICAgICAgICAgICAgICAgIHJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHJlbW92aW5nQ3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgcmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0ucHlyYW1pZE1lbnVUb2dnbGUgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxscyB0aGUgY29tcGxldGUgY2hhbGxuZ2UgZnVuY3Rpb24gd2l0aCB0aGUgZm9yZmVpdGluZyBwbGF5ZXJcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHBsYXllclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNoYWxsZW5nZUV4cGlyZWQocGxheWVyKSB7XG4gICAgICBjb21wbGV0ZUNoYWxsZW5nZShudWxsLCB0cnVlLCBwbGF5ZXIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIHRoZSBjdXJyZW50IHVzZXIgdGhlIHB5cmFtaWQgXG4gICAgICogaWYgdGhleSdyZSBub3QgYWxyZWFkeSBvbiBpdCBhbmQgdGhlcmUncyBzcGFjZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZEN1cnJlbnRVc2VyVG9QeXJhbWlkKCkge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICBpZiAodm0ubnVtYmVyT2ZSZWFsUGxheWVycyA8IHZtLm1heFBsYXllcnMpIHtcbiAgICAgICAgICB2YXIgcGxheWVyID0ge1xuICAgICAgICAgICAgX2lkOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgbGFzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5sYXN0TmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgICBwb3NpdGlvbjogdm0ubnVtYmVyT2ZSZWFsUGxheWVycyArIDFcbiAgICAgICAgICB9O1xuICAgICAgICAgIGlmICh2bS5weXJhbWlkLm9wZW4pIHtcbiAgICAgICAgICAgIHN3YWwoe1xuICAgICAgICAgICAgICB0aXRsZTogJ0pvaW4gQ29tcGV0aXRpb24/JyxcbiAgICAgICAgICAgICAgdGV4dDogJ1lvdVxcJ2xsIGJlIGFkZGVkIHRvIHRoZSBib3R0b20nLFxuICAgICAgICAgICAgICB0eXBlOiAnd2FybmluZycsXG4gICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnSm9pbicsXG4gICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICdOZXZlcm1pbmQnLFxuICAgICAgICAgICAgICBjbG9zZU9uQ29uZmlybTogZmFsc2UsXG4gICAgICAgICAgICAgIGNsb3NlT25DYW5jZWw6IHRydWVcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmFkZFBsYXllclRvUHlyYW1pZCh2bS5jb21wZXRpdGlvbklkLCBwbGF5ZXIpO1xuICAgICAgICAgICAgICBzd2FsKCdXZWxjb21lIEFib2FyZCEnLCAnTm93IHN0YXJ0IGZpZ2h0aW5nIHlvdXIgd2F5IHRvIHRoZSB0b3AnLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgfSk7ICBcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3dhbCh7XG4gICAgICAgICAgICAgIHRpdGxlOiAnU2VuZCBKb2luIFJlcXVlc3Q/JyxcbiAgICAgICAgICAgICAgdGV4dDogJ1RoaXMgaXMgYSBjbG9zZWQgY29tcGV0aXRpb24gc28gdGhlIG93bmVyIG11c3QgYXBwcm92ZSB5b3VyIHJlcXVlc3QnLFxuICAgICAgICAgICAgICB0eXBlOiAnd2FybmluZycsXG4gICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnU2VuZCBSZXF1ZXN0JyxcbiAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ05ldmVybWluZCcsXG4gICAgICAgICAgICAgIGNsb3NlT25Db25maXJtOiBmYWxzZSxcbiAgICAgICAgICAgICAgY2xvc2VPbkNhbmNlbDogdHJ1ZVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBweXJhbWlkc1NlcnZpY2UuYWRkUGxheWVyVG9QeXJhbWlkUmVxdWVzdCh2bS5weXJhbWlkLCBwbGF5ZXIpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZtLmN1cnJlbnRVc2VySXNQZW5kaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHN3YWwoJ1JlcXVlc3QgU2VudCcsICdZb3Ugd2lsbCByZWNlaXZlIGFuIGVtYWlsIG9uY2UgdGhlIG93bmVyIHByb2Nlc3NlcyB0aGUgcmVxdWVzdC4nLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2Uud2FybmluZygnU29ycnksIHRoaXMgcHlyYW1pZCBpcyBmdWxsJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb25maXJtUmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCgpIHtcbiAgICAgIHN3YWwoe1xuICAgICAgICB0aXRsZTogJ0xlYXZlIFB5cmFtaWQ/JyxcbiAgICAgICAgdGV4dDogJ1lvdSB3aWxsIGxvc2UgeW91ciBzcG90IGFuZCBmb3JmZWl0IGFueSBhY3RpdmUgY2hhbGxlbmdlcy4nLFxuICAgICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLFxuICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ1llcywgbGVhdmUnLFxuICAgICAgICBjb25maXJtQnV0dG9uQ2xhc3M6ICdidG4tZGFuZ2VyJyxcbiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ05vLCBzdGF5JyxcbiAgICAgICAgY2xvc2VPbkNvbmZpcm06IGZhbHNlLFxuICAgICAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlXG4gICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQoKTtcbiAgICAgICAgc3dhbCgnT0ssIHlvdVxcJ3Igb3V0IScsICdZb3VcXCd2ZSBiZWVuIHJlbW92ZWQgZnJvbSB0aGUgcHlyYW1pZC4nLCAnc3VjY2VzcycpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gVXNlIHRoaXMgdG8gZW5mb3JjZSBvcmRlciBvZiBvcGVyYXRpb25zIHdoZW4gdGhlIHBsYXllciB0byBiZSByZW1vdmVkIGhhZCBhbiBhY3RpdmUgY2hhbGxlbmdlXG4gICAgdmFyIHJlbW92aW5nQ3VycmVudFVzZXIgPSBmYWxzZTtcblxuICAgIGZ1bmN0aW9uIHJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQoKSB7XG4gICAgICAvLyBNYWtlIHN1cmUgdGhlIHVzZXIgaXMgbG9nZ2VkIGluIGFuZCBpcyBvbiB0aGlzIHB5cmFtaWRcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkgJiYgdm0uY3VycmVudFVzZXJJc09uUHlyYW1pZCkge1xuICAgICAgICByZW1vdmluZ0N1cnJlbnRVc2VyID0gdHJ1ZTtcbiAgICAgICAgLy8gRm9yZmVpdCBpZiB0aGV5IGhhdmUgYW4gYWN0aXZlIGNoYWxsZW5nZVxuICAgICAgICBpZiAodm0uaGFzQWN0aXZlQ2hhbGxlbmdlKSB7XG4gICAgICAgICAgY29tcGxldGVDaGFsbGVuZ2UobnVsbCwgdHJ1ZSwgdm0uY3VycmVudFVzZXJQbGF5ZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIFNpbmNlIHdlIGFyZSByZW1vdmluZyB0aGVtIC4uLlxuICAgICAgICAgIHZtLmN1cnJlbnRVc2VySXNPblB5cmFtaWQgPSBmYWxzZTtcbiAgICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcblxuICAgICAgICAgIC8vIEdldCBhbiB1cGRhdGVkIGNvcHkgb2YgdGhlIHB5cmFtaWQgaW5jYXNlIGEgZm9yZmVpdCBoYXBwZW5lZFxuICAgICAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHApIHtcbiAgICAgICAgICAgIC8vIFN0b3JlIHRoZSB1cGRhdGVkIGNvcHkgbG9jYWxseSBzbyBhcyBub3QgdG8gZGlzdHJ1cHQgdGhlIHB5cmFtaWRcbiAgICAgICAgICAgIC8vIHVudGlsIHRoZSBwbGF5ZXIgaGFzIGJlZW4gcmVtb3ZlZFxuICAgICAgICAgICAgdmFyIHB5cmFtaWQgPSBwLmRhdGE7XG5cbiAgICAgICAgICAgIC8vIEtlZXAgdHJhY2sgb2YgdGhlIHNwb3QgdGhleSB3ZXJlIGluIG9uIHRoZSBweXJhbWlkXG4gICAgICAgICAgICB2YXIgb3BlblBvc2l0aW9uID0gdm0uY3VycmVudFVzZXJQbGF5ZXIucG9zaXRpb247XG5cbiAgICAgICAgICAgIC8vIE1vdmUgYWxsIHRoZSBwbGF5ZXJzIHVwIDEgcG9zaXRpb24gdGhhdCB3ZXJlIGJlaGluZCB0aGUgcmVtb3ZlZCBwbGF5ZXJcbiAgICAgICAgICAgIF8uZm9yRWFjaChweXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgICAgICAgaWYgKHBsYXllci5wb3NpdGlvbiA+PSBvcGVuUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIucG9zaXRpb24gLT0gMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZWQgdGhlIHBsYXllciBmcm9tIHRoZSBweXJhbWlkXG4gICAgICAgICAgICB2YXIgcmVtb3ZlZFBsYXllciA9IF8ucmVtb3ZlKHB5cmFtaWQucGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICAgICAgICByZXR1cm4gcGxheWVyLl9pZCA9PT0gdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIE1ha2UgYSBuZXcgYXJyYXkgb2YgYWxsIHRoZSBwbGF5ZXJzIHN0aWxsIG9uIHRoZSBweXJhbWlkXG4gICAgICAgICAgICAvLyBvbmx5IHVzZSB0aGUgcHJvcGVydGllcyB3ZSB3YW50IHRvIHN0b3JlIGluIHRoZSBweXJhbWlkIGRvY3VtZW50XG4gICAgICAgICAgICB2YXIgdXBkYXRlZFBsYXllcnMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ubnVtYmVyT2ZSZWFsUGxheWVycyAtIDE7ICsraSkge1xuICAgICAgICAgICAgICB2YXIgdXBkYXRlZFBsYXllciA9IHtcbiAgICAgICAgICAgICAgICBfaWQ6IHB5cmFtaWQucGxheWVyc1tpXS5faWQsXG4gICAgICAgICAgICAgICAgZmlyc3ROYW1lOiBweXJhbWlkLnBsYXllcnNbaV0uZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgIGxhc3ROYW1lOiBweXJhbWlkLnBsYXllcnNbaV0ubGFzdE5hbWUsXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHB5cmFtaWQucGxheWVyc1tpXS5wb3NpdGlvblxuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIHVwZGF0ZWRQbGF5ZXJzLnB1c2godXBkYXRlZFBsYXllcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENhbGwgc2VydmljZSB0byByZW1vdmUgdGhlIHBsYXllclxuICAgICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLnJlbW92ZWRQbGF5ZXJGcm9tUHlyYW1pZCh2bS5jb21wZXRpdGlvbklkLCByZW1vdmVkUGxheWVyWzBdLCB1cGRhdGVkUGxheWVycykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJlbW92aW5nQ3VycmVudFVzZXIgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVmcmVzaCB0aGUgcHlyYW1pZCBiZWNhc3VlIG9mIGFuIHVwZGF0ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlZnJlc2hQeXJhbWlkKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuICAgICAgICBvcmRlclBsYXllcnMoKTtcbiAgICAgICAgZ2V0UGxheWVyc1N0YXR1cygpO1xuICAgICAgICBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKTtcbiAgICAgICAgY2FsY3VsYXRlUHlyYW1pZEJsb2NrcygpO1xuICAgICAgICBmaWxsSW5FbXB0eUJsb2NrcygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jcmVhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jb21wbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIGlmICghcmVtb3ZpbmdDdXJyZW50VXNlcikge1xuICAgICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpwbGF5ZXJfYWRkZWQnLCBmdW5jdGlvbiAoXywgZGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGRldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oZGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cGxheWVyX3JlbW92ZWQnLCBmdW5jdGlvbiAoXywgZGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGRldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oZGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cHlyYW1pZF91cGRhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFVwZGF0ZVBsYXllcnMnLCBrcFVwZGF0ZVBsYXllcnMpO1xuXG4gIGZ1bmN0aW9uIGtwVXBkYXRlUGxheWVycygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHB5cmFtaWQ6ICc9J1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3B5cmFtaWRzL2NvbXBvbmVudHMvdXBkYXRlLXBsYXllcnMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJGZpbHRlciwgcHlyYW1pZHNTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciByZW1vdmVkUGxheWVycyA9IFtdO1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0udXBkYXRlUHlyYW1pZCA9IHVwZGF0ZVB5cmFtaWQ7XG4gICAgdm0uY2FuY2VsVXBkYXRlID0gY2FuY2VsVXBkYXRlO1xuICAgIHZtLnJlb3JkZXJQbGF5ZXJzID0gcmVvcmRlclBsYXllcnM7XG4gICAgdm0ucmVtb3ZlUGxheWVyID0gcmVtb3ZlUGxheWVyO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge31cblxuICAgIC8vIFBlcmZvcm0gdGhlIHVwZGF0ZXMgdGhhdCB3ZXJlIHJlcXVzdGVkXG4gICAgZnVuY3Rpb24gdXBkYXRlUHlyYW1pZCgpIHtcbiAgICAgIF8uZm9yRWFjaChyZW1vdmVkUGxheWVycywgZnVuY3Rpb24ocGxheWVyKSB7XG4gICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmRlbGV0ZUFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcih2bS5weXJhbWlkLl9pZCwgcGxheWVyLl9pZCk7XG4gICAgICB9KTtcbiAgICAgIHB5cmFtaWRzU2VydmljZS51cGRhdGVQeXJhbWlkKHZtLnB5cmFtaWQpOyAgIFxuICAgIH1cblxuICAgIC8vIENhbmNlbCB0aGUgdXBkYXRlIGFuZCBwdXQgZXZlcnl0aGluZyBiYWNrIHRvIHRoZSBvcmdpbmFsXG4gICAgZnVuY3Rpb24gY2FuY2VsVXBkYXRlKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0ucHlyYW1pZC5faWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgcHlyYW1pZC5kYXRhLnBsYXllcnMgPSAkZmlsdGVyKCdvcmRlckJ5JykocHlyYW1pZC5kYXRhLnBsYXllcnMsICdwb3NpdGlvbicpO1xuICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUmVvcmRlciB0aGUgcGxheWVycyBiYXNlZCBvbiB0aGUgZHJhZy1kcm9wXG4gICAgZnVuY3Rpb24gcmVvcmRlclBsYXllcnMoKSB7XG4gICAgICB2YXIgaSA9IDE7XG4gICAgICBfLmZvckVhY2godm0ucHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIHBsYXllci5wb3NpdGlvbiA9IGk7XG4gICAgICAgICsraTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFF1ZXVlIHVwIHRoZSBwbGF5ZXJzIHRvIGJlIHJlbW92ZWQgYW5kIHJlbW92ZSB0aGVtIGZyb20gdGhlIGRpc3BsYXlcbiAgICBmdW5jdGlvbiByZW1vdmVQbGF5ZXIocGxheWVyLCBwbGF5ZXJJbmRleCkge1xuICAgICAgcmVtb3ZlZFBsYXllcnMucHVzaChwbGF5ZXIpO1xuICAgICAgdm0ucHlyYW1pZC5wbGF5ZXJzLnNwbGljZShwbGF5ZXJJbmRleCwgMSk7XG4gICAgICByZW9yZGVyUGxheWVycygpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdweXJhbWlkc1NlcnZpY2UnLCBweXJhbWlkc1NlcnZpY2UpO1xuXG4gIGZ1bmN0aW9uIHB5cmFtaWRzU2VydmljZSgkaHR0cCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0UHlyYW1pZDogZ2V0UHlyYW1pZCxcbiAgICAgIGdldFB5cmFtaWRzRm9yVXNlcjogZ2V0UHlyYW1pZHNGb3JVc2VyLFxuICAgICAgZ2V0UHlyYW1pZHM6IGdldFB5cmFtaWRzLFxuICAgICAgY3JlYXRlUHlyYW1pZDogY3JlYXRlUHlyYW1pZCxcbiAgICAgIHVwZGF0ZVB5cmFtaWQ6IHVwZGF0ZVB5cmFtaWQsXG4gICAgICBzd2FwUG9zaXRpb25zOiBzd2FwUG9zaXRpb25zLFxuICAgICAgYWRkUGxheWVyVG9QeXJhbWlkOiBhZGRQbGF5ZXJUb1B5cmFtaWQsXG4gICAgICBhZGRQbGF5ZXJUb1B5cmFtaWRSZXF1ZXN0OiBhZGRQbGF5ZXJUb1B5cmFtaWRSZXF1ZXN0LFxuICAgICAgcmVtb3ZlZFBsYXllckZyb21QeXJhbWlkOiByZW1vdmVkUGxheWVyRnJvbVB5cmFtaWQsXG4gICAgICBhcHByb3ZlUGVuZGluZ1BsYXllcjogYXBwcm92ZVBlbmRpbmdQbGF5ZXIsXG4gICAgICBkZW55UGVuZGluZ1BsYXllcjogZGVueVBlbmRpbmdQbGF5ZXJcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGEgcHlyYW1pZCBmcm9tIHRoZSBkYXRhYmFzZSAob3IgbWVtb3J5KVxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHB5cmFtaWQgaWQgZm9yIHRoZSByZXF1ZXN0ZWQgcHlyYW1pZFxuICAgICAqIEByZXR1cm4ge09iamVjdH0gcHlyYW1pZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFB5cmFtaWQoY29tcGV0aXRpb25JZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9weXJhbWlkJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYWxsIHB5cmFtaWRzIGZyb20gdGhlIGRhdGFiYXNlIHRoYXQgYSBwYXJ0aWN1bGFyIHVzZXIgaXMgaW5jbHVkZWQgaW5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7dXNlcklkfSB0aGUgdXNlciBpZCBmb3IgdGhlIHJlcXVlc3RlZCB1c2VyXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBweXJhbWlkc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFB5cmFtaWRzRm9yVXNlcih1c2VySWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcHlyYW1pZHMvdXNlcicsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgdXNlcklkOiB1c2VySWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhbGwgYWN0aXZlIHB5cmFtaWRzIGZyb20gdGhlIGRhdGFiYXNlXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IHB5cmFtaWRzXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZHMoKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3B5cmFtaWRzJyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlUHlyYW1pZChweXJhbWlkKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9jcmVhdGUnLCB7XG4gICAgICAgIHB5cmFtaWQ6IHB5cmFtaWRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZVB5cmFtaWQocHlyYW1pZCkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvdXBkYXRlJywge1xuICAgICAgICBweXJhbWlkOiBweXJhbWlkXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzd2FwUG9zaXRpb25zKGNvbXBldGl0aW9uSWQsIGNoYWxsZW5nZXIsIG9wcG9uZW50KSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9zd2FwUG9zaXRpb25zJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICBjaGFsbGVuZ2VyOiBjaGFsbGVuZ2VyLFxuICAgICAgICBvcHBvbmVudDogb3Bwb25lbnRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFBsYXllclRvUHlyYW1pZChjb21wZXRpdGlvbklkLCBwbGF5ZXIpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2FkZFBsYXllcicsIHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgcGxheWVyOiBwbGF5ZXJcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFBsYXllclRvUHlyYW1pZFJlcXVlc3QoY29tcGV0aXRpb24sIHBsYXllcikge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvYWRkUGxheWVyUmVxdWVzdCcsIHtcbiAgICAgICAgY29tcGV0aXRpb246IGNvbXBldGl0aW9uLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVtb3ZlZFBsYXllckZyb21QeXJhbWlkKGNvbXBldGl0aW9uSWQsIHJlbW92ZWRQbGF5ZXIsIHBsYXllcnMpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL3JlbW92ZVBsYXllcicsIHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgcmVtb3ZlZFBsYXllcjogcmVtb3ZlZFBsYXllcixcbiAgICAgICAgcGxheWVyczogcGxheWVyc1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXBwcm92ZVBlbmRpbmdQbGF5ZXIoY29tcGV0aXRpb25JZCwgcGxheWVyKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9hcHByb3ZlUGxheWVyJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVueVBlbmRpbmdQbGF5ZXIoY29tcGV0aXRpb25JZCwgcGxheWVyKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9kZW55UGxheWVyJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0FkbWluQ3RybCcsIEFkbWluQ3RybCk7XG5cbiAgZnVuY3Rpb24gQWRtaW5DdHJsKCRzY29wZSwgJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRmaWx0ZXIsIHB5cmFtaWRzU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jb21wZXRpdGlvbklkID0gbnVsbDtcbiAgICB2bS51cGRhdGVQeXJhbWlkT3BlblN0YXR1cyA9IHVwZGF0ZVB5cmFtaWRPcGVuU3RhdHVzO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMubXlQeXJhbWlkcycpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlZnJlc2hQeXJhbWlkKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhpcyB1c2VyIGlzIGFuIG93bmVyIG9mIHRoaXMgY29tcGV0aXRpb25cbiAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSAmJiBfLnNvbWUocHlyYW1pZC5kYXRhLm93bmVycywgWydfaWQnLCBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkXSkpIHtcbiAgICAgICAgICAvLyBEaXNwbGF5IHRoZSBwbGF5ZXJzIGluIHRoZSBwcm9wZXIgb3JkZXJcbiAgICAgICAgICBweXJhbWlkLmRhdGEucGxheWVycyA9ICRmaWx0ZXIoJ29yZGVyQnknKShweXJhbWlkLmRhdGEucGxheWVycywgJ3Bvc2l0aW9uJyk7XG4gICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLm15UHlyYW1pZHMnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUGVyZm9ybSB0aGUgdXBkYXRlcyB0aGF0IHdlcmUgcmVxdXN0ZWRcbiAgICBmdW5jdGlvbiB1cGRhdGVQeXJhbWlkT3BlblN0YXR1cygpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgdmFyIHVwZGF0ZWRQeXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuICAgICAgICB1cGRhdGVkUHlyYW1pZC5vcGVuID0gdm0ucHlyYW1pZC5vcGVuO1xuICAgICAgICBweXJhbWlkc1NlcnZpY2UudXBkYXRlUHlyYW1pZCh1cGRhdGVkUHlyYW1pZCk7XG4gICAgICB9KTsgICAgICBcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpwbGF5ZXJfYWRkZWQnLCBmdW5jdGlvbiAoXywgZGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGRldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oZGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cGxheWVyX3JlbW92ZWQnLCBmdW5jdGlvbiAoXywgZGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGRldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oZGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cHlyYW1pZF91cGRhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmFkZF9wbGF5ZXJfcmVxdWVzdCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czphZGRfcGxheWVyX3JlcXVlc3RfZGVuaWVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIi8qKlxuICogQ3JlYXRlcyBhIHB5cmFtaWRcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQ3JlYXRlUHlyYW1pZEN0cmwnLCBDcmVhdGVQeXJhbWlkQ3RybCk7XG5cbiAgZnVuY3Rpb24gQ3JlYXRlUHlyYW1pZEN0cmwoJHN0YXRlLCB1c2VyU2VydmljZSwgcHlyYW1pZHNTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UpIHtcbiAgICB2YXIgYnJlYWtQb2ludHMgPSBbXTtcbiAgICB2YXIgbWF4TGV2ZWxzID0gMTA7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5uZXdQeXJhbWlkID0ge1xuICAgICAgcGxheWVyczogW10sXG4gICAgICBvcGVuOiBmYWxzZVxuICAgIH07XG4gICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IFtdO1xuICAgIHZtLmFkZGVkUGxheWVycyA9IFtdO1xuICAgIHZtLmNyZWF0ZVB5cmFtaWQgPSBjcmVhdGVQeXJhbWlkO1xuICAgIHZtLmFkZFBsYXllciA9IGFkZFBsYXllcjtcbiAgICB2bS5yZW1vdmVQbGF5ZXIgPSByZW1vdmVQbGF5ZXI7XG4gICAgdm0ucmVvcmRlclBsYXllcnMgPSByZW9yZGVyUGxheWVycztcbiAgICB2bS5uZXdQeXJhbWlkLmZvcmZlaXREYXlzID0gMTtcblxuICAgIGFjdGl2YXRlKCk7XG4gICAgXG4gICAgLyoqXG4gICAgICogUnVucyBvbiBjb250cm9sbGVyIGluc3RhbnRpYXRpb25cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIHVzZXJTZXJ2aWNlLmdldEFsbFVzZXJzKCkudGhlbihmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IHVzZXJzLmRhdGE7XG4gICAgICB9KTtcblxuICAgICAgLy8gQ3JlYXRlIGJyZWFrIHBvaW50cyBhcnJheVxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXhMZXZlbHM7IGkrKykge1xuICAgICAgICBicmVha1BvaW50cy5wdXNoKCgoKGkgKiAoaSArIDEpKSAvIDIpKSArIDEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBwbGF5ZXIgdG8gdGhlIG5ldyBweXJhbWlkXG4gICAgICogQ2hlY2tzIHRvIG1ha2Ugc3VyZSB5b3UgYXJlIG5vdCBhZGRpbmcgdG9vIG1hbnkgcGxheWVyc1xuICAgICAqIEBwYXJhbSAge29iamVjdH0gcGxheWVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWRkUGxheWVyKHBsYXllcikge1xuICAgICAgcGxheWVyLnBvc2l0aW9uID0gdm0uYWRkZWRQbGF5ZXJzLmxlbmd0aCArIDE7XG4gICAgICB2bS5hZGRlZFBsYXllcnMucHVzaChfLnJlbW92ZSh2bS5hdmFpbGFibGVQbGF5ZXJzLCB7X2lkOiBwbGF5ZXIuX2lkfSlbMF0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYSBwcmV2aXVvc2x5IGFkZGVkIHBsYXllciBmcm9tIHRoZSBweXJhbWlkXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBwbGF5ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZW1vdmVQbGF5ZXIocGxheWVyKSB7XG4gICAgICB2bS5hdmFpbGFibGVQbGF5ZXJzLnB1c2goXy5yZW1vdmUodm0uYWRkZWRQbGF5ZXJzLCB7X2lkOiBwbGF5ZXIuX2lkfSlbMF0pO1xuICAgICAgcmVvcmRlclBsYXllcnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW9yZGVyIHRoZSBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBkcmFnLWRyb3BcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZW9yZGVyUGxheWVycygpIHtcbiAgICAgIHZhciBpID0gMTtcbiAgICAgIF8uZm9yRWFjaCh2bS5hZGRlZFBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgcGxheWVyLnBvc2l0aW9uID0gaTtcbiAgICAgICAgKytpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gVXNlZCB0byBrZWVwIHRyYWNrIG9mIHBvc2l0aW9uIG9uIHRoZSBweXJhbWlkIGJhc2VkIG9uIHdoZW4gdGhlIHBsYXllciB3YXMgYWRkZWRcbiAgICB2YXIgcG9zaXRpb24gPSAwO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHRoZSBweXJhbWlkXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBweXJhbWlkXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlUHlyYW1pZChweXJhbWlkKSB7XG4gICAgICBhbmd1bGFyLmZvckVhY2godm0uYWRkZWRQbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIHBvc2l0aW9uICs9IDE7XG4gICAgICAgIHZhciBhZGRQbGF5ZXIgPSB7XG4gICAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLFxuICAgICAgICAgIF9pZDogcGxheWVyLl9pZCxcbiAgICAgICAgICBlbWFpbDogcGxheWVyLnVzZXJuYW1lLFxuICAgICAgICAgIGZpcnN0TmFtZTogcGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICBsYXN0TmFtZTogcGxheWVyLmxhc3ROYW1lXG4gICAgICAgIH07XG4gICAgICAgIHB5cmFtaWQucGxheWVycy5wdXNoKGFkZFBsYXllcik7XG4gICAgICB9KTtcbiAgICAgIHB5cmFtaWQub3duZXJzID0gW3tcbiAgICAgICAgX2lkOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkLFxuICAgICAgICBlbWFpbDogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLnVzZXJuYW1lLFxuICAgICAgICBmaXJzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5maXJzdE5hbWUsXG4gICAgICAgIGxhc3ROYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIubGFzdE5hbWVcbiAgICAgIH1dO1xuXG4gICAgICAvLyBGaWd1cmUgb3V0IHRoZSBudW1iZXIgb2YgbGV2ZWxzIGJhc2VkIG9uIHRoZSBudW1iZXIgb2YgcGxheWVyc1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBicmVha1BvaW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocHlyYW1pZC5wbGF5ZXJzLmxlbmd0aCA8IGJyZWFrUG9pbnRzW2ldKSB7XG4gICAgICAgICAgcHlyYW1pZC5sZXZlbHMgPSBpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHB5cmFtaWRzU2VydmljZS5jcmVhdGVQeXJhbWlkKHB5cmFtaWQpLnRoZW4oZnVuY3Rpb24gKG5ld1B5cmFtaWQpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy52aWV3Jywge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IG5ld1B5cmFtaWQuZGF0YS5faWRcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTXlQeXJhbWlkc0N0cmwnLCBNeVB5cmFtaWRzQ3RybCk7XG5cbiAgZnVuY3Rpb24gTXlQeXJhbWlkc0N0cmwoKSB7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1B5cmFtaWRDdHJsJywgUHlyYW1pZEN0cmwpO1xuXG4gIGZ1bmN0aW9uIFB5cmFtaWRDdHJsKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBweXJhbWlkc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNvbXBldGl0aW9uSWQgPSBudWxsO1xuICAgIHZtLnB5cmFtaWQgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcblxuICAgICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSkge1xuICAgICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy5teVB5cmFtaWRzJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUHlyYW1pZHNDdHJsJywgUHlyYW1pZHNDdHJsKTtcblxuICBmdW5jdGlvbiBQeXJhbWlkc0N0cmwoKSB7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1N0YXRzQ3RybCcsIFN0YXRzQ3RybCk7XG5cbiAgZnVuY3Rpb24gU3RhdHNDdHJsKCRzY29wZSwgJHN0YXRlUGFyYW1zLCAkc3RhdGUsIHB5cmFtaWRzU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY29tcGV0aXRpb25JZCA9IG51bGw7XG4gICAgdm0ucHlyYW1pZCA9IG51bGw7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBpZiAoJHN0YXRlUGFyYW1zLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgdm0uY29tcGV0aXRpb25JZCA9ICRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlZnJlc2hQeXJhbWlkKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICBpZiAocHlyYW1pZC5kYXRhKSB7XG4gICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLm15UHlyYW1pZHMnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jb21wbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignVXNlckN0cmwnLCBVc2VyQ3RybCk7XG5cbiAgZnVuY3Rpb24gVXNlckN0cmwoaWRlbnRpdHlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pbmRlbnRpdHkgPSBpZGVudGl0eVNlcnZpY2U7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7fVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnY092ZXJmbG93JywgY092ZXJmbG93KTtcblxuICBmdW5jdGlvbiBjT3ZlcmZsb3coc2Nyb2xsYmFyU2VydmljZSkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0MnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgIHZhciBzY3JvbGxheGlzID0gYXR0cnMuc2Nyb2xsYXhpcyB8fCAneSc7XG4gICAgICB2YXIgdGhlbWUgPSBhdHRycy50aGVtZSB8fCAnbWluaW1hbC1kYXJrJztcbiAgICAgIHZhciBtb3VzZXdoZWVsYXhpcyA9IGF0dHJzLm1vdXNld2hlZWxheGlzIHx8ICd5JztcbiAgICAgIGlmICghJCgnaHRtbCcpLmhhc0NsYXNzKCdpc21vYmlsZScpKSB7XG4gICAgICAgIHNjcm9sbGJhclNlcnZpY2UubWFsaWh1U2Nyb2xsKGVsZW1lbnQsIHRoZW1lLCBzY3JvbGxheGlzLCBtb3VzZXdoZWVsYXhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgndG9nZ2xlU3VibWVudScsIHRvZ2dsZVN1Ym1lbnUpO1xuXG4gIGZ1bmN0aW9uIHRvZ2dsZVN1Ym1lbnUoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbCkge1xuICAgICAgZWwuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBlbC5uZXh0KCkuc2xpZGVUb2dnbGUoMjAwKTtcbiAgICAgICAgZWwucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ3RvZ2dsZWQnKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ3dhdmVzRWZmZWN0Jywgd2F2ZXNFZmZlY3QpO1xuXG4gIGZ1bmN0aW9uIHdhdmVzRWZmZWN0KCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0MnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCkge1xuICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ2J0bi1pY29uJykgfHwgZWxlbWVudC5oYXNDbGFzcygnYnRuLWZsb2F0JykpIHtcbiAgICAgICAgV2F2ZXMuYXR0YWNoKGVsZW1lbnQsIFsnd2F2ZXMtY2lyY2xlJ10pO1xuICAgICAgfSBlbHNlIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdidG4tbGlnaHQnKSkge1xuICAgICAgICBXYXZlcy5hdHRhY2goZWxlbWVudCwgWyd3YXZlcy1saWdodCddKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFdhdmVzLmF0dGFjaChlbGVtZW50KTtcbiAgICAgIH1cblxuICAgICAgV2F2ZXMuaW5pdCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2ZnTGluZScsIGZnTGluZSk7XG5cbiAgZnVuY3Rpb24gZmdMaW5lKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0MnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCkge1xuICAgICAgdmFyIGlucHV0ID0gZWxlbWVudC5jaGlsZHJlbigpLmZpcnN0KCk7XG4gICAgICB2YXIgaXNGbG9hdExhYmVsID0gZWxlbWVudC5wYXJlbnQoKS5oYXNDbGFzcygnZmctZmxvYXQnKTtcbiAgICAgIGlucHV0LmZvY3VzKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnZmctdG9nZ2xlZCcpO1xuICAgICAgfSk7XG5cbiAgICAgIGlucHV0LmJsdXIoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIWlzRmxvYXRMYWJlbCB8fCAoaXNGbG9hdExhYmVsICYmIGlucHV0LnZhbCgpLmxlbmd0aCA9PT0gMCkpIHtcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdmZy10b2dnbGVkJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiXX0=
