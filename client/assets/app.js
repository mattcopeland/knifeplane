angular.module("app",["ui.router","ui.bootstrap","ngAnimate","angular-loading-bar","nouislider","localytics.directives","timer","LocalStorageModule","angular-sortable-view"]),function(){"use strict ";function e(e,t){e.defaults.headers.get||(e.defaults.headers.get={}),e.defaults.headers.get["If-Modified-Since"]="Fri, 01 Jan 2016 05:00:00 GMT",e.defaults.headers.get["Cache-Control"]="no-cache",e.defaults.headers.get.Pragma="no-cache",t.options({appendToBody:!0})}e.$inject=["$httpProvider","$uibTooltipProvider"],angular.module("app").config(e)}(),function(){"use strict";function e(e,t){function n(e){t.set("sidebarLocked",e)}var r=this;r.$state=e,r.lockSidebar=t.get("sidebarLocked"),r.toggleSidebarLocked=n}e.$inject=["$state","localStorageService"],angular.module("app").controller("AppCtrl",e)}(),function(){"use strict";function e(e,i,o){var a={superAdmin:n,admin:t,user:r};o.html5Mode(!0),i.otherwise("/"),i.when("/pyramids/","/pyramids"),e.state("home",{url:"/",views:{content:{controller:"HomeCtrl",controllerAs:"vm",templateUrl:"common/views/home.html"}}}).state("pyramids",{url:"/pyramids",views:{content:{controller:"PyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramids.html"}}}).state("pyramids.myPyramids",{url:"/my-pyramids",views:{"content@":{controller:"MyPyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/my-pyramids.html"}},resolve:{auth:a.user}}).state("pyramids.view",{url:"/view/:competitionId",views:{"content@":{controller:"PyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramid.html"}}}).state("pyramids.stats",{url:"/stats/:competitionId",views:{"content@":{controller:"StatsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/stats.html"}}}).state("pyramids.admin",{url:"/admin/:competitionId",views:{"content@":{controller:"AdminCtrl",controllerAs:"vm",templateUrl:"pyramids/views/admin.html"}},resolve:{auth:a.user}}).state("pyramids.create",{url:"/create",views:{"content@":{controller:"CreatePyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/create-pyramid.html"}},resolve:{auth:a.user}}).state("login",{url:"/login",views:{content:{controller:"LoginCtrl",controllerAs:"vm",templateUrl:"authentication/views/login.html"}}}).state("register",{url:"/register",views:{content:{controller:"RegisterCtrl",controllerAs:"vm",templateUrl:"authentication/views/register.html"}}}).state("verify",{url:"/verification",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}}).state("verification",{url:"/verification/:userId/:verificationToken",views:{content:{controller:"VerificationCtrl",controllerAs:"vm",templateUrl:"authentication/views/verification.html"}}})}function t(e){return e.authorizeCurrentUserForRoute("admin")}function n(e){return e.authorizeCurrentUserForRoute("super-admin")}function r(e){return e.authenticatedUserForRoute()}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app").config(e),t.$inject=["authService"],n.$inject=["authService"],r.$inject=["authService"]}(),function(){"use strict";function e(e,t,n){e.$on("$stateChangeError",function(e,n,r,i,o,a){"not authorized"===a&&(t.go("login"),t.previous=n,t.prevParams=r)}),e.$on("$stateChangeStart",function(){n.setSidebarStatus(!1)})}e.$inject=["$rootScope","$state","sidebarService"],angular.module("app").run(e)}(),function(){"use strict";function e(e,t,n,r,i,o){function a(e,r){var o=n.defer();return t.post("/login",{username:e,password:r}).then(function(e){e.data.success?(i.currentUser=e.data.user,o.resolve(!0)):"unverified"===e.data.message?o.resolve("unverified"):o.resolve(!1)}),o.promise}function l(e){var r=n.defer();return t.post("/api/users",{userData:e}).then(function(e){e.data?r.resolve(!0):r.resolve(!1)},function(e){"Error: Duplicate Username"===e.data.reason&&o.error("Sorry, an account already exists with that email address.")}),r.promise}function c(){var r=n.defer();return t.post("/logout",{logout:!0}).then(function(){i.currentUser=void 0,r.resolve(),e.go("home")}),r.promise}function s(e){return!!i.isAuthorized(e)||n.reject("not authorized")}function u(){return!!i.isAuthenticated()||n.reject("not authorized")}var d={authenticateUser:a,createUser:l,logout:c,authorizeCurrentUserForRoute:s,authenticatedUserForRoute:u};return d}e.$inject=["$state","$http","$q","userService","identityService","notifyService"],angular.module("app").factory("authService",e)}(),function(){"use strict";function e(e){function t(){return e.get("/api/users").then(function(e){return e})}function n(t,n){return e.get("/api/user/verification",{params:{userId:t,verificationToken:n}})}var r={getAllUsers:t,verifyUser:n};return r}e.$inject=["$http"],angular.module("app").factory("userService",e)}(),function(){"use strict";function e(e,t,n){function r(){}function i(r,i){t.authenticateUser(r,i).then(function(t){t?"unverified"===t?n.error("You must verify your email before you can login"):e.previous?(e.go(e.previous,e.prevParams),e.previous=null,e.prevParams=null):e.go("home"):n.error("Username / password combinaiton incorrect")})}var o=this;o.login=i,r()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("LoginCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){}function i(r){r.password!==r.confirmPassword?n.error("Passwords don't match!"):t.createUser(r).then(function(){e.go("verify")})}var o=this;o.register=i,r()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("RegisterCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){t.userId&&t.verificationToken&&(i.verifying=!0,i.verified=null,n.verifyUser(t.userId,t.verificationToken).then(function(e){e.data?i.verified=!0:i.verified=!1}))}var i=this;i.verified=void 0,i.verifying=!1,r()}e.$inject=["$state","$stateParams","userService"],angular.module("app").controller("VerificationCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@"},templateUrl:"/challenges/components/active-challenges.html"};return e}function t(e,t){function n(){r()}function r(){i.challenges=[],t.getActiveChallengesByCompetition(i.competitionId).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){0!==e.timeLimit&&(e.expires=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1)}))})}var i=this;i.challenges=[],n(),e.$on("ws:challenge_created",function(e,t){i.competitionId===t.competitionId&&r()}),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&r()}),e.$on("ws:pyramid_updated",function(e,t){i.competitionId===t.competitionId&&r()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpActiveChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@",limit:"@"},templateUrl:"/challenges/components/completed-challenges.html"};return e}function t(e,t){function n(){r()}function r(){i.challenges=[],t.getCompletedChallengesByCompetition(i.competitionId,i.limit).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){e.loser="challenger"===e.winner?"opponent":"challenger",e.whenCompleted=moment(e.completed).calendar(null,{sameDay:"[Today]",nextDay:"[Tomorrow]",nextWeek:"dddd",lastDay:"[Yesterday]",lastWeek:"[Last] dddd",sameElse:"DD/MM/YYYY"})}))})}var i=this;i.challenges=[],n(),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&r()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpCompletedChalleneges",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@",player:"="},templateUrl:"/challenges/components/player-overall-results.html"};return e}function t(e,t,n){function r(){i(o.competitionId,o.player._id)}function i(e,n){t.getPlayerResultsByCompetition(e,n).then(function(e){for(var t=[],r=0;r<o.maxLevels;r++)t.push(r*(r+1)/2+1);o.player.level=t.length;for(var i=0;i<t.length;i++)if(o.player.position<t[i+1]){o.player.level=t.indexOf(t[i])+1;break}var a,l=0,c=!0;_.forEach(e.data,function(e){c&&("challenger"===e.winner&&e.challenger._id===n||"opponent"===e.winner&&e.opponent._id===n?"losing"!==a?(l+=1,a="winning"):c=!1:("opponent"===e.winner&&e.challenger._id===n||"challenger"===e.winner&&e.opponent._id===n)&&("winning"!==a?(l+=1,a="losing"):c=!1)),o.streak={type:a,value:l}}),o.wins.asOpponent=_.size(_.filter(e.data,function(e){return e.opponent._id===n&&"opponent"===e.winner})),o.wins.asChallenger=_.size(_.filter(e.data,function(e){return e.challenger._id===n&&"challenger"===e.winner})),o.wins.total=o.wins.asChallenger+o.wins.asOpponent,o.wins.byForfeit=_.size(_.filter(e.data,function(e){return e.forfeit&&(e.challenger._id===n&&"challenger"===e.winner||e.opponent._id===n&&"opponent"===e.winner)})),o.loses.asOpponent=_.size(_.filter(e.data,function(e){return e.opponent._id===n&&"challenger"===e.winner})),o.loses.asChallenger=_.size(_.filter(e.data,function(e){return e.challenger._id===n&&"opponent"===e.winner})),o.loses.total=o.loses.asChallenger+o.loses.asOpponent,o.loses.byForfeit=_.size(_.filter(e.data,function(e){return e.forfeit&&(e.challenger._id===n&&"opponent"===e.winner||e.opponent._id===n&&"challenger"===e.winner)}))})}var o=this;o.maxLevels=10,o.wins={total:0,asChallenger:0,asOpponent:0,byForfeit:0},o.loses={total:0,asChallenger:0,asOpponent:0,byForfeit:0},o.streak={type:null,value:0},r(),e.$on("ws:challenge_completed",function(e,t){o.competitionId===t.competitionId&&(o.player._id===t.challengerId?(n.info(t.description),i(t.competitionId,t.challengerId)):o.player._id===t.opponentId&&i(t.competitionId,t.opponentId))})}t.$inject=["$scope","challengesService","notifyService"],angular.module("app").directive("kpPlayerOverallResults",e)}(),function(){"use strict";function e(e){function t(t){return e.post("/api/challenges/create",{challenge:t})}function n(t){return e.post("/api/challenges/complete",{challenge:t})}function r(t){return e.get("/api/challenges/competition",{params:{competitionId:t}})}function i(t){return e.get("/api/challenges/active/competition",{params:{competitionId:t}})}function o(t,n){return e.get("/api/challenges/active/competition/player",{params:{competitionId:t,playerId:n}})}function a(t,n){return e.get("/api/challenges/completed/competition",{params:{competitionId:t,limit:n}})}function l(t,n){return e.delete("/api/challenges/active/competition/player/delete",{params:{competitionId:t,playerId:n}})}function c(t,n){return e.get("/api/challenges/results/competition/player",{params:{competitionId:t,playerId:n}})}var s={createChallenge:t,completeChallenge:n,getChallengesByCompetition:r,getActiveChallengesByCompetition:i,getActiveChallengeByCompetitionByPlayer:o,getCompletedChallengesByCompetition:a,deleteActiveChallengeByCompetitionByPlayer:l,getPlayerResultsByCompetition:c};return s}e.$inject=["$http"],angular.module("app").factory("challengesService",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",templateUrl:"/common/components/footer.html"};return e}function t(e,t){function n(){t.logout()}var r=this;r.indentity=e,r.logout=n}t.$inject=["identityService","authService"],angular.module("app").directive("kpFooter",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"headerCtrl",restrict:"A",templateUrl:"/common/components/header.html"};return e}function t(e,t,n){function r(){o.sidebarStatus.left=!o.sidebarStatus.left,e.setSidebarStatus(o.sidebarStatus.left)}function i(){n.logout()}var o=this;o.indentity=t,o.logout=i,o.sidebarStatus=e.getSidebarStatus(),o.toggleSidebar=r}t.$inject=["sidebarService","identityService","authService"],angular.module("app").directive("kpHeader",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"sidebarCtrl",restrict:"A",templateUrl:"/common/components/sidebar.html"};return e}function t(e,t,n){function r(){t.logout()}var i=this;i.indentity=e,i.logout=r,i.sidebarStatus=n.getSidebarStatus()}t.$inject=["identityService","authService","sidebarService"],angular.module("app").directive("kpSidebar",e)}(),function(){"use strict";function e(){return function(e,t){if(!angular.isObject(e))return e;var n=[];for(var r in e)n.push(e[r]);return n.sort(function(e,n){return e=parseInt(e[t]),n=parseInt(n[t]),e-n}),n}}angular.module("app").filter("orderObjectBy",e)}(),function(){"use strict";function e(e){function t(){return!!this.currentUser}function n(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}var r;null!==e.bootstrappedUserObject&&(r=e.bootstrappedUserObject);var i={currentUser:r,isAuthenticated:t,isAuthorized:n};return i}e.$inject=["$window"],angular.module("app").factory("identityService",e)}(),function(){"use strict";function e(){function e(e,t,n){$.notify({message:e,url:t,target:n},{type:"info"})}function t(e,t,n){$.notify({message:e,url:t,target:n},{type:"success"})}function n(e,t,n){$.notify({message:e,url:t,target:n},{type:"warning"})}function r(e,t,n){$.notify({message:e,url:t,target:n},{type:"danger"})}function i(e,t,n){$.notify({message:e,url:t,target:n},{type:"inverse"})}var o={info:e,success:t,warning:n,error:r,inverse:i};return $.notifyDefaults({newest_on_top:!0,offset:{x:20,y:85}}),o}angular.module("app").factory("notifyService",e)}(),function(){"use strict";function e(){function e(e,t,n,r){$(e).mCustomScrollbar({theme:t,scrollInertia:100,axis:n,mouseWheel:{enable:!0,axis:r,preventDefault:!0}})}var t={malihuScroll:e};return t}angular.module("app").factory("scrollbarService",e)}(),function(){"use strict";function e(){function e(){return n}function t(e){n.left=e}var n={left:!1,right:!1},r={getSidebarStatus:e,setSidebarStatus:t};return r}angular.module("app").factory("sidebarService",e)}(),angular.module("app").service("websocketService",["$rootScope","$window",function(e,t){function n(){return"https:"===t.location.protocol?"wss://"+t.location.host:"ws://"+t.location.host}var r;this.connect=function(){r=new WebSocket(n()),r.onmessage=function(t){var n=JSON.parse(t.data);e.$broadcast("ws:"+n.topic,n.data)}},this.send=function(e,t){var n=JSON.stringify({topic:e,data:t});r.send(n)}}]).run(["websocketService",function(e){e.connect()}]),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("HomeCtrl",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@"},templateUrl:"/pyramids/components/pending-players.html"};return e}function t(e,t){function n(){r()}function r(){a.pendingPlayers=[],t.getPyramid(a.competitionId).then(function(e){a.pyramid=e.data,e.data&&e.data.pendingPlayers.length>0&&(a.pendingPlayers=e.data.pendingPlayers)})}function i(e){e.position=a.pyramid.players.length+1,t.approvePendingPlayer(a.competitionId,e).then(r)}function o(e){t.denyPendingPlayer(a.competitionId,e).then(r)}var a=this;a.pyramid={},a.pendingPlayers=[],a.approvePendingPlayer=i,a.denyPendingPlayer=o,n()}t.$inject=["$scope","pyramidsService"],angular.module("app").directive("kpPendingPlayers",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{type:"@"},templateUrl:"/pyramids/components/pyramid-compact.html"};return e}function t(e,t){function n(){"user"===r.type?e.getPyramidsForUser(t.currentUser._id).then(function(e){r.pyramids=e.data}):e.getPyramids().then(function(e){r.pyramids=e.data})}var r=this;r.pyramids=null,n()}t.$inject=["pyramidsService","identityService"],angular.module("app").directive("kpPyramidCompact",e)}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"/pyramids/components/pyramid.html",replace:!0,scope:{competitionId:"@"},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,n,r,i,o,a){function l(){n.getPyramid(S.competitionId).then(function(e){for(var t=I;t>0;--t)S.maxPlayers+=t;e.data&&(S.pyramid=e.data,c(),s(),d(),p(),m())})}function c(){S.pyramid.players=r("orderBy")(S.pyramid.players,"position")}function s(){o.isAuthenticated()&&(S.currentUserIsOwner=_.some(S.pyramid.owners,["_id",o.currentUser._id])),_.forEach(S.pyramid.players,function(e){o.isAuthenticated()&&e._id===o.currentUser._id&&(S.currentUserIsOnPyramid=!0,e.class="current-user",S.currentUserPlayer=e,a.getActiveChallengeByCompetitionByPlayer(S.competitionId,e._id).then(function(e){e.data&&(S.hasActiveChallenge=!0)}))}),_.forEach(S.pyramid.pendingPlayers,function(e){o.isAuthenticated()&&e._id===o.currentUser._id&&(S.currentUserIsPending=!0)}),a.getActiveChallengesByCompetition(S.competitionId).then(function(e){_.forEach(e.data,function(e){var t=_.find(S.pyramid.players,{_id:e.challenger._id});t.class="unavailable",t.challenge={position:"challenger"};var n=_.find(S.pyramid.players,{_id:e.opponent._id});if(n.class="unavailable",n.challenge={position:"opponent"},0!==e.timeLimit){var r=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1;r>0?n.challenge.expires=r:r<=0&&v(null,!0,n)}}),f()})}function u(){S.breakPoints=[];for(var e=0;e<I;e++)S.breakPoints.push(e*(e+1)/2+1)}function d(){var e=0;S.levels=[],u();for(var t=0;t<S.pyramid.players.length;t++)S.breakPoints.indexOf(t+1)>-1&&(e+=1,S.levels.push(e)),S.pyramid.players[t].level=e}function p(){S.numberOfBlocks=0;for(var e=_.last(S.levels);e>0;e--)S.numberOfBlocks+=e}function m(){S.numberOfRealPlayers=S.pyramid.players.length;for(var e=S.pyramid.players.length;e<S.numberOfBlocks;e++)S.pyramid.players.push({firstName:"Empty",lastName:"Spot",position:99,class:"empty"});d()}function f(){var e=S.currentUserPlayer.level>1?S.currentUserPlayer.level-1:null;_.forEach(S.pyramid.players,function(t){t.level===e&&99!==t.position&&"unavailable"!==t.class&&(S.availableChallenges=!0,t.available=!0)})}function y(e){if(e.available){S.hasActiveChallenge=!0;var t={competitionName:S.pyramid.name,competitionId:S.competitionId,complete:!1,forfeit:!1,timeLimit:S.pyramid.forfeitDays,challenger:{_id:S.currentUserPlayer._id,email:S.currentUserPlayer.email,firstName:S.currentUserPlayer.firstName,lastName:S.currentUserPlayer.lastName,position:S.currentUserPlayer.position},opponent:{_id:e._id,email:e.email,firstName:e.firstName,lastName:e.lastName,position:e.position}};a.createChallenge(t).then(function(){S.pyramidMenuToggle=!1})}else i.error("Sorry, that is not a valid challenge.")}function v(e,t,r){var i=r||S.currentUserPlayer;a.getActiveChallengeByCompetitionByPlayer(S.competitionId,i._id).then(function(i){S.hasActiveChallenge=!1;var o=!1;t?(i.data.forfeit=!0,"opponent"===r.challenge.position?(i.data.winner="challenger",o=!0):i.data.winner="opponent"):e?i.data.challenger._id===S.currentUserPlayer._id?(i.data.winner="challenger",o=!0):i.data.winner="opponent":i.data.challenger._id===S.currentUserPlayer._id?i.data.winner="opponent":(i.data.winner="challenger",o=!0),o?n.swapPositions(S.competitionId,i.data.opponent,i.data.challenger).then(function(){a.completeChallenge(i.data).then(function(){$&&w()})}):a.completeChallenge(i.data).then(function(){$&&w()}),S.pyramidMenuToggle=!1})}function g(e){v(null,!0,e)}function h(){if(o.isAuthenticated())if(S.numberOfRealPlayers<S.maxPlayers){var e={_id:o.currentUser._id,firstName:o.currentUser.firstName,lastName:o.currentUser.lastName,email:o.currentUser.username,position:S.numberOfRealPlayers+1};S.pyramid.open?swal({title:"Join Competition?",text:"You'll be added to the bottom",type:"warning",showCancelButton:!0,confirmButtonText:"Join",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToPyramid(S.competitionId,e),swal("Welcome Aboard!","Now start fighting your way to the top","success")}):swal({title:"Send Join Request?",text:"This is a closed competition so the owner must approve your request",type:"warning",showCancelButton:!0,confirmButtonText:"Send Request",cancelButtonText:"Nevermind",closeOnConfirm:!1,closeOnCancel:!0},function(){n.addPlayerToPyramidRequest(S.pyramid,e).then(function(){S.currentUserIsPending=!0}),swal("Request Sent","You will receive an email once the owner processes the request.","success")})}else i.warning("Sorry, this pyramid is full");else t.go("login")}function P(){swal({title:"Leave Pyramid?",text:"You will lose your spot and forfeit any active challenges.",type:"error",showCancelButton:!0,confirmButtonText:"Yes, leave",confirmButtonClass:"btn-danger",cancelButtonText:"No, stay",closeOnConfirm:!1,closeOnCancel:!0},function(){w(),swal("OK, you'r out!","You've been removed from the pyramid.","success")})}function w(){o.isAuthenticated()&&S.currentUserIsOnPyramid&&($=!0,S.hasActiveChallenge?v(null,!0,S.currentUserPlayer):(S.currentUserIsOnPyramid=!1,S.hasActiveChallenge=!1,n.getPyramid(S.competitionId).then(function(e){var t=e.data,r=S.currentUserPlayer.position;_.forEach(t.players,function(e){e.position>=r&&(e.position-=1)});for(var i=_.remove(t.players,function(e){return e._id===S.currentUserPlayer._id}),o=[],a=0;a<S.numberOfRealPlayers-1;++a){var l={_id:t.players[a]._id,firstName:t.players[a].firstName,lastName:t.players[a].lastName,position:t.players[a].position};o.push(l)}n.removedPlayerFromPyramid(S.competitionId,i[0],o).then(function(){$=!1})})))}function C(){n.getPyramid(S.competitionId).then(function(e){S.pyramid=e.data,c(),s(),d(),p(),m()})}var I=10,S=this;S.pyramid={},S.breakPoints=[],S.levels=[],S.numberOfBlocks=0,S.currentUserIsOnPyramid=!1,S.currentUserIsPending=!1,S.currentUserIsOwner=!1,S.hasActiveChallenge=!1,S.availableChallenges=!1,S.createChallenge=y,S.completeChallenge=v,S.challengeExpired=g,S.currentUserPlayer={},S.pyramidMenuToggle=!1,S.addCurrentUserToPyramid=h,S.confirmRemoveCurrentUserFromPyramid=P,S.numberOfRealPlayers=0,S.maxPlayers=0,l();var $=!1;e.$on("ws:challenge_created",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:challenge_completed",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),$||C())}),e.$on("ws:player_added",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:player_removed",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())}),e.$on("ws:pyramid_updated",function(e,t){S.competitionId===t.competitionId&&(i.info(t.description),C())})}t.$inject=["$scope","$state","pyramidsService","$filter","notifyService","identityService","challengesService"],angular.module("app").directive("kpPyramid",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{pyramid:"="},templateUrl:"/pyramids/components/update-players.html"};return e}function t(e,t,n,r,i){function o(){p.pyramid&&a(p.pyramid)}function a(e){e.players=n("orderBy")(e.players,"position")}function l(){_.forEach(d,function(e){i.deleteActiveChallengeByCompetitionByPlayer(p.pyramid._id,e._id)}),r.updatePyramid(p.pyramid)}function c(){r.getPyramid(p.pyramid._id).then(function(e){p.pyramid=e.data})}function s(){var e=1;_.forEach(p.pyramid.players,function(t){t.position=e,++e})}function u(e,t){d.push(e),p.pyramid.players.splice(t,1),s()}var d=[],p=this;p.updatePyramid=l,p.cancelUpdate=c,p.reorderPlayers=s,p.removePlayer=u,o()}t.$inject=["$scope","$state","$filter","pyramidsService","challengesService"],angular.module("app").directive("kpUpdatePlayers",e)}(),function(){"use strict";function e(e){function t(t){return e.get("/api/pyramid",{params:{competitionId:t}})}function n(t){return e.get("/api/pyramids/user",{params:{userId:t}})}function r(){return e.get("/api/pyramids")}function i(t){return e.post("/api/pyramids/create",{pyramid:t})}function o(t){return e.post("/api/pyramids/update",{pyramid:t})}function a(t,n,r){return e.post("/api/pyramids/swapPositions",{competitionId:t,challenger:n,opponent:r})}function l(t,n){return e.post("/api/pyramids/addPlayer",{competitionId:t,player:n})}function c(t,n){return e.post("/api/pyramids/addPlayerRequest",{competition:t,player:n})}function s(t,n,r){return e.post("/api/pyramids/removePlayer",{competitionId:t,removedPlayer:n,players:r})}function u(t,n){return e.post("/api/pyramids/approvePlayer",{competitionId:t,player:n})}function d(t,n){return e.post("/api/pyramids/denyPlayer",{competitionId:t,player:n})}var p={getPyramid:t,getPyramidsForUser:n,getPyramids:r,createPyramid:i,updatePyramid:o,swapPositions:a,addPlayerToPyramid:l,addPlayerToPyramidRequest:c,removedPlayerFromPyramid:s,approvePendingPlayer:u,denyPendingPlayer:d};return p}e.$inject=["$http"],angular.module("app").factory("pyramidsService",e)}(),function(){"use strict";function e(e,t,n,r,i,o,a,l){function c(){n.competitionId?(d.competitionId=n.competitionId,s()):t.go("pyramids.myPyramids")}function s(){i.getPyramid(d.competitionId).then(function(e){e.data&&_.some(e.data.owners,["_id",a.currentUser._id])?d.pyramid=e.data:t.go("pyramids.myPyramids")})}function u(){i.getPyramid(d.competitionId).then(function(e){var t=e.data;t.open=d.pyramid.open,i.updatePyramid(t)})}var d=this;d.competitionId=null,d.updatePyramidOpenStatus=u,c(),e.$on("ws:challenge_completed",function(e,t){d.competitionId===t.competitionId&&(l.info(t.description),s())}),e.$on("ws:player_added",function(e,t){d.competitionId===t.competitionId&&(l.info(t.description),s())}),e.$on("ws:player_removed",function(e,t){d.competitionId===t.competitionId&&(l.info(t.description),s())}),e.$on("ws:pyramid_updated",function(e,t){d.competitionId===t.competitionId&&(l.info(t.description),s())})}e.$inject=["$scope","$state","$stateParams","$filter","pyramidsService","challengesService","identityService","notifyService"],angular.module("app").controller("AdminCtrl",e)}(),function(){"use strict";function e(e,t,n,r,i){function o(){t.getAllUsers().then(function(e){p.availablePlayers=e.data});for(var e=0;e<d;e++)u.push(e*(e+1)/2+1)}function a(e){e.position=p.addedPlayers.length+1,p.addedPlayers.push(_.remove(p.availablePlayers,{_id:e._id})[0])}function l(e){p.availablePlayers.push(_.remove(p.addedPlayers,{_id:e._id})[0])}function c(){var e=1;_.forEach(p.addedPlayers,function(t){t.position=e,++e})}function s(t){angular.forEach(p.addedPlayers,function(e){m+=1;var n={position:m,_id:e._id,email:e.username,firstName:e.firstName,lastName:e.lastName};t.players.push(n)}),t.owners=[{_id:i.currentUser._id,email:i.currentUser.username,firstName:i.currentUser.firstName,lastName:i.currentUser.lastName}];for(var r=0;r<u.length;r++)if(t.players.length<u[r]){t.levels=r;break}n.createPyramid(t).then(function(t){e.go("pyramids.view",{competitionId:t.data._id})})}var u=[],d=10,p=this;p.newPyramid={players:[],open:!1},p.availablePlayers=[],p.addedPlayers=[],p.createPyramid=s,p.addPlayer=a,p.removePlayer=l,p.reorderPlayers=c,p.newPyramid.forfeitDays=1,o();var m=0}e.$inject=["$state","userService","pyramidsService","notifyService","identityService"],angular.module("app").controller("CreatePyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("MyPyramidsCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){t.competitionId&&(i.competitionId=t.competitionId,n.getPyramid(i.competitionId).then(function(t){t.data?i.pyramid=t.data:e.go("pyramids.myPyramids")}))}var i=this;i.competitionId=null,i.pyramid=null,r()}e.$inject=["$state","$stateParams","pyramidsService"],angular.module("app").controller("PyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("PyramidsCtrl",e)}(),function(){"use strict";function e(e,t,n){function r(){e.competitionId&&(i.competitionId=e.competitionId,n.getPyramid(i.competitionId).then(function(e){e.data?i.pyramid=e.data:t.go("pyramids.myPyramids")}))}var i=this;i.competitionId=null,i.pyramid=null,r()}e.$inject=["$stateParams","$state","pyramidsService"],angular.module("app").controller("StatsCtrl",e)}(),function(){"use strict";function e(e){function t(t,n,r){var i=r.scrollaxis||"y",o=r.theme||"minimal-dark",a=r.mousewheelaxis||"y";$("html").hasClass("ismobile")||e.malihuScroll(n,o,i,a)}var n={restrict:"C",link:t};return n}e.$inject=["scrollbarService"],angular.module("app").directive("cOverflow",e)}(),function(){"use strict";function e(){function e(e,t){t.click(function(){t.next().slideToggle(200),t.parent().toggleClass("toggled")})}var t={restrict:"A",link:e};return t}angular.module("app").directive("toggleSubmenu",e)}(),function(){"use strict";function e(){function e(e,t){t.hasClass("btn-icon")||t.hasClass("btn-float")?Waves.attach(t,["waves-circle"]):t.hasClass("btn-light")?Waves.attach(t,["waves-light"]):Waves.attach(t),Waves.init()}var t={restrict:"C",link:e};return t}angular.module("app").directive("wavesEffect",e)}(),function(){"use strict";function e(){function e(e,t){var n=t.children().first(),r=t.parent().hasClass("fg-float");n.focus(function(){t.addClass("fg-toggled")}),n.blur(function(){(!r||r&&0===n.val().length)&&t.removeClass("fg-toggled")})}var t={restrict:"C",link:e};return t}angular.module("app").directive("fgLine",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiYXBwLmNvbnRyb2xsZXIuanMiLCJhcHAucm91dGVzLmpzIiwiYXBwLnJ1bi5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL2F1dGguc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL3VzZXIuc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3ZpZXdzL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJhdXRoZW50aWNhdGlvbi92aWV3cy9yZWdpc3Rlci5jb250cm9sbGVyLmpzIiwiYXV0aGVudGljYXRpb24vdmlld3MvdmVyaWZpY2F0aW9uLmNvbnRyb2xsZXIuanMiLCJjaGFsbGVuZ2VzL2NvbXBvbmVudHMvYWN0aXZlLWNoYWxsZW5nZXMuZGlyZWN0aXZlLmpzIiwiY2hhbGxlbmdlcy9jb21wb25lbnRzL2NvbXBsZXRlZC1jaGFsbGVuZ2VzLmRpcmVjdGl2ZS5qcyIsImNoYWxsZW5nZXMvY29tcG9uZW50cy9wbGF5ZXItb3ZlcmFsbC1yZXN1bHRzLmRpcmVjdGl2ZS5qcyIsImNoYWxsZW5nZXMvc2VydmljZXMvY2hhbGxlbmdlcy5zZXJ2aWNlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvZm9vdGVyLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL2hlYWRlci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy9zaWRlYmFyLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9maWx0ZXJzL29yZGVyLW9iamVjdC1ieS5maWx0ZXIuanMiLCJjb21tb24vc2VydmljZXMvaW5kZW50aXR5LnNlcnZpY2UuanMiLCJjb21tb24vc2VydmljZXMvbm90aWZ5LnNlcnZpY2UuanMiLCJjb21tb24vc2VydmljZXMvc2Nyb2xsYmFyLnNlcnZpY2UuanMiLCJjb21tb24vc2VydmljZXMvc2lkZWJhci5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3dlYnNvY2tldC5zZXJ2aWNlLmpzIiwiY29tbW9uL3ZpZXdzL2hvbWUuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL2NvbXBvbmVudHMvcGVuZGluZy1wbGF5ZXJzLmRpcmVjdGl2ZS5qcyIsInB5cmFtaWRzL2NvbXBvbmVudHMvcHlyYW1pZC1jb21wYWN0LmRpcmVjdGl2ZS5qcyIsInB5cmFtaWRzL2NvbXBvbmVudHMvcHlyYW1pZC5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy9jb21wb25lbnRzL3VwZGF0ZS1wbGF5ZXJzLmRpcmVjdGl2ZS5qcyIsInB5cmFtaWRzL3NlcnZpY2VzL3B5cmFtaWRzLnNlcnZpY2UuanMiLCJweXJhbWlkcy92aWV3cy9hZG1pbi5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvY3JlYXRlLXB5cmFtaWQuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL215LXB5cmFtaWRzLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy92aWV3cy9weXJhbWlkLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy92aWV3cy9weXJhbWlkcy5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3Mvc3RhdHMuY29udHJvbGxlci5qcyIsImNvbW1vbi9jb21wb25lbnRzL3VpL3Njcm9sbGJhci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS90b2dnbGUtc3VibWVudS5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS93YXZlcy5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS9mb3Jtcy9mZy1saW5lLmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlndXJhdGlvbiIsIiRodHRwUHJvdmlkZXIiLCIkdWliVG9vbHRpcFByb3ZpZGVyIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiZ2V0Iiwib3B0aW9ucyIsImFwcGVuZFRvQm9keSIsImNvbmZpZyIsIkFwcEN0cmwiLCIkc3RhdGUiLCJsb2NhbFN0b3JhZ2VTZXJ2aWNlIiwidG9nZ2xlU2lkZWJhckxvY2tlZCIsImxvY2tlZCIsInNldCIsImFwcEN0cmwiLCJ0aGlzIiwibG9ja1NpZGViYXIiLCJjb250cm9sbGVyIiwiY29uZmlndXJlUm91dGVzIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsInJvdXRlUm9sZUNoZWNrcyIsInN1cGVyQWRtaW4iLCJyZXF1aXJlU3VwZXJBZG1pbiIsImFkbWluIiwicmVxdWlyZUFkbWluIiwidXNlciIsInJlcXVpcmVBdXRoIiwiaHRtbDVNb2RlIiwib3RoZXJ3aXNlIiwid2hlbiIsInN0YXRlIiwidXJsIiwidmlld3MiLCJjb250ZW50IiwiY29udHJvbGxlckFzIiwidGVtcGxhdGVVcmwiLCJjb250ZW50QCIsInJlc29sdmUiLCJhdXRoIiwiYXV0aFNlcnZpY2UiLCJhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlIiwiYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSIsIiRpbmplY3QiLCJhcHBSdW4iLCIkcm9vdFNjb3BlIiwic2lkZWJhclNlcnZpY2UiLCIkb24iLCJldmVudCIsInRvU3RhdGUiLCJ0b1BhcmFtcyIsImZyb21TdGF0ZSIsImZyb21QYXJhbXMiLCJlcnJvciIsImdvIiwicHJldmlvdXMiLCJwcmV2UGFyYW1zIiwic2V0U2lkZWJhclN0YXR1cyIsInJ1biIsIiRodHRwIiwiJHEiLCJ1c2VyU2VydmljZSIsImlkZW50aXR5U2VydmljZSIsIm5vdGlmeVNlcnZpY2UiLCJhdXRoZW50aWNhdGVVc2VyIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsImRmZCIsImRlZmVyIiwicG9zdCIsInRoZW4iLCJyZXNwb25zZSIsImRhdGEiLCJzdWNjZXNzIiwiY3VycmVudFVzZXIiLCJtZXNzYWdlIiwicHJvbWlzZSIsImNyZWF0ZVVzZXIiLCJ1c2VyRGF0YSIsInJlYXNvbiIsImxvZ291dCIsInVuZGVmaW5lZCIsInJvbGUiLCJpc0F1dGhvcml6ZWQiLCJyZWplY3QiLCJpc0F1dGhlbnRpY2F0ZWQiLCJzZXJ2aWNlIiwiZmFjdG9yeSIsImdldEFsbFVzZXJzIiwidXNlcnMiLCJ2ZXJpZnlVc2VyIiwidXNlcklkIiwidmVyaWZpY2F0aW9uVG9rZW4iLCJwYXJhbXMiLCJMb2dpbkN0cmwiLCJhY3RpdmF0ZSIsImxvZ2luIiwidm0iLCJSZWdpc3RlckN0cmwiLCJyZWdpc3RlciIsIm5ld1VzZXIiLCJjb25maXJtUGFzc3dvcmQiLCJWZXJpZmljYXRpb25DdHJsIiwiJHN0YXRlUGFyYW1zIiwidmVyaWZ5aW5nIiwidmVyaWZpZWQiLCJrcEFjdGl2ZUNoYWxsZW5lZ2VzIiwiZGlyZWN0aXZlIiwiYmluZFRvQ29udHJvbGxlciIsImN0cmxGdW5jIiwicmVzdHJpY3QiLCJzY29wZSIsImNvbXBldGl0aW9uSWQiLCIkc2NvcGUiLCJjaGFsbGVuZ2VzU2VydmljZSIsImdldEFjdGl2ZUNoYWxsZW5nZXMiLCJjaGFsbGVuZ2VzIiwiZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24iLCJsZW5ndGgiLCJfIiwiZm9yRWFjaCIsImNoYWxsZW5nZSIsInRpbWVMaW1pdCIsImV4cGlyZXMiLCJtb21lbnQiLCJkaWZmIiwiY3JlYXRlZCIsImFkZCIsImNoYWxsZW5nZURldGFpbHMiLCJrcENvbXBsZXRlZENoYWxsZW5lZ2VzIiwibGltaXQiLCJnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzIiwiZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24iLCJsb3NlciIsIndpbm5lciIsIndoZW5Db21wbGV0ZWQiLCJjb21wbGV0ZWQiLCJjYWxlbmRhciIsInNhbWVEYXkiLCJuZXh0RGF5IiwibmV4dFdlZWsiLCJsYXN0RGF5IiwibGFzdFdlZWsiLCJzYW1lRWxzZSIsImtwUGxheWVyT3ZlcmFsbFJlc3VsdHMiLCJwbGF5ZXIiLCJnZXRQbGF5ZXJPdmVyYWxsUmVzdWx0cyIsIl9pZCIsInBsYXllcklkIiwiZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb24iLCJyZXN1bHRzIiwiYnJlYWtQb2ludHMiLCJpIiwibWF4TGV2ZWxzIiwicHVzaCIsImxldmVsIiwiaiIsInBvc2l0aW9uIiwiaW5kZXhPZiIsInN0cmVha1R5cGUiLCJzdHJlYWsiLCJjb250aW51ZVN0cmVhayIsImNoYWxsZW5nZXIiLCJvcHBvbmVudCIsInR5cGUiLCJ2YWx1ZSIsIndpbnMiLCJhc09wcG9uZW50Iiwic2l6ZSIsImZpbHRlciIsImFzQ2hhbGxlbmdlciIsInRvdGFsIiwiYnlGb3JmZWl0IiwiZm9yZmVpdCIsImxvc2VzIiwiY2hhbGxlbmdlcklkIiwiaW5mbyIsImRlc2NyaXB0aW9uIiwib3Bwb25lbnRJZCIsImNyZWF0ZUNoYWxsZW5nZSIsImNvbXBsZXRlQ2hhbGxlbmdlIiwiZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb24iLCJnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIiLCJkZWxldGVBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIiLCJkZWxldGUiLCJrcEZvb3RlciIsImluZGVudGl0eSIsImtwSGVhZGVyIiwidG9nZ2xlU2lkZWJhciIsInNpZGViYXJTdGF0dXMiLCJsZWZ0IiwiZ2V0U2lkZWJhclN0YXR1cyIsImtwU2lkZWJhciIsIm9yZGVyT2JqZWN0QnkiLCJpbnB1dCIsImF0dHJpYnV0ZSIsImlzT2JqZWN0IiwiYXJyYXkiLCJvYmplY3RLZXkiLCJzb3J0IiwiYSIsImIiLCJwYXJzZUludCIsIiR3aW5kb3ciLCJyb2xlcyIsImJvb3RzdHJhcHBlZFVzZXJPYmplY3QiLCJ0YXJnZXQiLCIkIiwibm90aWZ5Iiwid2FybmluZyIsImludmVyc2UiLCJub3RpZnlEZWZhdWx0cyIsIm5ld2VzdF9vbl90b3AiLCJvZmZzZXQiLCJ4IiwieSIsInNjcm9sbGJhclNlcnZpY2UiLCJtYWxpaHVTY3JvbGwiLCJzZWxlY3RvciIsInRoZW1lIiwic2Nyb2xsYXhpcyIsIm1vdXNld2hlZWxheGlzIiwibUN1c3RvbVNjcm9sbGJhciIsInNjcm9sbEluZXJ0aWEiLCJheGlzIiwibW91c2VXaGVlbCIsImVuYWJsZSIsInByZXZlbnREZWZhdWx0Iiwic3RhdHVzIiwicmlnaHQiLCJ3ZWJzb2NrZXRIb3N0IiwibG9jYXRpb24iLCJwcm90b2NvbCIsImhvc3QiLCJjb25uZWN0aW9uIiwiY29ubmVjdCIsIldlYlNvY2tldCIsIm9ubWVzc2FnZSIsImUiLCJwYXlsb2FkIiwiSlNPTiIsInBhcnNlIiwiJGJyb2FkY2FzdCIsInRvcGljIiwic2VuZCIsImpzb24iLCJzdHJpbmdpZnkiLCJ3ZWJzb2NrZXRTZXJ2aWNlIiwiSG9tZUN0cmwiLCJrcFBlbmRpbmdQbGF5ZXJzIiwicHlyYW1pZHNTZXJ2aWNlIiwiZ2V0UGVuZGluZ1BsYXllcnMiLCJwZW5kaW5nUGxheWVycyIsImdldFB5cmFtaWQiLCJweXJhbWlkIiwiYXBwcm92ZVBlbmRpbmdQbGF5ZXIiLCJwbGF5ZXJzIiwiZGVueVBlbmRpbmdQbGF5ZXIiLCJrcFB5cmFtaWRDb21wYWN0IiwiZ2V0UHlyYW1pZHNGb3JVc2VyIiwicHlyYW1pZHMiLCJnZXRQeXJhbWlkcyIsImtwUHlyYW1pZCIsInJlcGxhY2UiLCIkZmlsdGVyIiwibWF4UGxheWVycyIsIm9yZGVyUGxheWVycyIsImdldFBsYXllcnNTdGF0dXMiLCJhc3NpZ25MZXZlbHNUb1BsYXllcnMiLCJjYWxjdWxhdGVQeXJhbWlkQmxvY2tzIiwiZmlsbEluRW1wdHlCbG9ja3MiLCJjdXJyZW50VXNlcklzT3duZXIiLCJzb21lIiwib3duZXJzIiwiY3VycmVudFVzZXJJc09uUHlyYW1pZCIsImNsYXNzIiwiY3VycmVudFVzZXJQbGF5ZXIiLCJoYXNBY3RpdmVDaGFsbGVuZ2UiLCJjdXJyZW50VXNlcklzUGVuZGluZyIsImZpbmQiLCJ0aW1lVG9FeHBpcmUiLCJmaW5kQXZhaWxhYmxlQ2hhbGxlbmdlcyIsImNyZWF0ZUJyZWFrUG9pbnRzIiwibGV2ZWxzIiwibnVtYmVyT2ZCbG9ja3MiLCJsYXN0IiwibnVtYmVyT2ZSZWFsUGxheWVycyIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwibGV2ZWxBYm92ZSIsImF2YWlsYWJsZUNoYWxsZW5nZXMiLCJhdmFpbGFibGUiLCJjb21wZXRpdGlvbk5hbWUiLCJuYW1lIiwiY29tcGxldGUiLCJmb3JmZWl0RGF5cyIsImVtYWlsIiwicHlyYW1pZE1lbnVUb2dnbGUiLCJ3aW5uZXJJc0N1cnJlbnRVc2VyIiwiZm9yZmVpdExvc2VyIiwic3dhcFBvc2l0aW9ucyIsInJlbW92aW5nQ3VycmVudFVzZXIiLCJyZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkIiwiY2hhbGxlbmdlRXhwaXJlZCIsImFkZEN1cnJlbnRVc2VyVG9QeXJhbWlkIiwib3BlbiIsInN3YWwiLCJ0aXRsZSIsInRleHQiLCJzaG93Q2FuY2VsQnV0dG9uIiwiY29uZmlybUJ1dHRvblRleHQiLCJjYW5jZWxCdXR0b25UZXh0IiwiY2xvc2VPbkNvbmZpcm0iLCJjbG9zZU9uQ2FuY2VsIiwiYWRkUGxheWVyVG9QeXJhbWlkIiwiYWRkUGxheWVyVG9QeXJhbWlkUmVxdWVzdCIsImNvbmZpcm1SZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkIiwiY29uZmlybUJ1dHRvbkNsYXNzIiwicCIsIm9wZW5Qb3NpdGlvbiIsInJlbW92ZWRQbGF5ZXIiLCJyZW1vdmUiLCJ1cGRhdGVkUGxheWVycyIsInVwZGF0ZWRQbGF5ZXIiLCJyZW1vdmVkUGxheWVyRnJvbVB5cmFtaWQiLCJyZWZyZXNoUHlyYW1pZCIsImRldGFpbHMiLCJrcFVwZGF0ZVBsYXllcnMiLCJyZW5kZXJQbGF5ZXJzIiwidXBkYXRlUHlyYW1pZCIsInJlbW92ZWRQbGF5ZXJzIiwiY2FuY2VsVXBkYXRlIiwicmVvcmRlclBsYXllcnMiLCJyZW1vdmVQbGF5ZXIiLCJwbGF5ZXJJbmRleCIsInNwbGljZSIsImNyZWF0ZVB5cmFtaWQiLCJjb21wZXRpdGlvbiIsIkFkbWluQ3RybCIsInVwZGF0ZVB5cmFtaWRPcGVuU3RhdHVzIiwidXBkYXRlZFB5cmFtaWQiLCJDcmVhdGVQeXJhbWlkQ3RybCIsImF2YWlsYWJsZVBsYXllcnMiLCJhZGRQbGF5ZXIiLCJhZGRlZFBsYXllcnMiLCJuZXdQeXJhbWlkIiwiTXlQeXJhbWlkc0N0cmwiLCJQeXJhbWlkQ3RybCIsIlB5cmFtaWRzQ3RybCIsIlN0YXRzQ3RybCIsImNPdmVyZmxvdyIsImxpbmtGdW5jIiwiZWxlbWVudCIsImF0dHJzIiwiaGFzQ2xhc3MiLCJsaW5rIiwidG9nZ2xlU3VibWVudSIsImVsIiwiY2xpY2siLCJuZXh0Iiwic2xpZGVUb2dnbGUiLCJwYXJlbnQiLCJ0b2dnbGVDbGFzcyIsIndhdmVzRWZmZWN0IiwiV2F2ZXMiLCJhdHRhY2giLCJpbml0IiwiZmdMaW5lIiwiY2hpbGRyZW4iLCJmaXJzdCIsImlzRmxvYXRMYWJlbCIsImZvY3VzIiwiYWRkQ2xhc3MiLCJibHVyIiwidmFsIiwicmVtb3ZlQ2xhc3MiXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFBQyxPQUFBLE9BQ0EsWUFDQSxlQUNBLFlBQ0Esc0JBQ0EsYUFDQSx3QkFDQSxRQUNBLHFCQUNBLDBCQ1RBLHdCQUlBLFNBQUFDLEdBQUFDLEVBQUFDLEdBRUFELEVBQUFFLFNBQUFDLFFBQUFDLE1BQ0FKLEVBQUFFLFNBQUFDLFFBQUFDLFFBR0FKLEVBQUFFLFNBQUFDLFFBQUFDLElBQUEscUJBQUEsZ0NBRUFKLEVBQUFFLFNBQUFDLFFBQUFDLElBQUEsaUJBQUEsV0FDQUosRUFBQUUsU0FBQUMsUUFBQUMsSUFBQSxPQUFBLFdBRUFILEVBQUFJLFNBQUFDLGNBQUEsc0RBYkFULFFBQUFDLE9BQUEsT0FBQVMsT0FBQVIsTUNGQSx1QkFJQSxTQUFBUyxHQUFBQyxFQUFBQyxHQVFBLFFBQUFDLEdBQUFDLEdBQ0FGLEVBQUFHLElBQUEsZ0JBQUFELEdBUkEsR0FBQUUsR0FBQUMsSUFFQUQsR0FBQUwsT0FBQUEsRUFFQUssRUFBQUUsWUFBQU4sRUFBQU4sSUFBQSxpQkFDQVUsRUFBQUgsb0JBQUFBLDZDQVJBZCxRQUFBQyxPQUFBLE9BQUFtQixXQUFBLFVBQUFULE1DRkEsdUJBSUEsU0FBQVUsR0FBQUMsRUFBQUMsRUFBQUMsR0FDQSxHQUFBQyxJQUNBQyxXQUFBQyxFQUNBQyxN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ci5tb2R1bGUoJ2FwcCcsIFtcbiAgJ3VpLnJvdXRlcicsXG4gICd1aS5ib290c3RyYXAnLFxuICAnbmdBbmltYXRlJyxcbiAgJ2FuZ3VsYXItbG9hZGluZy1iYXInLFxuICAnbm91aXNsaWRlcicsXG4gICdsb2NhbHl0aWNzLmRpcmVjdGl2ZXMnLFxuICAndGltZXInLFxuICAnTG9jYWxTdG9yYWdlTW9kdWxlJyxcbiAgJ2FuZ3VsYXItc29ydGFibGUtdmlldydcbl0pOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0ICc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb25maWcoY29uZmlndXJhdGlvbik7XG5cbiAgZnVuY3Rpb24gY29uZmlndXJhdGlvbigkaHR0cFByb3ZpZGVyLCAkdWliVG9vbHRpcFByb3ZpZGVyKSB7XG4gICAgLy9pbml0aWFsaXplIGdldCBpZiBub3QgdGhlcmVcbiAgICBpZiAoISRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXQpIHtcbiAgICAgICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXQgPSB7fTsgICAgXG4gICAgfSAgICBcbiAgICAvL2Rpc2FibGUgSUUgYWpheCByZXF1ZXN0IGNhY2hpbmdcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0WydJZi1Nb2RpZmllZC1TaW5jZSddID0gJ0ZyaSwgMDEgSmFuIDIwMTYgMDU6MDA6MDAgR01UJztcbiAgICAvLyBleHRyYVxuICAgICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXRbJ0NhY2hlLUNvbnRyb2wnXSA9ICduby1jYWNoZSc7XG4gICAgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldFsnUHJhZ21hJ10gPSAnbm8tY2FjaGUnO1xuXG4gICAgJHVpYlRvb2x0aXBQcm92aWRlci5vcHRpb25zKHsgYXBwZW5kVG9Cb2R5OiB0cnVlIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0FwcEN0cmwnLCBBcHBDdHJsKTtcblxuICBmdW5jdGlvbiBBcHBDdHJsKCRzdGF0ZSwgbG9jYWxTdG9yYWdlU2VydmljZSkge1xuICAgIHZhciBhcHBDdHJsID0gdGhpcztcbiAgICAvLyBVc2UgdGhpcyBmb3IgU2lkZWJhciBtZW51XG4gICAgYXBwQ3RybC4kc3RhdGUgPSAkc3RhdGU7XG4gICAgLy8gTG9jayB0aGUgc2lkZWJhciBpbiB2aWV3XG4gICAgYXBwQ3RybC5sb2NrU2lkZWJhciA9IGxvY2FsU3RvcmFnZVNlcnZpY2UuZ2V0KCdzaWRlYmFyTG9ja2VkJyk7XG4gICAgYXBwQ3RybC50b2dnbGVTaWRlYmFyTG9ja2VkID0gdG9nZ2xlU2lkZWJhckxvY2tlZDtcblxuICAgIGZ1bmN0aW9uIHRvZ2dsZVNpZGViYXJMb2NrZWQobG9ja2VkKSB7XG4gICAgICBsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCgnc2lkZWJhckxvY2tlZCcsIGxvY2tlZCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbmZpZyhjb25maWd1cmVSb3V0ZXMpO1xuXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyZVJvdXRlcygkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgIHZhciByb3V0ZVJvbGVDaGVja3MgPSB7XG4gICAgICBzdXBlckFkbWluOiByZXF1aXJlU3VwZXJBZG1pbixcbiAgICAgIGFkbWluOiByZXF1aXJlQWRtaW4sXG4gICAgICB1c2VyOiByZXF1aXJlQXV0aFxuICAgIH07XG5cbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG5cbiAgICAvLyBmb3IgYW55IHVubWF0Y2hlZCB1cmxcbiAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG5cbiAgICAkdXJsUm91dGVyUHJvdmlkZXIud2hlbignL3B5cmFtaWRzLycsICcvcHlyYW1pZHMnKTtcblxuICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAuc3RhdGUoJ2hvbWUnLCB7XG4gICAgICAgIHVybDogJy8nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tbW9uL3ZpZXdzL2hvbWUuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcycsIHtcbiAgICAgICAgdXJsOiAnL3B5cmFtaWRzJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQeXJhbWlkc0N0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9weXJhbWlkcy5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLm15UHlyYW1pZHMnLCB7XG4gICAgICAgIHVybDogJy9teS1weXJhbWlkcycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ015UHlyYW1pZHNDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvbXktcHlyYW1pZHMuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICBhdXRoOiByb3V0ZVJvbGVDaGVja3MudXNlclxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMudmlldycsIHtcbiAgICAgICAgdXJsOiAnL3ZpZXcvOmNvbXBldGl0aW9uSWQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQeXJhbWlkQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL3B5cmFtaWQuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy5zdGF0cycsIHtcbiAgICAgICAgdXJsOiAnL3N0YXRzLzpjb21wZXRpdGlvbklkJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3RhdHNDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3Mvc3RhdHMuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy5hZG1pbicsIHtcbiAgICAgICAgdXJsOiAnL2FkbWluLzpjb21wZXRpdGlvbklkJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQWRtaW5DdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvYWRtaW4uaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICBhdXRoOiByb3V0ZVJvbGVDaGVja3MudXNlclxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMuY3JlYXRlJywge1xuICAgICAgICB1cmw6ICcvY3JlYXRlJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQ3JlYXRlUHlyYW1pZEN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdweXJhbWlkcy92aWV3cy9jcmVhdGUtcHlyYW1pZC5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIGF1dGg6IHJvdXRlUm9sZUNoZWNrcy51c2VyXG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdsb2dpbicsIHtcbiAgICAgICAgdXJsOiAnL2xvZ2luJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwnLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoZW50aWNhdGlvbi92aWV3cy9sb2dpbi5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3JlZ2lzdGVyJywge1xuICAgICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL3JlZ2lzdGVyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgndmVyaWZ5Jywge1xuICAgICAgICB1cmw6ICcvdmVyaWZpY2F0aW9uJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWZXJpZmljYXRpb25DdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvdmVyaWZpY2F0aW9uLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgndmVyaWZpY2F0aW9uJywge1xuICAgICAgICB1cmw6ICcvdmVyaWZpY2F0aW9uLzp1c2VySWQvOnZlcmlmaWNhdGlvblRva2VuJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWZXJpZmljYXRpb25DdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvdmVyaWZpY2F0aW9uLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgfVxuXG4gIHJlcXVpcmVBZG1pbi4kaW5qZWN0ID0gWydhdXRoU2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIHJlcXVpcmVBZG1pbihhdXRoU2VydmljZSkge1xuICAgIHJldHVybiBhdXRoU2VydmljZS5hdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlKCdhZG1pbicpO1xuICB9XG5cbiAgcmVxdWlyZVN1cGVyQWRtaW4uJGluamVjdCA9IFsnYXV0aFNlcnZpY2UnXTtcblxuICBmdW5jdGlvbiByZXF1aXJlU3VwZXJBZG1pbihhdXRoU2VydmljZSkge1xuICAgIHJldHVybiBhdXRoU2VydmljZS5hdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlKCdzdXBlci1hZG1pbicpO1xuICB9XG5cbiAgcmVxdWlyZUF1dGguJGluamVjdCA9IFsnYXV0aFNlcnZpY2UnXTtcblxuICBmdW5jdGlvbiByZXF1aXJlQXV0aChhdXRoU2VydmljZSkge1xuICAgIHJldHVybiBhdXRoU2VydmljZS5hdXRoZW50aWNhdGVkVXNlckZvclJvdXRlKCk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykucnVuKGFwcFJ1bik7XG5cbiAgZnVuY3Rpb24gYXBwUnVuKCRyb290U2NvcGUsICRzdGF0ZSwgc2lkZWJhclNlcnZpY2UpIHtcbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlRXJyb3InLCBmdW5jdGlvbiAoZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMsIGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgPT09ICdub3QgYXV0aG9yaXplZCcpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgICAkc3RhdGUucHJldmlvdXMgPSB0b1N0YXRlO1xuICAgICAgICAkc3RhdGUucHJldlBhcmFtcyA9IHRvUGFyYW1zO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKCkge1xuICAgICAgc2lkZWJhclNlcnZpY2Uuc2V0U2lkZWJhclN0YXR1cyhmYWxzZSk7XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnYXV0aFNlcnZpY2UnLCBhdXRoU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gYXV0aFNlcnZpY2UoJHN0YXRlLCAkaHR0cCwgJHEsIHVzZXJTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UsIG5vdGlmeVNlcnZpY2UpIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGF1dGhlbnRpY2F0ZVVzZXI6IGF1dGhlbnRpY2F0ZVVzZXIsXG4gICAgICBjcmVhdGVVc2VyOiBjcmVhdGVVc2VyLFxuICAgICAgbG9nb3V0OiBsb2dvdXQsXG4gICAgICBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlOiBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlLFxuICAgICAgYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZTogYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZVxuICAgIH07XG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBhdXRoZW50aWNhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5wb3N0KCcvbG9naW4nLCB7XG4gICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcbiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyID0gcmVzcG9uc2UuZGF0YS51c2VyO1xuICAgICAgICAgIGRmZC5yZXNvbHZlKHRydWUpO1xuICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PT0gJ3VudmVyaWZpZWQnKSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUoJ3VudmVyaWZpZWQnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkZmQucmVzb2x2ZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVVzZXIodXNlckRhdGEpIHtcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xuICAgICAgJGh0dHAucG9zdCgnL2FwaS91c2VycycsIHtcbiAgICAgICAgdXNlckRhdGE6IHVzZXJEYXRhXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAgIGRmZC5yZXNvbHZlKHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRmZC5yZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnJlYXNvbiA9PT0gJ0Vycm9yOiBEdXBsaWNhdGUgVXNlcm5hbWUnKSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignU29ycnksIGFuIGFjY291bnQgYWxyZWFkeSBleGlzdHMgd2l0aCB0aGF0IGVtYWlsIGFkZHJlc3MuJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xuICAgICAgJGh0dHAucG9zdCgnL2xvZ291dCcsIHtcbiAgICAgICAgbG9nb3V0OiB0cnVlXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyID0gdW5kZWZpbmVkO1xuICAgICAgICBkZmQucmVzb2x2ZSgpO1xuICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUocm9sZSkge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhvcml6ZWQocm9sZSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJHEucmVqZWN0KCdub3QgYXV0aG9yaXplZCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUoKSB7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICRxLnJlamVjdCgnbm90IGF1dGhvcml6ZWQnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgndXNlclNlcnZpY2UnLCB1c2VyU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gdXNlclNlcnZpY2UoJGh0dHApIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGdldEFsbFVzZXJzOiBnZXRBbGxVc2VycyxcbiAgICAgIHZlcmlmeVVzZXI6IHZlcmlmeVVzZXJcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gZ2V0QWxsVXNlcnMoKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJykudGhlbihmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJzO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmVyaWZ5VXNlcih1c2VySWQsIHZlcmlmaWNhdGlvblRva2VuKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXIvdmVyaWZpY2F0aW9uJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICB1c2VySWQ6IHVzZXJJZCxcbiAgICAgICAgICB2ZXJpZmljYXRpb25Ub2tlbjogdmVyaWZpY2F0aW9uVG9rZW5cbiAgICAgICAgfVxuICAgICAgfSk7ICBcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTG9naW5DdHJsJywgTG9naW5DdHJsKTtcblxuICBmdW5jdGlvbiBMb2dpbkN0cmwoJHN0YXRlLCBhdXRoU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubG9naW4gPSBsb2dpbjtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmF1dGhlbnRpY2F0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAoIXJlc3BvbnNlKSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignVXNlcm5hbWUgLyBwYXNzd29yZCBjb21iaW5haXRvbiBpbmNvcnJlY3QnKTtcbiAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZSA9PT0gJ3VudmVyaWZpZWQnKSB7XG4gICAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignWW91IG11c3QgdmVyaWZ5IHlvdXIgZW1haWwgYmVmb3JlIHlvdSBjYW4gbG9naW4nKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoJHN0YXRlLnByZXZpb3VzKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJHN0YXRlLnByZXZpb3VzLCAkc3RhdGUucHJldlBhcmFtcyk7XG4gICAgICAgICAgICAkc3RhdGUucHJldmlvdXMgPSBudWxsO1xuICAgICAgICAgICAgJHN0YXRlLnByZXZQYXJhbXMgPSBudWxsO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBSZWdpc3RlckN0cmwpO1xuXG4gIGZ1bmN0aW9uIFJlZ2lzdGVyQ3RybCgkc3RhdGUsIGF1dGhTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5yZWdpc3RlciA9IHJlZ2lzdGVyO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge31cblxuICAgIGZ1bmN0aW9uIHJlZ2lzdGVyKG5ld1VzZXIpIHtcbiAgICAgIGlmIChuZXdVc2VyLnBhc3N3b3JkICE9PSBuZXdVc2VyLmNvbmZpcm1QYXNzd29yZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmVycm9yKCdQYXNzd29yZHMgZG9uXFwndCBtYXRjaCEnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF1dGhTZXJ2aWNlLmNyZWF0ZVVzZXIobmV3VXNlcikudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJHN0YXRlLmdvKCd2ZXJpZnknKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1ZlcmlmaWNhdGlvbkN0cmwnLCBWZXJpZmljYXRpb25DdHJsKTtcblxuICBmdW5jdGlvbiBWZXJpZmljYXRpb25DdHJsKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCB1c2VyU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0udmVyaWZpZWQgPSB1bmRlZmluZWQ7XG4gICAgdm0udmVyaWZ5aW5nID0gZmFsc2U7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBpZiAoJHN0YXRlUGFyYW1zLnVzZXJJZCAmJiAkc3RhdGVQYXJhbXMudmVyaWZpY2F0aW9uVG9rZW4pIHtcbiAgICAgICAgdm0udmVyaWZ5aW5nID0gdHJ1ZTtcbiAgICAgICAgdm0udmVyaWZpZWQgPSBudWxsO1xuICAgICAgICB1c2VyU2VydmljZS52ZXJpZnlVc2VyKCRzdGF0ZVBhcmFtcy51c2VySWQsICRzdGF0ZVBhcmFtcy52ZXJpZmljYXRpb25Ub2tlbikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAgICAgdm0udmVyaWZpZWQgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2bS52ZXJpZmllZCA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcEFjdGl2ZUNoYWxsZW5lZ2VzJywga3BBY3RpdmVDaGFsbGVuZWdlcyk7XG5cbiAgZnVuY3Rpb24ga3BBY3RpdmVDaGFsbGVuZWdlcygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6ICdAJ1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NoYWxsZW5nZXMvY29tcG9uZW50cy9hY3RpdmUtY2hhbGxlbmdlcy5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUsIGNoYWxsZW5nZXNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jaGFsbGVuZ2VzID0gW107XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlcygpIHtcbiAgICAgIHZtLmNoYWxsZW5nZXMgPSBbXTtcbiAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZXMpIHtcbiAgICAgICAgaWYgKGNoYWxsZW5nZXMuZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdm0uY2hhbGxlbmdlcyA9IGNoYWxsZW5nZXMuZGF0YTtcbiAgICAgICAgICBfLmZvckVhY2godm0uY2hhbGxlbmdlcywgZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgaWYgKGNoYWxsZW5nZS50aW1lTGltaXQgIT09IDApIHtcbiAgICAgICAgICAgICAgY2hhbGxlbmdlLmV4cGlyZXMgPSAobW9tZW50KCkuZGlmZihtb21lbnQoY2hhbGxlbmdlLmNyZWF0ZWQpLmFkZChjaGFsbGVuZ2UudGltZUxpbWl0LCAnZCcpLCdzJykpICogLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjaGFsbGVuZ2VfY3JlYXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIGdldEFjdGl2ZUNoYWxsZW5nZXMoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjaGFsbGVuZ2VfY29tcGxldGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlcygpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOnB5cmFtaWRfdXBkYXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIGdldEFjdGl2ZUNoYWxsZW5nZXMoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BDb21wbGV0ZWRDaGFsbGVuZWdlcycsIGtwQ29tcGxldGVkQ2hhbGxlbmVnZXMpO1xuXG4gIGZ1bmN0aW9uIGtwQ29tcGxldGVkQ2hhbGxlbmVnZXMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCcsXG4gICAgICAgIGxpbWl0OiAnQCdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jaGFsbGVuZ2VzL2NvbXBvbmVudHMvY29tcGxldGVkLWNoYWxsZW5nZXMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgZ2V0Q29tcGxldGVkQ2hhbGxlbmdlcygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENvbXBsZXRlZENoYWxsZW5nZXMoKSB7XG4gICAgICB2bS5jaGFsbGVuZ2VzID0gW107XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkLCB2bS5saW1pdCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlcykge1xuICAgICAgICBpZiAoY2hhbGxlbmdlcy5kYXRhLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB2bS5jaGFsbGVuZ2VzID0gY2hhbGxlbmdlcy5kYXRhO1xuICAgICAgICAgIF8uZm9yRWFjaCh2bS5jaGFsbGVuZ2VzLCBmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UubG9zZXIgPSBjaGFsbGVuZ2Uud2lubmVyID09PSAnY2hhbGxlbmdlcicgPyAnb3Bwb25lbnQnIDogJ2NoYWxsZW5nZXInO1xuICAgICAgICAgICAgY2hhbGxlbmdlLndoZW5Db21wbGV0ZWQgPSBtb21lbnQoY2hhbGxlbmdlLmNvbXBsZXRlZCkuY2FsZW5kYXIobnVsbCwge1xuICAgICAgICAgICAgICBzYW1lRGF5OiAnW1RvZGF5XScsXG4gICAgICAgICAgICAgIG5leHREYXk6ICdbVG9tb3Jyb3ddJyxcbiAgICAgICAgICAgICAgbmV4dFdlZWs6ICdkZGRkJyxcbiAgICAgICAgICAgICAgbGFzdERheTogJ1tZZXN0ZXJkYXldJyxcbiAgICAgICAgICAgICAgbGFzdFdlZWs6ICdbTGFzdF0gZGRkZCcsXG4gICAgICAgICAgICAgIHNhbWVFbHNlOiAnREQvTU0vWVlZWSdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIGdldENvbXBsZXRlZENoYWxsZW5nZXMoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BQbGF5ZXJPdmVyYWxsUmVzdWx0cycsIGtwUGxheWVyT3ZlcmFsbFJlc3VsdHMpO1xuXG4gIGZ1bmN0aW9uIGtwUGxheWVyT3ZlcmFsbFJlc3VsdHMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCcsXG4gICAgICAgIHBsYXllcjogJz0nXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY2hhbGxlbmdlcy9jb21wb25lbnRzL3BsYXllci1vdmVyYWxsLXJlc3VsdHMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBjaGFsbGVuZ2VzU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubWF4TGV2ZWxzID0gMTA7XG4gICAgdm0ud2lucyA9IHtcbiAgICAgIHRvdGFsOiAwLFxuICAgICAgYXNDaGFsbGVuZ2VyOiAwLFxuICAgICAgYXNPcHBvbmVudDogMCxcbiAgICAgIGJ5Rm9yZmVpdDogMFxuICAgIH07XG4gICAgdm0ubG9zZXMgPSB7XG4gICAgICB0b3RhbDogMCxcbiAgICAgIGFzQ2hhbGxlbmdlcjogMCxcbiAgICAgIGFzT3Bwb25lbnQ6IDAsXG4gICAgICBieUZvcmZlaXQ6IDBcbiAgICB9O1xuICAgIHZtLnN0cmVhayA9IHtcbiAgICAgIHR5cGU6IG51bGwsXG4gICAgICB2YWx1ZTogMFxuICAgIH07XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBnZXRQbGF5ZXJPdmVyYWxsUmVzdWx0cyh2bS5jb21wZXRpdGlvbklkLCB2bS5wbGF5ZXIuX2lkKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJPdmVyYWxsUmVzdWx0cyhjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkge1xuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0UGxheWVyUmVzdWx0c0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCwgcGxheWVySWQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHtcblxuICAgICAgICAvLyBEZXRlcm1pbmUgYWxsIHRoZSBicmVhayBwb2ludHMgdG8gZmlndXJlIG91dCBsZXZlbHNcbiAgICAgICAgdmFyIGJyZWFrUG9pbnRzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ubWF4TGV2ZWxzOyBpKyspIHtcbiAgICAgICAgICBicmVha1BvaW50cy5wdXNoKCgoKGkgKiAoaSArIDEpKSAvIDIpKSArIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGVmYXVsdCBhbGwgcGxheWVycyB0byB0aGUgbG93ZXN0IGxldmVsXG4gICAgICAgIHZtLnBsYXllci5sZXZlbCA9IGJyZWFrUG9pbnRzLmxlbmd0aDtcbiAgICAgICAgLy8gTm93IGNoZWNrIHRvIHNlZSBpZiB0aGUgcGxheWVyIGlzIGF0IGEgaGlnaGVyIGxldmVsXG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgYnJlYWtQb2ludHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBpZiAodm0ucGxheWVyLnBvc2l0aW9uIDwgYnJlYWtQb2ludHNbaiArIDFdKSB7XG4gICAgICAgICAgICB2bS5wbGF5ZXIubGV2ZWwgPSBicmVha1BvaW50cy5pbmRleE9mKGJyZWFrUG9pbnRzW2pdKSArIDE7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGaWd1cmUgb3V0IHRoZSBwbGF5ZXIncyBjdXJyZW50IHN0cmVha1xuICAgICAgICB2YXIgc3RyZWFrID0gMDtcbiAgICAgICAgdmFyIGNvbnRpbnVlU3RyZWFrID0gdHJ1ZTtcbiAgICAgICAgdmFyIHN0cmVha1R5cGU7XG4gICAgICAgIF8uZm9yRWFjaChyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICBpZiAoY29udGludWVTdHJlYWspIHtcbiAgICAgICAgICAgIC8vIFdpbm5pbmcgU3RyZWFrXG4gICAgICAgICAgICBpZiAoKGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJyAmJiBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkKSB8fFxuICAgICAgICAgICAgICAoY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50JyAmJiBjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkID09PSBwbGF5ZXJJZCkpIHtcbiAgICAgICAgICAgICAgLy8gSWYgdGhleSBhcmUgbm90IGFscmVhZHkgb24gYSBsb3Npbmcgc3RyZWFrIGFuZCAxIHRvIHRoZWlyIHdpbm5pbmcgc3RyZWFrXG4gICAgICAgICAgICAgIGlmIChzdHJlYWtUeXBlICE9PSAnbG9zaW5nJykge1xuICAgICAgICAgICAgICAgIHN0cmVhayArPSAxO1xuICAgICAgICAgICAgICAgIHN0cmVha1R5cGUgPSAnd2lubmluZyc7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGludWVTdHJlYWsgPSBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gTG9zaW5nIFN0cmVha1xuICAgICAgICAgICAgfSBlbHNlIGlmICgoY2hhbGxlbmdlLndpbm5lciA9PT0gJ29wcG9uZW50JyAmJiBjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkKSB8fFxuICAgICAgICAgICAgICAoY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInICYmIGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkKSkge1xuICAgICAgICAgICAgICAvLyBJZiB0aGV5IGFyZSBub3QgYWxyZWFkeSBvbiBhIHdpbm5pbmcgc3RyZWFrIGFuZCAxIHRvIHRoZWlyIGxvc2luZyBzdHJlYWtcbiAgICAgICAgICAgICAgaWYgKHN0cmVha1R5cGUgIT09ICd3aW5uaW5nJykge1xuICAgICAgICAgICAgICAgIHN0cmVhayArPSAxO1xuICAgICAgICAgICAgICAgIHN0cmVha1R5cGUgPSAnbG9zaW5nJztcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZVN0cmVhayA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHZtLnN0cmVhayA9IHtcbiAgICAgICAgICAgIHR5cGU6IHN0cmVha1R5cGUsXG4gICAgICAgICAgICB2YWx1ZTogc3RyZWFrXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRmlndXJlIG91dCB3aW5zIGFuZCBsb3Nlc1xuICAgICAgICB2bS53aW5zLmFzT3Bwb25lbnQgPSBfLnNpemUoXy5maWx0ZXIocmVzdWx0cy5kYXRhLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdvcHBvbmVudCdcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgdm0ud2lucy5hc0NoYWxsZW5nZXIgPSBfLnNpemUoXy5maWx0ZXIocmVzdWx0cy5kYXRhLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCA9PT0gcGxheWVySWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInXG4gICAgICAgICAgKTtcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHZtLndpbnMudG90YWwgPSB2bS53aW5zLmFzQ2hhbGxlbmdlciArIHZtLndpbnMuYXNPcHBvbmVudDtcblxuICAgICAgICB2bS53aW5zLmJ5Rm9yZmVpdCA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLmZvcmZlaXQgJiYgKChjaGFsbGVuZ2UuY2hhbGxlbmdlci5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJykgfHxcbiAgICAgICAgICAgIChjaGFsbGVuZ2Uub3Bwb25lbnQuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnKSlcbiAgICAgICAgICApO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgdm0ubG9zZXMuYXNPcHBvbmVudCA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCA9PT0gcGxheWVySWQgJiYgY2hhbGxlbmdlLndpbm5lciA9PT0gJ2NoYWxsZW5nZXInXG4gICAgICAgICAgKTtcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHZtLmxvc2VzLmFzQ2hhbGxlbmdlciA9IF8uc2l6ZShfLmZpbHRlcihyZXN1bHRzLmRhdGEsIGZ1bmN0aW9uKGNoYWxsZW5nZSkgeyBcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnXG4gICAgICAgICAgKTtcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHZtLmxvc2VzLnRvdGFsID0gdm0ubG9zZXMuYXNDaGFsbGVuZ2VyICsgdm0ubG9zZXMuYXNPcHBvbmVudDtcblxuICAgICAgICB2bS5sb3Nlcy5ieUZvcmZlaXQgPSBfLnNpemUoXy5maWx0ZXIocmVzdWx0cy5kYXRhLCBmdW5jdGlvbihjaGFsbGVuZ2UpIHsgXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGNoYWxsZW5nZS5mb3JmZWl0ICYmICgoY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkID09PSBwbGF5ZXJJZCAmJiBjaGFsbGVuZ2Uud2lubmVyID09PSAnb3Bwb25lbnQnKSB8fFxuICAgICAgICAgICAgKGNoYWxsZW5nZS5vcHBvbmVudC5faWQgPT09IHBsYXllcklkICYmIGNoYWxsZW5nZS53aW5uZXIgPT09ICdjaGFsbGVuZ2VyJykpXG4gICAgICAgICAgKTtcbiAgICAgICAgfSkpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jb21wbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBpZiAodm0ucGxheWVyLl9pZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jaGFsbGVuZ2VySWQpIHtcbiAgICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgICAgZ2V0UGxheWVyT3ZlcmFsbFJlc3VsdHMoY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkLCBjaGFsbGVuZ2VEZXRhaWxzLmNoYWxsZW5nZXJJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAodm0ucGxheWVyLl9pZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5vcHBvbmVudElkKSB7XG4gICAgICAgICAgZ2V0UGxheWVyT3ZlcmFsbFJlc3VsdHMoY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkLCBjaGFsbGVuZ2VEZXRhaWxzLm9wcG9uZW50SWQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnY2hhbGxlbmdlc1NlcnZpY2UnLCBjaGFsbGVuZ2VzU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gY2hhbGxlbmdlc1NlcnZpY2UoJGh0dHApIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGNyZWF0ZUNoYWxsZW5nZTogY3JlYXRlQ2hhbGxlbmdlLFxuICAgICAgY29tcGxldGVDaGFsbGVuZ2U6IGNvbXBsZXRlQ2hhbGxlbmdlLFxuICAgICAgZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb246IGdldEFjdGl2ZUNoYWxsZW5nZXNCeUNvbXBldGl0aW9uLFxuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyOiBnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIsXG4gICAgICBnZXRDb21wbGV0ZWRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbjogZ2V0Q29tcGxldGVkQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24sXG4gICAgICBkZWxldGVBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXI6IGRlbGV0ZUFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcixcbiAgICAgIGdldFBsYXllclJlc3VsdHNCeUNvbXBldGl0aW9uOiBnZXRQbGF5ZXJSZXN1bHRzQnlDb21wZXRpdGlvblxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYWxsZW5nZShjaGFsbGVuZ2UpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NoYWxsZW5nZXMvY3JlYXRlJywge1xuICAgICAgICBjaGFsbGVuZ2U6IGNoYWxsZW5nZVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jaGFsbGVuZ2VzL2NvbXBsZXRlJywgIHtcbiAgICAgICAgY2hhbGxlbmdlOiBjaGFsbGVuZ2VcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2FjdGl2ZS9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvYWN0aXZlL2NvbXBldGl0aW9uL3BsYXllcicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgcGxheWVySWQ6IHBsYXllcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENvbXBsZXRlZENoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQsIGxpbWl0KSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvY29tcGxldGVkL2NvbXBldGl0aW9uJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBsaW1pdDogbGltaXRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsZXRlQWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZGVsZXRlKCcvYXBpL2NoYWxsZW5nZXMvYWN0aXZlL2NvbXBldGl0aW9uL3BsYXllci9kZWxldGUnLCAge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICAgIHBsYXllcklkOiBwbGF5ZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJSZXN1bHRzQnlDb21wZXRpdGlvbihjb21wZXRpdGlvbklkLCBwbGF5ZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL3Jlc3VsdHMvY29tcGV0aXRpb24vcGxheWVyJywgIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgY29tcGV0aXRpb25JZDogY29tcGV0aXRpb25JZCxcbiAgICAgICAgICBwbGF5ZXJJZDogcGxheWVySWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcEZvb3RlcicsIGtwRm9vdGVyKTtcblxuICBmdW5jdGlvbiBrcEZvb3RlcigpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbW1vbi9jb21wb25lbnRzL2Zvb3Rlci5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYyhpZGVudGl0eVNlcnZpY2UsIGF1dGhTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pbmRlbnRpdHkgPSBpZGVudGl0eVNlcnZpY2U7XG4gICAgdm0ubG9nb3V0ID0gbG9nb3V0O1xuXG4gICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcEhlYWRlcicsIGtwSGVhZGVyKTtcblxuICBmdW5jdGlvbiBrcEhlYWRlcigpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAnaGVhZGVyQ3RybCcsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY29tbW9uL2NvbXBvbmVudHMvaGVhZGVyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKHNpZGViYXJTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UsIGF1dGhTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pbmRlbnRpdHkgPSBpZGVudGl0eVNlcnZpY2U7XG4gICAgdm0ubG9nb3V0ID0gbG9nb3V0O1xuICAgIHZtLnNpZGViYXJTdGF0dXMgPSBzaWRlYmFyU2VydmljZS5nZXRTaWRlYmFyU3RhdHVzKCk7XG4gICAgdm0udG9nZ2xlU2lkZWJhciA9IHRvZ2dsZVNpZGViYXI7XG5cbiAgICBmdW5jdGlvbiB0b2dnbGVTaWRlYmFyKCkge1xuICAgICAgdm0uc2lkZWJhclN0YXR1cy5sZWZ0ID0gIXZtLnNpZGViYXJTdGF0dXMubGVmdDtcbiAgICAgIHNpZGViYXJTZXJ2aWNlLnNldFNpZGViYXJTdGF0dXModm0uc2lkZWJhclN0YXR1cy5sZWZ0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twU2lkZWJhcicsIGtwU2lkZWJhcik7XG5cbiAgZnVuY3Rpb24ga3BTaWRlYmFyKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICdzaWRlYmFyQ3RybCcsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY29tbW9uL2NvbXBvbmVudHMvc2lkZWJhci5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYyhpZGVudGl0eVNlcnZpY2UsIGF1dGhTZXJ2aWNlLCBzaWRlYmFyU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaW5kZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgIHZtLmxvZ291dCA9IGxvZ291dDtcbiAgICB2bS5zaWRlYmFyU3RhdHVzID0gc2lkZWJhclNlcnZpY2UuZ2V0U2lkZWJhclN0YXR1cygpO1xuXG4gICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZpbHRlcignb3JkZXJPYmplY3RCeScsIG9yZGVyT2JqZWN0QnkpO1xuXG4gIGZ1bmN0aW9uIG9yZGVyT2JqZWN0QnkoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChpbnB1dCwgYXR0cmlidXRlKSB7XG4gICAgICBpZiAoIWFuZ3VsYXIuaXNPYmplY3QoaW5wdXQpKSByZXR1cm4gaW5wdXQ7XG5cbiAgICAgIHZhciBhcnJheSA9IFtdO1xuICAgICAgZm9yICh2YXIgb2JqZWN0S2V5IGluIGlucHV0KSB7XG4gICAgICAgIGFycmF5LnB1c2goaW5wdXRbb2JqZWN0S2V5XSk7XG4gICAgICB9XG5cbiAgICAgIGFycmF5LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgYSA9IHBhcnNlSW50KGFbYXR0cmlidXRlXSk7XG4gICAgICAgIGIgPSBwYXJzZUludChiW2F0dHJpYnV0ZV0pO1xuICAgICAgICByZXR1cm4gYSAtIGI7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBhcnJheTtcbiAgICB9O1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ2lkZW50aXR5U2VydmljZScsIGlkZW50aXR5U2VydmljZSk7XG5cbiAgZnVuY3Rpb24gaWRlbnRpdHlTZXJ2aWNlKCR3aW5kb3cpIHtcbiAgICB2YXIgY3VycmVudFVzZXI7XG4gICAgaWYgKCR3aW5kb3cuYm9vdHN0cmFwcGVkVXNlck9iamVjdCAhPT0gbnVsbCkge1xuICAgICAgY3VycmVudFVzZXIgPSAkd2luZG93LmJvb3RzdHJhcHBlZFVzZXJPYmplY3Q7XG4gICAgfVxuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgY3VycmVudFVzZXI6IGN1cnJlbnRVc2VyLFxuICAgICAgaXNBdXRoZW50aWNhdGVkOiBpc0F1dGhlbnRpY2F0ZWQsXG4gICAgICBpc0F1dGhvcml6ZWQ6IGlzQXV0aG9yaXplZFxuICAgIH07XG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBpc0F1dGhlbnRpY2F0ZWQoKSB7XG4gICAgICByZXR1cm4gISF0aGlzLmN1cnJlbnRVc2VyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzQXV0aG9yaXplZChyb2xlKSB7XG4gICAgICByZXR1cm4gISF0aGlzLmN1cnJlbnRVc2VyICYmIHRoaXMuY3VycmVudFVzZXIucm9sZXMuaW5kZXhPZihyb2xlKSA+IC0xO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdub3RpZnlTZXJ2aWNlJywgbm90aWZ5U2VydmljZSk7XG5cbiAgZnVuY3Rpb24gbm90aWZ5U2VydmljZSgpIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGluZm86IGluZm8sXG4gICAgICBzdWNjZXNzOiBzdWNjZXNzLFxuICAgICAgd2FybmluZzogd2FybmluZyxcbiAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgIGludmVyc2U6IGludmVyc2VcbiAgICB9O1xuXG4gICAgJC5ub3RpZnlEZWZhdWx0cyh7XG4gICAgICBuZXdlc3Rfb25fdG9wOiB0cnVlLFxuICAgICAgb2Zmc2V0OiB7XG4gICAgICAgIHg6IDIwLFxuICAgICAgICB5OiA4NVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBpbmZvKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdpbmZvJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3VjY2VzcyhtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnc3VjY2VzcydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ3dhcm5pbmcnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnZGFuZ2VyJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW52ZXJzZShtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnaW52ZXJzZSdcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdzY3JvbGxiYXJTZXJ2aWNlJywgc2Nyb2xsYmFyU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gc2Nyb2xsYmFyU2VydmljZSgpIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIG1hbGlodVNjcm9sbDogbWFsaWh1U2Nyb2xsXG4gICAgfTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gbWFsaWh1U2Nyb2xsKHNlbGVjdG9yLCB0aGVtZSwgc2Nyb2xsYXhpcywgbW91c2V3aGVlbGF4aXMpIHtcbiAgICAgICQoc2VsZWN0b3IpLm1DdXN0b21TY3JvbGxiYXIoe1xuICAgICAgICB0aGVtZTogdGhlbWUsXG4gICAgICAgIHNjcm9sbEluZXJ0aWE6IDEwMCxcbiAgICAgICAgYXhpczogc2Nyb2xsYXhpcyxcbiAgICAgICAgbW91c2VXaGVlbDoge1xuICAgICAgICAgIGVuYWJsZTogdHJ1ZSxcbiAgICAgICAgICBheGlzOiBtb3VzZXdoZWVsYXhpcyxcbiAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZmFjdG9yeSgnc2lkZWJhclNlcnZpY2UnLCBzaWRlYmFyU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gc2lkZWJhclNlcnZpY2UoKSB7XG4gICAgdmFyIHNpZGViYXJTdGF0dXMgPSB7XG4gICAgICBsZWZ0OiBmYWxzZSxcbiAgICAgIHJpZ2h0OiBmYWxzZVxuICAgIH07XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBnZXRTaWRlYmFyU3RhdHVzOiBnZXRTaWRlYmFyU3RhdHVzLFxuICAgICAgc2V0U2lkZWJhclN0YXR1czogc2V0U2lkZWJhclN0YXR1c1xuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGdldFNpZGViYXJTdGF0dXMoKSB7XG4gICAgICByZXR1cm4gc2lkZWJhclN0YXR1cztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRTaWRlYmFyU3RhdHVzKHN0YXR1cykge1xuICAgICAgc2lkZWJhclN0YXR1cy5sZWZ0ID0gc3RhdHVzO1xuICAgIH1cbiAgfVxufSkoKTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgLnNlcnZpY2UoJ3dlYnNvY2tldFNlcnZpY2UnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHdpbmRvdykge1xuICAgIGZ1bmN0aW9uIHdlYnNvY2tldEhvc3QoKSB7XG4gICAgICBpZiAoJHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHBzOicpIHtcbiAgICAgICAgcmV0dXJuICd3c3M6Ly8nICsgJHdpbmRvdy5sb2NhdGlvbi5ob3N0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICd3czovLycgKyAkd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGNvbm5lY3Rpb247XG4gICAgdGhpcy5jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgY29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQod2Vic29ja2V0SG9zdCgpKTtcblxuICAgICAgY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgcGF5bG9hZCA9IEpTT04ucGFyc2UoZS5kYXRhKTtcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd3czonICsgcGF5bG9hZC50b3BpYywgcGF5bG9hZC5kYXRhKTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIHRoaXMuc2VuZCA9IGZ1bmN0aW9uICh0b3BpYywgZGF0YSkge1xuICAgICAgdmFyIGpzb24gPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIHRvcGljOiB0b3BpYyxcbiAgICAgICAgZGF0YTogZGF0YVxuICAgICAgfSk7XG4gICAgICBjb25uZWN0aW9uLnNlbmQoanNvbik7XG4gICAgfTtcbiAgfSkucnVuKGZ1bmN0aW9uICh3ZWJzb2NrZXRTZXJ2aWNlKSB7XG4gICAgd2Vic29ja2V0U2VydmljZS5jb25uZWN0KCk7XG4gIH0pOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0hvbWVDdHJsJywgSG9tZUN0cmwpO1xuXG4gIGZ1bmN0aW9uIEhvbWVDdHJsKCkge1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge31cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BQZW5kaW5nUGxheWVycycsIGtwUGVuZGluZ1BsYXllcnMpO1xuXG4gIGZ1bmN0aW9uIGtwUGVuZGluZ1BsYXllcnMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9weXJhbWlkcy9jb21wb25lbnRzL3BlbmRpbmctcGxheWVycy5odG1sJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBjdHJsRnVuYygkc2NvcGUsIHB5cmFtaWRzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucHlyYW1pZCA9IHt9O1xuICAgIHZtLnBlbmRpbmdQbGF5ZXJzID0gW107XG4gICAgdm0uYXBwcm92ZVBlbmRpbmdQbGF5ZXIgPSBhcHByb3ZlUGVuZGluZ1BsYXllcjtcbiAgICB2bS5kZW55UGVuZGluZ1BsYXllciA9IGRlbnlQZW5kaW5nUGxheWVyO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgZ2V0UGVuZGluZ1BsYXllcnMoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRQZW5kaW5nUGxheWVycygpIHtcbiAgICAgIHZtLnBlbmRpbmdQbGF5ZXJzID0gW107XG4gICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgIHZtLnB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICAgIGlmIChweXJhbWlkLmRhdGEgJiYgcHlyYW1pZC5kYXRhLnBlbmRpbmdQbGF5ZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB2bS5wZW5kaW5nUGxheWVycyA9IHB5cmFtaWQuZGF0YS5wZW5kaW5nUGxheWVycztcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXBwcm92ZVBlbmRpbmdQbGF5ZXIocGxheWVyKSB7XG4gICAgICBwbGF5ZXIucG9zaXRpb24gPSB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoICsgMTtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5hcHByb3ZlUGVuZGluZ1BsYXllcih2bS5jb21wZXRpdGlvbklkLCBwbGF5ZXIpLnRoZW4oZ2V0UGVuZGluZ1BsYXllcnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbnlQZW5kaW5nUGxheWVyKHBsYXllcikge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmRlbnlQZW5kaW5nUGxheWVyKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllcikudGhlbihnZXRQZW5kaW5nUGxheWVycyk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFB5cmFtaWRDb21wYWN0Jywga3BQeXJhbWlkQ29tcGFjdCk7XG5cbiAgZnVuY3Rpb24ga3BQeXJhbWlkQ29tcGFjdCgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHR5cGU6ICdAJyxcblxuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3B5cmFtaWRzL2NvbXBvbmVudHMvcHlyYW1pZC1jb21wYWN0Lmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKHB5cmFtaWRzU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5weXJhbWlkcyA9IG51bGw7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBpZiAodm0udHlwZSA9PT0gJ3VzZXInKSB7XG4gICAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkc0ZvclVzZXIoaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZHMpIHtcbiAgICAgICAgICB2bS5weXJhbWlkcyA9IHB5cmFtaWRzLmRhdGE7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWRzKCkudGhlbihmdW5jdGlvbiAocHlyYW1pZHMpIHtcbiAgICAgICAgICB2bS5weXJhbWlkcyA9IHB5cmFtaWRzLmRhdGE7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twUHlyYW1pZCcsIGtwUHlyYW1pZCk7XG5cbiAgZnVuY3Rpb24ga3BQeXJhbWlkKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvcHlyYW1pZHMvY29tcG9uZW50cy9weXJhbWlkLmh0bWwnLFxuICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6ICdAJ1xuICAgICAgfSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZVxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKCRzY29wZSwgJHN0YXRlLCBweXJhbWlkc1NlcnZpY2UsICRmaWx0ZXIsIG5vdGlmeVNlcnZpY2UsIGlkZW50aXR5U2VydmljZSwgY2hhbGxlbmdlc1NlcnZpY2UpIHtcbiAgICB2YXIgbWF4TGV2ZWxzID0gMTA7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5weXJhbWlkID0ge307XG4gICAgdm0uYnJlYWtQb2ludHMgPSBbXTtcbiAgICB2bS5sZXZlbHMgPSBbXTtcbiAgICB2bS5udW1iZXJPZkJsb2NrcyA9IDA7XG4gICAgdm0uY3VycmVudFVzZXJJc09uUHlyYW1pZCA9IGZhbHNlO1xuICAgIHZtLmN1cnJlbnRVc2VySXNQZW5kaW5nID0gZmFsc2U7XG4gICAgdm0uY3VycmVudFVzZXJJc093bmVyID0gZmFsc2U7XG4gICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gZmFsc2U7XG4gICAgdm0uYXZhaWxhYmxlQ2hhbGxlbmdlcyA9IGZhbHNlO1xuICAgIHZtLmNyZWF0ZUNoYWxsZW5nZSA9IGNyZWF0ZUNoYWxsZW5nZTtcbiAgICB2bS5jb21wbGV0ZUNoYWxsZW5nZSA9IGNvbXBsZXRlQ2hhbGxlbmdlO1xuICAgIHZtLmNoYWxsZW5nZUV4cGlyZWQgPSBjaGFsbGVuZ2VFeHBpcmVkO1xuICAgIHZtLmN1cnJlbnRVc2VyUGxheWVyID0ge307XG4gICAgdm0ucHlyYW1pZE1lbnVUb2dnbGUgPSBmYWxzZTtcbiAgICB2bS5hZGRDdXJyZW50VXNlclRvUHlyYW1pZCA9IGFkZEN1cnJlbnRVc2VyVG9QeXJhbWlkO1xuICAgIHZtLmNvbmZpcm1SZW1vdmVDdXJyZW50VXNlckZyb21QeXJhbWlkID0gY29uZmlybVJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQ7XG4gICAgdm0ubnVtYmVyT2ZSZWFsUGxheWVycyA9IDA7XG4gICAgdm0ubWF4UGxheWVycyA9IDA7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBweXJhbWlkc1NlcnZpY2UuZ2V0UHlyYW1pZCh2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgIC8vIERldGVybWluZSB0aGUgbWF4aW11bSBudW1iZXIgb2YgcGxheWVycyBiYXNlZCBvbiB0aGUgbWF4aW11bSBudW1iZXIgb2YgbGV2ZWxzXG4gICAgICAgIGZvciAodmFyIGkgPSBtYXhMZXZlbHM7IGkgPiAwOyAtLWkpIHtcbiAgICAgICAgICB2bS5tYXhQbGF5ZXJzICs9IGk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocHlyYW1pZC5kYXRhKSB7XG4gICAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcblxuICAgICAgICAgIG9yZGVyUGxheWVycygpO1xuICAgICAgICAgIGdldFBsYXllcnNTdGF0dXMoKTtcbiAgICAgICAgICBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKTtcbiAgICAgICAgICBjYWxjdWxhdGVQeXJhbWlkQmxvY2tzKCk7XG4gICAgICAgICAgZmlsbEluRW1wdHlCbG9ja3MoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3JkZXIgdGhlIHBsYXllcnMgYnkgdGhlIHBvc2l0aW9uIHByb3BlcnR5IG9mIHRoZSBwbGF5ZXJzIGFycmF5IGluIHRoZSBweXJhbWlkIG9iamVjdFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9yZGVyUGxheWVycygpIHtcbiAgICAgIHZtLnB5cmFtaWQucGxheWVycyA9ICRmaWx0ZXIoJ29yZGVyQnknKSh2bS5weXJhbWlkLnBsYXllcnMsICdwb3NpdGlvbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpZ3VyZSBvdXQgaWYgZWFjaCBwbGF5ZXIgaXMgYWxyZWFkeSBjaGFsbGVuZ2VkIGFuZCBzZXQgc29tZSBzdHVmZlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFBsYXllcnNTdGF0dXMoKSB7XG4gICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIGN1cnJlbnQgdXNlciBpcyBhbiBvd25lciBvZiB0aGlzIHB5cmFtaWRcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgdm0uY3VycmVudFVzZXJJc093bmVyID0gXy5zb21lKHZtLnB5cmFtaWQub3duZXJzLCBbJ19pZCcsIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWRdKTtcbiAgICAgIH1cblxuICAgICAgXy5mb3JFYWNoKHZtLnB5cmFtaWQucGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICAvLyBGaW5kIHRoZSBjdXJyZW50IHVzZXIgaWYgdGhleSBhcmUgb24gdGhpcyBweXJhbWlkIGFuZCBzZXQgc29tZSBwcm9wZXJ0aWVzXG4gICAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkgJiYgcGxheWVyLl9pZCA9PT0gaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCkge1xuICAgICAgICAgIHZtLmN1cnJlbnRVc2VySXNPblB5cmFtaWQgPSB0cnVlO1xuICAgICAgICAgIHBsYXllci5jbGFzcyA9ICdjdXJyZW50LXVzZXInO1xuICAgICAgICAgIHZtLmN1cnJlbnRVc2VyUGxheWVyID0gcGxheWVyO1xuXG4gICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKHZtLmNvbXBldGl0aW9uSWQsIHBsYXllci5faWQpLnRoZW4oZnVuY3Rpb24gKGNoYWxsZW5nZSkge1xuICAgICAgICAgICAgaWYgKGNoYWxsZW5nZS5kYXRhKSB7XG4gICAgICAgICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIGN1cnJlbnQgdXNlciBoYXMgYSBwZW5kaW5nIHJlcXVlc3QgdG8gam9pblxuICAgICAgXy5mb3JFYWNoKHZtLnB5cmFtaWQucGVuZGluZ1BsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSAmJiBwbGF5ZXIuX2lkID09PSBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkKSB7XG4gICAgICAgICAgdm0uY3VycmVudFVzZXJJc1BlbmRpbmcgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlcykge1xuICAgICAgICBfLmZvckVhY2goY2hhbGxlbmdlcy5kYXRhLCBmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG5cbiAgICAgICAgICB2YXIgY2hhbGxlbmdlciA9IF8uZmluZCh2bS5weXJhbWlkLnBsYXllcnMsIHsgJ19pZCc6IGNoYWxsZW5nZS5jaGFsbGVuZ2VyLl9pZCB9KTtcbiAgICAgICAgICBjaGFsbGVuZ2VyLmNsYXNzID0gJ3VuYXZhaWxhYmxlJztcbiAgICAgICAgICBjaGFsbGVuZ2VyLmNoYWxsZW5nZSA9IHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnY2hhbGxlbmdlcidcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgdmFyIG9wcG9uZW50ID0gXy5maW5kKHZtLnB5cmFtaWQucGxheWVycywgeyAnX2lkJzogY2hhbGxlbmdlLm9wcG9uZW50Ll9pZCB9KTtcbiAgICAgICAgICBvcHBvbmVudC5jbGFzcyA9ICd1bmF2YWlsYWJsZSc7XG4gICAgICAgICAgb3Bwb25lbnQuY2hhbGxlbmdlID0ge1xuICAgICAgICAgICAgcG9zaXRpb246ICdvcHBvbmVudCdcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgLy8gVHJhY2sgd2hlbiB0aGUgY2hhbGxlbmdlIHdpbGwgZXhwaXJlXG4gICAgICAgICAgaWYgKGNoYWxsZW5nZS50aW1lTGltaXQgIT09IDApIHtcbiAgICAgICAgICAgIHZhciB0aW1lVG9FeHBpcmUgPSBtb21lbnQoKS5kaWZmKG1vbWVudChjaGFsbGVuZ2UuY3JlYXRlZCkuYWRkKGNoYWxsZW5nZS50aW1lTGltaXQsICdkJyksICdzJykgKiAtMTtcbiAgICAgICAgICAgIC8vIElmIHRoZSBjaGFsbGVuZ2UgaGFzIG5vdCB5ZXQgZXhwaXJlZCBkaXNwbGF5IGEgY291bnRkb3duIG9uIHRoZSBvcHBvbmVudFxuICAgICAgICAgICAgaWYgKHRpbWVUb0V4cGlyZSA+IDApIHtcbiAgICAgICAgICAgICAgb3Bwb25lbnQuY2hhbGxlbmdlLmV4cGlyZXMgPSB0aW1lVG9FeHBpcmU7XG4gICAgICAgICAgICAgIC8vIElmIHRoZSBjaGFsbGVuZ2UgZXhwaXJlZCB3aGlsZSBubyBvbmUgd2FzIHZpZXdpbmcgdGhpcyBweXJhbWlkIGNvbXBsZXRlIHRoZSBjaGFsbGVuZ2UgYnkgZm9yZmVpdFxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aW1lVG9FeHBpcmUgPD0gMCkge1xuICAgICAgICAgICAgICBjb21wbGV0ZUNoYWxsZW5nZShudWxsLCB0cnVlLCBvcHBvbmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gTm93IHRoYXQgd2Uga25vdyB3aGljaCBwbGF5ZXJzIGFyZSBpbiBjaGFsbGVuZ2VzIGFuZCB3aGljaCBhcmVuJ3RcbiAgICAgICAgLy8gZmluZCB0aGUgYXZhaWxhYmxlIGNoYWxsZW5nZXMgZm9yIHRoaXMgdXNlclxuICAgICAgICBmaW5kQXZhaWxhYmxlQ2hhbGxlbmdlcygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlndXJlIG91dCB3aGVyZSB0byBzdGFydCBlYWNoIG5ldyByb3cgb24gdGhlIHB5cmFtaWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVCcmVha1BvaW50cygpIHtcbiAgICAgIHZtLmJyZWFrUG9pbnRzID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1heExldmVsczsgaSsrKSB7XG4gICAgICAgIHZtLmJyZWFrUG9pbnRzLnB1c2goKCgoaSAqIChpICsgMSkpIC8gMikpICsgMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gR2l2ZSBlYWNoIHBsYXllciBhIGxldmVsIHByb3BlcnR5IGJhc2VkIG9uIHRoZSBicmVhayBwb2ludHNcbiAgICAvLyBUaGlzIHdpbGwgYmUgdXNlZCB0byBkZXRlcm1pbmUgd2hvIG90aGVyIHBsYXllcnMgY2FuIGNoYWxsZW5nZVxuICAgIGZ1bmN0aW9uIGFzc2lnbkxldmVsc1RvUGxheWVycygpIHtcbiAgICAgIHZhciBsZXZlbCA9IDA7XG4gICAgICB2bS5sZXZlbHMgPSBbXTtcbiAgICAgIGNyZWF0ZUJyZWFrUG9pbnRzKCk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLnB5cmFtaWQucGxheWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAodm0uYnJlYWtQb2ludHMuaW5kZXhPZihpICsgMSkgPiAtMSkge1xuICAgICAgICAgIGxldmVsICs9IDE7XG4gICAgICAgICAgLy8gU2V0IHRoZSBudW1iZXIgb2YgdG90YWwgbGV2ZWxzXG4gICAgICAgICAgdm0ubGV2ZWxzLnB1c2gobGV2ZWwpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEdpdmUgZWFjaCBwbGF5ZXIgYSBsZXZlbFxuICAgICAgICB2bS5weXJhbWlkLnBsYXllcnNbaV0ubGV2ZWwgPSBsZXZlbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBIb3cgbWFueSB0b3RhbCBibG9ja3MgaW4gdGhpcyBweXJhbWlkXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlUHlyYW1pZEJsb2NrcygpIHtcbiAgICAgIHZtLm51bWJlck9mQmxvY2tzID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSBfLmxhc3Qodm0ubGV2ZWxzKTsgaSA+IDA7IGktLSkge1xuICAgICAgICB2bS5udW1iZXJPZkJsb2NrcyArPSBpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZpbGwgb3V0IHRoZSByZW1haW5pbmcgYmxvY2tzIG9mIHRoZSBweXJhbWlkIHdpdGggZW1wdHkgYmxvY2tzXG4gICAgZnVuY3Rpb24gZmlsbEluRW1wdHlCbG9ja3MoKSB7XG4gICAgICB2bS5udW1iZXJPZlJlYWxQbGF5ZXJzID0gdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDtcbiAgICAgIGZvciAodmFyIGkgPSB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoOyBpIDwgdm0ubnVtYmVyT2ZCbG9ja3M7IGkrKykge1xuICAgICAgICB2bS5weXJhbWlkLnBsYXllcnMucHVzaCh7XG4gICAgICAgICAgZmlyc3ROYW1lOiAnRW1wdHknLFxuICAgICAgICAgIGxhc3ROYW1lOiAnU3BvdCcsXG4gICAgICAgICAgcG9zaXRpb246IDk5LFxuICAgICAgICAgIGNsYXNzOiAnZW1wdHknXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgLy8gV2UgaGF2ZSB0byBnaXZlIGxldmVscyB0byB0aGUgbmV3IGVtcHR5IHNwb3RzXG4gICAgICBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKTtcbiAgICB9XG5cbiAgICAvLyBGaW5kIGFsbCB0aGUgcGxheWVycyB0aGF0IGFyZSBhdmFpbGFibGUgdG8gYmUgY2hhbGxlbmdlZCBieSB0aGlzIHVzZXJcbiAgICBmdW5jdGlvbiBmaW5kQXZhaWxhYmxlQ2hhbGxlbmdlcygpIHtcbiAgICAgIHZhciBsZXZlbEFib3ZlID0gdm0uY3VycmVudFVzZXJQbGF5ZXIubGV2ZWwgPiAxID8gdm0uY3VycmVudFVzZXJQbGF5ZXIubGV2ZWwgLSAxIDogbnVsbDtcbiAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgaWYgKHBsYXllci5sZXZlbCA9PT0gbGV2ZWxBYm92ZSAmJiBwbGF5ZXIucG9zaXRpb24gIT09IDk5ICYmIHBsYXllci5jbGFzcyAhPT0gJ3VuYXZhaWxhYmxlJykge1xuICAgICAgICAgIHZtLmF2YWlsYWJsZUNoYWxsZW5nZXMgPSB0cnVlO1xuICAgICAgICAgIHBsYXllci5hdmFpbGFibGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFsbGVuZ2UocGxheWVyKSB7XG4gICAgICBpZiAoIXBsYXllci5hdmFpbGFibGUpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignU29ycnksIHRoYXQgaXMgbm90IGEgdmFsaWQgY2hhbGxlbmdlLicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gdHJ1ZTtcbiAgICAgICAgdmFyIGNoYWxsZW5nZSA9IHtcbiAgICAgICAgICBjb21wZXRpdGlvbk5hbWU6IHZtLnB5cmFtaWQubmFtZSxcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiB2bS5jb21wZXRpdGlvbklkLFxuICAgICAgICAgIGNvbXBsZXRlOiBmYWxzZSxcbiAgICAgICAgICBmb3JmZWl0OiBmYWxzZSxcbiAgICAgICAgICB0aW1lTGltaXQ6IHZtLnB5cmFtaWQuZm9yZmVpdERheXMsXG4gICAgICAgICAgY2hhbGxlbmdlcjoge1xuICAgICAgICAgICAgX2lkOiB2bS5jdXJyZW50VXNlclBsYXllci5faWQsXG4gICAgICAgICAgICBlbWFpbDogdm0uY3VycmVudFVzZXJQbGF5ZXIuZW1haWwsXG4gICAgICAgICAgICBmaXJzdE5hbWU6IHZtLmN1cnJlbnRVc2VyUGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiB2bS5jdXJyZW50VXNlclBsYXllci5sYXN0TmFtZSxcbiAgICAgICAgICAgIHBvc2l0aW9uOiB2bS5jdXJyZW50VXNlclBsYXllci5wb3NpdGlvblxuICAgICAgICAgIH0sXG4gICAgICAgICAgb3Bwb25lbnQ6IHtcbiAgICAgICAgICAgIF9pZDogcGxheWVyLl9pZCxcbiAgICAgICAgICAgIGVtYWlsOiBwbGF5ZXIuZW1haWwsXG4gICAgICAgICAgICBmaXJzdE5hbWU6IHBsYXllci5maXJzdE5hbWUsXG4gICAgICAgICAgICBsYXN0TmFtZTogcGxheWVyLmxhc3ROYW1lLFxuICAgICAgICAgICAgcG9zaXRpb246IHBsYXllci5wb3NpdGlvblxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBjaGFsbGVuZ2VcbiAgICAgICAgLy8gV2Vic29ja2V0IGV2ZW50IHdpbGwgcmVmcmVzaCB0aGUgcHlyYW1pZFxuICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jcmVhdGVDaGFsbGVuZ2UoY2hhbGxlbmdlKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2bS5weXJhbWlkTWVudVRvZ2dsZSA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tcGxldGUgYSBjaGFsbGVuZ2UgYnkgYSB1c2VyIGludGVyYWN0aW9uIG9yIGEgZm9yZmVpdFxuICAgICAqIFxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IHdpbm5lcklzQ3VycmVudFVzZXJcbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSBmb3JmZWl0XG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBmb3JmZWl0TG9zZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb21wbGV0ZUNoYWxsZW5nZSh3aW5uZXJJc0N1cnJlbnRVc2VyLCBmb3JmZWl0LCBmb3JmZWl0TG9zZXIpIHtcbiAgICAgIHZhciBwbGF5ZXIgPSBmb3JmZWl0TG9zZXIgfHwgdm0uY3VycmVudFVzZXJQbGF5ZXI7XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIodm0uY29tcGV0aXRpb25JZCwgcGxheWVyLl9pZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBzd2FwUG9zaXRpb25zID0gZmFsc2U7XG5cbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBmb3JmZWl0XG4gICAgICAgIGlmIChmb3JmZWl0KSB7XG4gICAgICAgICAgY2hhbGxlbmdlLmRhdGEuZm9yZmVpdCA9IHRydWU7XG4gICAgICAgICAgaWYgKGZvcmZlaXRMb3Nlci5jaGFsbGVuZ2UucG9zaXRpb24gPT09ICdvcHBvbmVudCcpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdjaGFsbGVuZ2VyJztcbiAgICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnb3Bwb25lbnQnO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBGaWd1cmUgb3V0IHdobyB0aGUgd2lubmVyIHdhcyB0byBzdG9yZSBpbiB0aGUgY2hhbGxlbmdlIHJlY29yZFxuICAgICAgICB9IGVsc2UgaWYgKHdpbm5lcklzQ3VycmVudFVzZXIpIHtcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci5faWQgPT09IHZtLmN1cnJlbnRVc2VyUGxheWVyLl9pZCkge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEud2lubmVyID0gJ2NoYWxsZW5nZXInO1xuICAgICAgICAgICAgc3dhcFBvc2l0aW9ucyA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLndpbm5lciA9ICdvcHBvbmVudCc7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLl9pZCA9PT0gdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnb3Bwb25lbnQnO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS53aW5uZXIgPSAnY2hhbGxlbmdlcic7XG4gICAgICAgICAgICBzd2FwUG9zaXRpb25zID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTd2FwIHBvc2l0aW9ucyBhbmQgdGhlbiBjb21wbGV0ZSB0aGUgY2hhbGxlbmdlIG9yIGp1c3QgY29tcGxldGUgdGhlIGNoYWxsZW5nZVxuICAgICAgICAvLyBXZWJzb2NrZXQgZXZlbnQgd2lsbCByZWZyZXNoIHRoZSBweXJhbWlkXG4gICAgICAgIGlmIChzd2FwUG9zaXRpb25zKSB7XG4gICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLnN3YXBQb3NpdGlvbnModm0uY29tcGV0aXRpb25JZCwgY2hhbGxlbmdlLmRhdGEub3Bwb25lbnQsIGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBpZiAocmVtb3ZpbmdDdXJyZW50VXNlcikge1xuICAgICAgICAgICAgICAgIHJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHJlbW92aW5nQ3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgcmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0ucHlyYW1pZE1lbnVUb2dnbGUgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxscyB0aGUgY29tcGxldGUgY2hhbGxuZ2UgZnVuY3Rpb24gd2l0aCB0aGUgZm9yZmVpdGluZyBwbGF5ZXJcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHBsYXllclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNoYWxsZW5nZUV4cGlyZWQocGxheWVyKSB7XG4gICAgICBjb21wbGV0ZUNoYWxsZW5nZShudWxsLCB0cnVlLCBwbGF5ZXIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIHRoZSBjdXJyZW50IHVzZXIgdGhlIHB5cmFtaWQgXG4gICAgICogaWYgdGhleSdyZSBub3QgYWxyZWFkeSBvbiBpdCBhbmQgdGhlcmUncyBzcGFjZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZEN1cnJlbnRVc2VyVG9QeXJhbWlkKCkge1xuICAgICAgaWYgKGlkZW50aXR5U2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICBpZiAodm0ubnVtYmVyT2ZSZWFsUGxheWVycyA8IHZtLm1heFBsYXllcnMpIHtcbiAgICAgICAgICB2YXIgcGxheWVyID0ge1xuICAgICAgICAgICAgX2lkOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgbGFzdE5hbWU6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5sYXN0TmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgICBwb3NpdGlvbjogdm0ubnVtYmVyT2ZSZWFsUGxheWVycyArIDFcbiAgICAgICAgICB9O1xuICAgICAgICAgIGlmICh2bS5weXJhbWlkLm9wZW4pIHtcbiAgICAgICAgICAgIHN3YWwoe1xuICAgICAgICAgICAgICB0aXRsZTogJ0pvaW4gQ29tcGV0aXRpb24/JyxcbiAgICAgICAgICAgICAgdGV4dDogJ1lvdVxcJ2xsIGJlIGFkZGVkIHRvIHRoZSBib3R0b20nLFxuICAgICAgICAgICAgICB0eXBlOiAnd2FybmluZycsXG4gICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnSm9pbicsXG4gICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICdOZXZlcm1pbmQnLFxuICAgICAgICAgICAgICBjbG9zZU9uQ29uZmlybTogZmFsc2UsXG4gICAgICAgICAgICAgIGNsb3NlT25DYW5jZWw6IHRydWVcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmFkZFBsYXllclRvUHlyYW1pZCh2bS5jb21wZXRpdGlvbklkLCBwbGF5ZXIpO1xuICAgICAgICAgICAgICBzd2FsKCdXZWxjb21lIEFib2FyZCEnLCAnTm93IHN0YXJ0IGZpZ2h0aW5nIHlvdXIgd2F5IHRvIHRoZSB0b3AnLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgfSk7ICBcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3dhbCh7XG4gICAgICAgICAgICAgIHRpdGxlOiAnU2VuZCBKb2luIFJlcXVlc3Q/JyxcbiAgICAgICAgICAgICAgdGV4dDogJ1RoaXMgaXMgYSBjbG9zZWQgY29tcGV0aXRpb24gc28gdGhlIG93bmVyIG11c3QgYXBwcm92ZSB5b3VyIHJlcXVlc3QnLFxuICAgICAgICAgICAgICB0eXBlOiAnd2FybmluZycsXG4gICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnU2VuZCBSZXF1ZXN0JyxcbiAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ05ldmVybWluZCcsXG4gICAgICAgICAgICAgIGNsb3NlT25Db25maXJtOiBmYWxzZSxcbiAgICAgICAgICAgICAgY2xvc2VPbkNhbmNlbDogdHJ1ZVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBweXJhbWlkc1NlcnZpY2UuYWRkUGxheWVyVG9QeXJhbWlkUmVxdWVzdCh2bS5weXJhbWlkLCBwbGF5ZXIpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZtLmN1cnJlbnRVc2VySXNQZW5kaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHN3YWwoJ1JlcXVlc3QgU2VudCcsICdZb3Ugd2lsbCByZWNlaXZlIGFuIGVtYWlsIG9uY2UgdGhlIG93bmVyIHByb2Nlc3NlcyB0aGUgcmVxdWVzdC4nLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2Uud2FybmluZygnU29ycnksIHRoaXMgcHlyYW1pZCBpcyBmdWxsJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb25maXJtUmVtb3ZlQ3VycmVudFVzZXJGcm9tUHlyYW1pZCgpIHtcbiAgICAgIHN3YWwoe1xuICAgICAgICB0aXRsZTogJ0xlYXZlIFB5cmFtaWQ/JyxcbiAgICAgICAgdGV4dDogJ1lvdSB3aWxsIGxvc2UgeW91ciBzcG90IGFuZCBmb3JmZWl0IGFueSBhY3RpdmUgY2hhbGxlbmdlcy4nLFxuICAgICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLFxuICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ1llcywgbGVhdmUnLFxuICAgICAgICBjb25maXJtQnV0dG9uQ2xhc3M6ICdidG4tZGFuZ2VyJyxcbiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ05vLCBzdGF5JyxcbiAgICAgICAgY2xvc2VPbkNvbmZpcm06IGZhbHNlLFxuICAgICAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlXG4gICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQoKTtcbiAgICAgICAgc3dhbCgnT0ssIHlvdVxcJ3Igb3V0IScsICdZb3VcXCd2ZSBiZWVuIHJlbW92ZWQgZnJvbSB0aGUgcHlyYW1pZC4nLCAnc3VjY2VzcycpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gVXNlIHRoaXMgdG8gZW5mb3JjZSBvcmRlciBvZiBvcGVyYXRpb25zIHdoZW4gdGhlIHBsYXllciB0byBiZSByZW1vdmVkIGhhZCBhbiBhY3RpdmUgY2hhbGxlbmdlXG4gICAgdmFyIHJlbW92aW5nQ3VycmVudFVzZXIgPSBmYWxzZTtcblxuICAgIGZ1bmN0aW9uIHJlbW92ZUN1cnJlbnRVc2VyRnJvbVB5cmFtaWQoKSB7XG4gICAgICAvLyBNYWtlIHN1cmUgdGhlIHVzZXIgaXMgbG9nZ2VkIGluIGFuZCBpcyBvbiB0aGlzIHB5cmFtaWRcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkgJiYgdm0uY3VycmVudFVzZXJJc09uUHlyYW1pZCkge1xuICAgICAgICByZW1vdmluZ0N1cnJlbnRVc2VyID0gdHJ1ZTtcbiAgICAgICAgLy8gRm9yZmVpdCBpZiB0aGV5IGhhdmUgYW4gYWN0aXZlIGNoYWxsZW5nZVxuICAgICAgICBpZiAodm0uaGFzQWN0aXZlQ2hhbGxlbmdlKSB7XG4gICAgICAgICAgY29tcGxldGVDaGFsbGVuZ2UobnVsbCwgdHJ1ZSwgdm0uY3VycmVudFVzZXJQbGF5ZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIFNpbmNlIHdlIGFyZSByZW1vdmluZyB0aGVtIC4uLlxuICAgICAgICAgIHZtLmN1cnJlbnRVc2VySXNPblB5cmFtaWQgPSBmYWxzZTtcbiAgICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSBmYWxzZTtcblxuICAgICAgICAgIC8vIEdldCBhbiB1cGRhdGVkIGNvcHkgb2YgdGhlIHB5cmFtaWQgaW5jYXNlIGEgZm9yZmVpdCBoYXBwZW5lZFxuICAgICAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHApIHtcbiAgICAgICAgICAgIC8vIFN0b3JlIHRoZSB1cGRhdGVkIGNvcHkgbG9jYWxseSBzbyBhcyBub3QgdG8gZGlzdHJ1cHQgdGhlIHB5cmFtaWRcbiAgICAgICAgICAgIC8vIHVudGlsIHRoZSBwbGF5ZXIgaGFzIGJlZW4gcmVtb3ZlZFxuICAgICAgICAgICAgdmFyIHB5cmFtaWQgPSBwLmRhdGE7XG5cbiAgICAgICAgICAgIC8vIEtlZXAgdHJhY2sgb2YgdGhlIHNwb3QgdGhleSB3ZXJlIGluIG9uIHRoZSBweXJhbWlkXG4gICAgICAgICAgICB2YXIgb3BlblBvc2l0aW9uID0gdm0uY3VycmVudFVzZXJQbGF5ZXIucG9zaXRpb247XG5cbiAgICAgICAgICAgIC8vIE1vdmUgYWxsIHRoZSBwbGF5ZXJzIHVwIDEgcG9zaXRpb24gdGhhdCB3ZXJlIGJlaGluZCB0aGUgcmVtb3ZlZCBwbGF5ZXJcbiAgICAgICAgICAgIF8uZm9yRWFjaChweXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgICAgICAgaWYgKHBsYXllci5wb3NpdGlvbiA+PSBvcGVuUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIucG9zaXRpb24gLT0gMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZWQgdGhlIHBsYXllciBmcm9tIHRoZSBweXJhbWlkXG4gICAgICAgICAgICB2YXIgcmVtb3ZlZFBsYXllciA9IF8ucmVtb3ZlKHB5cmFtaWQucGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICAgICAgICByZXR1cm4gcGxheWVyLl9pZCA9PT0gdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIE1ha2UgYSBuZXcgYXJyYXkgb2YgYWxsIHRoZSBwbGF5ZXJzIHN0aWxsIG9uIHRoZSBweXJhbWlkXG4gICAgICAgICAgICAvLyBvbmx5IHVzZSB0aGUgcHJvcGVydGllcyB3ZSB3YW50IHRvIHN0b3JlIGluIHRoZSBweXJhbWlkIGRvY3VtZW50XG4gICAgICAgICAgICB2YXIgdXBkYXRlZFBsYXllcnMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ubnVtYmVyT2ZSZWFsUGxheWVycyAtIDE7ICsraSkge1xuICAgICAgICAgICAgICB2YXIgdXBkYXRlZFBsYXllciA9IHtcbiAgICAgICAgICAgICAgICBfaWQ6IHB5cmFtaWQucGxheWVyc1tpXS5faWQsXG4gICAgICAgICAgICAgICAgZmlyc3ROYW1lOiBweXJhbWlkLnBsYXllcnNbaV0uZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgIGxhc3ROYW1lOiBweXJhbWlkLnBsYXllcnNbaV0ubGFzdE5hbWUsXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHB5cmFtaWQucGxheWVyc1tpXS5wb3NpdGlvblxuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIHVwZGF0ZWRQbGF5ZXJzLnB1c2godXBkYXRlZFBsYXllcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENhbGwgc2VydmljZSB0byByZW1vdmUgdGhlIHBsYXllclxuICAgICAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLnJlbW92ZWRQbGF5ZXJGcm9tUHlyYW1pZCh2bS5jb21wZXRpdGlvbklkLCByZW1vdmVkUGxheWVyWzBdLCB1cGRhdGVkUGxheWVycykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJlbW92aW5nQ3VycmVudFVzZXIgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVmcmVzaCB0aGUgcHlyYW1pZCBiZWNhc3VlIG9mIGFuIHVwZGF0ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlZnJlc2hQeXJhbWlkKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuICAgICAgICBvcmRlclBsYXllcnMoKTtcbiAgICAgICAgZ2V0UGxheWVyc1N0YXR1cygpO1xuICAgICAgICBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKTtcbiAgICAgICAgY2FsY3VsYXRlUHlyYW1pZEJsb2NrcygpO1xuICAgICAgICBmaWxsSW5FbXB0eUJsb2NrcygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jcmVhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOmNoYWxsZW5nZV9jb21wbGV0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIGlmICghcmVtb3ZpbmdDdXJyZW50VXNlcikge1xuICAgICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpwbGF5ZXJfYWRkZWQnLCBmdW5jdGlvbiAoXywgZGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGRldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oZGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cGxheWVyX3JlbW92ZWQnLCBmdW5jdGlvbiAoXywgZGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGRldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oZGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6cHlyYW1pZF91cGRhdGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdrcFVwZGF0ZVBsYXllcnMnLCBrcFVwZGF0ZVBsYXllcnMpO1xuXG4gIGZ1bmN0aW9uIGtwVXBkYXRlUGxheWVycygpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IGN0cmxGdW5jLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHB5cmFtaWQ6ICc9J1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3B5cmFtaWRzL2NvbXBvbmVudHMvdXBkYXRlLXBsYXllcnMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCAkc3RhdGUsICRmaWx0ZXIsIHB5cmFtaWRzU2VydmljZSwgY2hhbGxlbmdlc1NlcnZpY2UpIHtcbiAgICB2YXIgcmVtb3ZlZFBsYXllcnMgPSBbXTtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnVwZGF0ZVB5cmFtaWQgPSB1cGRhdGVQeXJhbWlkO1xuICAgIHZtLmNhbmNlbFVwZGF0ZSA9IGNhbmNlbFVwZGF0ZTtcbiAgICB2bS5yZW9yZGVyUGxheWVycyA9IHJlb3JkZXJQbGF5ZXJzO1xuICAgIHZtLnJlbW92ZVBsYXllciA9IHJlbW92ZVBsYXllcjtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICh2bS5weXJhbWlkKSB7XG4gICAgICAgIHJlbmRlclBsYXllcnModm0ucHlyYW1pZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRGlzcGxheSB0aGUgcGxheWVycyBpbiB0aGUgcHJvcGVyIG9yZGVyXG4gICAgZnVuY3Rpb24gcmVuZGVyUGxheWVycyhweXJhbWlkKSB7XG4gICAgICBweXJhbWlkLnBsYXllcnMgPSAkZmlsdGVyKCdvcmRlckJ5JykocHlyYW1pZC5wbGF5ZXJzLCAncG9zaXRpb24nKTtcbiAgICB9XG5cbiAgICAvLyBQZXJmb3JtIHRoZSB1cGRhdGVzIHRoYXQgd2VyZSByZXF1c3RlZFxuICAgIGZ1bmN0aW9uIHVwZGF0ZVB5cmFtaWQoKSB7XG4gICAgICBfLmZvckVhY2gocmVtb3ZlZFBsYXllcnMsIGZ1bmN0aW9uKHBsYXllcikge1xuICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5kZWxldGVBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIodm0ucHlyYW1pZC5faWQsIHBsYXllci5faWQpO1xuICAgICAgfSk7XG4gICAgICBweXJhbWlkc1NlcnZpY2UudXBkYXRlUHlyYW1pZCh2bS5weXJhbWlkKTsgICAgICBcbiAgICB9XG5cbiAgICAvLyBDYW5jZWwgdGhlIHVwZGF0ZSBhbmQgcHV0IGV2ZXJ5dGhpbmcgYmFjayB0byB0aGUgb3JnaW5hbFxuICAgIGZ1bmN0aW9uIGNhbmNlbFVwZGF0ZSgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLnB5cmFtaWQuX2lkKS50aGVuKGZ1bmN0aW9uIChweXJhbWlkKSB7XG4gICAgICAgIHZtLnB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBSZW9yZGVyIHRoZSBwbGF5ZXJzIGJhc2VkIG9uIHRoZSBkcmFnLWRyb3BcbiAgICBmdW5jdGlvbiByZW9yZGVyUGxheWVycygpIHtcbiAgICAgIHZhciBpID0gMTtcbiAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgcGxheWVyLnBvc2l0aW9uID0gaTtcbiAgICAgICAgKytpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUXVldWUgdXAgdGhlIHBsYXllcnMgdG8gYmUgcmVtb3ZlZCBhbmQgcmVtb3ZlIHRoZW0gZnJvbSB0aGUgZGlzcGxheVxuICAgIGZ1bmN0aW9uIHJlbW92ZVBsYXllcihwbGF5ZXIsIHBsYXllckluZGV4KSB7XG4gICAgICByZW1vdmVkUGxheWVycy5wdXNoKHBsYXllcik7XG4gICAgICB2bS5weXJhbWlkLnBsYXllcnMuc3BsaWNlKHBsYXllckluZGV4LCAxKTtcbiAgICAgIHJlb3JkZXJQbGF5ZXJzKCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ3B5cmFtaWRzU2VydmljZScsIHB5cmFtaWRzU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gcHlyYW1pZHNTZXJ2aWNlKCRodHRwKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBnZXRQeXJhbWlkOiBnZXRQeXJhbWlkLFxuICAgICAgZ2V0UHlyYW1pZHNGb3JVc2VyOiBnZXRQeXJhbWlkc0ZvclVzZXIsXG4gICAgICBnZXRQeXJhbWlkczogZ2V0UHlyYW1pZHMsXG4gICAgICBjcmVhdGVQeXJhbWlkOiBjcmVhdGVQeXJhbWlkLFxuICAgICAgdXBkYXRlUHlyYW1pZDogdXBkYXRlUHlyYW1pZCxcbiAgICAgIHN3YXBQb3NpdGlvbnM6IHN3YXBQb3NpdGlvbnMsXG4gICAgICBhZGRQbGF5ZXJUb1B5cmFtaWQ6IGFkZFBsYXllclRvUHlyYW1pZCxcbiAgICAgIGFkZFBsYXllclRvUHlyYW1pZFJlcXVlc3Q6IGFkZFBsYXllclRvUHlyYW1pZFJlcXVlc3QsXG4gICAgICByZW1vdmVkUGxheWVyRnJvbVB5cmFtaWQ6IHJlbW92ZWRQbGF5ZXJGcm9tUHlyYW1pZCxcbiAgICAgIGFwcHJvdmVQZW5kaW5nUGxheWVyOiBhcHByb3ZlUGVuZGluZ1BsYXllcixcbiAgICAgIGRlbnlQZW5kaW5nUGxheWVyOiBkZW55UGVuZGluZ1BsYXllclxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIC8qKlxuICAgICAqIEdldHMgYSBweXJhbWlkIGZyb20gdGhlIGRhdGFiYXNlIChvciBtZW1vcnkpXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcHlyYW1pZCBpZCBmb3IgdGhlIHJlcXVlc3RlZCBweXJhbWlkXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBweXJhbWlkXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZChjb21wZXRpdGlvbklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3B5cmFtaWQnLCB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhbGwgcHlyYW1pZHMgZnJvbSB0aGUgZGF0YWJhc2UgdGhhdCBhIHBhcnRpY3VsYXIgdXNlciBpcyBpbmNsdWRlZCBpblxuICAgICAqXG4gICAgICogQHBhcmFtIHt1c2VySWR9IHRoZSB1c2VyIGlkIGZvciB0aGUgcmVxdWVzdGVkIHVzZXJcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IHB5cmFtaWRzXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UHlyYW1pZHNGb3JVc2VyKHVzZXJJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9weXJhbWlkcy91c2VyJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICB1c2VySWQ6IHVzZXJJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGFsbCBhY3RpdmUgcHlyYW1pZHMgZnJvbSB0aGUgZGF0YWJhc2VcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge09iamVjdH0gcHlyYW1pZHNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRQeXJhbWlkcygpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcHlyYW1pZHMnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVQeXJhbWlkKHB5cmFtaWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2NyZWF0ZScsIHtcbiAgICAgICAgcHlyYW1pZDogcHlyYW1pZFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlUHlyYW1pZChweXJhbWlkKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy91cGRhdGUnLCB7XG4gICAgICAgIHB5cmFtaWQ6IHB5cmFtaWRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN3YXBQb3NpdGlvbnMoY29tcGV0aXRpb25JZCwgY2hhbGxlbmdlciwgb3Bwb25lbnQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL3N3YXBQb3NpdGlvbnMnLCB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgIGNoYWxsZW5nZXI6IGNoYWxsZW5nZXIsXG4gICAgICAgIG9wcG9uZW50OiBvcHBvbmVudFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkUGxheWVyVG9QeXJhbWlkKGNvbXBldGl0aW9uSWQsIHBsYXllcikge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvYWRkUGxheWVyJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkUGxheWVyVG9QeXJhbWlkUmVxdWVzdChjb21wZXRpdGlvbiwgcGxheWVyKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9hZGRQbGF5ZXJSZXF1ZXN0Jywge1xuICAgICAgICBjb21wZXRpdGlvbjogY29tcGV0aXRpb24sXG4gICAgICAgIHBsYXllcjogcGxheWVyXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmVkUGxheWVyRnJvbVB5cmFtaWQoY29tcGV0aXRpb25JZCwgcmVtb3ZlZFBsYXllciwgcGxheWVycykge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvcmVtb3ZlUGxheWVyJywge1xuICAgICAgICBjb21wZXRpdGlvbklkOiBjb21wZXRpdGlvbklkLFxuICAgICAgICByZW1vdmVkUGxheWVyOiByZW1vdmVkUGxheWVyLFxuICAgICAgICBwbGF5ZXJzOiBwbGF5ZXJzXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhcHByb3ZlUGVuZGluZ1BsYXllcihjb21wZXRpdGlvbklkLCBwbGF5ZXIpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2FwcHJvdmVQbGF5ZXInLCB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgIHBsYXllcjogcGxheWVyXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZW55UGVuZGluZ1BsYXllcihjb21wZXRpdGlvbklkLCBwbGF5ZXIpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3B5cmFtaWRzL2RlbnlQbGF5ZXInLCB7XG4gICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgIHBsYXllcjogcGxheWVyXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQWRtaW5DdHJsJywgQWRtaW5DdHJsKTtcblxuICBmdW5jdGlvbiBBZG1pbkN0cmwoJHNjb3BlLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgJGZpbHRlciwgcHlyYW1pZHNTZXJ2aWNlLCBjaGFsbGVuZ2VzU2VydmljZSwgaWRlbnRpdHlTZXJ2aWNlLCBub3RpZnlTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jb21wZXRpdGlvbklkID0gbnVsbDtcbiAgICB2bS51cGRhdGVQeXJhbWlkT3BlblN0YXR1cyA9IHVwZGF0ZVB5cmFtaWRPcGVuU3RhdHVzO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIHZtLmNvbXBldGl0aW9uSWQgPSAkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZDtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMubXlQeXJhbWlkcycpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlZnJlc2hQeXJhbWlkKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhpcyB1c2VyIGlzIGFuIG93bmVyIG9mIHRoaXMgY29tcGV0aXRpb25cbiAgICAgICAgaWYgKHB5cmFtaWQuZGF0YSAmJiBfLnNvbWUocHlyYW1pZC5kYXRhLm93bmVycywgWydfaWQnLCBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuX2lkXSkpIHtcbiAgICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMubXlQeXJhbWlkcycpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBQZXJmb3JtIHRoZSB1cGRhdGVzIHRoYXQgd2VyZSByZXF1c3RlZFxuICAgIGZ1bmN0aW9uIHVwZGF0ZVB5cmFtaWRPcGVuU3RhdHVzKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICB2YXIgdXBkYXRlZFB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICAgIHVwZGF0ZWRQeXJhbWlkLm9wZW4gPSB2bS5weXJhbWlkLm9wZW47XG4gICAgICAgIHB5cmFtaWRzU2VydmljZS51cGRhdGVQeXJhbWlkKHVwZGF0ZWRQeXJhbWlkKTtcbiAgICAgIH0pOyAgICAgIFxuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjaGFsbGVuZ2VfY29tcGxldGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggZm9yIHdlYnNvY2tldCBldmVudFxuICAgICRzY29wZS4kb24oJ3dzOnBsYXllcl9hZGRlZCcsIGZ1bmN0aW9uIChfLCBkZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gZGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhkZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpwbGF5ZXJfcmVtb3ZlZCcsIGZ1bmN0aW9uIChfLCBkZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gZGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhkZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpweXJhbWlkX3VwZGF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBub3RpZnlTZXJ2aWNlLmluZm8oY2hhbGxlbmdlRGV0YWlscy5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJlZnJlc2hQeXJhbWlkKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiLyoqXG4gKiBDcmVhdGVzIGEgcHlyYW1pZFxuICovXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdDcmVhdGVQeXJhbWlkQ3RybCcsIENyZWF0ZVB5cmFtaWRDdHJsKTtcblxuICBmdW5jdGlvbiBDcmVhdGVQeXJhbWlkQ3RybCgkc3RhdGUsIHVzZXJTZXJ2aWNlLCBweXJhbWlkc1NlcnZpY2UsIG5vdGlmeVNlcnZpY2UsIGlkZW50aXR5U2VydmljZSkge1xuICAgIHZhciBicmVha1BvaW50cyA9IFtdO1xuICAgIHZhciBtYXhMZXZlbHMgPSAxMDtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLm5ld1B5cmFtaWQgPSB7XG4gICAgICBwbGF5ZXJzOiBbXSxcbiAgICAgIG9wZW46IGZhbHNlXG4gICAgfTtcbiAgICB2bS5hdmFpbGFibGVQbGF5ZXJzID0gW107XG4gICAgdm0uYWRkZWRQbGF5ZXJzID0gW107XG4gICAgdm0uY3JlYXRlUHlyYW1pZCA9IGNyZWF0ZVB5cmFtaWQ7XG4gICAgdm0uYWRkUGxheWVyID0gYWRkUGxheWVyO1xuICAgIHZtLnJlbW92ZVBsYXllciA9IHJlbW92ZVBsYXllcjtcbiAgICB2bS5yZW9yZGVyUGxheWVycyA9IHJlb3JkZXJQbGF5ZXJzO1xuICAgIHZtLm5ld1B5cmFtaWQuZm9yZmVpdERheXMgPSAxO1xuXG4gICAgYWN0aXZhdGUoKTtcbiAgICBcbiAgICAvKipcbiAgICAgKiBSdW5zIG9uIGNvbnRyb2xsZXIgaW5zdGFudGlhdGlvblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgdXNlclNlcnZpY2UuZ2V0QWxsVXNlcnMoKS50aGVuKGZ1bmN0aW9uICh1c2Vycykge1xuICAgICAgICB2bS5hdmFpbGFibGVQbGF5ZXJzID0gdXNlcnMuZGF0YTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDcmVhdGUgYnJlYWsgcG9pbnRzIGFycmF5XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1heExldmVsczsgaSsrKSB7XG4gICAgICAgIGJyZWFrUG9pbnRzLnB1c2goKCgoaSAqIChpICsgMSkpIC8gMikpICsgMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBhIHBsYXllciB0byB0aGUgbmV3IHB5cmFtaWRcbiAgICAgKiBDaGVja3MgdG8gbWFrZSBzdXJlIHlvdSBhcmUgbm90IGFkZGluZyB0b28gbWFueSBwbGF5ZXJzXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBwbGF5ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhZGRQbGF5ZXIocGxheWVyKSB7XG4gICAgICBwbGF5ZXIucG9zaXRpb24gPSB2bS5hZGRlZFBsYXllcnMubGVuZ3RoICsgMTtcbiAgICAgIHZtLmFkZGVkUGxheWVycy5wdXNoKF8ucmVtb3ZlKHZtLmF2YWlsYWJsZVBsYXllcnMsIHtfaWQ6IHBsYXllci5faWR9KVswXSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhIHByZXZpdW9zbHkgYWRkZWQgcGxheWVyIGZyb20gdGhlIHB5cmFtaWRcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHBsYXllclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlbW92ZVBsYXllcihwbGF5ZXIpIHtcbiAgICAgIHZtLmF2YWlsYWJsZVBsYXllcnMucHVzaChfLnJlbW92ZSh2bS5hZGRlZFBsYXllcnMsIHtfaWQ6IHBsYXllci5faWR9KVswXSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVvcmRlciB0aGUgcGxheWVycyBiYXNlZCBvbiB0aGUgZHJhZy1kcm9wXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVvcmRlclBsYXllcnMoKSB7XG4gICAgICB2YXIgaSA9IDE7XG4gICAgICBfLmZvckVhY2godm0uYWRkZWRQbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG4gICAgICAgIHBsYXllci5wb3NpdGlvbiA9IGk7XG4gICAgICAgICsraTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFVzZWQgdG8ga2VlcCB0cmFjayBvZiBwb3NpdGlvbiBvbiB0aGUgcHlyYW1pZCBiYXNlZCBvbiB3aGVuIHRoZSBwbGF5ZXIgd2FzIGFkZGVkXG4gICAgdmFyIHBvc2l0aW9uID0gMDtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSB0aGUgcHlyYW1pZFxuICAgICAqIEBwYXJhbSAge29iamVjdH0gcHlyYW1pZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZVB5cmFtaWQocHlyYW1pZCkge1xuICAgICAgYW5ndWxhci5mb3JFYWNoKHZtLmFkZGVkUGxheWVycywgZnVuY3Rpb24gKHBsYXllcikge1xuICAgICAgICBwb3NpdGlvbiArPSAxO1xuICAgICAgICB2YXIgYWRkUGxheWVyID0ge1xuICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbixcbiAgICAgICAgICBfaWQ6IHBsYXllci5faWQsXG4gICAgICAgICAgZW1haWw6IHBsYXllci51c2VybmFtZSxcbiAgICAgICAgICBmaXJzdE5hbWU6IHBsYXllci5maXJzdE5hbWUsXG4gICAgICAgICAgbGFzdE5hbWU6IHBsYXllci5sYXN0TmFtZVxuICAgICAgICB9O1xuICAgICAgICBweXJhbWlkLnBsYXllcnMucHVzaChhZGRQbGF5ZXIpO1xuICAgICAgfSk7XG4gICAgICBweXJhbWlkLm93bmVycyA9IFt7XG4gICAgICAgIF9pZDogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCxcbiAgICAgICAgZW1haWw6IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci51c2VybmFtZSxcbiAgICAgICAgZmlyc3ROYW1lOiBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIuZmlyc3ROYW1lLFxuICAgICAgICBsYXN0TmFtZTogaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmxhc3ROYW1lXG4gICAgICB9XTtcblxuICAgICAgLy8gRmlndXJlIG91dCB0aGUgbnVtYmVyIG9mIGxldmVscyBiYXNlZCBvbiB0aGUgbnVtYmVyIG9mIHBsYXllcnNcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnJlYWtQb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHB5cmFtaWQucGxheWVycy5sZW5ndGggPCBicmVha1BvaW50c1tpXSkge1xuICAgICAgICAgIHB5cmFtaWQubGV2ZWxzID0gaTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBweXJhbWlkc1NlcnZpY2UuY3JlYXRlUHlyYW1pZChweXJhbWlkKS50aGVuKGZ1bmN0aW9uIChuZXdQeXJhbWlkKSB7XG4gICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMudmlldycsIHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiBuZXdQeXJhbWlkLmRhdGEuX2lkXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ015UHlyYW1pZHNDdHJsJywgTXlQeXJhbWlkc0N0cmwpO1xuXG4gIGZ1bmN0aW9uIE15UHlyYW1pZHNDdHJsKCkge1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge31cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdQeXJhbWlkQ3RybCcsIFB5cmFtaWRDdHJsKTtcblxuICBmdW5jdGlvbiBQeXJhbWlkQ3RybCgkc3RhdGUsICRzdGF0ZVBhcmFtcywgcHlyYW1pZHNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jb21wZXRpdGlvbklkID0gbnVsbDtcbiAgICB2bS5weXJhbWlkID0gbnVsbDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICgkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICB2bS5jb21wZXRpdGlvbklkID0gJHN0YXRlUGFyYW1zLmNvbXBldGl0aW9uSWQ7XG5cbiAgICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICAgIGlmIChweXJhbWlkLmRhdGEpIHtcbiAgICAgICAgICAgIHZtLnB5cmFtaWQgPSBweXJhbWlkLmRhdGE7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygncHlyYW1pZHMubXlQeXJhbWlkcycpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1B5cmFtaWRzQ3RybCcsIFB5cmFtaWRzQ3RybCk7XG5cbiAgZnVuY3Rpb24gUHlyYW1pZHNDdHJsKCkge1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge31cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdTdGF0c0N0cmwnLCBTdGF0c0N0cmwpO1xuXG4gIGZ1bmN0aW9uIFN0YXRzQ3RybCgkc3RhdGVQYXJhbXMsICRzdGF0ZSwgcHlyYW1pZHNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jb21wZXRpdGlvbklkID0gbnVsbDtcbiAgICB2bS5weXJhbWlkID0gbnVsbDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICgkc3RhdGVQYXJhbXMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICB2bS5jb21wZXRpdGlvbklkID0gJHN0YXRlUGFyYW1zLmNvbXBldGl0aW9uSWQ7XG4gICAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgICBpZiAocHlyYW1pZC5kYXRhKSB7XG4gICAgICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLm15UHlyYW1pZHMnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2NPdmVyZmxvdycsIGNPdmVyZmxvdyk7XG5cbiAgZnVuY3Rpb24gY092ZXJmbG93KHNjcm9sbGJhclNlcnZpY2UpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICB2YXIgc2Nyb2xsYXhpcyA9IGF0dHJzLnNjcm9sbGF4aXMgfHwgJ3knO1xuICAgICAgdmFyIHRoZW1lID0gYXR0cnMudGhlbWUgfHwgJ21pbmltYWwtZGFyayc7XG4gICAgICB2YXIgbW91c2V3aGVlbGF4aXMgPSBhdHRycy5tb3VzZXdoZWVsYXhpcyB8fCAneSc7XG4gICAgICBpZiAoISQoJ2h0bWwnKS5oYXNDbGFzcygnaXNtb2JpbGUnKSkge1xuICAgICAgICBzY3JvbGxiYXJTZXJ2aWNlLm1hbGlodVNjcm9sbChlbGVtZW50LCB0aGVtZSwgc2Nyb2xsYXhpcywgbW91c2V3aGVlbGF4aXMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ3RvZ2dsZVN1Ym1lbnUnLCB0b2dnbGVTdWJtZW51KTtcblxuICBmdW5jdGlvbiB0b2dnbGVTdWJtZW51KCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWwpIHtcbiAgICAgIGVsLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZWwubmV4dCgpLnNsaWRlVG9nZ2xlKDIwMCk7XG4gICAgICAgIGVsLnBhcmVudCgpLnRvZ2dsZUNsYXNzKCd0b2dnbGVkJyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCd3YXZlc0VmZmVjdCcsIHdhdmVzRWZmZWN0KTtcblxuICBmdW5jdGlvbiB3YXZlc0VmZmVjdCgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdidG4taWNvbicpIHx8IGVsZW1lbnQuaGFzQ2xhc3MoJ2J0bi1mbG9hdCcpKSB7XG4gICAgICAgIFdhdmVzLmF0dGFjaChlbGVtZW50LCBbJ3dhdmVzLWNpcmNsZSddKTtcbiAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5oYXNDbGFzcygnYnRuLWxpZ2h0JykpIHtcbiAgICAgICAgV2F2ZXMuYXR0YWNoKGVsZW1lbnQsIFsnd2F2ZXMtbGlnaHQnXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBXYXZlcy5hdHRhY2goZWxlbWVudCk7XG4gICAgICB9XG5cbiAgICAgIFdhdmVzLmluaXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdmZ0xpbmUnLCBmZ0xpbmUpO1xuXG4gIGZ1bmN0aW9uIGZnTGluZSgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgIHZhciBpbnB1dCA9IGVsZW1lbnQuY2hpbGRyZW4oKS5maXJzdCgpO1xuICAgICAgdmFyIGlzRmxvYXRMYWJlbCA9IGVsZW1lbnQucGFyZW50KCkuaGFzQ2xhc3MoJ2ZnLWZsb2F0Jyk7XG4gICAgICBpbnB1dC5mb2N1cyhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ2ZnLXRvZ2dsZWQnKTtcbiAgICAgIH0pO1xuXG4gICAgICBpbnB1dC5ibHVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFpc0Zsb2F0TGFiZWwgfHwgKGlzRmxvYXRMYWJlbCAmJiBpbnB1dC52YWwoKS5sZW5ndGggPT09IDApKSB7XG4gICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnZmctdG9nZ2xlZCcpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
