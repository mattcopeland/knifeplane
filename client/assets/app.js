angular.module("app",["ui.router","ui.bootstrap","ngAnimate","angular-loading-bar","nouislider","localytics.directives","timer","luegg.directives"]),function(){"use strict ";function e(e){e.defaults.headers.get||(e.defaults.headers.get={}),e.defaults.headers.get["If-Modified-Since"]="Fri, 01 Jan 2016 05:00:00 GMT",e.defaults.headers.get["Cache-Control"]="no-cache",e.defaults.headers.get.Pragma="no-cache"}e.$inject=["$httpProvider"],angular.module("app").config(e)}(),function(){"use strict";function e(e){var t=this;t.$state=e}e.$inject=["$state"],angular.module("app").controller("AppCtrl",e)}(),function(){"use strict";function e(e,i,a){var o={superAdmin:r,admin:t,user:n};a.html5Mode(!0),i.otherwise("/"),i.when("/pyramids/","/pyramids"),e.state("home",{url:"/",views:{content:{controller:"HomeCtrl",controllerAs:"vm",templateUrl:"common/views/home.html"}}}).state("pyramids",{url:"/pyramids",views:{content:{controller:"PyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramids.html"}}}).state("pyramids.myPyramids",{url:"/my-pyramids",views:{"content@":{controller:"MyPyramidsCtrl",controllerAs:"vm",templateUrl:"pyramids/views/my-pyramids.html"}},resolve:{auth:o.user}}).state("pyramids.view",{url:"/view/:pyramidId",views:{"content@":{controller:"PyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/pyramid.html"}}}).state("pyramids.create",{url:"/create",views:{"content@":{controller:"CreatePyramidCtrl",controllerAs:"vm",templateUrl:"pyramids/views/create-pyramid.html"}},resolve:{auth:o.user}}).state("login",{url:"/login",views:{content:{controller:"LoginCtrl",controllerAs:"vm",templateUrl:"authentication/views/login.html"}}}).state("register",{url:"/register",views:{content:{controller:"RegisterCtrl",controllerAs:"vm",templateUrl:"authentication/views/register.html"}}})}function t(e){return e.authorizeCurrentUserForRoute("admin")}function r(e){return e.authorizeCurrentUserForRoute("super-admin")}function n(e){return e.authenticatedUserForRoute()}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app").config(e),t.$inject=["authService"],r.$inject=["authService"],n.$inject=["authService"]}(),function(){"use strict";function e(e,t,r){e.$on("$stateChangeError",function(e,r,n,i,a,o){"not authorized"===o&&(t.go("login"),t.previous=r)}),e.$on("$stateChangeStart",function(){r.setSidebarStatus(!1)})}e.$inject=["$rootScope","$state","sidebarService"],angular.module("app").run(e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",scope:{competitionId:"@"},templateUrl:"/challenges/components/active-challenges.html"};return e}function t(e,t){function r(){n()}function n(){i.challenges=[],t.getActiveChallengesByCompetition(i.competitionId).then(function(e){e.data.length>0&&(i.challenges=e.data,_.forEach(i.challenges,function(e){0!==e.timeLimit&&(e.expires=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1)}))})}var i=this;i.challenges=[],r(),e.$on("ws:challenge_created",function(e,t){i.competitionId===t.competitionId&&n()}),e.$on("ws:challenge_completed",function(e,t){i.competitionId===t.competitionId&&n()})}t.$inject=["$scope","challengesService"],angular.module("app").directive("kpActiveChalleneges",e)}(),function(){"use strict";function e(e){function t(t){return e.post("/api/challenges/create",{challenge:t})}function r(t){return e.post("/api/challenges/complete",{challenge:t})}function n(t){return e.get("/api/challenges/competition",{params:{competitionId:t}})}function i(t){return e.get("/api/challenges/active/competition",{params:{competitionId:t}})}function a(t,r){return e.get("/api/challenges/active/competition/player",{params:{competitionId:t,playerId:r}})}var o={createChallenge:t,completeChallenge:r,getChallengesByCompetition:n,getActiveChallengesByCompetition:i,getActiveChallengeByCompetitionByPlayer:a};return o}e.$inject=["$http"],angular.module("app").factory("challengesService",e)}(),function(){"use strict";function e(e,t,r,n,i){function a(e,n){var a=r.defer();return t.post("/login",{username:e,password:n}).then(function(e){e.data.success?(i.currentUser=e.data.user,a.resolve(!0)):a.resolve(!1)}),a.promise}function o(e){var n=r.defer();return t.post("/api/users",{userData:e}).then(function(e){e.data?(i.currentUser=e.data,n.resolve(!0)):n.resolve(!1)}),n.promise}function l(){var n=r.defer();return t.post("/logout",{logout:!0}).then(function(){i.currentUser=void 0,n.resolve(),e.go("home")}),n.promise}function c(e){return!!i.isAuthorized(e)||r.reject("not authorized")}function s(){return!!i.isAuthenticated()||r.reject("not authorized")}var u={authenticateUser:a,createUser:o,logout:l,authorizeCurrentUserForRoute:c,authenticatedUserForRoute:s};return u}e.$inject=["$state","$http","$q","userService","identityService"],angular.module("app").factory("authService",e)}(),function(){"use strict";function e(e,t){function r(){return e.get("/api/users").then(function(e){return e})}var n={getAllUsers:r};return n}e.$inject=["$http","identityService"],angular.module("app").factory("userService",e)}(),function(){"use strict";function e(e,t,r){function n(){}function i(n,i){t.authenticateUser(n,i).then(function(t){t?e.previous?e.go(e.previous):e.go("home"):r.error("Username / password combinaiton incorrect")})}var a=this;a.login=i,n()}e.$inject=["$state","authService","notifyService"],angular.module("app").controller("LoginCtrl",e)}(),function(){"use strict";function e(e,t,r,n){function i(){}function a(e){e.password!==e.confirmPassword?n.error("Passwords don't match!"):r.createUser(e).then(function(e){t.go("home")})}var o=this;o.register=a,i()}e.$inject=["$scope","$state","authService","notifyService"],angular.module("app").controller("RegisterCtrl",e)}(),function(){"use strict";function e(e){function t(t){return e.get("/api/pyramid",{params:{pyramidId:t}})}function r(t){return e.get("/api/pyramids/user",{params:{userId:t}})}function n(t){return e.post("/api/pyramids/create",{pyramid:t})}function i(t,r,n){return e.post("/api/pyramids/swapPositions",{pyramidId:t,challenger:r,opponent:n})}function a(t,r){return e.post("/api/pyramids/addPlayer",{pyramidId:t,player:r})}var o={getPyramid:t,getPyramidsForUser:r,createPyramid:n,swapPositions:i,addPlayerToPyramid:a};return o}e.$inject=["$http"],angular.module("app").factory("pyramidsService",e)}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"/pyramids/components/pyramid.html",replace:!0,scope:{competitionId:"@"},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(e,t,r,n,i,a){function o(){t.getPyramid(h.competitionId).then(function(e){h.pyramid=e.data,h.levels=[];for(var t=1;t<=e.data.levels;++t)h.levels.push(t);l(),c(),u(),d(),p()})}function l(){h.pyramid.players=r("orderBy")(h.pyramid.players,"position")}function c(){_.forEach(h.pyramid.players,function(e){i.currentUser&&e._id===i.currentUser._id&&(h.isCurrentUserOnPyramid=!0,e.class="current-user",h.currentUserPlayer=e,a.getActiveChallengeByCompetitionByPlayer(h.competitionId,e._id).then(function(e){e.data&&(h.hasActiveChallenge=!0)}))}),a.getActiveChallengesByCompetition(h.competitionId).then(function(e){_.forEach(e.data,function(e){var t=_.find(h.pyramid.players,{_id:e.challenger._id});t.class="unavailable",t.challenge={position:"challenger"};var r=_.find(h.pyramid.players,{_id:e.opponent._id});if(r.class="unavailable",r.challenge={position:"opponent"},0!==e.timeLimit){var n=moment().diff(moment(e.created).add(e.timeLimit,"d"),"s")*-1;n>0?r.challenge.expires=n:n<=0&&g(null,!0,r)}}),m()})}function s(){h.breakPoints=[];for(var e=0;e<h.pyramid.levels;e++)h.breakPoints.push(e*(e+1)/2+1)}function u(){h.numberOfBlocks=0;for(var e=h.pyramid.levels;e>0;e--)h.numberOfBlocks+=e}function d(){for(var e=h.pyramid.players.length;e<h.numberOfBlocks;e++)h.pyramid.players.push({firstName:"Empty",lastName:"Spot",position:99,class:"empty"})}function p(){var e=0;s();for(var t=0;t<h.pyramid.players.length;t++)h.breakPoints.indexOf(t+1)>-1&&(e+=1),h.pyramid.players[t].level=e}function m(){var e=h.currentUserPlayer.level>1?h.currentUserPlayer.level-1:null;_.forEach(h.pyramid.players,function(t){t.level===e&&99!==t.position&&"unavailable"!==t.class&&(h.availableChallenges=!0,t.available=!0)})}function f(e){if(e.available){h.hasActiveChallenge=!0;var t={competitionId:h.competitionId,complete:!1,forfeit:!1,timeLimit:h.pyramid.forfeitDays,challenger:{_id:h.currentUserPlayer._id,firstName:h.currentUserPlayer.firstName,lastName:h.currentUserPlayer.lastName,nickname:h.currentUserPlayer.nickname,position:h.currentUserPlayer.position},opponent:{_id:e._id,firstName:e.firstName,lastName:e.lastName,nickname:e.nickname,position:e.position}};a.createChallenge(t).then(function(){y(),h.pyramidMenuToggle=!1})}else n.error("Sorry, that is not a valid challenge.")}function g(e,r,n){var i=n||h.currentUserPlayer;a.getActiveChallengeByCompetitionByPlayer(h.competitionId,i._id).then(function(n){h.hasActiveChallenge=!1;var i=!1;r?(n.data.forfeit=!0,n.data.challenger.winner=!0,i=!0):e?n.data.challenger._id===h.currentUserPlayer._id?(n.data.challenger.winner=!0,i=!0):n.data.opponent.winner=!0:n.data.challenger._id===h.currentUserPlayer._id?n.data.opponent.winner=!0:(n.data.challenger.winner=!0,i=!0),i?t.swapPositions(h.competitionId,n.data.opponent,n.data.challenger).then(function(){a.completeChallenge(n.data)}):a.completeChallenge(n.data),h.pyramidMenuToggle=!1})}function v(e){g(null,!0,e)}function y(){t.getPyramid(h.competitionId).then(function(e){h.pyramid=e.data,l(),c(),d(),p()})}var h=this;h.pyramid={},h.breakPoints=[],h.numberOfBlocks=0,h.isCurrentUserOnPyramid=!1,h.hasActiveChallenge=!1,h.availableChallenges=!1,h.createChallenge=f,h.completeChallenge=g,h.challengeExpired=v,h.currentUserPlayer={},h.pyramidMenuToggle=!1,o(),e.$on("ws:challenge_created",function(e,t){h.competitionId===t.competitionId&&(n.info(t.description),y())}),e.$on("ws:challenge_completed",function(e,t){h.competitionId===t.competitionId&&(n.info(t.description),y())})}t.$inject=["$scope","pyramidsService","$filter","notifyService","identityService","challengesService"],angular.module("app").directive("kpPyramid",e)}(),function(){"use strict";function e(e,t,r,n){function i(){r.getAllUsers().then(function(e){l.availablePlayers=e.data})}function a(e){c+=1;var t={position:c,_id:e._id,firstName:e.firstName,lastName:e.lastName,nickname:e.nickname};l.newPyramid.players.push(t),_.remove(l.availablePlayers,{_id:e._id})}function o(t){n.createPyramid(t).then(function(t){e.go("pyramids.view",{pyramidId:t.data._id})})}var l=this;l.availablePlayers=[],l.addPlayerToPyramid=a,l.createPyramid=o,i();var c=0}e.$inject=["$state","$stateParams","userService","pyramidsService"],angular.module("app").controller("AddPlayerCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){t.getAllUsers().then(function(e){c.availablePlayers=e.data})}function i(e){c.addedPlayerAdded=!0,c.addedPlayers.push(_.remove(c.availablePlayers,{_id:e._id})[0])}function a(e){c.availablePlayerAdded=!0,c.addedPlayerAdded=!1,c.availablePlayers.push(_.remove(c.addedPlayers,{_id:e._id})[0])}function o(e){console.log(e)}function l(t){angular.forEach(c.addedPlayers,function(e){s+=1;var t={position:s,_id:e._id,firstName:e.firstName,lastName:e.lastName,nickname:e.nickname};c.newPyramid.players.push(t)}),r.createPyramid(t).then(function(t){e.go("pyramids.view",{pyramidId:t.data._id})})}var c=this;c.newPyramid={players:[]},c.availablePlayers=[],c.addedPlayers=[],c.createPyramid=l,c.addPlayer=i,c.removePlayer=a,c.updateAllowedPlayers=o,c.newPyramid.levels=4,c.newPyramid.forfeitDays=1,n();var s=0}e.$inject=["$state","userService","pyramidsService"],angular.module("app").controller("CreatePyramidCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){t.getPyramidsForUser(r.currentUser._id).then(function(e){i.pyramids=e.data})}var i=this;i.pyramids=null,n()}e.$inject=["$state","pyramidsService","identityService"],angular.module("app").controller("MyPyramidsCtrl",e)}(),function(){"use strict";function e(e){function t(){e.pyramidId&&(r.pyramidId=e.pyramidId)}var r=this;r.pyramidId=null,t()}e.$inject=["$stateParams"],angular.module("app").controller("PyramidCtrl",e)}(),function(){"use strict";function e(){function e(){}var t=this;t.pyramids=null,e()}angular.module("app").controller("PyramidsCtrl",e)}(),function(){"use strict";function e(e){function t(){return!!this.currentUser}function r(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}var n;null!==e.bootstrappedUserObject&&(n=e.bootstrappedUserObject);var i={currentUser:n,isAuthenticated:t,isAuthorized:r};return i}e.$inject=["$window"],angular.module("app").factory("identityService",e)}(),function(){"use strict";function e(){function e(e,t,r){$.notify({message:e,url:t,target:r},{type:"info"})}function t(e,t,r){$.notify({message:e,url:t,target:r},{type:"success"})}function r(e,t,r){$.notify({message:e,url:t,target:r},{type:"warning"})}function n(e,t,r){$.notify({message:e,url:t,target:r},{type:"danger"})}function i(e,t,r){$.notify({message:e,url:t,target:r},{type:"inverse"})}var a={info:e,success:t,warning:r,error:n,inverse:i};return $.notifyDefaults({newest_on_top:!0,offset:{x:20,y:85}}),a}angular.module("app").factory("notifyService",e)}(),function(){"use strict";function e(){function e(){return r}function t(e){r.left=e}var r={left:!1,right:!1},n={getSidebarStatus:e,setSidebarStatus:t};return n}angular.module("app").factory("sidebarService",e)}(),angular.module("app").service("websocketService",["$rootScope","$window",function(e,t){function r(){return"https:"===t.location.protocol?"wss://"+t.location.host:"ws://"+t.location.host}var n;this.connect=function(){n=new WebSocket(r()),n.onmessage=function(t){var r=JSON.parse(t.data);e.$broadcast("ws:"+r.topic,r.data)}},this.send=function(e,t){var r=JSON.stringify({topic:e,data:t});n.send(r)}}]).run(["websocketService",function(e){e.connect()}]),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"A",templateUrl:"/common/components/footer.html"};return e}function t(e,t){function r(){t.logout()}var n=this;n.indentity=e,n.logout=r}t.$inject=["identityService","authService"],angular.module("app").directive("kpFooter",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"headerCtrl",restrict:"A",templateUrl:"/common/components/header.html"};return e}function t(e,t,r){function n(){a.sidebarStatus.left=!a.sidebarStatus.left,e.setSidebarStatus(a.sidebarStatus.left)}function i(){r.logout()}var a=this;a.indentity=t,a.logout=i,a.sidebarStatus=e.getSidebarStatus(),a.toggleSidebar=n}t.$inject=["sidebarService","identityService","authService"],angular.module("app").directive("kpHeader",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"sidebarCtrl",restrict:"A",templateUrl:"/common/components/sidebar.html"};return e}function t(e,t,r){function n(){t.logout()}var i=this;i.indentity=e,i.logout=n,i.sidebarStatus=r.getSidebarStatus()}t.$inject=["identityService","authService","sidebarService"],angular.module("app").directive("kpSidebar",e)}(),function(){"use strict";function e(){function e(){}e()}angular.module("app").controller("HomeCtrl",e)}(),function(){"use strict";function e(){function e(e,t){t.click(function(){t.next().slideToggle(200),t.parent().toggleClass("toggled")})}var t={restrict:"A",link:e};return t}angular.module("app").directive("toggleSubmenu",e)}(),function(){"use strict";function e(){function e(e,t){t.hasClass("btn-icon")||t.hasClass("btn-float")?Waves.attach(t,["waves-circle"]):t.hasClass("btn-light")?Waves.attach(t,["waves-light"]):Waves.attach(t),Waves.init()}var t={restrict:"C",link:e};return t}angular.module("app").directive("wavesEffect",e)}(),function(){"use strict";function e(){function e(e,t){var r=t.children().first(),n=t.parent().hasClass("fg-float");r.focus(function(){t.addClass("fg-toggled")}),r.blur(function(){(!n||n&&0===r.val().length)&&t.removeClass("fg-toggled")})}var t={restrict:"C",link:e};return t}angular.module("app").directive("fgLine",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiYXBwLmNvbnRyb2xsZXIuanMiLCJhcHAucm91dGVzLmpzIiwiYXBwLnJ1bi5qcyIsImNoYWxsZW5nZXMvY29tcG9uZW50cy9hY3RpdmUtY2hhbGxlbmdlcy5kaXJlY3RpdmUuanMiLCJjaGFsbGVuZ2VzL3NlcnZpY2VzL2NoYWxsZW5nZXMuc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL2F1dGguc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3NlcnZpY2VzL3VzZXIuc2VydmljZS5qcyIsImF1dGhlbnRpY2F0aW9uL3ZpZXdzL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJhdXRoZW50aWNhdGlvbi92aWV3cy9yZWdpc3Rlci5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvc2VydmljZXMvcHlyYW1pZHMuc2VydmljZS5qcyIsInB5cmFtaWRzL2NvbXBvbmVudHMvcHlyYW1pZC5kaXJlY3RpdmUuanMiLCJweXJhbWlkcy92aWV3cy9hZGQtcGxheWVyLmNvbnRyb2xsZXIuanMiLCJweXJhbWlkcy92aWV3cy9jcmVhdGUtcHlyYW1pZC5jb250cm9sbGVyLmpzIiwicHlyYW1pZHMvdmlld3MvbXktcHlyYW1pZHMuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL3B5cmFtaWQuY29udHJvbGxlci5qcyIsInB5cmFtaWRzL3ZpZXdzL3B5cmFtaWRzLmNvbnRyb2xsZXIuanMiLCJjb21tb24vc2VydmljZXMvaW5kZW50aXR5LnNlcnZpY2UuanMiLCJjb21tb24vc2VydmljZXMvbm90aWZ5LnNlcnZpY2UuanMiLCJjb21tb24vc2VydmljZXMvc2lkZWJhci5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3dlYnNvY2tldC5zZXJ2aWNlLmpzIiwiY29tbW9uL2NvbXBvbmVudHMvZm9vdGVyLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi9jb21wb25lbnRzL2hlYWRlci5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy9zaWRlYmFyLmRpcmVjdGl2ZS5qcyIsImNvbW1vbi92aWV3cy9ob21lLmNvbnRyb2xsZXIuanMiLCJjb21tb24vY29tcG9uZW50cy91aS90b2dnbGUtc3VibWVudS5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS93YXZlcy5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy91aS9mb3Jtcy9mZy1saW5lLmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlndXJhdGlvbiIsIiRodHRwUHJvdmlkZXIiLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJnZXQiLCJjb25maWciLCJBcHBDdHJsIiwiJHN0YXRlIiwiYXBwQ3RybCIsInRoaXMiLCJjb250cm9sbGVyIiwiY29uZmlndXJlUm91dGVzIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsInJvdXRlUm9sZUNoZWNrcyIsInN1cGVyQWRtaW4iLCJyZXF1aXJlU3VwZXJBZG1pbiIsImFkbWluIiwicmVxdWlyZUFkbWluIiwidXNlciIsInJlcXVpcmVBdXRoIiwiaHRtbDVNb2RlIiwib3RoZXJ3aXNlIiwid2hlbiIsInN0YXRlIiwidXJsIiwidmlld3MiLCJjb250ZW50IiwiY29udHJvbGxlckFzIiwidGVtcGxhdGVVcmwiLCJjb250ZW50QCIsInJlc29sdmUiLCJhdXRoIiwiYXV0aFNlcnZpY2UiLCJhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlIiwiYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSIsIiRpbmplY3QiLCJhcHBSdW4iLCIkcm9vdFNjb3BlIiwic2lkZWJhclNlcnZpY2UiLCIkb24iLCJldmVudCIsInRvU3RhdGUiLCJ0b1BhcmFtcyIsImZyb21TdGF0ZSIsImZyb21QYXJhbXMiLCJlcnJvciIsImdvIiwicHJldmlvdXMiLCJzZXRTaWRlYmFyU3RhdHVzIiwicnVuIiwia3BBY3RpdmVDaGFsbGVuZWdlcyIsImRpcmVjdGl2ZSIsImJpbmRUb0NvbnRyb2xsZXIiLCJjdHJsRnVuYyIsInJlc3RyaWN0Iiwic2NvcGUiLCJjb21wZXRpdGlvbklkIiwiJHNjb3BlIiwiY2hhbGxlbmdlc1NlcnZpY2UiLCJhY3RpdmF0ZSIsImdldEFjdGl2ZUNoYWxsZW5nZXMiLCJ2bSIsImNoYWxsZW5nZXMiLCJnZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbiIsInRoZW4iLCJkYXRhIiwibGVuZ3RoIiwiXyIsImZvckVhY2giLCJjaGFsbGVuZ2UiLCJ0aW1lTGltaXQiLCJleHBpcmVzIiwibW9tZW50IiwiZGlmZiIsImNyZWF0ZWQiLCJhZGQiLCJjaGFsbGVuZ2VEZXRhaWxzIiwiJGh0dHAiLCJjcmVhdGVDaGFsbGVuZ2UiLCJwb3N0IiwiY29tcGxldGVDaGFsbGVuZ2UiLCJnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbiIsInBhcmFtcyIsImdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllciIsInBsYXllcklkIiwic2VydmljZSIsImZhY3RvcnkiLCIkcSIsInVzZXJTZXJ2aWNlIiwiaWRlbnRpdHlTZXJ2aWNlIiwiYXV0aGVudGljYXRlVXNlciIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJkZmQiLCJkZWZlciIsInJlc3BvbnNlIiwic3VjY2VzcyIsImN1cnJlbnRVc2VyIiwicHJvbWlzZSIsImNyZWF0ZVVzZXIiLCJ1c2VyRGF0YSIsImxvZ291dCIsInVuZGVmaW5lZCIsInJvbGUiLCJpc0F1dGhvcml6ZWQiLCJyZWplY3QiLCJpc0F1dGhlbnRpY2F0ZWQiLCJnZXRBbGxVc2VycyIsInVzZXJzIiwiTG9naW5DdHJsIiwibm90aWZ5U2VydmljZSIsImxvZ2luIiwiUmVnaXN0ZXJDdHJsIiwicmVnaXN0ZXIiLCJuZXdVc2VyIiwiY29uZmlybVBhc3N3b3JkIiwicHlyYW1pZHNTZXJ2aWNlIiwiZ2V0UHlyYW1pZCIsInB5cmFtaWRJZCIsImdldFB5cmFtaWRzRm9yVXNlciIsInVzZXJJZCIsImNyZWF0ZVB5cmFtaWQiLCJweXJhbWlkIiwic3dhcFBvc2l0aW9ucyIsImNoYWxsZW5nZXIiLCJvcHBvbmVudCIsImFkZFBsYXllclRvUHlyYW1pZCIsInBsYXllciIsImtwUHlyYW1pZCIsInJlcGxhY2UiLCIkZmlsdGVyIiwibGV2ZWxzIiwiaSIsInB1c2giLCJvcmRlclBsYXllcnMiLCJnZXRQbGF5ZXJzU3RhdHVzIiwiY2FsY3VsYXRlUHlyYW1pZEJsb2NrcyIsImZpbGxJbkVtcHR5QmxvY2tzIiwiYXNzaWduTGV2ZWxzVG9QbGF5ZXJzIiwicGxheWVycyIsIl9pZCIsImlzQ3VycmVudFVzZXJPblB5cmFtaWQiLCJjbGFzcyIsImN1cnJlbnRVc2VyUGxheWVyIiwiaGFzQWN0aXZlQ2hhbGxlbmdlIiwiZmluZCIsInBvc2l0aW9uIiwidGltZVRvRXhwaXJlIiwiZmluZEF2YWlsYWJsZUNoYWxsZW5nZXMiLCJjcmVhdGVCcmVha1BvaW50cyIsImJyZWFrUG9pbnRzIiwibnVtYmVyT2ZCbG9ja3MiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsImxldmVsIiwiaW5kZXhPZiIsImxldmVsQWJvdmUiLCJhdmFpbGFibGVDaGFsbGVuZ2VzIiwiYXZhaWxhYmxlIiwiY29tcGxldGUiLCJmb3JmZWl0IiwiZm9yZmVpdERheXMiLCJuaWNrbmFtZSIsInJlZnJlc2hQeXJhbWlkIiwicHlyYW1pZE1lbnVUb2dnbGUiLCJ3aW5uZXJJc0N1cnJlbnRVc2VyIiwiZm9yZmVpdExvc2VyIiwid2lubmVyIiwiY2hhbGxlbmdlRXhwaXJlZCIsImluZm8iLCJkZXNjcmlwdGlvbiIsIkFkZFBsYXllckN0cmwiLCIkc3RhdGVQYXJhbXMiLCJhdmFpbGFibGVQbGF5ZXJzIiwiYWRkUGxheWVyIiwibmV3UHlyYW1pZCIsInJlbW92ZSIsIkNyZWF0ZVB5cmFtaWRDdHJsIiwiYWRkZWRQbGF5ZXJBZGRlZCIsImFkZGVkUGxheWVycyIsInJlbW92ZVBsYXllciIsImF2YWlsYWJsZVBsYXllckFkZGVkIiwidXBkYXRlQWxsb3dlZFBsYXllcnMiLCJjb25zb2xlIiwibG9nIiwiTXlQeXJhbWlkc0N0cmwiLCJweXJhbWlkcyIsIlB5cmFtaWRDdHJsIiwiUHlyYW1pZHNDdHJsIiwiJHdpbmRvdyIsInJvbGVzIiwiYm9vdHN0cmFwcGVkVXNlck9iamVjdCIsIm1lc3NhZ2UiLCJ0YXJnZXQiLCIkIiwibm90aWZ5IiwidHlwZSIsIndhcm5pbmciLCJpbnZlcnNlIiwibm90aWZ5RGVmYXVsdHMiLCJuZXdlc3Rfb25fdG9wIiwib2Zmc2V0IiwieCIsInkiLCJnZXRTaWRlYmFyU3RhdHVzIiwic2lkZWJhclN0YXR1cyIsInN0YXR1cyIsImxlZnQiLCJyaWdodCIsIndlYnNvY2tldEhvc3QiLCJsb2NhdGlvbiIsInByb3RvY29sIiwiaG9zdCIsImNvbm5lY3Rpb24iLCJjb25uZWN0IiwiV2ViU29ja2V0Iiwib25tZXNzYWdlIiwiZSIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCIkYnJvYWRjYXN0IiwidG9waWMiLCJzZW5kIiwianNvbiIsInN0cmluZ2lmeSIsIndlYnNvY2tldFNlcnZpY2UiLCJrcEZvb3RlciIsImluZGVudGl0eSIsImtwSGVhZGVyIiwidG9nZ2xlU2lkZWJhciIsImtwU2lkZWJhciIsIkhvbWVDdHJsIiwidG9nZ2xlU3VibWVudSIsImxpbmtGdW5jIiwiZWwiLCJjbGljayIsIm5leHQiLCJzbGlkZVRvZ2dsZSIsInBhcmVudCIsInRvZ2dsZUNsYXNzIiwibGluayIsIndhdmVzRWZmZWN0IiwiZWxlbWVudCIsImhhc0NsYXNzIiwiV2F2ZXMiLCJhdHRhY2giLCJpbml0IiwiZmdMaW5lIiwiaW5wdXQiLCJjaGlsZHJlbiIsImZpcnN0IiwiaXNGbG9hdExhYmVsIiwiZm9jdXMiLCJhZGRDbGFzcyIsImJsdXIiLCJ2YWwiLCJyZW1vdmVDbGFzcyJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQUFDLE9BQUEsT0FDQSxZQUNBLGVBQ0EsWUFDQSxzQkFDQSxhQUNBLHdCQUNBLFFBQ0EscUJDUkEsd0JBSUEsU0FBQUMsR0FBQUMsR0FF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Z0JBR0FMLEVBQUFNLEtBQUEsYUFDQUgsR0FBQUEsR0FBQSxJQUFBSCxFQUFBTyxNQUFBOUwsU0FDQWlMLEVBQUFjLFlBQUEsZ0JBaEJBLEdBQUE5TSxJQUNBRyxTQUFBLElBQ0EyTCxLQUFBUCxFQUdBLE9BQUF2TCxHQVZBdkQsUUFDQUMsT0FBQSxPQUNBc0QsVUFBQSxTQUFBcU0iLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcbiAgJ3VpLnJvdXRlcicsXG4gICd1aS5ib290c3RyYXAnLFxuICAnbmdBbmltYXRlJyxcbiAgJ2FuZ3VsYXItbG9hZGluZy1iYXInLFxuICAnbm91aXNsaWRlcicsXG4gICdsb2NhbHl0aWNzLmRpcmVjdGl2ZXMnLFxuICAndGltZXInLFxuICAnbHVlZ2cuZGlyZWN0aXZlcydcbl0pOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0ICc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb25maWcoY29uZmlndXJhdGlvbik7XG5cbiAgZnVuY3Rpb24gY29uZmlndXJhdGlvbigkaHR0cFByb3ZpZGVyKSB7XG4gICAgLy9pbml0aWFsaXplIGdldCBpZiBub3QgdGhlcmVcbiAgICBpZiAoISRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXQpIHtcbiAgICAgICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXQgPSB7fTsgICAgXG4gICAgfSAgICBcbiAgICAvL2Rpc2FibGUgSUUgYWpheCByZXF1ZXN0IGNhY2hpbmdcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0WydJZi1Nb2RpZmllZC1TaW5jZSddID0gJ0ZyaSwgMDEgSmFuIDIwMTYgMDU6MDA6MDAgR01UJztcbiAgICAvLyBleHRyYVxuICAgICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXRbJ0NhY2hlLUNvbnRyb2wnXSA9ICduby1jYWNoZSc7XG4gICAgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldFsnUHJhZ21hJ10gPSAnbm8tY2FjaGUnO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0FwcEN0cmwnLCBBcHBDdHJsKTtcblxuICBmdW5jdGlvbiBBcHBDdHJsKCRzdGF0ZSkge1xuICAgIHZhciBhcHBDdHJsID0gdGhpcztcbiAgICBhcHBDdHJsLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb25maWcoY29uZmlndXJlUm91dGVzKTtcblxuICBmdW5jdGlvbiBjb25maWd1cmVSb3V0ZXMoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICB2YXIgcm91dGVSb2xlQ2hlY2tzID0ge1xuICAgICAgc3VwZXJBZG1pbjogcmVxdWlyZVN1cGVyQWRtaW4sXG4gICAgICBhZG1pbjogcmVxdWlyZUFkbWluLFxuICAgICAgdXNlcjogcmVxdWlyZUF1dGhcbiAgICB9O1xuXG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgLy8gZm9yIGFueSB1bm1hdGNoZWQgdXJsXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLndoZW4oJy9weXJhbWlkcy8nLCAnL3B5cmFtaWRzJyk7XG5cbiAgICAkc3RhdGVQcm92aWRlclxuICAgICAgLnN0YXRlKCdob21lJywge1xuICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbW1vbi92aWV3cy9ob21lLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncHlyYW1pZHMnLCB7XG4gICAgICAgIHVybDogJy9weXJhbWlkcycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHlyYW1pZHNDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHlyYW1pZHMvdmlld3MvcHlyYW1pZHMuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy5teVB5cmFtaWRzJywge1xuICAgICAgICB1cmw6ICcvbXktcHlyYW1pZHMnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNeVB5cmFtaWRzQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL215LXB5cmFtaWRzLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ3B5cmFtaWRzLnZpZXcnLCB7XG4gICAgICAgIHVybDogJy92aWV3LzpweXJhbWlkSWQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQeXJhbWlkQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL3B5cmFtaWQuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnN0YXRlKCdweXJhbWlkcy5jcmVhdGUnLCB7XG4gICAgICAgIHVybDogJy9jcmVhdGUnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDcmVhdGVQeXJhbWlkQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3B5cmFtaWRzL3ZpZXdzL2NyZWF0ZS1weXJhbWlkLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgYXV0aDogcm91dGVSb2xlQ2hlY2tzLnVzZXJcbiAgICAgICAgfVxuICAgICAgfSkuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0xvZ2luQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGhlbnRpY2F0aW9uL3ZpZXdzL2xvZ2luLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KS5zdGF0ZSgncmVnaXN0ZXInLCB7XG4gICAgICAgIHVybDogJy9yZWdpc3RlcicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aGVudGljYXRpb24vdmlld3MvcmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgcmVxdWlyZUFkbWluLiRpbmplY3QgPSBbJ2F1dGhTZXJ2aWNlJ107XG5cbiAgZnVuY3Rpb24gcmVxdWlyZUFkbWluKGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUoJ2FkbWluJyk7XG4gIH1cblxuICByZXF1aXJlU3VwZXJBZG1pbi4kaW5qZWN0ID0gWydhdXRoU2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIHJlcXVpcmVTdXBlckFkbWluKGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUoJ3N1cGVyLWFkbWluJyk7XG4gIH1cblxuICByZXF1aXJlQXV0aC4kaW5qZWN0ID0gWydhdXRoU2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIHJlcXVpcmVBdXRoKGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUoKTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5ydW4oYXBwUnVuKTtcblxuICBmdW5jdGlvbiBhcHBSdW4oJHJvb3RTY29wZSwgJHN0YXRlLCBzaWRlYmFyU2VydmljZSkge1xuICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VFcnJvcicsIGZ1bmN0aW9uIChldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcywgZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvciA9PT0gJ25vdCBhdXRob3JpemVkJykge1xuICAgICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XG4gICAgICAgICRzdGF0ZS5wcmV2aW91cyA9IHRvU3RhdGU7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBzaWRlYmFyU2VydmljZS5zZXRTaWRlYmFyU3RhdHVzKGZhbHNlKTtcbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BBY3RpdmVDaGFsbGVuZWdlcycsIGtwQWN0aXZlQ2hhbGxlbmVnZXMpO1xuXG4gIGZ1bmN0aW9uIGtwQWN0aXZlQ2hhbGxlbmVnZXMoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb21wZXRpdGlvbklkOiAnQCdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jaGFsbGVuZ2VzL2NvbXBvbmVudHMvYWN0aXZlLWNoYWxsZW5nZXMuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBjaGFsbGVuZ2VzU2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY2hhbGxlbmdlcyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgZ2V0QWN0aXZlQ2hhbGxlbmdlcygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZUNoYWxsZW5nZXMoKSB7XG4gICAgICB2bS5jaGFsbGVuZ2VzID0gW107XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbih2bS5jb21wZXRpdGlvbklkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2VzKSB7XG4gICAgICAgIGlmIChjaGFsbGVuZ2VzLmRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZtLmNoYWxsZW5nZXMgPSBjaGFsbGVuZ2VzLmRhdGE7XG4gICAgICAgICAgXy5mb3JFYWNoKHZtLmNoYWxsZW5nZXMsIGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICAgIGlmIChjaGFsbGVuZ2UudGltZUxpbWl0ICE9PSAwKSB7XG4gICAgICAgICAgICAgIGNoYWxsZW5nZS5leHBpcmVzID0gKG1vbWVudCgpLmRpZmYobW9tZW50KGNoYWxsZW5nZS5jcmVhdGVkKS5hZGQoY2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2QnKSwncycpKSAqIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NyZWF0ZWQnLCBmdW5jdGlvbiAoXywgY2hhbGxlbmdlRGV0YWlscykge1xuICAgICAgaWYgKHZtLmNvbXBldGl0aW9uSWQgPT09IGNoYWxsZW5nZURldGFpbHMuY29tcGV0aXRpb25JZCkge1xuICAgICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXYXRjaCBmb3Igd2Vic29ja2V0IGV2ZW50XG4gICAgJHNjb3BlLiRvbignd3M6Y2hhbGxlbmdlX2NvbXBsZXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIGdldEFjdGl2ZUNoYWxsZW5nZXMoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdjaGFsbGVuZ2VzU2VydmljZScsIGNoYWxsZW5nZXNTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBjaGFsbGVuZ2VzU2VydmljZSgkaHR0cCkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgY3JlYXRlQ2hhbGxlbmdlOiBjcmVhdGVDaGFsbGVuZ2UsXG4gICAgICBjb21wbGV0ZUNoYWxsZW5nZTogY29tcGxldGVDaGFsbGVuZ2UsXG4gICAgICBnZXRDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbjogZ2V0Q2hhbGxlbmdlc0J5Q29tcGV0aXRpb24sXG4gICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VzQnlDb21wZXRpdGlvbjogZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24sXG4gICAgICBnZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXI6IGdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllclxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYWxsZW5nZShjaGFsbGVuZ2UpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NoYWxsZW5nZXMvY3JlYXRlJywge1xuICAgICAgICBjaGFsbGVuZ2U6IGNoYWxsZW5nZVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jaGFsbGVuZ2VzL2NvbXBsZXRlJywgIHtcbiAgICAgICAgY2hhbGxlbmdlOiBjaGFsbGVuZ2VcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENoYWxsZW5nZXNCeUNvbXBldGl0aW9uKGNvbXBldGl0aW9uSWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2hhbGxlbmdlcy9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24oY29tcGV0aXRpb25JZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jaGFsbGVuZ2VzL2FjdGl2ZS9jb21wZXRpdGlvbicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QWN0aXZlQ2hhbGxlbmdlQnlDb21wZXRpdGlvbkJ5UGxheWVyKGNvbXBldGl0aW9uSWQsIHBsYXllcklkKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NoYWxsZW5nZXMvYWN0aXZlL2NvbXBldGl0aW9uL3BsYXllcicsICB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIGNvbXBldGl0aW9uSWQ6IGNvbXBldGl0aW9uSWQsXG4gICAgICAgICAgcGxheWVySWQ6IHBsYXllcklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdhdXRoU2VydmljZScsIGF1dGhTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBhdXRoU2VydmljZSgkc3RhdGUsICRodHRwLCAkcSwgdXNlclNlcnZpY2UsIGlkZW50aXR5U2VydmljZSkge1xuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgYXV0aGVudGljYXRlVXNlcjogYXV0aGVudGljYXRlVXNlcixcbiAgICAgIGNyZWF0ZVVzZXI6IGNyZWF0ZVVzZXIsXG4gICAgICBsb2dvdXQ6IGxvZ291dCxcbiAgICAgIGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGU6IGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUsXG4gICAgICBhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlOiBhdXRoZW50aWNhdGVkVXNlckZvclJvdXRlXG4gICAgfTtcbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9sb2dpbicsIHtcbiAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSByZXNwb25zZS5kYXRhLnVzZXI7XG4gICAgICAgICAgZGZkLnJlc29sdmUodHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVVc2VyKHVzZXJEYXRhKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG4gICAgICAgIHVzZXJEYXRhOiB1c2VyRGF0YVxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgIGRmZC5yZXNvbHZlKHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRmZC5yZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5wb3N0KCcvbG9nb3V0Jywge1xuICAgICAgICBsb2dvdXQ6IHRydWVcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIGRmZC5yZXNvbHZlKCk7XG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZShyb2xlKSB7XG4gICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aG9yaXplZChyb2xlKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoJ25vdCBhdXRob3JpemVkJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpIHtcbiAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJHEucmVqZWN0KCdub3QgYXV0aG9yaXplZCcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCd1c2VyU2VydmljZScsIHVzZXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiB1c2VyU2VydmljZSgkaHR0cCwgaWRlbnRpdHlTZXJ2aWNlKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBnZXRBbGxVc2VyczogZ2V0QWxsVXNlcnNcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gZ2V0QWxsVXNlcnMoKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJykudGhlbihmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJzO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIExvZ2luQ3RybCk7XG5cbiAgZnVuY3Rpb24gTG9naW5DdHJsKCRzdGF0ZSwgYXV0aFNlcnZpY2UsIG5vdGlmeVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmxvZ2luID0gbG9naW47XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICBhdXRoU2VydmljZS5hdXRoZW50aWNhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICAgIG5vdGlmeVNlcnZpY2UuZXJyb3IoJ1VzZXJuYW1lIC8gcGFzc3dvcmQgY29tYmluYWl0b24gaW5jb3JyZWN0Jyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKCRzdGF0ZS5wcmV2aW91cykge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCRzdGF0ZS5wcmV2aW91cyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIFJlZ2lzdGVyQ3RybCk7XG5cbiAgZnVuY3Rpb24gUmVnaXN0ZXJDdHJsKCRzY29wZSwgJHN0YXRlLCBhdXRoU2VydmljZSwgbm90aWZ5U2VydmljZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucmVnaXN0ZXIgPSByZWdpc3RlcjtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHt9XG5cbiAgICBmdW5jdGlvbiByZWdpc3RlcihuZXdVc2VyKSB7XG4gICAgICBpZiAobmV3VXNlci5wYXNzd29yZCAhPT0gbmV3VXNlci5jb25maXJtUGFzc3dvcmQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignUGFzc3dvcmRzIGRvblxcJ3QgbWF0Y2ghJyk7XG4gICAgICB9IGVsc2V7XG4gICAgICAgIGF1dGhTZXJ2aWNlLmNyZWF0ZVVzZXIobmV3VXNlcikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ3B5cmFtaWRzU2VydmljZScsIHB5cmFtaWRzU2VydmljZSk7XG5cbiAgZnVuY3Rpb24gcHlyYW1pZHNTZXJ2aWNlKCRodHRwKSB7XG4gICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICBnZXRQeXJhbWlkOiBnZXRQeXJhbWlkLFxuICAgICAgZ2V0UHlyYW1pZHNGb3JVc2VyOiBnZXRQeXJhbWlkc0ZvclVzZXIsXG4gICAgICBjcmVhdGVQeXJhbWlkOiBjcmVhdGVQeXJhbWlkLFxuICAgICAgc3dhcFBvc2l0aW9uczogc3dhcFBvc2l0aW9ucyxcbiAgICAgIGFkZFBsYXllclRvUHlyYW1pZDogYWRkUGxheWVyVG9QeXJhbWlkXG4gICAgfTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgLyoqXG4gICAgICogR2V0cyBhIHB5cmFtaWQgZnJvbSB0aGUgZGF0YWJhc2UgKG9yIG1lbW9yeSlcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBweXJhbWlkIGlkIGZvciB0aGUgcmVxdWVzdGVkIHB5cmFtaWRcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IHB5cmFtaWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRQeXJhbWlkKHB5cmFtaWRJZCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9weXJhbWlkJywge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBweXJhbWlkSWQ6IHB5cmFtaWRJZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGFsbCBweXJhbWlkcyBmcm9tIHRoZSBkYXRhYmFzZSB0aGUgYSBwYXJ0aWN1bGFyIHVzZXIgaXMgaW5jbHVkZWQgaW5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7dXNlcklkfSB0aGUgdXNlciBpZCBmb3IgdGhlIHJlcXVlc3RlZCB1c2VyXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBweXJhbWlkc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFB5cmFtaWRzRm9yVXNlcih1c2VySWQpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcHlyYW1pZHMvdXNlcicsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgdXNlcklkOiB1c2VySWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlUHlyYW1pZChweXJhbWlkKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9jcmVhdGUnLCB7XG4gICAgICAgIHB5cmFtaWQ6IHB5cmFtaWRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN3YXBQb3NpdGlvbnMocHlyYW1pZElkLCBjaGFsbGVuZ2VyLCBvcHBvbmVudCkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcHlyYW1pZHMvc3dhcFBvc2l0aW9ucycsIHtcbiAgICAgICAgcHlyYW1pZElkOiBweXJhbWlkSWQsXG4gICAgICAgIGNoYWxsZW5nZXI6IGNoYWxsZW5nZXIsXG4gICAgICAgIG9wcG9uZW50OiBvcHBvbmVudFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkUGxheWVyVG9QeXJhbWlkKHB5cmFtaWRJZCwgcGxheWVyKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9weXJhbWlkcy9hZGRQbGF5ZXInLCB7XG4gICAgICAgIHB5cmFtaWRJZDogcHlyYW1pZElkLFxuICAgICAgICBwbGF5ZXI6IHBsYXllclxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BQeXJhbWlkJywga3BQeXJhbWlkKTtcblxuICBmdW5jdGlvbiBrcFB5cmFtaWQoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9weXJhbWlkcy9jb21wb25lbnRzL3B5cmFtaWQuaHRtbCcsXG4gICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29tcGV0aXRpb25JZDogJ0AnXG4gICAgICB9LFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlXG4gICAgfTtcblxuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoJHNjb3BlLCBweXJhbWlkc1NlcnZpY2UsICRmaWx0ZXIsIG5vdGlmeVNlcnZpY2UsIGlkZW50aXR5U2VydmljZSwgY2hhbGxlbmdlc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnB5cmFtaWQgPSB7fTtcbiAgICB2bS5icmVha1BvaW50cyA9IFtdO1xuICAgIHZtLm51bWJlck9mQmxvY2tzID0gMDtcbiAgICB2bS5pc0N1cnJlbnRVc2VyT25QeXJhbWlkID0gZmFsc2U7XG4gICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gZmFsc2U7XG4gICAgdm0uYXZhaWxhYmxlQ2hhbGxlbmdlcyA9IGZhbHNlO1xuICAgIHZtLmNyZWF0ZUNoYWxsZW5nZSA9IGNyZWF0ZUNoYWxsZW5nZTtcbiAgICB2bS5jb21wbGV0ZUNoYWxsZW5nZSA9IGNvbXBsZXRlQ2hhbGxlbmdlO1xuICAgIHZtLmNoYWxsZW5nZUV4cGlyZWQgPSBjaGFsbGVuZ2VFeHBpcmVkO1xuICAgIHZtLmN1cnJlbnRVc2VyUGxheWVyID0ge307XG4gICAgdm0ucHlyYW1pZE1lbnVUb2dnbGUgPSBmYWxzZTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkKHZtLmNvbXBldGl0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHB5cmFtaWQpIHtcbiAgICAgICAgdm0ucHlyYW1pZCA9IHB5cmFtaWQuZGF0YTtcblxuICAgICAgICB2bS5sZXZlbHMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gcHlyYW1pZC5kYXRhLmxldmVsczsgKytpKSB7XG4gICAgICAgICAgdm0ubGV2ZWxzLnB1c2goaSk7XG4gICAgICAgIH1cblxuICAgICAgICBvcmRlclBsYXllcnMoKTtcbiAgICAgICAgZ2V0UGxheWVyc1N0YXR1cygpO1xuICAgICAgICBjYWxjdWxhdGVQeXJhbWlkQmxvY2tzKCk7XG4gICAgICAgIGZpbGxJbkVtcHR5QmxvY2tzKCk7XG4gICAgICAgIGFzc2lnbkxldmVsc1RvUGxheWVycygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3JkZXIgdGhlIHBsYXllcnMgYnkgdGhlIHBvc2l0aW9uIHByb3BlcnR5IG9mIHRoZSBwbGF5ZXJzIGFycmF5IGluIHRoZSBweXJhbWlkIG9iamVjdFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9yZGVyUGxheWVycygpIHtcbiAgICAgIHZtLnB5cmFtaWQucGxheWVycyA9ICRmaWx0ZXIoJ29yZGVyQnknKSh2bS5weXJhbWlkLnBsYXllcnMsICdwb3NpdGlvbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpZ3VyZSBvdXQgaWYgZWFjaCBwbGF5ZXIgaXMgYWxyZWFkeSBjaGFsbGVuZ2VkIGFuZCBzZXQgc29tZSBzdHVmZlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFBsYXllcnNTdGF0dXMoKSB7XG4gICAgICBfLmZvckVhY2godm0ucHlyYW1pZC5wbGF5ZXJzLCBmdW5jdGlvbiAocGxheWVyKSB7XG5cbiAgICAgICAgLy8gRmluZCB0aGUgY3VycmVudCB1c2VyIGlmIHRoZXkgYXJlIG9uIHRoaXMgcHlyYW1pZCBhbmQgc2V0IHNvbWUgcHJvcGVydGllc1xuICAgICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyICYmIHBsYXllci5faWQgPT09IGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlci5faWQpIHtcbiAgICAgICAgICB2bS5pc0N1cnJlbnRVc2VyT25QeXJhbWlkID0gdHJ1ZTtcbiAgICAgICAgICBwbGF5ZXIuY2xhc3MgPSAnY3VycmVudC11c2VyJztcbiAgICAgICAgICB2bS5jdXJyZW50VXNlclBsYXllciA9IHBsYXllcjtcblxuICAgICAgICAgIGNoYWxsZW5nZXNTZXJ2aWNlLmdldEFjdGl2ZUNoYWxsZW5nZUJ5Q29tcGV0aXRpb25CeVBsYXllcih2bS5jb21wZXRpdGlvbklkLCBwbGF5ZXIuX2lkKS50aGVuKGZ1bmN0aW9uIChjaGFsbGVuZ2UpIHtcbiAgICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YSkge1xuICAgICAgICAgICAgICB2bS5oYXNBY3RpdmVDaGFsbGVuZ2UgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuZ2V0QWN0aXZlQ2hhbGxlbmdlc0J5Q29tcGV0aXRpb24odm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlcykge1xuICAgICAgICBfLmZvckVhY2goY2hhbGxlbmdlcy5kYXRhLCBmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG5cbiAgICAgICAgICB2YXIgY2hhbGxlbmdlciA9IF8uZmluZCh2bS5weXJhbWlkLnBsYXllcnMsIHsnX2lkJzogY2hhbGxlbmdlLmNoYWxsZW5nZXIuX2lkfSk7XG4gICAgICAgICAgY2hhbGxlbmdlci5jbGFzcyA9ICd1bmF2YWlsYWJsZSc7XG4gICAgICAgICAgY2hhbGxlbmdlci5jaGFsbGVuZ2UgPSB7XG4gICAgICAgICAgICBwb3NpdGlvbjogJ2NoYWxsZW5nZXInXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHZhciBvcHBvbmVudCA9IF8uZmluZCh2bS5weXJhbWlkLnBsYXllcnMsIHsnX2lkJzogY2hhbGxlbmdlLm9wcG9uZW50Ll9pZH0pO1xuICAgICAgICAgIG9wcG9uZW50LmNsYXNzID0gJ3VuYXZhaWxhYmxlJztcbiAgICAgICAgICBvcHBvbmVudC5jaGFsbGVuZ2UgPSB7XG4gICAgICAgICAgICBwb3NpdGlvbjogJ29wcG9uZW50J1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICAvLyBUcmFjayB3aGVuIHRoZSBjaGFsbGVuZ2Ugd2lsbCBleHBpcmVcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlLnRpbWVMaW1pdCAhPT0gMCkge1xuICAgICAgICAgICAgdmFyIHRpbWVUb0V4cGlyZSA9IG1vbWVudCgpLmRpZmYobW9tZW50KGNoYWxsZW5nZS5jcmVhdGVkKS5hZGQoY2hhbGxlbmdlLnRpbWVMaW1pdCwgJ2QnKSwgJ3MnKSAqIC0xO1xuICAgICAgICAgICAgLy8gSWYgdGhlIGNoYWxsZW5nZSBoYXMgbm90IHlldCBleHBpcmVkIGRpc3BsYXkgYSBjb3VudGRvd24gb24gdGhlIG9wcG9uZW50XG4gICAgICAgICAgICBpZiAodGltZVRvRXhwaXJlID4gMCkge1xuICAgICAgICAgICAgICBvcHBvbmVudC5jaGFsbGVuZ2UuZXhwaXJlcyA9IHRpbWVUb0V4cGlyZTtcbiAgICAgICAgICAgICAgLy8gSWYgdGhlIGNoYWxsZW5nZSBleHBpcmVkIHdoaWxlIG5vIG9uZSB3YXMgdmlld2luZyB0aGlzIHB5cmFtaWQgY29tcGxldGUgdGhlIGNoYWxsZW5nZSBieSBmb3JmZWl0XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRpbWVUb0V4cGlyZSA8PSAwKSB7XG4gICAgICAgICAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlKG51bGwsIHRydWUsIG9wcG9uZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBOb3cgdGhhdCB3ZSBrbm93IHdoaWNoIHBsYXllcnMgYXJlIGluIGNoYWxsZW5nZXMgYW5kIHdoaWNoIGFyZW4ndFxuICAgICAgICAvLyBmaW5kIHRoZSBhdmFpbGFibGUgY2hhbGxlbmdlcyBmb3IgdGhpcyB1c2VyXG4gICAgICAgIGZpbmRBdmFpbGFibGVDaGFsbGVuZ2VzKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaWd1cmUgb3V0IHdoZXJlIHRvIHN0YXJ0IGVhY2ggbmV3IHJvdyBvbiB0aGUgcHlyYW1pZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZUJyZWFrUG9pbnRzKCkge1xuICAgICAgdm0uYnJlYWtQb2ludHMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ucHlyYW1pZC5sZXZlbHM7IGkrKykge1xuICAgICAgICB2bS5icmVha1BvaW50cy5wdXNoKCgoKGkgKiAoaSArIDEpKSAvIDIpKSArIDEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhvdyBtYW55IHRvdGFsIGJsb2NrcyBpbiB0aGlzIHB5cmFtaWRcbiAgICBmdW5jdGlvbiBjYWxjdWxhdGVQeXJhbWlkQmxvY2tzKCkge1xuICAgICAgdm0ubnVtYmVyT2ZCbG9ja3MgPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IHZtLnB5cmFtaWQubGV2ZWxzOyBpID4gMDsgaS0tKSB7XG4gICAgICAgIHZtLm51bWJlck9mQmxvY2tzICs9IGk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmlsbCBvdXQgdGhlIHJlbWFpbmluZyBibG9ja3Mgb2YgdGhlIHB5cmFtaWQgd2l0aCBlbXB0eSBibG9ja3NcbiAgICBmdW5jdGlvbiBmaWxsSW5FbXB0eUJsb2NrcygpIHtcbiAgICAgIGZvciAodmFyIGkgPSB2bS5weXJhbWlkLnBsYXllcnMubGVuZ3RoOyBpIDwgdm0ubnVtYmVyT2ZCbG9ja3M7IGkrKykge1xuICAgICAgICB2bS5weXJhbWlkLnBsYXllcnMucHVzaCh7XG4gICAgICAgICAgZmlyc3ROYW1lOiAnRW1wdHknLFxuICAgICAgICAgIGxhc3ROYW1lOiAnU3BvdCcsXG4gICAgICAgICAgcG9zaXRpb246IDk5LFxuICAgICAgICAgIGNsYXNzOiAnZW1wdHknXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdpdmUgZWFjaCBwbGF5ZXIgYSBsZXZlbCBwcm9wZXJ0eSBiYXNlZCBvbiB0aGUgYnJlYWsgcG9pbnRzXG4gICAgLy8gVGhpcyB3aWxsIGJlIHVzZWQgdG8gZGV0ZXJtaW5lIHdobyBvdGhlciBwbGF5ZXJzIGNhbiBjaGFsbGVuZ2VcbiAgICBmdW5jdGlvbiBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKSB7XG4gICAgICB2YXIgbGV2ZWwgPSAwO1xuICAgICAgY3JlYXRlQnJlYWtQb2ludHMoKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0ucHlyYW1pZC5wbGF5ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh2bS5icmVha1BvaW50cy5pbmRleE9mKGkgKyAxKSA+IC0xKSB7XG4gICAgICAgICAgbGV2ZWwgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICB2bS5weXJhbWlkLnBsYXllcnNbaV0ubGV2ZWwgPSBsZXZlbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGaW5kIGFsbCB0aGUgcGxheWVycyB0aGF0IGFyZSBhdmFpbGFibGUgdG8gYmUgY2hhbGxlbmdlZCBieSB0aGlzIHVzZXJcbiAgICBmdW5jdGlvbiBmaW5kQXZhaWxhYmxlQ2hhbGxlbmdlcygpIHtcbiAgICAgIHZhciBsZXZlbEFib3ZlID0gdm0uY3VycmVudFVzZXJQbGF5ZXIubGV2ZWwgPiAxID8gdm0uY3VycmVudFVzZXJQbGF5ZXIubGV2ZWwgLSAxIDogbnVsbDtcbiAgICAgIF8uZm9yRWFjaCh2bS5weXJhbWlkLnBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgaWYgKHBsYXllci5sZXZlbCA9PT0gbGV2ZWxBYm92ZSAmJiBwbGF5ZXIucG9zaXRpb24gIT09IDk5ICYmIHBsYXllci5jbGFzcyAhPT0gJ3VuYXZhaWxhYmxlJykge1xuICAgICAgICAgIHZtLmF2YWlsYWJsZUNoYWxsZW5nZXMgPSB0cnVlO1xuICAgICAgICAgIHBsYXllci5hdmFpbGFibGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFsbGVuZ2UocGxheWVyKSB7XG4gICAgICBpZiAoIXBsYXllci5hdmFpbGFibGUpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5lcnJvcignU29ycnksIHRoYXQgaXMgbm90IGEgdmFsaWQgY2hhbGxlbmdlLicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdm0uaGFzQWN0aXZlQ2hhbGxlbmdlID0gdHJ1ZTtcbiAgICAgICAgdmFyIGNoYWxsZW5nZSA9IHtcbiAgICAgICAgICBjb21wZXRpdGlvbklkOiB2bS5jb21wZXRpdGlvbklkLFxuICAgICAgICAgIGNvbXBsZXRlOiBmYWxzZSxcbiAgICAgICAgICBmb3JmZWl0OiBmYWxzZSxcbiAgICAgICAgICB0aW1lTGltaXQ6IHZtLnB5cmFtaWQuZm9yZmVpdERheXMsXG4gICAgICAgICAgY2hhbGxlbmdlcjoge1xuICAgICAgICAgICAgX2lkOiB2bS5jdXJyZW50VXNlclBsYXllci5faWQsXG4gICAgICAgICAgICBmaXJzdE5hbWU6IHZtLmN1cnJlbnRVc2VyUGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiB2bS5jdXJyZW50VXNlclBsYXllci5sYXN0TmFtZSxcbiAgICAgICAgICAgIG5pY2tuYW1lOiB2bS5jdXJyZW50VXNlclBsYXllci5uaWNrbmFtZSxcbiAgICAgICAgICAgIHBvc2l0aW9uOiB2bS5jdXJyZW50VXNlclBsYXllci5wb3NpdGlvblxuICAgICAgICAgIH0sXG4gICAgICAgICAgb3Bwb25lbnQ6IHtcbiAgICAgICAgICAgIF9pZDogcGxheWVyLl9pZCxcbiAgICAgICAgICAgIGZpcnN0TmFtZTogcGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiBwbGF5ZXIubGFzdE5hbWUsXG4gICAgICAgICAgICBuaWNrbmFtZTogcGxheWVyLm5pY2tuYW1lLFxuICAgICAgICAgICAgcG9zaXRpb246IHBsYXllci5wb3NpdGlvblxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY3JlYXRlQ2hhbGxlbmdlKGNoYWxsZW5nZSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgICAgICB2bS5weXJhbWlkTWVudVRvZ2dsZSA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tcGxldGUgYSBjaGFsbGVuZ2UgYnkgYSB1c2VyIGludGVyYWN0aW9uIG9yIGEgZm9yZmVpdFxuICAgICAqIFxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IHdpbm5lcklzQ3VycmVudFVzZXJcbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSBmb3JmZWl0XG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBmb3JmZWl0TG9zZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb21wbGV0ZUNoYWxsZW5nZSh3aW5uZXJJc0N1cnJlbnRVc2VyLCBmb3JmZWl0LCBmb3JmZWl0TG9zZXIpIHtcbiAgICAgIHZhciBwbGF5ZXIgPSBmb3JmZWl0TG9zZXIgfHwgdm0uY3VycmVudFVzZXJQbGF5ZXI7XG4gICAgICBjaGFsbGVuZ2VzU2VydmljZS5nZXRBY3RpdmVDaGFsbGVuZ2VCeUNvbXBldGl0aW9uQnlQbGF5ZXIodm0uY29tcGV0aXRpb25JZCwgcGxheWVyLl9pZCkudGhlbihmdW5jdGlvbiAoY2hhbGxlbmdlKSB7XG4gICAgICAgIHZtLmhhc0FjdGl2ZUNoYWxsZW5nZSA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBzd2FwUG9zaXRpb25zID0gZmFsc2U7XG5cbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBmb3JmZWl0IHRoYW4gc3dhcCBwb3NpdGlvbiBhbmQgbWFrZSB0aGUgY2hhbGxlbmdlciB0aGUgd2lubmVyXG4gICAgICAgIGlmIChmb3JmZWl0KSB7XG4gICAgICAgICAgY2hhbGxlbmdlLmRhdGEuZm9yZmVpdCA9IHRydWU7XG4gICAgICAgICAgY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlci53aW5uZXIgPSB0cnVlO1xuICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIC8vIEZpZ3VyZSBvdXQgd2hvIHRoZSB3aW5uZXIgd2FzIHRvIHN0b3JlIGluIHRoZSBjaGFsbGVuZ2UgcmVjb3JkXG4gICAgICAgIH0gZWxzZSBpZiAod2lubmVySXNDdXJyZW50VXNlcikge1xuICAgICAgICAgIGlmIChjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLl9pZCA9PT0gdm0uY3VycmVudFVzZXJQbGF5ZXIuX2lkKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2UuZGF0YS5jaGFsbGVuZ2VyLndpbm5lciA9IHRydWU7XG4gICAgICAgICAgICBzd2FwUG9zaXRpb25zID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhbGxlbmdlLmRhdGEub3Bwb25lbnQud2lubmVyID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIuX2lkID09PSB2bS5jdXJyZW50VXNlclBsYXllci5faWQpIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLm9wcG9uZW50Lndpbm5lciA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYWxsZW5nZS5kYXRhLmNoYWxsZW5nZXIud2lubmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIHN3YXBQb3NpdGlvbnMgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN3YXAgcG9zaXRpb25zIGFuZCB0aGVuIGNvbXBsZXRlIHRoZSBjaGFsbGVuZ2Ugb3IganVzdCBjb21wbGV0ZSB0aGUgY2hhbGxlbmdlXG4gICAgICAgIC8vIFdlYnNvY2tldCBldmVudCB3aWxsIHJlZnJlc2ggdGhlIHB5cmFtaWRcbiAgICAgICAgaWYgKHN3YXBQb3NpdGlvbnMpIHtcbiAgICAgICAgICBweXJhbWlkc1NlcnZpY2Uuc3dhcFBvc2l0aW9ucyh2bS5jb21wZXRpdGlvbklkLCBjaGFsbGVuZ2UuZGF0YS5vcHBvbmVudCwgY2hhbGxlbmdlLmRhdGEuY2hhbGxlbmdlcikudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjaGFsbGVuZ2VzU2VydmljZS5jb21wbGV0ZUNoYWxsZW5nZShjaGFsbGVuZ2UuZGF0YSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2hhbGxlbmdlc1NlcnZpY2UuY29tcGxldGVDaGFsbGVuZ2UoY2hhbGxlbmdlLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2bS5weXJhbWlkTWVudVRvZ2dsZSA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2hhbGxlbmdlRXhwaXJlZChwbGF5ZXIpIHtcbiAgICAgIGNvbXBsZXRlQ2hhbGxlbmdlKG51bGwsIHRydWUsIHBsYXllcik7XG4gICAgfVxuXG4gICAgLy8gUmVmcmVzaCB0aGUgcHlyYW1pZCBiZWNhc3VlIG9mIGFuIHVwZGF0ZVxuICAgIGZ1bmN0aW9uIHJlZnJlc2hQeXJhbWlkKCkge1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmdldFB5cmFtaWQodm0uY29tcGV0aXRpb25JZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZCkge1xuICAgICAgICB2bS5weXJhbWlkID0gcHlyYW1pZC5kYXRhO1xuICAgICAgICBvcmRlclBsYXllcnMoKTtcbiAgICAgICAgZ2V0UGxheWVyc1N0YXR1cygpO1xuICAgICAgICBmaWxsSW5FbXB0eUJsb2NrcygpO1xuICAgICAgICBhc3NpZ25MZXZlbHNUb1BsYXllcnMoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjaGFsbGVuZ2VfY3JlYXRlZCcsIGZ1bmN0aW9uIChfLCBjaGFsbGVuZ2VEZXRhaWxzKSB7XG4gICAgICBpZiAodm0uY29tcGV0aXRpb25JZCA9PT0gY2hhbGxlbmdlRGV0YWlscy5jb21wZXRpdGlvbklkKSB7XG4gICAgICAgIG5vdGlmeVNlcnZpY2UuaW5mbyhjaGFsbGVuZ2VEZXRhaWxzLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmVmcmVzaFB5cmFtaWQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGZvciB3ZWJzb2NrZXQgZXZlbnRcbiAgICAkc2NvcGUuJG9uKCd3czpjaGFsbGVuZ2VfY29tcGxldGVkJywgZnVuY3Rpb24gKF8sIGNoYWxsZW5nZURldGFpbHMpIHtcbiAgICAgIGlmICh2bS5jb21wZXRpdGlvbklkID09PSBjaGFsbGVuZ2VEZXRhaWxzLmNvbXBldGl0aW9uSWQpIHtcbiAgICAgICAgbm90aWZ5U2VydmljZS5pbmZvKGNoYWxsZW5nZURldGFpbHMuZGVzY3JpcHRpb24pO1xuICAgICAgICByZWZyZXNoUHlyYW1pZCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0FkZFBsYXllckN0cmwnLCBBZGRQbGF5ZXJDdHJsKTtcblxuICBmdW5jdGlvbiBBZGRQbGF5ZXJDdHJsKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCB1c2VyU2VydmljZSwgcHlyYW1pZHNTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5hdmFpbGFibGVQbGF5ZXJzID0gW107XG4gICAgdm0uYWRkUGxheWVyVG9QeXJhbWlkID0gYWRkUGxheWVyVG9QeXJhbWlkO1xuICAgIHZtLmNyZWF0ZVB5cmFtaWQgPSBjcmVhdGVQeXJhbWlkO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgdXNlclNlcnZpY2UuZ2V0QWxsVXNlcnMoKS50aGVuKGZ1bmN0aW9uICh1c2Vycykge1xuICAgICAgICB2bS5hdmFpbGFibGVQbGF5ZXJzID0gdXNlcnMuZGF0YTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHZhciBwb3NpdGlvbiA9IDA7XG5cbiAgICBmdW5jdGlvbiBhZGRQbGF5ZXJUb1B5cmFtaWQocGxheWVyKSB7XG4gICAgICAvLyBBZGQgdGhlIHNlbGVjdGVkIHBsYXllciB0byB0aGUgcGxheWVycyBhcnJheVxuICAgICAgcG9zaXRpb24gKz0gMTtcbiAgICAgIHZhciBhZGRQbGF5ZXIgPSB7XG4gICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbixcbiAgICAgICAgX2lkOiBwbGF5ZXIuX2lkLFxuICAgICAgICBmaXJzdE5hbWU6IHBsYXllci5maXJzdE5hbWUsXG4gICAgICAgIGxhc3ROYW1lOiBwbGF5ZXIubGFzdE5hbWUsXG4gICAgICAgIG5pY2tuYW1lOiBwbGF5ZXIubmlja25hbWVcbiAgICAgIH07XG4gICAgICB2bS5uZXdQeXJhbWlkLnBsYXllcnMucHVzaChhZGRQbGF5ZXIpO1xuICAgICAgLy8gUmVtb3ZlIHRoZSBzZWxlY3RlZCBwbGF5ZXIgZnJvbSB0aGUgYXZhaWxhYmxlIHBsYXllcnNcbiAgICAgIF8ucmVtb3ZlKHZtLmF2YWlsYWJsZVBsYXllcnMsIHtcbiAgICAgICAgX2lkOiBwbGF5ZXIuX2lkXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVQeXJhbWlkKHB5cmFtaWQpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5jcmVhdGVQeXJhbWlkKHB5cmFtaWQpLnRoZW4oZnVuY3Rpb24gKG5ld1B5cmFtaWQpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdweXJhbWlkcy52aWV3Jywge1xuICAgICAgICAgIHB5cmFtaWRJZDogbmV3UHlyYW1pZC5kYXRhLl9pZFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdDcmVhdGVQeXJhbWlkQ3RybCcsIENyZWF0ZVB5cmFtaWRDdHJsKTtcblxuICBmdW5jdGlvbiBDcmVhdGVQeXJhbWlkQ3RybCgkc3RhdGUsIHVzZXJTZXJ2aWNlLCBweXJhbWlkc1NlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLm5ld1B5cmFtaWQgPSB7XG4gICAgICBwbGF5ZXJzOiBbXVxuICAgIH07XG4gICAgdm0uYXZhaWxhYmxlUGxheWVycyA9IFtdO1xuICAgIHZtLmFkZGVkUGxheWVycyA9IFtdO1xuICAgIHZtLmNyZWF0ZVB5cmFtaWQgPSBjcmVhdGVQeXJhbWlkO1xuICAgIHZtLmFkZFBsYXllciA9IGFkZFBsYXllcjtcbiAgICB2bS5yZW1vdmVQbGF5ZXIgPSByZW1vdmVQbGF5ZXI7XG4gICAgdm0udXBkYXRlQWxsb3dlZFBsYXllcnMgPSB1cGRhdGVBbGxvd2VkUGxheWVycztcbiAgICB2bS5uZXdQeXJhbWlkLmxldmVscyA9IDQ7XG4gICAgdm0ubmV3UHlyYW1pZC5mb3JmZWl0RGF5cyA9IDE7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICB1c2VyU2VydmljZS5nZXRBbGxVc2VycygpLnRoZW4oZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIHZtLmF2YWlsYWJsZVBsYXllcnMgPSB1c2Vycy5kYXRhO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkUGxheWVyKHBsYXllcikge1xuICAgICAgdm0uYWRkZWRQbGF5ZXJBZGRlZCA9IHRydWU7XG4gICAgICB2bS5hZGRlZFBsYXllcnMucHVzaChfLnJlbW92ZSh2bS5hdmFpbGFibGVQbGF5ZXJzLCB7X2lkOiBwbGF5ZXIuX2lkfSlbMF0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZVBsYXllcihwbGF5ZXIpIHtcbiAgICAgIHZtLmF2YWlsYWJsZVBsYXllckFkZGVkID0gdHJ1ZTtcbiAgICAgIHZtLmFkZGVkUGxheWVyQWRkZWQgPSBmYWxzZTtcbiAgICAgIHZtLmF2YWlsYWJsZVBsYXllcnMucHVzaChfLnJlbW92ZSh2bS5hZGRlZFBsYXllcnMsIHtfaWQ6IHBsYXllci5faWR9KVswXSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlQWxsb3dlZFBsYXllcnMobGV2ZWxzKSB7XG4gICAgICBjb25zb2xlLmxvZyhsZXZlbHMpO1xuICAgIH1cblxuICAgIHZhciBwb3NpdGlvbiA9IDA7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVQeXJhbWlkKHB5cmFtaWQpIHtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaCh2bS5hZGRlZFBsYXllcnMsIGZ1bmN0aW9uIChwbGF5ZXIpIHtcbiAgICAgICAgcG9zaXRpb24gKz0gMTtcbiAgICAgICAgdmFyIGFkZFBsYXllciA9IHtcbiAgICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sXG4gICAgICAgICAgX2lkOiBwbGF5ZXIuX2lkLFxuICAgICAgICAgIGZpcnN0TmFtZTogcGxheWVyLmZpcnN0TmFtZSxcbiAgICAgICAgICBsYXN0TmFtZTogcGxheWVyLmxhc3ROYW1lLFxuICAgICAgICAgIG5pY2tuYW1lOiBwbGF5ZXIubmlja25hbWVcbiAgICAgICAgfTtcbiAgICAgICAgdm0ubmV3UHlyYW1pZC5wbGF5ZXJzLnB1c2goYWRkUGxheWVyKTtcbiAgICAgIH0pO1xuICAgICAgcHlyYW1pZHNTZXJ2aWNlLmNyZWF0ZVB5cmFtaWQocHlyYW1pZCkudGhlbihmdW5jdGlvbiAobmV3UHlyYW1pZCkge1xuICAgICAgICAkc3RhdGUuZ28oJ3B5cmFtaWRzLnZpZXcnLCB7XG4gICAgICAgICAgcHlyYW1pZElkOiBuZXdQeXJhbWlkLmRhdGEuX2lkXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ015UHlyYW1pZHNDdHJsJywgTXlQeXJhbWlkc0N0cmwpO1xuXG4gIGZ1bmN0aW9uIE15UHlyYW1pZHNDdHJsKCRzdGF0ZSwgcHlyYW1pZHNTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnB5cmFtaWRzID0gbnVsbDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIHB5cmFtaWRzU2VydmljZS5nZXRQeXJhbWlkc0ZvclVzZXIoaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLl9pZCkudGhlbihmdW5jdGlvbiAocHlyYW1pZHMpIHtcbiAgICAgICAgdm0ucHlyYW1pZHMgPSBweXJhbWlkcy5kYXRhO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1B5cmFtaWRDdHJsJywgUHlyYW1pZEN0cmwpO1xuXG4gIGZ1bmN0aW9uIFB5cmFtaWRDdHJsKCRzdGF0ZVBhcmFtcykge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucHlyYW1pZElkID0gbnVsbDtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGlmICgkc3RhdGVQYXJhbXMucHlyYW1pZElkKSB7XG4gICAgICAgIHZtLnB5cmFtaWRJZCA9ICRzdGF0ZVBhcmFtcy5weXJhbWlkSWQ7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1B5cmFtaWRzQ3RybCcsIFB5cmFtaWRzQ3RybCk7XG5cbiAgZnVuY3Rpb24gUHlyYW1pZHNDdHJsKCkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucHlyYW1pZHMgPSBudWxsO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgXG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ2lkZW50aXR5U2VydmljZScsIGlkZW50aXR5U2VydmljZSk7XG5cbiAgZnVuY3Rpb24gaWRlbnRpdHlTZXJ2aWNlKCR3aW5kb3cpIHtcbiAgICB2YXIgY3VycmVudFVzZXI7XG4gICAgaWYgKCR3aW5kb3cuYm9vdHN0cmFwcGVkVXNlck9iamVjdCAhPT0gbnVsbCkge1xuICAgICAgY3VycmVudFVzZXIgPSAkd2luZG93LmJvb3RzdHJhcHBlZFVzZXJPYmplY3Q7XG4gICAgfVxuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgY3VycmVudFVzZXI6IGN1cnJlbnRVc2VyLFxuICAgICAgaXNBdXRoZW50aWNhdGVkOiBpc0F1dGhlbnRpY2F0ZWQsXG4gICAgICBpc0F1dGhvcml6ZWQ6IGlzQXV0aG9yaXplZFxuICAgIH07XG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBpc0F1dGhlbnRpY2F0ZWQoKSB7XG4gICAgICByZXR1cm4gISF0aGlzLmN1cnJlbnRVc2VyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzQXV0aG9yaXplZChyb2xlKSB7XG4gICAgICByZXR1cm4gISF0aGlzLmN1cnJlbnRVc2VyICYmIHRoaXMuY3VycmVudFVzZXIucm9sZXMuaW5kZXhPZihyb2xlKSA+IC0xO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdub3RpZnlTZXJ2aWNlJywgbm90aWZ5U2VydmljZSk7XG5cbiAgZnVuY3Rpb24gbm90aWZ5U2VydmljZSgpIHtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGluZm86IGluZm8sXG4gICAgICBzdWNjZXNzOiBzdWNjZXNzLFxuICAgICAgd2FybmluZzogd2FybmluZyxcbiAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgIGludmVyc2U6IGludmVyc2VcbiAgICB9O1xuXG4gICAgJC5ub3RpZnlEZWZhdWx0cyh7XG4gICAgICBuZXdlc3Rfb25fdG9wOiB0cnVlLFxuICAgICAgb2Zmc2V0OiB7XG4gICAgICAgIHg6IDIwLFxuICAgICAgICB5OiA4NVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBpbmZvKG1lc3NhZ2UsIHVybCwgdGFyZ2V0KSB7XG4gICAgICAkLm5vdGlmeSh7XG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICB9LCB7XG4gICAgICAgIC8vIHNldHRpbmdzXG4gICAgICAgIHR5cGU6ICdpbmZvJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3VjY2VzcyhtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnc3VjY2VzcydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSwgdXJsLCB0YXJnZXQpIHtcbiAgICAgICQubm90aWZ5KHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgIH0sIHtcbiAgICAgICAgLy8gc2V0dGluZ3NcbiAgICAgICAgdHlwZTogJ3dhcm5pbmcnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnZGFuZ2VyJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW52ZXJzZShtZXNzYWdlLCB1cmwsIHRhcmdldCkge1xuICAgICAgJC5ub3RpZnkoe1xuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSwge1xuICAgICAgICAvLyBzZXR0aW5nc1xuICAgICAgICB0eXBlOiAnaW52ZXJzZSdcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5mYWN0b3J5KCdzaWRlYmFyU2VydmljZScsIHNpZGViYXJTZXJ2aWNlKTtcblxuICBmdW5jdGlvbiBzaWRlYmFyU2VydmljZSgpIHtcbiAgICB2YXIgc2lkZWJhclN0YXR1cyA9IHtcbiAgICAgIGxlZnQ6IGZhbHNlLFxuICAgICAgcmlnaHQ6IGZhbHNlXG4gICAgfTtcbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGdldFNpZGViYXJTdGF0dXM6IGdldFNpZGViYXJTdGF0dXMsXG4gICAgICBzZXRTaWRlYmFyU3RhdHVzOiBzZXRTaWRlYmFyU3RhdHVzXG4gICAgfTtcblxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gZ2V0U2lkZWJhclN0YXR1cygpIHtcbiAgICAgIHJldHVybiBzaWRlYmFyU3RhdHVzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFNpZGViYXJTdGF0dXMoc3RhdHVzKSB7XG4gICAgICBzaWRlYmFyU3RhdHVzLmxlZnQgPSBzdGF0dXM7XG4gICAgfVxuICB9XG59KSgpOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAuc2VydmljZSgnd2Vic29ja2V0U2VydmljZScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkd2luZG93KSB7XG4gICAgZnVuY3Rpb24gd2Vic29ja2V0SG9zdCgpIHtcbiAgICAgIGlmICgkd2luZG93LmxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cHM6Jykge1xuICAgICAgICByZXR1cm4gJ3dzczovLycgKyAkd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJ3dzOi8vJyArICR3aW5kb3cubG9jYXRpb24uaG9zdDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgY29ubmVjdGlvbjtcbiAgICB0aGlzLmNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh3ZWJzb2NrZXRIb3N0KCkpO1xuXG4gICAgICBjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpO1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3dzOicgKyBwYXlsb2FkLnRvcGljLCBwYXlsb2FkLmRhdGEpO1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgdGhpcy5zZW5kID0gZnVuY3Rpb24gKHRvcGljLCBkYXRhKSB7XG4gICAgICB2YXIganNvbiA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgdG9waWM6IHRvcGljLFxuICAgICAgICBkYXRhOiBkYXRhXG4gICAgICB9KTtcbiAgICAgIGNvbm5lY3Rpb24uc2VuZChqc29uKTtcbiAgICB9O1xuICB9KS5ydW4oZnVuY3Rpb24gKHdlYnNvY2tldFNlcnZpY2UpIHtcbiAgICB3ZWJzb2NrZXRTZXJ2aWNlLmNvbm5lY3QoKTtcbiAgfSk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twRm9vdGVyJywga3BGb290ZXIpO1xuXG4gIGZ1bmN0aW9uIGtwRm9vdGVyKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvY29tbW9uL2NvbXBvbmVudHMvZm9vdGVyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmluZGVudGl0eSA9IGlkZW50aXR5U2VydmljZTtcbiAgICB2bS5sb2dvdXQgPSBsb2dvdXQ7XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnKVxuICAgIC5kaXJlY3RpdmUoJ2twSGVhZGVyJywga3BIZWFkZXIpO1xuXG4gIGZ1bmN0aW9uIGtwSGVhZGVyKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogY3RybEZ1bmMsXG4gICAgICBjb250cm9sbGVyQXM6ICdoZWFkZXJDdHJsJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9oZWFkZXIuaHRtbCdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG4gIH1cblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gY3RybEZ1bmMoc2lkZWJhclNlcnZpY2UsIGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmluZGVudGl0eSA9IGlkZW50aXR5U2VydmljZTtcbiAgICB2bS5sb2dvdXQgPSBsb2dvdXQ7XG4gICAgdm0uc2lkZWJhclN0YXR1cyA9IHNpZGViYXJTZXJ2aWNlLmdldFNpZGViYXJTdGF0dXMoKTtcbiAgICB2bS50b2dnbGVTaWRlYmFyID0gdG9nZ2xlU2lkZWJhcjtcblxuICAgIGZ1bmN0aW9uIHRvZ2dsZVNpZGViYXIoKSB7XG4gICAgICB2bS5zaWRlYmFyU3RhdHVzLmxlZnQgPSAhdm0uc2lkZWJhclN0YXR1cy5sZWZ0O1xuICAgICAgc2lkZWJhclNlcnZpY2Uuc2V0U2lkZWJhclN0YXR1cyh2bS5zaWRlYmFyU3RhdHVzLmxlZnQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgna3BTaWRlYmFyJywga3BTaWRlYmFyKTtcblxuICBmdW5jdGlvbiBrcFNpZGViYXIoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBjdHJsRnVuYyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3NpZGViYXJDdHJsJyxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9jb21tb24vY29tcG9uZW50cy9zaWRlYmFyLmh0bWwnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGN0cmxGdW5jKGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UsIHNpZGViYXJTZXJ2aWNlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pbmRlbnRpdHkgPSBpZGVudGl0eVNlcnZpY2U7XG4gICAgdm0ubG9nb3V0ID0gbG9nb3V0O1xuICAgIHZtLnNpZGViYXJTdGF0dXMgPSBzaWRlYmFyU2VydmljZS5nZXRTaWRlYmFyU3RhdHVzKCk7XG5cbiAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICB9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignSG9tZUN0cmwnLCBIb21lQ3RybCk7XG5cbiAgZnVuY3Rpb24gSG9tZUN0cmwoKSB7XG4gICAgdmFyIHZtID0gdGhpcztcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHt9XG4gIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCd0b2dnbGVTdWJtZW51JywgdG9nZ2xlU3VibWVudSk7XG5cbiAgZnVuY3Rpb24gdG9nZ2xlU3VibWVudSgpIHtcbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsKSB7XG4gICAgICBlbC5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVsLm5leHQoKS5zbGlkZVRvZ2dsZSgyMDApO1xuICAgICAgICBlbC5wYXJlbnQoKS50b2dnbGVDbGFzcygndG9nZ2xlZCcpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnd2F2ZXNFZmZlY3QnLCB3YXZlc0VmZmVjdCk7XG5cbiAgZnVuY3Rpb24gd2F2ZXNFZmZlY3QoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQycsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICBpZiAoZWxlbWVudC5oYXNDbGFzcygnYnRuLWljb24nKSB8fCBlbGVtZW50Lmhhc0NsYXNzKCdidG4tZmxvYXQnKSkge1xuICAgICAgICBXYXZlcy5hdHRhY2goZWxlbWVudCwgWyd3YXZlcy1jaXJjbGUnXSk7XG4gICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ2J0bi1saWdodCcpKSB7XG4gICAgICAgIFdhdmVzLmF0dGFjaChlbGVtZW50LCBbJ3dhdmVzLWxpZ2h0J10pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgV2F2ZXMuYXR0YWNoKGVsZW1lbnQpO1xuICAgICAgfVxuXG4gICAgICBXYXZlcy5pbml0KCk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnZmdMaW5lJywgZmdMaW5lKTtcblxuICBmdW5jdGlvbiBmZ0xpbmUoKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlc3RyaWN0OiAnQycsXG4gICAgICBsaW5rOiBsaW5rRnVuYyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICB2YXIgaW5wdXQgPSBlbGVtZW50LmNoaWxkcmVuKCkuZmlyc3QoKTtcbiAgICAgIHZhciBpc0Zsb2F0TGFiZWwgPSBlbGVtZW50LnBhcmVudCgpLmhhc0NsYXNzKCdmZy1mbG9hdCcpO1xuICAgICAgaW5wdXQuZm9jdXMoZnVuY3Rpb24gKCkge1xuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdmZy10b2dnbGVkJyk7XG4gICAgICB9KTtcblxuICAgICAgaW5wdXQuYmx1cihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghaXNGbG9hdExhYmVsIHx8IChpc0Zsb2F0TGFiZWwgJiYgaW5wdXQudmFsKCkubGVuZ3RoID09PSAwKSkge1xuICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2ZnLXRvZ2dsZWQnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
